<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="640" Id="frmitem0021MEduEquipmentHMgmt" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="교육기자재관리" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="800" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oCode1">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCode2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCode3">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSubulGubunH">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>교재개발과&#32;수령</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>타지부&#32;수령</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>사용</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oUseTargetB">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>교육</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>타지부지원</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>기타</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibuAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRCode">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="EIBTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EIMTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EISTITLE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduSchedule">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>사용</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>미사용</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSubulGubunV">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>제작</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oBCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="EIBTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EIMTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EISTITLE" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
						<EIBTITLE></EIBTITLE>
						<EIMTITLE></EIMTITLE>
						<EISTITLE></EISTITLE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioEduEquipmentH" OnRowPosChanged="ds_ioEduEquipmentH_OnRowPosChanged">
				<Contents>
					<colinfo id="EQHMGNO" size="100" summ="default" type="STRING"/>
					<colinfo id="EQHBUYDATE" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHBUYGTMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BUYGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="EQHMGGTMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MGGTMGNO" size="8" summ="default" type="STRING"/>
					<colinfo id="EQHITEMNO" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHBUYSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHEQCCD1" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHEQCCD2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHEQCCD3" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHCD" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHNM" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHQTY" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHBUYAMOUNT" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHBUYGUBUN" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHHOLDGUBUN" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="HOLDGUBUN" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHDISCARDGUBUN" size="30" summ="default" type="STRING"/>
					<colinfo id="DISCARDGUBUN" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHDISCARDDATE" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHREMARK" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHREGDATE" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHREGSABUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHMODDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHMODSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHDELGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHSAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHFILESIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHDIRPATH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioEduEquipmentHUnit">
				<Contents>
					<colinfo id="EQHMGNO" size="100" summ="default" type="STRING"/>
					<colinfo id="EQHBUYDATE" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHBUYGTMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="BUYGTMGNO" size="10" summ="default" type="STRING"/>
					<colinfo id="EQHMGGTMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="MGGTMGNO" size="10" summ="default" type="STRING"/>
					<colinfo id="EQHITEMNO" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHBUYSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHEQCCD1" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHEQCCD2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHEQCCD3" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHCD" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHNM" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHQTY" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHBUYAMOUNT" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHBUYGUBUN" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHHOLDGUBUN" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="HOLDGUBUN" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHDISCARDGUBUN" size="30" summ="default" type="STRING"/>
					<colinfo id="DISCARDGUBUN" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHDISCARDDATE" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EQHREMARK" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHREGDATE" size="30" summ="default" type="STRING"/>
					<colinfo id="EQHREGSABUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EQHMODDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHMODSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHDELGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHSAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHFILESIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="EQHDIRPATH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioEduEquipmentSingle">
				<Contents>
					<colinfo id="EQCMGNO" size="22" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iOnlyKey">
				<Contents>
					<colinfo id="ONLYKEY" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="ACTION" size="1" summ="default" type="STRING"/>
					<record>
						<ACTION>X</ACTION>
						<ONLYKEY>0</ONLYKEY>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduScheduleSingle">
				<Contents>
					<colinfo id="CGROUPNM" size="50" type="STRING"/>
					<colinfo id="EDUTIME" size="13" type="STRING"/>
					<colinfo id="EPNM" size="100" type="STRING"/>
					<colinfo id="EPSAVENM" size="256" type="STRING"/>
					<colinfo id="ESACCESSCNT" size="22" type="DECIMAL"/>
					<colinfo id="ESCOUSECD" size="2" type="STRING"/>
					<colinfo id="ESDATE" size="8" type="STRING"/>
					<colinfo id="ESENDTIME" size="4" type="STRING"/>
					<colinfo id="ESEPMGNO" size="22" type="DECIMAL"/>
					<colinfo id="ESGTMGNO" size="4" type="STRING"/>
					<colinfo id="ESGUBUN" size="1" type="STRING"/>
					<colinfo id="ESINETCLOSEDATE" size="8" type="STRING"/>
					<colinfo id="ESINETJUBSUCNT" size="22" type="DECIMAL"/>
					<colinfo id="ESMGNO" size="22" type="DECIMAL"/>
					<colinfo id="ESNOTICE" size="200" type="STRING"/>
					<colinfo id="ESPREPARED" size="200" type="STRING"/>
					<colinfo id="ESSEATCNT" size="22" type="DECIMAL"/>
					<colinfo id="ESSTARTTIME" size="4" type="STRING"/>
					<colinfo id="ESSTUDENT" size="1" type="STRING"/>
					<colinfo id="ESSUBJECTGUBUN" size="1" type="STRING"/>
					<colinfo id="ESYEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingOrderSingle">
				<Contents>
					<colinfo id="COURSEMUNJECD" size="4" type="STRING"/>
					<colinfo id="JUBSUCNT" size="22" type="DECIMAL"/>
					<colinfo id="TOCOURSEGUBUN" size="2" type="STRING"/>
					<colinfo id="TOCOURSEGUBUNNM" size="50" type="STRING"/>
					<colinfo id="TOEDUCONTENTS" size="1000" type="STRING"/>
					<colinfo id="TOEDUREMARK" size="1000" type="STRING"/>
					<colinfo id="TOENDDATE" size="8" type="STRING"/>
					<colinfo id="TOENDTIME" size="4" type="STRING"/>
					<colinfo id="TOEPMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TOINETJUBSUCNT" size="22" type="DECIMAL"/>
					<colinfo id="TOINETJUBSUYN" size="1" type="STRING"/>
					<colinfo id="TOJUBSUMAXCNT" size="22" type="DECIMAL"/>
					<colinfo id="TOJUBSUSTATUS" size="2" type="STRING"/>
					<colinfo id="TOMAILNOTICE" size="1000" type="STRING"/>
					<colinfo id="TOMGGTMGNO" size="4" type="STRING"/>
					<colinfo id="TOMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TOMODDATE" size="7" type="DATE"/>
					<colinfo id="TOMODSABUN" size="8" type="STRING"/>
					<colinfo id="TOMUNJEGUBUN" size="2" type="STRING"/>
					<colinfo id="TOREGDATE" size="7" type="DATE"/>
					<colinfo id="TOREGSABUN" size="8" type="STRING"/>
					<colinfo id="TOREMARK" size="100" type="STRING"/>
					<colinfo id="TOSEATCNT" size="22" type="DECIMAL"/>
					<colinfo id="TOSEATLIMITYN" size="1" type="STRING"/>
					<colinfo id="TOSEATSELECTYN" size="1" type="STRING"/>
					<colinfo id="TOSEXLIMITYN" size="1" type="STRING"/>
					<colinfo id="TOSTARTDATE" size="8" type="STRING"/>
					<colinfo id="TOSTARTTIME" size="4" type="STRING"/>
					<colinfo id="TOTCCOURSECD" size="2" type="STRING"/>
					<colinfo id="TOTRAININGORDER" size="3" type="STRING"/>
					<colinfo id="TOUSEYN" size="1" type="STRING"/>
					<colinfo id="TOYEAR" size="4" type="STRING"/>
					<colinfo id="COURSENM" size="100" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oUseTargetL">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>신규</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>교부</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>재교부</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>훼손</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>기타</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oUseTargetF">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>사용</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>훼손</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>기타</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oUseTargetC">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>사용</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>훼손</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>기타</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oReceiveJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oQty">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>0</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>1</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>2</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>3</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>4</DATA>
					</record>
					<record>
						<CD>5</CD>
						<DATA>5</DATA>
					</record>
					<record>
						<CD>6</CD>
						<DATA>6</DATA>
					</record>
					<record>
						<CD>7</CD>
						<DATA>7</DATA>
					</record>
					<record>
						<CD>8</CD>
						<DATA>8</DATA>
					</record>
					<record>
						<CD>9</CD>
						<DATA>9</DATA>
					</record>
					<record>
						<CD>10</CD>
						<DATA>10</DATA>
					</record>
					<record>
						<CD>11</CD>
						<DATA>11</DATA>
					</record>
					<record>
						<CD>12</CD>
						<DATA>12</DATA>
					</record>
					<record>
						<CD>13</CD>
						<DATA>13</DATA>
					</record>
					<record>
						<CD>14</CD>
						<DATA>14</DATA>
					</record>
					<record>
						<CD>15</CD>
						<DATA>15</DATA>
					</record>
					<record>
						<CD>16</CD>
						<DATA>16</DATA>
					</record>
					<record>
						<CD>17</CD>
						<DATA>17</DATA>
					</record>
					<record>
						<CD>18</CD>
						<DATA>18</DATA>
					</record>
					<record>
						<CD>19</CD>
						<DATA>19</DATA>
					</record>
					<record>
						<CD>20</CD>
						<DATA>20</DATA>
					</record>
					<record>
						<CD>21</CD>
						<DATA>21</DATA>
					</record>
					<record>
						<CD>22</CD>
						<DATA>22</DATA>
					</record>
					<record>
						<CD>23</CD>
						<DATA>23</DATA>
					</record>
					<record>
						<CD>24</CD>
						<DATA>24</DATA>
					</record>
					<record>
						<CD>25</CD>
						<DATA>25</DATA>
					</record>
					<record>
						<CD>26</CD>
						<DATA>26</DATA>
					</record>
					<record>
						<CD>27</CD>
						<DATA>27</DATA>
					</record>
					<record>
						<CD>28</CD>
						<DATA>28</DATA>
					</record>
					<record>
						<CD>29</CD>
						<DATA>29</DATA>
					</record>
					<record>
						<CD>30</CD>
						<DATA>30</DATA>
					</record>
					<record>
						<CD>31</CD>
						<DATA>31</DATA>
					</record>
					<record>
						<CD>32</CD>
						<DATA>32</DATA>
					</record>
					<record>
						<CD>33</CD>
						<DATA>33</DATA>
					</record>
					<record>
						<CD>34</CD>
						<DATA>34</DATA>
					</record>
					<record>
						<CD>35</CD>
						<DATA>35</DATA>
					</record>
					<record>
						<CD>36</CD>
						<DATA>36</DATA>
					</record>
					<record>
						<CD>37</CD>
						<DATA>37</DATA>
					</record>
					<record>
						<CD>38</CD>
						<DATA>38</DATA>
					</record>
					<record>
						<CD>39</CD>
						<DATA>39</DATA>
					</record>
					<record>
						<CD>40</CD>
						<DATA>40</DATA>
					</record>
					<record>
						<CD>41</CD>
						<DATA>41</DATA>
					</record>
					<record>
						<CD>42</CD>
						<DATA>42</DATA>
					</record>
					<record>
						<CD>43</CD>
						<DATA>43</DATA>
					</record>
					<record>
						<CD>44</CD>
						<DATA>44</DATA>
					</record>
					<record>
						<CD>45</CD>
						<DATA>45</DATA>
					</record>
					<record>
						<CD>46</CD>
						<DATA>46</DATA>
					</record>
					<record>
						<CD>47</CD>
						<DATA>47</DATA>
					</record>
					<record>
						<CD>48</CD>
						<DATA>48</DATA>
					</record>
					<record>
						<CD>49</CD>
						<DATA>49</DATA>
					</record>
					<record>
						<CD>50</CD>
						<DATA>50</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oBuyGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택</DATA>
					</record>
					<record>
						<CD>0</CD>
						<DATA>구입</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>본회수령</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>기증</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>자체제작</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oHoldGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>양호</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>불량(폐기요)</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>불량(수리요)</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>불량(기타)</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDiscardGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>미폐기</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>폐기</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>반납</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>매각</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oBuyJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="632" Height="236" Id="Shape1" Left="3" LineColor="user15" Right="795" TabOrder="18" Top="396" Type="Rectangle" Width="792"></Shape>
		<Shape Bottom="84" Height="28" Id="shpGubunBox1" Left="4" LineColor="user15" Right="795" TabOrder="0" Top="56" Type="Rectangle" Width="791"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="0" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="284">
			<Contents></Contents>
		</Div>
		<Shape Bottom="52" Height="52" Id="Shape0" Left="443" LineColor="user14" Right="795" TabOrder="16" Top="0" Type="Rectangle" Width="352"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="446" OnClick="lfn_Search" Style="sty_Button" TabOrder="5" ToolTipText="조회" Top="27" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnInput" ImageID="BTN_COM_ADD" Left="533" OnClick="lfn_Input" Style="sty_Button" TabOrder="6" ToolTipText="추가&#32;저장" Top="27" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="707" OnClick="lfn_Delete" Style="sty_Button" TabOrder="8" ToolTipText="삭제&#32;저장" Top="27" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="620" OnClick="lfn_Save" Style="sty_Button" TabOrder="7" ToolTipText="수정&#32;저장" Top="27" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="446" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="1" ToolTipText="입력&#32;초기화" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="533" OnClick="lfn_Excel" Style="sty_Button" TabOrder="2" ToolTipText="엑셀로&#32;저장" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="620" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="3" ToolTipText="화면&#32;출력" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="707" OnClick="lfn_End" Style="sty_Button" TabOrder="4" ToolTipText="닫기" Top="3" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static8" Left="-144" Style="sty_LabelGruopBox" TabOrder="16" Text="안전원&#32;교수&#32;관리" Top="63" VAlign="Middle" Width="120"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="720" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="10" Top="88" Transparent="TRUE" Width="74"></Button>
		<Static Align="Center" Height="20" Id="lbTotalCnt" Left="4" Style="sty_LabelStat" TabOrder="18" Text="총건수" Top="88" VAlign="Middle" Width="68"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medTotalCnt" Left="75" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="17" Top="88" UserData="S" Width="68"></MaskEdit>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioEduEquipmentH" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="392" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="280" Id="gdEduEquipmentH" InputPanel="FALSE" Left="4" LineColor="default" OnHeadClick="gdEduEquipmentH_OnHeadClick" Right="795" RowHeight="20" Style="sty_Grid" TabOrder="11" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UserData="교보재수불정보목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="791">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="77"/>
						<col width="0"/>
						<col width="81"/>
						<col width="142"/>
						<col width="57"/>
						<col width="80"/>
						<col width="90"/>
						<col width="82"/>
						<col width="56"/>
						<col width="62"/>
						<col width="76"/>
						<col width="178"/>
						<col width="91"/>
						<col width="68"/>
						<col width="71"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell col="1" display="text" text="관리부서"/>
						<cell align="center" col="2" display="text" text="교재분류"/>
						<cell align="center" col="3" display="text" text="품목코드"/>
						<cell col="4" display="text" text="교육기자재명"/>
						<cell align="center" col="5" display="text" text="수량"/>
						<cell col="6" display="text" text="구입일자"/>
						<cell col="7" display="text" text="취득금액"/>
						<cell align="center" col="8" combocol="CD" combodataset="ds_oUseTarget" combotext="DATA" display="text" text="보유상태"/>
						<cell align="center" col="9" display="text" text="이미지"/>
						<cell align="center" col="10" combocol="CD" combodataset="ds_oUseTarget" combotext="DATA" display="text" text="폐기구분"/>
						<cell col="11" display="text" text="폐기일자"/>
						<cell col="12" display="text" text="설치위치"/>
						<cell col="13" display="text" text="구입부서"/>
						<cell col="14" display="text" text="품목번호"/>
						<cell col="15" display="text" text="구입순번"/>
					</head>
					<body>
						<cell align="center" col="0" colid="no" display="text" expr="currow+1" text="1"/>
						<cell align="center" col="1" colid="MGGTMGNO" display="normal"/>
						<cell align="center" col="2" colid="EIKINDGUBUNNM" display="text"/>
						<cell align="center" col="3" colid="EQHCD" display="text"/>
						<cell align="center" col="4" colid="EQHNM" display="text"/>
						<cell align="right" col="5" colid="EQHQTY" display="text"/>
						<cell align="center" col="6" colid="EQHBUYDATE" display="text" Mask="####-##-##"/>
						<cell align="right" col="7" colid="EQHBUYAMOUNT" display="number" Mask="###,###,###원"/>
						<cell align="center" col="8" colid="HOLDGUBUN" display="text"/>
						<cell align="center" col="9" display="text" expr='DECODE(EQHSAVENM,null,&#32;&quot;X&quot;,&quot;○&quot;)'/>
						<cell align="center" col="10" colid="DISCARDGUBUN" display="normal"/>
						<cell align="center" col="11" colid="EQHDISCARDDATE" display="text" Mask="####-##-##"/>
						<cell col="12" colid="EQHREMARK" display="text"/>
						<cell align="center" col="13" colid="BUYGTMGNO" display="text"/>
						<cell align="center" col="14" colid="EQHITEMNO" display="text"/>
						<cell align="center" col="15" colid="EQHBUYSEQ" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="20" Text="관리지부" Top="60" UserData="S" VAlign="Middle" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibuAll" Left="82" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="9" Top="59" UserData="S" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="lbDept" Left="8" Style="sty_Label" TabOrder="21" Text="관리지부" Top="402" VAlign="Middle" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" Column="EQHMGGTMGNO" DataColumn="DATA" Height="20" Id="cbxMgDept" INDEX="0" InnerDataset="ds_oJibu" Left="82" OnChanged="cbxMgDept_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="12" Top="401" Value="0" Width="112"></Combo>
		<Static Align="Center" BKColor="user37" Font="굴림,14,Bold" Height="26" Id="lbStatus" Left="699" Style="sty_LabelStat" TabOrder="22" Text="추가모드" Top="398" VAlign="Middle" Width="94"></Static>
		<Shape Bottom="504" Height="78" Id="Shape2" Left="8" LineColor="user15" Right="382" TabOrder="23" Top="426" Type="Rectangle" Width="374"></Shape>
		<Combo BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" CodeColumn="CD" Column="EQHEQCCD1" DataColumn="DATA" Height="20" Id="cbxEECD1" ImeMode="none" INDEX="0" InnerDataset="ds_oCode1" Left="89" OnChanged="cbxEECD1_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="24" Top="429" Value="0" Width="270"></Combo>
		<Static Align="Center" Height="20" Id="lbEiBCd" Left="36" Style="sty_Label" TabOrder="25" Text="대분류" Top="430" VAlign="Middle" Width="50"></Static>
		<Static Align="Center" Height="20" Id="Static0" Left="8" Style="sty_Label" TabOrder="26" Text="교육기자재명" Top="508" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" CodeColumn="CD" Column="EQHEQCCD2" DataColumn="DATA" Height="20" Id="cbxEECD2" INDEX="0" InnerDataset="ds_oCode2" Left="89" OnChanged="cbxEECD2_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="27" Top="453" Value="0" Width="270"></Combo>
		<Static Align="Center" Height="20" Id="Static1" Left="36" Style="sty_Label" TabOrder="28" Text="중분류" Top="454" VAlign="Middle" Width="50"></Static>
		<Combo BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" CodeColumn="CD" Column="EQHEQCCD3" DataColumn="DATA" Height="20" Id="cbxEECD3" INDEX="0" InnerDataset="ds_oCode3" Left="89" OnChanged="cbxEECD3_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="29" Top="477" Value="0" Width="270"></Combo>
		<Static Align="Center" Height="20" Id="Static2" Left="36" Style="sty_Label" TabOrder="30" Text="소분류" Top="478" VAlign="Middle" Width="50"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Column="EQHNM" Height="20" Id="edEquipmentNM" ImeMode="native" Left="91" LeftMargin="2" MaxLength="50" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="31" Top="508" UserData="S" Width="349"></Edit>
		<Static Align="Center" BKColor="user31" Height="70" Id="Static3" Left="12" Style="sty_Label" TabOrder="32" Text="품&#10;목&#10;분&#10;류" Top="430" VAlign="Middle" Width="20"></Static>
		<Shape Bottom="504" Height="78" Id="Shape3" Left="384" LineColor="user15" Right="792" TabOrder="33" Top="426" Type="Rectangle" Width="408"></Shape>
		<Static Align="Center" BKColor="user31" Height="70" Id="Static4" Left="388" Style="sty_Label" TabOrder="34" Text="집&#10;기&#10;비&#10;품" Top="430" VAlign="Middle" Width="20"></Static>
		<Static Align="Center" Height="20" Id="Static5" Left="411" Style="sty_Label" TabOrder="35" Text="구입일자" Top="430" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="20" Id="Static6" Left="411" Style="sty_Label" TabOrder="37" Text="구입부서" Top="454" VAlign="Middle" Width="70"></Static>
		<Combo Border="Flat" CodeColumn="CD" Column="EQHBUYGTMGNO" DataColumn="DATA" Height="20" Id="cbxBuyDept" INDEX="0" InnerDataset="ds_oBuyJibu" Left="483" OnChanged="cbxBuyDept_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="36" Top="453" Value="0" Width="112"></Combo>
		<Calendar BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Column="EQHBUYDATE" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calBuyDate" Left="484" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="38" Top="430" UserData="S" WeeksFont="돋음,9" Width="100"></Calendar>
		<Static Align="Center" Height="20" Id="Static9" Left="411" Style="sty_Label" TabOrder="39" Text="품목번호" Top="478" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="20" Id="Static10" Left="594" Style="sty_Label" TabOrder="40" Text="구입순번" Top="478" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Column="EQHITEMNO" Enable="FALSE" Height="20" Id="edItemNo" ImeMode="native" Left="484" LeftMargin="2" MaxLength="50" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="41" Text="1" Top="478" UserData="S" Width="50"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Column="EQHBUYSEQ" Height="20" Id="edBuySeq" ImeMode="native" Left="667" LeftMargin="2" MaxLength="50" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="42" Top="478" UserData="S" Width="50"></Edit>
		<Static Align="Center" Height="20" Id="lbEiRCd" Left="8" Style="sty_Label" TabOrder="43" Text="수량" Top="532" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" CodeColumn="CD" Column="EQHQTY" DataColumn="DATA" Height="20" Id="cbxQty" INDEX="0" InnerDataset="ds_oQty" Left="90" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="44" Top="531" Value="0" Width="70"></Combo>
		<Static Align="Center" Height="20" Id="Static11" Left="163" Style="sty_Label" TabOrder="45" Text="취득금액" Top="532" VAlign="Middle" Width="80"></Static>
		<Static Height="20" Id="Static12" Left="426" TabOrder="46" Text="원" Top="533" VAlign="Middle" Width="20"></Static>
		<MaskEdit BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" BorderColor="user14" Column="EQHBUYAMOUNT" Height="21" Id="medBuyAmount" Left="338" TabOrder="47" Top="532" Width="86"></MaskEdit>
		<Static Align="Center" Height="20" Id="Static14" Left="8" Style="sty_Label" TabOrder="48" Text="보유상태" Top="556" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="20" Id="Static15" Left="8" Style="sty_Label" TabOrder="49" Text="설치위치" Top="580" VAlign="Middle" Width="80"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Column="EQHREMARK" Height="20" Id="edRemark" ImeMode="native" Left="91" LeftMargin="2" MaxLength="50" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="50" Top="580" UserData="S" Width="349"></Edit>
		<Shape Bottom="629" Height="26" Id="Shape4" Left="8" LineColor="user15" Right="440" TabOrder="51" Top="603" Type="Rectangle" Width="432"></Shape>
		<Combo BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" CodeColumn="CD" Column="EQHBUYGUBUN" DataColumn="DATA" Height="20" Id="cbxBuyGubun" ImeMode="none" INDEX="0" InnerDataset="ds_oBuyGubun" Left="245" OnChanged="cbxBuyGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="52" Top="531" Value="0" Width="91"></Combo>
		<Static Align="Center" BKColor="user31" Height="20" Id="Static16" Left="12" Style="sty_Label" TabOrder="53" Text="폐기&#32;등" Top="606" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="20" Id="Static17" Left="86" Style="sty_Label" TabOrder="54" Text="구분" Top="606" VAlign="Middle" Width="60"></Static>
		<Combo BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" CodeColumn="CD" Column="EQHDISCARDGUBUN" DataColumn="DATA" Height="20" Id="cbxDiscardGubun" ImeMode="none" INDEX="0" InnerDataset="ds_oDiscardGubun" Left="148" OnChanged="cbxDiscardGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="55" Top="605" Value="0" Width="92"></Combo>
		<Static Align="Center" Height="20" Id="Static18" Left="248" Style="sty_Label" TabOrder="56" Text="폐기일자" Top="606" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Column="EQHDISCARDDATE" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calDiscardDate" Left="331" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="57" Top="606" UserData="S" WeeksFont="돋음,9" Width="100"></Calendar>
		<Static Align="Center" Height="20" Id="Static19" Left="194" Style="sty_Label" TabOrder="58" Text="구입일자" Top="60" VAlign="Middle" Width="70"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calBuyDateFrom" Left="267" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="59" Top="60" UserData="S" WeeksFont="돋음,9" Width="100"></Calendar>
		<Static Align="Center" Height="20" Id="Static22" Left="368" Style="sty_Text" TabOrder="61" Text="~" Top="62" VAlign="Middle" Width="20"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calBuyDateTo" Left="388" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="60" Top="60" UserData="S" WeeksFont="돋음,9" Width="100"></Calendar>
		<Radio BindDataset="ds_ioEduEquipmentHUnit" CodeColumn="CD" Column="EQHHOLDGUBUN" ColumnCount="4" DataColumn="DATA" Height="20" Id="radHoldGubun" INDEX="-1" InnerDataset="ds_oHoldGubun" Left="91" OnKeyDown="gfn_EnterNextFocus" TabOrder="62" Top="557" Value="0" Width="349"></Radio>
		<Shape Bottom="629" Height="122" Id="Shape5" Left="444" LineColor="user15" Right="792" TabOrder="63" Top="507" Type="Rectangle" Width="348"></Shape>
		<Image Border="Flat" FillType="STRETCH" Height="114" Id="imgPicture" Left="688" Style="sty_Image" TabOrder="64" Text="이미지" Top="512" Transparent="TRUE" Width="100"></Image>
		<Static Align="Center" Height="20" Id="Static7" Left="471" Style="sty_Label" TabOrder="65" Text="이미지&#32;파일" Top="512" VAlign="Middle" Width="89"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnImage" ImageID="BTN_TEXT_07" Left="564" OnClick="btnImage_OnClick" Style="sty_Button" TabOrder="66" Text="이미지&#32;업로드" Top="511" Transparent="TRUE" Width="108"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduEquipmentHUnit" Border="Flat" Enable="FALSE" Height="20" Id="edImageFile" ImeMode="native" Left="472" LeftMargin="2" MaxLength="50" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="67" Top="537" UserData="S" Width="212"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadImage" ImageID="BTN_TEXT_07" Left="580" OnClick="btnLoadImage_OnClick" Style="sty_Button" TabOrder="68" Text="이미지&#32;확대보기" Top="572" Transparent="TRUE" Width="108"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnImageDownload" ImageID="BTN_TEXT_07" Left="580" OnClick="btnImageDownload_OnClick" Style="sty_Button" TabOrder="69" Text="이미지&#32;다운로드" Top="600" Transparent="TRUE" Width="108"></Button>
		<File Bottom="584" Height="24" Id="fiAttachFile" Left="472" Right="496" TabOrder="71" Top="560" Width="24"></File>
		<FileDialog Bottom="584" Height="24" Id="fdAttachFile" Left="500" Right="524" TabOrder="70" Top="560" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfAttachFile" Left="526" Top="560" Width="24"></HttpFile>
		<Static Height="20" Id="lbFileSize" Left="472" Style="sty_Text" TabOrder="70" Top="600" UserData="S" VAlign="Middle" Visible="FALSE" Width="112"></Static>
		<Static Align="Center" BKColor="user31" Height="112" Id="Static13" Left="448" Style="sty_Label" TabOrder="71" Text="이&#10;&#10;미&#10;&#10;지" Top="512" VAlign="Middle" Width="20"></Static>
	</Form>
	<Script><![CDATA[/*

 * 프로그램명 : frmitem0021MEduEquipmentHMgmt.xml

 * 설명 : 교육기자재 관리

 * 작성일 : 2012.12.11

 * 작성자 : 정현호

 */

 

#include "LIB::item.js"; // 공통업무 관련


var sEQCMGNO = "";

var lb_FileUpload = false;
var ls_UploadFileName = "ITEM"; //서버에 저장될 파일 명
var ls_FileUploadPath = "/ITEMDATA";
var ls_RealFileName = "";
var ls_UploadRealName = "";

var lb_FileDelete = false;

/* 공통 필수 시작 */

function Form_OnLoadCompleted(obj) {

    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리



    // 폼 환경설정

    ls_SystemGubun = gs_SystemGubun;

    ls_SystemMenuId = gs_SystemMenuId;

    var ls_FormId = split(sFormUrl, "::");

    ls_FormId = split(ls_FormId[1], ".");

    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";



    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.



    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.

    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정

        lfn_SetFormAuth(true); // 저장 권한

    } else if (ms_FormAuth == "R") {

        lfn_SetFormAuth(false); // 읽기 권한

    } else {

        gfn_Alert(MSGI00080);

        close();

    }

    

	lfn_MakeJibuSearchCode("A"); // 조회용 관리지부 콤보 생성

    lfn_MakeJibuSearchCode("B"); // 관리지부 콤보 생성
    
    lfn_MakeJibuSearchCode("C"); // 구입부서 콤보 생성

	calBuyDateFrom.Value = left(getDate(), 4) + "0101";
	
	calBuyDateTo.Value = left(getDate(), 8);
	
	cbxBuyGubun_OnChanged(cbxBuyGubun, "0"); // 취득구분 변경

}



/*

 * 기능 :폼사이즈 조정

 */

function Form_OnSize(obj,nCx,nCy,nState) {

    if (gs_IsResizingForm == "Y") {

		// gdEduItemH.Height = nCy - gdEduItemH.Top - 4;

		// gdEduItemH.Width = nCx - gdEduItemH.Left - 4;

    }

}



/*

 * 기능 : 조회

 */

function lfn_Search() {

	lfn_SearchEduEquipmentHList(); // 교육기자재 정보목록 조회

	if (ds_ioEduEquipmentH.row == -1) {

		mb_IsNewData = false; // 저장버튼이 클릭 설정

		lbStatus.Text = "초기모드";

	}

	if (ds_iOnlyKey.GetColumn(0, "ACTION") == "S") {

		ds_ioEduEquipmentH.row = ds_ioEduEquipmentH.FindRow("EQHMGNO", ds_iOnlyKey.GetColumn(0, "ONLYKEY"));

		ds_iOnlyKey.SetColumn(0, "ACTION", "X"); // 디폴트
		
	}

	ds_ioEduEquipmentH_OnRowPosChanged(ds_ioEduEquipmentH,ds_ioEduEquipmentH.row,ds_ioEduEquipmentH.row);

	lfn_btnImageCheck();
	

}



/*

 * 기능 : 교육기자재 정보 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduEquipmentHList() {

	ds_ioEduEquipmentH.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0021EduEquipmentHList", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_ioEduEquipmentH=ds_oData" // outDs

		,"GTMGNO=" + quote(cbxJibu.Value) //-- 부서&지부

			+" BUYDATEFROM=" + quote(calBuyDateFrom.Value) // -- 구입일자

			+" BUYDATETO=" + quote(calBuyDateTo.Value)     // -- 구입일자

		,"lfn_AfterSearchEduEquipmentHList"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 교육기자재 정보 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduEquipmentHList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    

    medTotalCnt.Value = ds_ioEduEquipmentH.GetRowCount();

	cbxBuyGubun_OnChanged(cbxBuyGubun, cbxBuyGubun.Value); // 취득구분 변경

    gfn_SearchMessage(gdEduEquipmentH); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

}



/*

 * 기능 : 그리드 정렬 및 체크박스 전체선택

 */

function gdEduEquipmentH_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {

	if (nCell > 0) {

		var lobj_Dataset = object(obj.BindDataset);

		// 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.

		if (lobj_Dataset.GetRowCount() > 1) {

			gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.

		}

	}

}



/*

 * 기능 : 다중정렬

 */

function btnMutilSort_OnClick(obj) {

	gfn_GridMultiSort(gdEduEquipmentH, 1); // 멀티 정렬을 실행한다.

}



/*

 * 기능 : 버튼 활성/비활성시킨다.

 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)

 * return : 없음

 */

function lfn_SetFormAuth(bStatus) {

    btnInput.Enable = bStatus; // 추가 버튼

    btnSave.Enable = bStatus; // 저장 버튼

    btnDelete.Enable = bStatus; // 삭제 버튼

    gdEduEquipmentH.Editable = bStatus;

}



/*

 * 기능 : 폼 키처리

 */

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

    // to do

    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리

}



/*

 * 기능 : 부서/지부 콤보 생성

 */

function lfn_MakeJibuSearchCode(sGubun) {

	if (sGubun == "A") {

		ds_oJibuAll.ClearData(); // 데이타셋 초기화

		gfn_SearchAllJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회


		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM" 
		    || gds_oUserInfo.GetColumn(0, "PDEPTCD") == "0252"
		    || gds_oUserInfo.GetColumn(0, "PDEPTCD") == "0211") { // 관리자 또는 교재개발과,감사실

			ds_oJibuAll.AddRow();
	
			ds_oJibuAll.SetColumn(ds_oJibuAll.row, "CD", "0240");
	
			ds_oJibuAll.SetColumn(ds_oJibuAll.row, "DATA", "경영관리부");
			
			ds_oJibuAll.AddRow();
	
			ds_oJibuAll.SetColumn(ds_oJibuAll.row, "CD", "0250");
	
			ds_oJibuAll.SetColumn(ds_oJibuAll.row, "DATA", "교육부");
	

			cbxJibu.Enable = true;

		} else {

			cbxJibu.Enable = false;

		}


		// cbxJibu.Index = 0; // 로그인한 사용자의 부서로 세팅

	} else if (sGubun == "B") {

		ds_oJibu.ClearData(); // 데이타셋 초기화

		gfn_SearchAllJibu(cbxMgDept, "Y", ""); // 지부 코드 조회

		ds_oJibu.AddRow();

		ds_oJibu.SetColumn(ds_oJibu.row, "CD", "0240");

		ds_oJibu.SetColumn(ds_oJibu.row, "DATA", "경영관리부");

		ds_oJibu.AddRow();

		ds_oJibu.SetColumn(ds_oJibu.row, "CD", "0250");

		ds_oJibu.SetColumn(ds_oJibu.row, "DATA", "교육부");

		cbxMgDept.Enable = true;

		cbxMgDept.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD"); // 로그인한 사용자의 부서로 세팅


	} else if (sGubun == "C") {

		ds_oBuyJibu.ClearData(); // 데이타셋 초기화

		gfn_SearchAllJibu(cbxBuyDept, "Y", ""); // 지부 코드 조회
		
		ds_oBuyJibu.AddRow();

		ds_oBuyJibu.SetColumn(ds_oBuyJibu.row, "CD", "0240");

		ds_oBuyJibu.SetColumn(ds_oBuyJibu.row, "DATA", "경영관리부");

		ds_oBuyJibu.AddRow();

		ds_oBuyJibu.SetColumn(ds_oBuyJibu.row, "CD", "0250");

		ds_oBuyJibu.SetColumn(ds_oBuyJibu.row, "DATA", "교육부");

		cbxBuyDept.Enable = true;

		cbxBuyDept.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD"); // 로그인한 사용자의 부서로 세팅

	}

}



/*

 * 기능 : 대분류코드 콤보 생성

 */

function lfn_MakeEduEquipmentCode1(sGubun) {

	if (sGubun == "B") {

		ds_oCode1.ClearData(); // 데이타셋 초기화

		lfn_SearchEduEquipmentCode1("ds_oCode1"); // 대분류코드 콤보목록 조회

		cbxEECD1.Index = 0;

	} else {

		ds_oCode1.ClearData(); // 데이타셋 초기화

		lfn_SearchEduEquipmentCode1("ds_oCode1"); // 대분류코드 콤보목록 조회

		cbxEECD1.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHEQCCD1");

	}

}



/*

 * 기능 : 중분류코드 콤보 생성

 */

function lfn_MakeEduEquipmentCode2(sGubun) {

	if (sGubun == "B") {

		ds_oCode2.ClearData(); // 데이타셋 초기화

		lfn_SearchEduEquipmentCode2("ds_oCode2", cbxEECD1.Value); // 중분류코드 콤보목록 조회

		cbxEECD2.Index = 0;

	} else {

		ds_oCode2.ClearData(); // 데이타셋 초기화

		lfn_SearchEduEquipmentCode2("ds_oCode2", cbxEECD1.Value); // 중분류코드 콤보목록 조회

		cbxEECD2.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHEQCCD2");

	}	

}



/*

 * 기능 : 소분류코드 콤보 생성

 */

function lfn_MakeEduEquipmentCode3(sGubun) {

	if (sGubun == "B") {

		ds_oCode3.ClearData(); // 데이타셋 초기화

		lfn_SearchEduEquipmentCode3("ds_oCode3", cbxEECD1.Value, cbxEECD2.Value); // 소분류코드 콤보목록 조회

		cbxEECD3.Index = 0;

	} else {

		ds_oCode3.ClearData(); // 데이타셋 초기화

		lfn_SearchEduEquipmentCode3("ds_oCode3", cbxEECD1.Value, cbxEECD2.Value); // 소분류코드 콤보목록 조회

		cbxEECD3.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHEQCCD3");

	}

}



/*

 * 기능 : 추가

 */

function lfn_Input() {

	if (ds_ioEduEquipmentH.row <> -1) {

		if (mb_IsNewData) {

			gfn_Alert("이미 추가 입력중입니다.\n입력완료 후 저장버튼을 눌러 저장하세요.");

			return false;

		}

	}

	if (ds_ioEduEquipmentHUnit.GetUpdate()) {

		if (gfn_Confirm("변경된 내용이 있습니다.\n변경완료 후 저장버튼을 눌러 저장하시겠습니까?")) {

			return false;

		} else {

			// 이전값으로 변경

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHBUYDATE", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHBUYDATE"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHBUYGTMGNO", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHBUYGTMGNO"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "BUYGTMGNO", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "BUYGTMGNO"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHMGGTMGNO", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHMGGTMGNO"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "MGGTMGNO", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "MGGTMGNO"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHITEMNO", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHITEMNO"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHBUYSEQ", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHBUYSEQ"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHEQCCD1", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHEQCCD1"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHEQCCD2", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHEQCCD2"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHEQCCD3", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHEQCCD3"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHCD", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHCD"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHNM", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHNM"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHQTY", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHQTY"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHBUYAMOUNT", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHBUYAMOUNT"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHBUYGUBUN", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHBUYGUBUN"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHHOLDGUBUN", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHHOLDGUBUN"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "HOLDGUBUN", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "HOLDGUBUN"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHDISCARDGUBUN", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHDISCARDGUBUN"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "DISCARDGUBUN", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "DISCARDGUBUN"));

			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHDISCARDDATE", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHDISCARDDATE"));
			
			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHREMARK", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHREMARK"));
			
			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHSAVENM", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHSAVENM"));
			
			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHREALNM", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHREALNM"));
			
			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHFILESIZE", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHFILESIZE"));
			
			ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHDIRPATH", ds_ioEduEquipmentH.GetOrgColumn(ds_ioEduEquipmentH.row, "EQHDIRPATH"));


			lfn_SetGridToDetailDynamic(); // 그리드 내용을 상세로 동적으로 적용

			ds_ioEduEquipmentHUnit.ApplyChange();

			return true;

		}

	}


	if (!gfn_Confirm("교육기자재 정보를 추가 등록 하시겠습니까?\n입력완료 후 저장 버튼을 누르세요.")) {

		return false;

	}

	

	lfn_AddDetail(); // 추가시 상세에 적용

}



/*

 * 기능 : 그리드 내용을 상세로 동적으로 적용

 */

function lfn_SetGridToDetailDynamic() {

	cbxMgDept.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHMGGTMGNO");


	lfn_MakeEduEquipmentCode1("G"); // 대분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode2("G"); // 중분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode3("G"); // 소분류코드 콤보목록 생성

	

	calBuyDate.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHBUYDATE");
	
	cbxBuyDept.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHBUYGTMGNO");
	
	edItemNo.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHITEMNO");
	
	edBuySeq.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHBUYSEQ");
	
	edEquipmentNM.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHNM");
	
	cbxQty.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHQTY");
	
	cbxBuyGubun.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHFREEREASON");
	
	medBuyAmount.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHBUYAMOUNT");
	
	radHoldGubun.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHHOLDGUBUN");
	
	edRemark.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHREMARK");
	
	cbxDiscardGubun.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHDISCARDGUBUN");
	
	calDiscardDate.Value = ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.row, "EQHDISCARDDATE");


}



/*

 * 기능 : 추가시 상세에 적용

 */

function lfn_AddDetail() {

	ds_ioEduEquipmentHUnit.ClearData();

	ds_ioEduEquipmentHUnit.AddRow();

	mb_IsNewData = true; // 저장버튼이 클릭 설정

	lbStatus.Text = "입력모드";

	
	lfn_MakeJibuSearchCode("B"); // 관리지부 콤보 생성
	
	lfn_MakeJibuSearchCode("C"); // 구입부서 콤보 생성

	lfn_MakeEduEquipmentCode1("B"); // 대분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode2("B"); // 중분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode3("B"); // 소분류코드 콤보목록 생성


	calBuyDate.Value = Today();

	cbxBuyDept.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");
	
	cbxMgDept.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");
	
	edItemNo.Value = "";
	
	edBuySeq.Value = "";
	
	edEquipmentNM.Value = "";
	
	cbxQty.Index = 0;
	
	cbxBuyGubun.Index = 0;
	
	medBuyAmount.Value = "";
	
	radHoldGubun.Index = 0;
	
	edRemark.Value = "";
	
	cbxDiscardGubun.Index = 0;
	
	calDiscardDate.Value = "";
	
	edItemNo.Text = "1";
	

	lfn_SearchEduEquipmentSingle(); // 교육기자재코드 관리번호 조회

	sEQCMGNO = ds_ioEduEquipmentSingle.GetColumn(0, "EQCMGNO");

    ls_RealFileName = "";
    lbFileSize.Text = "";
    edImageFile.Text = "";
    imgPicture.ImageID = "";
    imgPicture.Text = "이미지";
    lfn_btnImageCheck();

	//trace(sEQCMGNO);
}




/*

 * 기능 : 저장

 */

function lfn_Save(obj) {

	// if (!gfn_FormValidate(this)) { // 입력 Validation Check

        // return false;

    // }

    

    if (lbStatus.Text == "초기모드") {

		gfn_Alert("추가 버튼을 눌러 입력완료 후 저장버튼을 눌러 저장하세요.");

		return false;

    }


    if (calBuyDate.Value == "") {
    
		gfn_Alert("구입일자를 입력하세요.");

		calBuyDate.SetFocus();

		return false;

	}
	
	
    if (cbxBuyDept.Value == "") {
    
		gfn_Alert("구입부서를 입력하세요.");

		cbxBuyDept.SetFocus();

		return false;

	}

    if (cbxMgDept.Value == "") {
    
		gfn_Alert("관리부서를 입력하세요.");

		cbxMgDept.SetFocus();

		return false;

	}

    if (cbxQty.Index == 0) {

		gfn_Alert("수량을 입력하세요.");

		cbxQty.SetFocus();

		return false;

	}
	
	if (edEquipmentNM.Text == "") {
	
		gfn_Alert("교육기자재명을 입력하세요.");

		cbxQty.SetFocus();

		return false;
	
	}

	if (cbxBuyGubun.Index == 0) {
	
		gfn_Alert("취득구분을 선택하세요.");

		cbxBuyGubun.SetFocus();

		return false;
	
	}


	if (mb_IsNewData) { // 신규 저장

		if (!gfn_Confirm(MSGW00020)) { // 추가 저장 하시겠습니까?

			return false;

		}

		

		lfn_InsEduEquipmentH(); // 교육기자재정보 입력

	} else { // 수정 저장

		if (!gfn_Confirm(MSGW00040)) { // 수정 저장 하시겠습니까?

			return false;

		}

		

		ds_iOnlyKey.SetColumn(0, "ONLYKEY", ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHMGNO"));

		ds_iOnlyKey.SetColumn(0, "ACTION", "S");

		

		lfn_UpdEduEquipmentH(); // 교육기자재정보 수정

	}

}

/*

 * 기능 : 교육기자재 정보 입력

 * parameter : 없음

 * Return : 없음

 */

function lfn_InsEduEquipmentH() {


	ds_ioEduEquipmentHUnit.SetColumn(0, "EQHBUYGTMGNO", cbxBuyDept.Value);	// 구입부서

	ds_ioEduEquipmentHUnit.SetColumn(0, "EQHMGGTMGNO", cbxMgDept.Value);	// 관리부서
	
	
    if(lb_FileUpload) { //파일 업로드일 경우
    
        ls_UploadRealName = ls_UploadFileName + "_" + getDate() + right(timem(),3) + gfn_GetFileExtensionName(fdAttachFile.FileName);
                
        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHSAVENM"  , fdAttachFile.FileName);      //업로드파일명

        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHREALNM"  , ls_UploadRealName);          //실제파일명
        
        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHFILESIZE", StripNum(lbFileSize.text));  //파일사이즈
        
        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHDIRPATH" , ls_FileUploadPath);          //저장위치

	}
	
	
	
	tit_clearActionInfo();

    tit_AddSingleActionInfo("item:insertItem0021EduEquipmentH", "", 0, "", "N");

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,"ds_iData=ds_ioEduEquipmentHUnit:A" // inDs		

        ,""	// outDs

        ,"PSABUN=" + gds_oUserInfo.GetColumn(0, "PSABUN") //-- 작성자사번 // args 

        ,"lfn_AfterInsEduEquipmentH"

        ,false

        ,false

		,true

    );
    
}



/*

 * 기능 : 교육기자재정보 입력 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterInsEduEquipmentH(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    if (lb_FileUpload) { //이미지 등록일 경우
        if (Length(fdAttachFile.FileName) < 1) { //삭제 일 경우
            tit_FileDelete(
                ls_FileUploadPath
                , ls_RealFileName
                , false
            );
        } else { //변경일 경우
            //alert("tit_FileWrite를 샐행한다.");
            tit_FileWrite(
                hfAttachFile
                , ls_FileUploadPath
                , fdAttachFile.FilePath
                , fdAttachFile.FileName
                , ls_UploadRealName
                , "U"
                , ls_RealFileName
            );
            hfAttachFile.CloseFile();
        }
        lb_FileUpload = false;
    }	

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

	lfn_Search(); // 조회

}

/*

 * 기능 : 교육기자재정보 수정

 * parameter : 없음

 * Return : 없음

 */

function lfn_UpdEduEquipmentH(obj) {

	ds_ioEduEquipmentHUnit.SetColumn(0, "EQHBUYGTMGNO", cbxBuyDept.Value);	// 구입부서
	
	ds_ioEduEquipmentHUnit.SetColumn(0, "EQHMGGTMGNO", cbxMgDept.Value);	// 관리부서
	
	ds_ioEduEquipmentHUnit.SetColumn(0, "EQHMGNO", ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHMGNO"));


    if(lb_FileUpload) { //파일 업로드일 경우
    
		if (fdAttachFile.FileName == "") {	// 파일삭제의 경우
		
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHSAVENM"  , "");      //업로드파일명
		
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHREALNM"  , "");          //실제파일명
			
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHFILESIZE", "");  //파일사이즈
			
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHDIRPATH" , "");          //저장위치

		
		} else {	// 파일업로드
		
			ls_UploadRealName = ls_UploadFileName + "_" + getDate() + right(timem(),3) + gfn_GetFileExtensionName(fdAttachFile.FileName);

			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHSAVENM"  , fdAttachFile.FileName);      //업로드파일명
	
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHREALNM"  , ls_UploadRealName);          //실제파일명
			
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHFILESIZE", StripNum(lbFileSize.text));  //파일사이즈
			
			ds_ioEduEquipmentHUnit.SetColumn(0, "EQHDIRPATH" , ls_FileUploadPath);          //저장위치
        
        }
        


	} else {
	
        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHSAVENM"  , ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHSAVENM"));      //업로드파일명

        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHREALNM"  , ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHREALNM"));          //실제파일명
        
        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHFILESIZE", ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHFILESIZE"));  //파일사이즈
        
        ds_ioEduEquipmentHUnit.SetColumn(0, "EQHDIRPATH" , ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHDIRPATH"));          //저장위치
	
	}

	tit_clearActionInfo();

	tit_AddSingleActionInfo("item:updateItem0021EduEquipmentH", "", 0, "", "N");

	// 서버 호출 

	tit_callService(

		""

		,""

		,"ds_iData=ds_ioEduEquipmentHUnit:A" // inDs		

		,""	// outDs

		,"PSABUN=" + gds_oUserInfo.GetColumn(0, "PSABUN") //-- 작성자사번 // args 

		,"lfn_AfterUpdEduEquipmentH"

		,false

		,false

		,true

	);


}



/*

 * 기능 : 교육기자재정보 수정 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterUpdEduEquipmentH(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }


    if (lb_FileUpload) { //파일 변경일 경우
        if (Length(fdAttachFile.FileName) < 1) { //삭제 일 경우
            tit_FileDelete(
                ls_FileUploadPath
                , ls_RealFileName
                , false
            );
        } else { //변경일 경우
            //alert("tit_FileWrite를 샐행한다.");
            tit_FileWrite(
                hfAttachFile
                , ls_FileUploadPath
                , fdAttachFile.FilePath
                , fdAttachFile.FileName
                , ls_UploadRealName
                , "U"
                , ls_RealFileName
            );
            hfAttachFile.CloseFile();
        }
        lb_FileUpload = false;
    }
    

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

    lfn_Search(); // 조회

}



/*

 * 기능 : 교육기자재 코드관리번호 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduEquipmentSingle() {

	ds_ioEduEquipmentSingle.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0021EduEquipmentSingle", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_ioEduEquipmentSingle=ds_oData" // outDs

		,"CODE1=" + quote(cbxEECD1.Value) //-- 대분류

			+" CODE2=" + quote(cbxEECD2.Value) //-- 중분류

			+" CODE3=" + quote(cbxEECD3.Value) //-- 소분류  // args 

		,"lfn_AfterSearchEduEquipmentSingle"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 교육기자재 관리번호 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduEquipmentSingle(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}







/*

 * 기능 : 삭제

 */

function lfn_Delete(obj) {

	if (ds_ioEduEquipmentH.row == -1) {

		gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.

		return false;

	}

	

	if (!gfn_Confirm(MSGW00030)) { // 정말로 삭제 하시겠습니까?

        return false;

	}

	

	lfn_DelEduEquipmentH(); // 교육기자재정보 삭제

}



/*

 * 기능 : 교육기자재정보 삭제

 * parameter : 없음

 * Return : 없음

 */

function lfn_DelEduEquipmentH(obj) {

	ds_ioEduEquipmentHUnit.SetColumn(0, "EQHMGNO", ds_ioEduEquipmentH.GetColumn(ds_ioEduEquipmentH.currow, "EQHMGNO"));

	tit_clearActionInfo();

	tit_AddSingleActionInfo("item:deleteItem0021EduEquipmentH", "", 0, "", "N");

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,"ds_iData=ds_ioEduEquipmentHUnit:A" // inDs		

        ,""	// outDs

        ,"PSABUN=" + gds_oUserInfo.GetColumn(0, "PSABUN") //-- 작성자사번 // args 

        ,"lfn_AfterDelEduEquipmentH"

        ,false

        ,false

		,true

    );

}



/*

 * 기능 : 교육기자재정보 삭제 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterDelEduEquipmentH(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

	lfn_Search(); // 조회

}



/*

 * 기능 : 대분류코드 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduEquipmentCode1(sDsNm) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0021EduEquipmentCode1", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oData" // outDs

		,"" // args 

		,"lfn_AfterSearchEduEquipmentCode1"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 대분류코드 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduEquipmentCode1(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}


/*

 * 기능 : 대분류코드 콤보값 변경

 */

function cbxEECD1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	lfn_MakeEduEquipmentCode2("B"); // 중분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode3("B"); // 소분류코드 콤보목록 생성

	

	lfn_SearchEduEquipmentSingle(); // 교육기자재코드 관리번호 조회

	sEQCMGNO = ds_ioEduEquipmentSingle.GetColumn(0, "EQCMGNO");

	

	if (!mb_IsNewData) { // 수정 저장

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCD1", cbxEECD1.Value);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCDNM1", cbxEECD1.Text);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCD2", cbxEECD2.Value);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCDNM2", cbxEECD2.Text);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCD3", cbxEECD3.Value);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCNM", cbxEECD3.Text);

	}

}





/*

 * 기능 : 중분류코드 콤보값 변경

 */

function cbxEECD2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	lfn_MakeEduEquipmentCode3("B"); // 소분류코드 콤보목록 생성

	

	lfn_SearchEduEquipmentSingle(); // 교육기자재코드 관리번호 조회

	sEQCMGNO = ds_ioEduEquipmentSingle.GetColumn(0, "EQCMGNO");

	

	if (!mb_IsNewData) { // 수정 저장

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCD2", cbxEECD2.Value);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCDNM2", cbxEECD2.Text);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCD3", cbxEECD3.Value);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCNM", cbxEECD3.Text);

	}

}



/*

 * 기능 : 소분류코드 콤보값 변경

 */

function cbxEECD3_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	lfn_SearchEduEquipmentSingle(); // 교육기자재코드 관리번호 조회

	sEQCMGNO = ds_ioEduEquipmentSingle.GetColumn(0, "EQCMGNO");

	

	if (!mb_IsNewData) { // 수정 저장

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCCD3", cbxEECD3.Value);

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQCNM", cbxEECD3.Text);

	}

}



/*

 * 기능 : 중분류코드 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduEquipmentCode2(sDsNm, sCode1) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0021EduEquipmentCode2", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oData" // outDs

		,"CODE1=" + quote(sCode1) // -- 대분류  // args 

		,"lfn_AfterSearchEduEquipmentCode2"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 중분류코드 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduEquipmentCode2(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}



/*

 * 기능 : 소분류코드 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduEquipmentCode3(sDsNm, sCode1, sCode2) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0021EduEquipmentCode3", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oData" // outDs

		,"CODE1=" + quote(sCode1) // -- 대분류

		    +" CODE2=" + quote(sCode2) // -- 중분류 // args 

		,"lfn_AfterSearchEduEquipmentCode3"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 소분류코드 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduEquipmentCode3(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}



/*

 * 기능 : 데이타셋 Position이 변경되기 전

 */

function ds_ioEduEquipmentH_CanRowPosChange(obj,nOldRow,nRow) {

	if (nOldRow >= 0 && nRow >= 0) {

		if (ds_ioEduEquipmentHUnit.GetUpdate()) {

			if (mb_IsNewData) {

				if (gfn_Confirm("추가 입력중인 내용이 있습니다.\n입력완료 후 저장버튼을 눌러 저장하시겠습니까?")) {

					return false;

				} else {

					lfn_SetOrgValue(nOldRow); // 이전값으로 변경

					return true;

				}

			} else {

				if (gfn_Confirm("변경된 내용이 있습니다.\n변경완료 후 저장버튼을 눌러 저장하시겠습니까?")) {

					return false;

				} else {

					lfn_SetOrgValue(nOldRow); // 이전값으로 변경

					return true;

				}

			}

		}

	}

	return true;

}



/*

 * 기능 : 이전값으로 변경

 */

function lfn_SetOrgValue(nOldRow) {

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EHGTMGNO", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EHGTMGNO"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIKINDGUBUN", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIKINDGUBUN"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIKINDGUBUNNM", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIKINDGUBUNNM"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIBCD", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIBCD"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIBNM", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIBNM"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIMCD", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIMCD"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIMNM", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIMNM"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EISCD", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EISCD"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EISNM", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EISNM"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EIBCD", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EIBCD"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EHSUBULGUBUN", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EHSUBULGUBUN"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EHUSETARGET", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EHUSETARGET"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EHSUBULDATE", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EHSUBULDATE"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EHEDUMGNO", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EHEDUMGNO"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EHUSETARGETNM", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EHUSETARGETNM"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EDUYEAR", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EDUYEAR"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EDUNM", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EDUNM"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EDUDATE", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EDUDATE"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EDUTIME", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EDUTIME"));

	ds_ioEduEquipmentH.SetColumn(nOldRow, "EDUCNT", ds_ioEduEquipmentH.GetOrgColumn(nOldRow, "EDUCNT"));

}



/*

 * 기능 : 데이타셋 Position이 변경된 후

 */

function ds_ioEduEquipmentH_OnRowPosChanged(obj,nOldRow,nRow) {

	ds_ioEduEquipmentHUnit.ClearData();

	ds_ioEduEquipmentHUnit.AddRow();

	mb_IsNewData = false; // 저장버튼이 클릭 초기화

	lbStatus.Text = "수정모드";

	

	//lfn_MakeJibuSearchCode("G"); // 부서&지부 콤보 생성

	lfn_MakeEduEquipmentCode1("G"); // 대분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode2("G"); // 중분류코드 콤보목록 생성

	lfn_MakeEduEquipmentCode3("G"); // 소분류코드 콤보목록 생성

	

	lfn_SetGridToDetail(nRow); // 그리드 내용을 상세로 적용

	//cbxBuyGubun_OnChanged(cbxBuyGubun, obj.GetColumn(nRow, "EQHBUYGUBUN")); // 취득구분 변경

	
	ds_ioEduEquipmentHUnit.ApplyChange();
	
	


}



/*

 * 기능 : 그리드 내용을 상세로 적용

 */

function lfn_SetGridToDetail(vRow) {


	cbxEECD1.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHEQCCD1");	// 대분류

	cbxEECD2.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHEQCCD2");	// 중분류

	cbxEECD3.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHEQCCD3");	// 소분류
	
	
	calBuyDate.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHBUYDATE");	// 구입일자
	
	cbxBuyDept.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHBUYGTMGNO");// 구입부서
	
	cbxMgDept.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHMGGTMGNO");	// 관리지부

	edItemNo.Text = ds_ioEduEquipmentH.GetColumn(vRow, "EQHITEMNO");	// 품목번호

	edBuySeq.Text = ds_ioEduEquipmentH.GetColumn(vRow, "EQHBUYSEQ");	// 구입순번
	

	edEquipmentNM.Text = ds_ioEduEquipmentH.GetColumn(vRow, "EQHNM");	// 교육기자재명
	
	cbxQty.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHQTY");	// 수량
	
	cbxBuyGubun.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHBUYGUBUN");	// 취득구분	
	
	
	if (cbxBuyGubun.Value = "0") {
	
		medBuyAmount.Enable = true;	
	
	} else {
	
		medBuyAmount.Enable = false;	
	
	}
	
	medBuyAmount.Text = ds_ioEduEquipmentH.GetColumn(vRow, "EQHBUYAMOUNT");	// 취득금액
	
	radHoldGubun.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHHOLDGUBUN");	// 보유상태
	
	edRemark.Text = ds_ioEduEquipmentH.GetColumn(vRow, "EQHREMARK");	// 비고
	
	cbxDiscardGubun.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHDISCARDGUBUN");// 폐기구분
	
	calDiscardDate.Value = ds_ioEduEquipmentH.GetColumn(vRow, "EQHDISCARDDATE");// 폐기일자
	
	
	edImageFile.text = ds_ioEduEquipmentH.GetColumn(vRow, "EQHSAVENM"); //저장파일명
	
	ls_RealFileName = ds_ioEduEquipmentH.GetColumn(vRow, "EQHREALNM"); //실제 이미지파일명
/*
	if(length(ls_RealFileName) >= 1) {
		lbFileSize.text = NumFormat(ds_ioEduEquipmentH.GetColumn(vRow, "EQHFILESIZE")) + " Byte";
	} else {
		lbFileSize.text = "";
	}
*/	
	imgPicture.ImageID = "";
	if (length(ds_ioEduEquipmentH.GetColumn(vRow, "EQHREALNM")) > 0) {

		imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"

			+ ds_ioEduEquipmentH.GetColumn(vRow, "EQHDIRPATH")

			+ "/" + ds_ioEduEquipmentH.GetColumn(vRow, "EQHREALNM");

		imgPicture.Text = "";
		

	} else {

		imgPicture.Text = "이미지";
		
		imgPicture.ImageID = "";
	
    }

	lfn_btnImageCheck();

}



/*

 * 기능 : 관리지부 콤보값 변경

 */

function cbxMgDept_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (!mb_IsNewData) { // 수정 저장

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHMGGTMGNO", cbxMgDept.Value);

	}

}

/*

 * 기능 : 구입부서 콤보값 변경

 */

function cbxBuyDept_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{

	if (!mb_IsNewData) { // 수정 저장

		ds_ioEduEquipmentH.SetColumn(ds_ioEduEquipmentH.row, "EQHBUYGTMGNO", cbxBuyDept.Value);

	}	
}


/*

 * 기능 : 초기화

 */

function lfn_Cancel(obj) {

	gfn_FormInit(this);

    lfn_MakeEduItemBCode("A"); // 대분류코드 콤보목록 생성

    // cbxEiBCdSearch.Enable = false;

    cbxEiMCdSearch.Enable = false;

    

    if (ds_ioEduEquipmentH.row == -1) {

		mb_IsNewData = false; // 저장버튼이 클릭 설정

		lbStatus.Text = "초기모드";

	}

   ls_RealFileName = "";
   lbFileSize.Text = "";
   lfn_btnImageCheck();

}

// 취득구분 변경시
function cbxBuyGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "0") {
	
		medBuyAmount.Enable = true;	
		
		medBuyAmount.SetFocus();
	
	} else {
	
		medBuyAmount.Enable = false;
		
		medBuyAmount.Text = "";
	
	}
}

//폐기구분 변경시
function cbxDiscardGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "0") {
		
		calDiscardDate.Value = "";
		
	} else if (strCode > "0") {
	
		calDiscardDate.SetFocus();
	
	}
}


/**
 * 버튼 정보 변경
 */
function lfn_btnImageCheck(){

    if (length(ls_RealFileName) > 0 && !lb_FileUpload) {
        btnImage.Text = "이미지 삭제";
    } else {
        btnImage.Text = "이미지 등록";
    }
}

// 이미지 등록
function btnImage_OnClick(obj)
{
    lb_FileUpload = false;
    
    if (btnImage.Text == "이미지 삭제") {
    
		if (gfn_IsNull(ls_RealFileName)) {
		
			gfn_Alert("삭제할 이미지 파일이 없습니다.");
			
			return false;
			
		}
	
		if (!gfn_Confirm("이미지 파일만 삭제하시겠습니까?\n\n 저장버튼을 눌러 저장해야 이미지 삭제가 완료됩니다.")) { // 삭제 하시겠습니까?
	
			return false;
	
		}
    
		if (tit_FileDelete( ls_FileUploadPath
		
						  , ls_RealFileName
						  
						  , true)) {
					  
			gfn_Alert("이미지파일만 정상적으로 삭제되었습니다.\n\n 저장버튼을 눌러 저장해야 이미지 삭제가 완료됩니다.");
		
			//lb_FileUpload = false;
			lb_FileUpload = true;
			
		} else {
		
			gfn_Alert("파일 삭제에 실패했습니다.");
			lb_FileUpload = false;
		}
    
        lbFileSize.text = "";
        edImageFile.text = "";
        btnImage.Text = "이미지 등록";
        imgPicture.ImageID = "";
        imgPicture.Text = "이미지";


    } else {	// 이미지 등록

        fdAttachFile.Type = "OPEN";
        
        if (fdAttachFile.open()) {
            //alert(fdAttachFile.FilePath + "\\" + fdAttachFile.FileName); => (D:\한국소방\보고문서\화면.ppt)
            fiAttachFile.FileName = fdAttachFile.FilePath + "\\" + fdAttachFile.FileName;
            
            edImageFile.text = fdAttachFile.FileName;
            
            imgPicture.ImageID = fdAttachFile.FilePath + "\\" + fdAttachFile.FileName;
            
            lbFileSize.text = NumFormat(fiAttachFile.GetLength()) + " Byte";
            
            fiAttachFile.Close();

            lb_FileUpload = true;
        }
        gfn_Alert("저장버튼을 눌러 저장해야 이미지 등록이 완료됩니다.");
    }
    
	
}

/**
 * 파일 다운로드
 */
function btnImageDownload_OnClick(obj)
{
    if (length(ls_RealFileName) > 0) {

        fdAttachFile.Type = "SAVE";
        fdAttachFile.FileName = edImageFile.text;

        if (fdAttachFile.open()) {
            var arrRtn = tit_fileRead(
									  hfAttachFile
									, ls_FileUploadPath
									, ls_RealFileName
									, fdAttachFile.FilePath
									, fdAttachFile.FileName
									);
 
            gfn_Alert(MSGI00060); //다운로드 완료 메시지
        }
    }
	
}

// 이미지 파일 보기
function btnLoadImage_OnClick(obj)
{

    gfn_ImageViewPopup(

        ls_FileUploadPath

        , ls_RealFileName

        , ls_RealFileName

    );
}


function gdEduEquipmentH_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	ds_ioEduEquipmentH_OnRowPosChanged(ds_ioEduEquipmentH,nRow,nRow);
}

]]></Script>
</Window>
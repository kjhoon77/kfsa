<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="576" Id="grd_MWFS" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="소방관서&#32;선임대장&#32;비교리스트" Top="8" Ver="1.0" Width="780" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioYear">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioChoiceYn">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>선택</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMemberGubun_0">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>예</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>아니오</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioCourseYn">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>0</CD>
						<DATA>선택&#32;</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>다중선택</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRegion">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="GTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioAssociationFiremanagerData"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioFireStationFiremanagerData">
				<Contents>
					<colinfo id="COL01" size="256" summ="default" type="STRING"/>
					<colinfo id="COL02" size="256" summ="default" type="STRING"/>
					<colinfo id="COL03" size="256" summ="default" type="STRING"/>
					<colinfo id="COL04" size="256" summ="default" type="STRING"/>
					<colinfo id="COL05" size="256" summ="default" type="STRING"/>
					<colinfo id="COL06" size="256" summ="default" type="STRING"/>
					<colinfo id="COL07" size="256" summ="default" type="STRING"/>
					<colinfo id="COL08" size="256" summ="default" type="STRING"/>
					<colinfo id="COL09" size="256" summ="default" type="STRING"/>
					<colinfo id="COL10" size="256" summ="default" type="STRING"/>
					<colinfo id="COL11" size="256" summ="default" type="STRING"/>
					<colinfo id="COL12" size="256" summ="default" type="STRING"/>
					<colinfo id="COL13" size="256" summ="default" type="STRING"/>
					<colinfo id="COL14" size="256" summ="default" type="STRING"/>
					<colinfo id="COL15" size="256" summ="default" type="STRING"/>
					<colinfo id="COL16" size="256" summ="default" type="STRING"/>
					<colinfo id="COL17" size="256" summ="default" type="STRING"/>
					<colinfo id="COL18" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioGetSysdateSearch"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioAssociationFireStation"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioFireStationAssociation"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioAssociationFireStationBnmaAddrFmnm"></Dataset>
		</Datasets>
		<Grid BindDataset="ds_ioFireStationFiremanagerData" BkColor2="user2" BkSelColor="user3" BoldHead="true" Bottom="571" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="195" Id="grdExport" InputPanel="FALSE" Left="3" LineColor="default" Right="776" Style="sty_Grid" TabOrder="17" TabStop="true" Top="376" UseDBuff="true" UsePopupMenu="true" UserData="지로회비고지자료&#32;생성" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="294"/>
						<col width="216"/>
						<col width="115"/>
						<col width="127"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="text" text="(1)대상물명"/>
						<cell col="1" display="text" text="(2)주소(소재지)"/>
						<cell col="2" display="text" text="(3)성명(선임자명)"/>
						<cell col="3" display="text" text="직능"/>
						<cell col="4" display="text" text="순번"/>
					</head>
					<body>
						<cell align="center" col="0" colid="COL01" display="text"/>
						<cell align="center" col="1" colid="COL02" display="text"/>
						<cell align="center" col="2" colid="COL03" display="text"/>
						<cell align="center" col="3" colid="COL04" display="text"/>
						<cell align="center" col="4" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape Bottom="350" Height="28" Id="Shape1" Left="434" LineColor="user14" Right="773" TabOrder="34" Top="322" Type="Rectangle" Width="339"></Shape>
		<Shape Bottom="349" Height="27" Id="Shape0" Left="4" LineColor="user15" Right="427" TabOrder="32" Top="322" Type="Rectangle" Width="423"></Shape>
		<Shape Bottom="88" Height="52" Id="Shape4" Left="4" LineColor="user15" Right="772" TabOrder="5" Top="36" Type="Rectangle" Width="768"></Shape>
		<Shape Bottom="32" Height="31" Id="shpBtnBox" Left="420" LineColor="user14" Right="776" TabOrder="4" Top="1" Type="Rectangle" Width="356"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="600" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="1" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="688" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="3" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="272">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_COM_SEARCH" Left="424" OnClick="lAssociationFiremanagerData" Style="sty_Button" TabOrder="6" ToolTipText="출력" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static31" Left="8" Style="sty_Label" TabOrder="8" Text="지부" Top="40" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="71" OnChanged="cbxJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="7" Top="39" UserData="S" Width="80"></Combo>
		<Static Align="Center" Height="20" Id="Static36" Left="337" Style="sty_Label" TabOrder="9" Text="지역" Top="40" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxRegion2" INDEX="0" InnerDataset="ds_oRegion" Left="512" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="10" Top="39" UserData="S" Value="01" Width="121"></Combo>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radRegin" INDEX="0" InnerDataset="ds_ioChoiceYn" Left="401" LeftMargin="4" OnChanged="radRegin_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="11" Top="40" UserData="S" Value="1" Width="108"></Radio>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxRegion3" INDEX="0" InnerDataset="ds_oRegion" Left="649" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="12" Top="39" UserData="S" Value="01" Width="121"></Combo>
		<Static Align="Center" Height="20" Id="Static37" Left="632" Style="sty_Text" TabOrder="13" Text="~" Top="39" VAlign="Middle" Width="20"></Static>
		<Static Align="Center" Height="20" Id="Static39" Left="153" Style="sty_Label" TabOrder="14" Text="직능" Top="40" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse1" ImeMode="none" INDEX="0" InnerDataset="ds_oCourse" Left="215" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="15" Top="40" UserData="S" Width="121"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="512" OnClick="lfn_localExcel" Style="sty_Button" TabOrder="16" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbAbsentCnt" Left="5" Style="sty_LabelStat" TabOrder="19" Text="안전원자료&#32;조회건수&#32;:" Top="92" VAlign="Middle" Width="135"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medAbsenCnt" Left="145" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="18" Top="92" UserData="S" Width="88"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFireStation" ImageID="BTN_TEXT_10" Left="437" OnClick="FireStation_Onclick" Style="sty_Button" TabOrder="20" Text="소방관서&#32;자료&#32;불러오기" ToolTipText="출력" Top="325" Width="145"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFireStationCheck" ImageID="BTN_TEXT_06" Left="583" OnClick="btnFireStationCheck_OnClick" Style="sty_Button" TabOrder="21" Text="자료&#32;비교&#32;하기" ToolTipText="출력" Top="325" Width="92"></Button>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medFireStationFiremanagerData" Left="148" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="22" Top="353" UserData="S" Width="88"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnResult" ImageID="BTN_TEXT_06" Left="677" OnClick="btnResult_OnClick" Style="sty_Button" TabOrder="24" Text="결과&#32;보기" ToolTipText="출력" Top="325" Width="92"></Button>
		<Grid BindDataset="ds_ioAssociationFiremanagerData" BkColor2="user2" BkSelColor="user3" BoldHead="true" Bottom="295" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="180" Id="gdAssociationFiremanagerData" InputPanel="FALSE" Left="5" LineColor="default" OnHeadDBLClick="gdAssociationFiremanagerData_OnHeadDblClick" Right="777" Style="sty_Grid" TabOrder="25" TabStop="true" Top="115" UseDBuff="true" UsePopupMenu="true" UserData="지로회비고지자료&#32;생성" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="772">
			<contents>
				<format id="Default">
					<columns>
						<col width="34"/>
						<col width="151"/>
						<col width="90"/>
						<col width="193"/>
						<col width="193"/>
						<col width="102"/>
					</columns>
					<head>
						<cell col="0" display="text" text="순번"/>
						<cell col="1" display="text" text="관리번호"/>
						<cell col="2" display="text" text="직능"/>
						<cell col="3" display="text" text="대상물명"/>
						<cell col="4" display="text" text="주소(소재지)"/>
						<cell col="5" display="text" text="성명(선임자명)"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
						<cell col="1" colid="CNO_BUNHO" display="text"/>
						<cell align="center" col="2" colid="CGROUPNM" display="text"/>
						<cell align="center" col="3" colid="BNM" display="text"/>
						<cell align="center" col="4" colid="ADDR12" display="text"/>
						<cell align="center" col="5" colid="FMNM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="Static2" Left="6" Style="sty_Label" TabOrder="26" Text="대상물" Top="326" VAlign="Middle" Width="84"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" BKColor="user0" Border="Flat" Font="굴림,12,Bold" Height="20" Id="edBnm" ImeMode="native" Left="92" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edBnm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="27" Top="326" UserData="S" Width="52"></Edit>
		<Static Align="Center" Height="20" Id="Static1" Left="146" Style="sty_Label" TabOrder="28" Text="주소" Top="326" VAlign="Middle" Width="84"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" BKColor="user0" Border="Flat" Font="굴림,12,Bold" Height="20" Id="edAddr12" ImeMode="native" Left="232" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr12_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="29" Top="326" UserData="S" Width="52"></Edit>
		<Static Align="Center" Height="20" Id="Static3" Left="286" Style="sty_Label" TabOrder="30" Text="성명" Top="326" VAlign="Middle" Width="84"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" BKColor="user0" Border="Flat" Font="굴림,12,Bold" Height="20" Id="edFmnm" ImeMode="native" Left="372" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edFmnm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="31" Top="326" UserData="S" Width="52"></Edit>
		<Static Align="Center" Height="20" Id="Static14" Left="8" Style="sty_LabelGruopBox" TabOrder="33" Text="소방관서&#32;항목위치(엑셀&#32;열&#32;위치)" Top="303" VAlign="Middle" Width="200"></Static>
		<Static Align="Center" Height="20" Id="Static0" Left="8" Style="sty_LabelStat" TabOrder="23" Text="소방관서&#32;조회건수&#32;:" Top="353" VAlign="Middle" Width="135"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calStartDate1" Left="72" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="36" Top="64" UserData="S" WeeksFont="돋음,9" Width="106"></Calendar>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calEndDate1" Left="204" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="35" Top="64" UserData="S" WeeksFont="돋음,9" Width="106"></Calendar>
		<Static Align="Center" Height="20" Id="Static4" Left="185" Style="sty_Text" TabOrder="37" Text="~" Top="64" VAlign="Middle" Width="10"></Static>
		<Static Align="Center" Height="20" Id="Static5" Left="8" Style="sty_Label" TabOrder="38" Text="선임일자" Top="64" VAlign="Middle" Width="60"></Static>
		<FileDialog Bottom="608" Filter="Excel&#32;File(*.xls)|*.xls|All(*.*)|*.*|" Height="24" Id="fdImport" Right="24" TabOrder="38" Top="584" Width="24"></FileDialog>
		<Static Align="Center" Height="20" Id="Static6" Left="286" Style="sty_Label" TabOrder="39" Text="자료시작&#32;행" Top="351" VAlign="Middle" Width="84"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" BKColor="user0" Border="Flat" Font="굴림,12,Bold" Height="20" Id="edStartRow" ImeMode="native" Left="372" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edStartRow_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="40" Top="351" UserData="S" Width="52"></Edit>
	</Form>
	<Script><![CDATA[
/*
 * 프로그램명 : frmcust2080MDailyFeeReportGateway.xml
 * 설명 : 소방관서 선임대자 비교리스트 
 * 작성일 : 2010. 02. 02
 * 작성자 : 이창희
 */

#include "LIB::cust.js"; // 공통업무 관련

    var cbxJibuV= "";        //지부
    var cbxCourse1V = "" ;       //직능
    //var radRegin      //지역전체_선택 유무
    var cbxRegion2V = "" ;       //지역1 (from)
    var cbxRegion3V = "" ;           //지역2 (to)
    var calStartDate1V = "" ;  //선임일자1
    var calEndDate1V = "";  //선임일자2    // args          
        
function Form_OnLoadCompleted(obj)
{
	gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
	
    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }       
   
   gfn_SearchAllJibu(cbxJibu, "Y"); // 지부 코드 조회 
//   gfn_SearchRegion(gds_oUserInfo.GetColumn(0, "PDEPTCD"), ds_oRegion, "0");	//지역 코드 조회
   gfn_SearchCodeRegion(gds_oUserInfo.GetColumn(0, "PDEPTCD"), ds_oRegion, "0");	//지역 코드 조회
   
   gfn_SearchCustomerCourseFullName(ds_oCourse, "0");	// 대표고객직능 조회
   calStartDate1.Value =  left(GetDate(), 8);   
   calEndDate1.Value =  left(GetDate(), 8);   
   
   /*
   
   cbxRegion2.value = ds_oRegion.GetColumn(0, "cd");                         // 지역 첫번째 콤보 
   cbxRegion3.value = ds_oRegion.GetColumn(0, "cd");        // 지역 두번째 콤보
   //cbxRegion3.value = ds_oRegion.GetColumn(ds_oRegion.lastrow, "cd");        // 지역 두번째 콤보
  
   ds_ioYear.AddRow();
   ds_ioYear.SetColumn(0, "CD", left(GetDate(), 4));   
   ds_ioYear.AddRow();
   ds_ioYear.SetColumn(1, "CD", ToNumber(left(GetDate(), 4))-1);
   ds_ioYear.AddRow();
   ds_ioYear.SetColumn(2, "CD", ToNumber(left(GetDate(), 4))-2);
   ds_ioYear.AddRow();
   ds_ioYear.SetColumn(3, "CD", ToNumber(left(GetDate(), 4))-3);
   
   //cbxRegion2.value = "";
   //cbxRegion3.value = "";
        
   cbxCourse1.Value = "";
   cbxCourse_1.Value = "";
   cbxCourse_2.Value = "";
   cbxCourse_3.Value = "";
   cbxCourse_4.Value = "";
   cbxCourse_5.Value = "";
   cbxCourse_6.Value = "";    
   
   radRegin.SetFocus(); 
   
   */   
     
      
}

//공통처리
//===================================================================
/*
 * 기능 : 버튼 활성/비활성시킨다.(권한 체크)
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetFormAuth(bStatus) {
  //  btnSelect.Enable = bStatus;    
  //  btnCreateList.Enable = bStatus;
  //  btnProcElecApv.Enable = bStatus;
}
  
/* 사용자 이벤트 함수 */
function btnMutilSort_OnClick(obj)
{
	gfn_GridMultiSort(gdElecAppr, 0); // 멀티 정렬을 실행한다.
}

/*
function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    // to do
    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}
*/
function Form_OnSize(obj,nCx,nCy,nState)
{
    if (gs_IsResizingForm == "Y") {
       // gdElecAppr.Height = nCy - gdElecAppr.Top - 4;
       // gdElecAppr.Width = nCx - gdElecAppr.Left - 4;
    }
}
//====================================================================

/*
 * 기능 : 안전원 선임자료 조회
 */
function lAssociationFiremanagerData(obj) {
     

    if (!Confirm("안전원 선임대장으로 조회하시겠습니까?")) {
        return false;
	} 	
      
    if (!gfn_FormValidate(this)) { // 입력 Validation Check
        return false;
    }    
    
    ds_ioAssociationFiremanagerData.Clear();        
    tit_clearActionInfo();
	tit_addCSVSearchActionInfo("cust:searchCust4050MAssociationFiremanagerData", false);     // 안전원 소방관서 선임대장 조회하기
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"ds_ioAssociationFiremanagerData=ds_oAssociationFiremanagerData"  // outDs	  	  
	    ,  "cbxJibu=" + quote(cbxJibu.value)               //지부
        + " cbxCourse1=" + quote(cbxCourse1.Value)          //직능
        + " radRegin=" + quote(radRegin.value)             //지역전체_선택 유무
        + " cbxRegion2=" + quote(cbxRegion2.value)             //지역1 (from)
        + " cbxRegion3=" + quote(cbxRegion3.value)             //지역2 (to)
        + " calStartDate1=" + quote(mid(calStartDate1.value,0,8)) //선임일자1
        + " calEndDate1=" + quote(mid(calEndDate1.value,0,8))     //선임일자2    // args                                  
		,"lfn_AftersearchCust"
		,false
		,""
		,true
	);	
	
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AftersearchCust(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    medAbsenCnt.Text = ds_ioAssociationFiremanagerData.count();  // 건수 출력
    alert("조회가 완료 되었습니다."); //
    gfn_SearchMessage(gdAssociationFiremanagerData); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
    
   cbxJibuV= cbxJibu.Value;        //지부
   cbxCourse1V = cbxCourse1.Value;        //직능
    //var radRegin      //지역전체_선택 유무
   cbxRegion2V = cbxRegion2.Value;        //지역1 (from)
   cbxRegion3V = cbxRegion3.Value;            //지역2 (to)
   calStartDate1V = calStartDate1.Value;   //선임일자1
   calEndDate1V = calEndDate1.Value;  //선임일자2    // args 
}

/*
 * 지역 전체 , 선택 변경
*/
function radRegin_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "1"){               // 선택
        cbxRegion2.Enable = true;
        cbxRegion3.Enable = true;
        cbxRegion2.value = ds_oRegion.GetColumn(0, "cd");
        cbxRegion3.value = ds_oRegion.GetColumn(ds_oRegion.lastrow, "cd");
	} else {                          // 전체
	    cbxRegion2.Enable = false;
        cbxRegion3.Enable = false;        
        cbxRegion2.value = "";
        cbxRegion3.value = "";
	}
}

function lfn_localExcel(obj)
{   
    gdAssociationFiremanagerData.ExportExcelEx("안전원 선임대장");
    /*
	if (ds_ioMCustomerFeeGoji.GetRowCount() < 1) {
        gfn_Alert("출력할 데이터가 존재하지 않습니다.");
        return false;
    }
	lfn_Excel(obj);
	*/
}

/*
 * 지부 변경시 지역 변경 
*/
function cbxJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
  //gfn_SearchRegion(ds_oJibu.GetColumn(nNewIndex, "CD"), ds_oRegion, "0");	//지역 코드 조회
    radRegin.Value = "1";
    cbxRegion2.Enable = true;
    cbxRegion3.Enable = true;
    
    gfn_SearchCodeRegion(ds_oJibu.GetColumn(nNewIndex, "CD"), ds_oRegion, "0");	//지역 코드 조회  
    cbxRegion2.value = ds_oRegion.GetColumn(0, "cd");                         // 지역 첫번째 콤보 
    cbxRegion3.value = ds_oRegion.GetColumn(0, "cd");        // 지역 두번째 콤보
  //cbxRegion3.value = ds_oRegion.GetColumn(ds_oRegion.lastrow, "cd");        // 지역 두번째 콤보

}

/*
* 결과보기
*/
function btnResult_OnClick(obj)
{
	//var sArg  = "sCmgno=" + quote(ds_ioCustomerInfo.GetColumn(ds_ioCustomerInfo.currow, "CMGNO")); //
	
	if(ds_ioAssociationFireStation.count() == "0" ) {
        alert("결과자료가 없습니다. 다시 비교 바랍니다.");
        return false;
	}	
	
    Dialog("cust::frmcust4051PFiremanagerDataCheck.xml", "", 600, 398, "", -1, -1);
}

/*
* 소방관서 자료 불러오기
*/
function FireStation_Onclick(obj)
{
    ds_ioFireStationFiremanagerData.ClearData();
    if ((!gfn_isNull(edBnm.text)) && 
         (!gfn_isNull(edAddr12.Text)) &&
         (!gfn_isNull(edFmnm.Text))) {

        var strContents	 = "";         
        strContents += '<contents>                                                       \n';
        strContents += '	<format id="Default">                                          \n';
        strContents += '		<columns>                                                    \n';
        strContents += '			<col width="294"/>                                          \n';
        strContents += '			<col width="216"/>                                         \n';
        strContents += '			<col width="115"/>                                         \n';
        strContents += '			<col width="127"/>                                         \n';
        strContents += '			<col width="80"/>                                         \n';
        strContents += '		</columns>                                                   \n';
        strContents += '			<head>                                                       \n';
        strContents += '				<cell col="0" display="text" text="(1)대상물명"/>          \n';
        strContents += '				<cell col="1" display="text" text="(2)주소(소재지)"/>      \n';
        strContents += '				<cell col="2" display="text" text="(3)성명(선임자명)"/>    \n';
        strContents += '				<cell col="3" display="text" text="직능"/>                 \n';
        strContents += '				<cell col="4" display="text" text="순번"/>                 \n';
        strContents += '			</head>                                                      \n';
        strContents += '			<body>                                                       \n';

        strContents += '				<cell col="0" colid="COL' + edBnm.text + '" display="text"/>  \n';        
        strContents += '				<cell col="1" colid="COL' + edAddr12.Text + '" display="text"/>     \n';
        strContents += '				<cell col="2" colid="COL' + edFmnm.Text + '" display="text"/>       \n';
        strContents += '				<cell col="3" display="text"/>               \n';
        strContents += '				<cell col="4" display="text"/>               \n';
        /*
        strContents += '				<cell col="0" colid="COL01" display="text"/>               \n';
        strContents += '				<cell col="1" colid="COL02" display="text"/>               \n';
        strContents += '				<cell col="2" colid="COL03" display="text"/>               \n';
        strContents += '				<cell col="3" colid="COL04" display="text"/>               \n';                        
        strContents += '				<cell col="4" display="text"/>                             \n';
        */
        strContents += '			</body>                                                      \n';
        strContents += '	</format>                                                      \n';
        strContents += '</contents>                                                      \n';
        strContents += '                                                                 \n';
       
       grdExport.Contents = strContents;  // 대상물, 주소, 성명 특정셀을 지정해 주면 해당 셀을 ds에 넣음
    } else {
        var strContents	 = ""; 
        
        strContents += '<contents>                                                       \n';
        strContents += '	<format id="Default">                                          \n';
        strContents += '		<columns>                                                    \n';
        strContents += '			<col width="294"/>                                          \n';
        strContents += '			<col width="216"/>                                         \n';
        strContents += '			<col width="115"/>                                         \n';
        strContents += '			<col width="127"/>                                         \n';
        strContents += '			<col width="80"/>                                         \n';
        strContents += '		</columns>                                                   \n';
        strContents += '			<head>                                                       \n';
        strContents += '				<cell col="0" display="text" text="(1)대상물명"/>          \n';
        strContents += '				<cell col="1" display="text" text="(2)주소(소재지)"/>      \n';
        strContents += '				<cell col="2" display="text" text="(3)성명(선임자명)"/>    \n';
        strContents += '				<cell col="3" display="text" text="직능"/>                 \n';
        strContents += '				<cell col="4" display="text" text="순번"/>                 \n';
        strContents += '			</head>                                                      \n';
        strContents += '			<body>                                                       \n';
        strContents += '				<cell col="0" colid="COL01" display="text"/>               \n';
        strContents += '				<cell col="1" colid="COL02" display="text"/>               \n';
        strContents += '				<cell col="2" colid="COL03" display="text"/>               \n';
        strContents += '				<cell col="3" colid="COL04" display="text"/>               \n';
        strContents += '				<cell col="4" display="text"/>                             \n';
        strContents += '			</body>                                                      \n';
        strContents += '	</format>                                                      \n';
        strContents += '</contents>                                                      \n';
        strContents += '                                                                 \n';
       
       grdExport.Contents = strContents;  // 대상물, 주소, 성명 특정셀을 지정해 주면 해당 셀을 ds에 넣음     
    }
       
   
   
   //////////////////////////////////////////////////////////////////////////
    fdImport.Type = "OPEN";
    fdImport.Filter = "Excel(.xls)|*.xls|";
    var result = fdImport.Open("C:\\");
    
    if (result) {
        if (!Confirm("소방관서 선임 자료를 불러 오시겠습니까?")) {
			return;
		}
        
        var ls_FilePath = fdImport.FilePath + '\\' + fdImport.FileName;
        ds_ioFireStationFiremanagerData.ClearData();
        ext_ExcelImportByIndex(ls_FilePath, 0,"ds_ioFireStationFiremanagerData");
        
        for(i = 0; i < toNumber(edStartRow.Text)-1; i++) {
            ds_ioFireStationFiremanagerData.DeleteRow(0); //지정한 row번째 만큼 삭제, 자료 시작점 찾기 위해 
        }
               
    } else {
        return;
    }
    
    medFireStationFiremanagerData.text = ds_ioFireStationFiremanagerData.count();
    alert("자료 불러오기가 완료 되었습니다."); 
    
}
  
/*
 * 기능 : 비교위해 insert시 사용할 key날짜를 sysdate()를 조회하여 가져옴
 */
function GetSysdateSearch(obj) {
    
    /*  
    if (!gfn_FormValidate(this)) { // 입력 Validation Check
        return false;
    }
    */    
    
    ds_ioGetSysdateSearch.Clear();        
    tit_clearActionInfo();
	tit_addCSVSearchActionInfo("cust:searchCust4050GetSysdateSearch", false);     // db sysdate 조회하기 key값
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"ds_ioGetSysdateSearch=ds_oGetSysdateSearch"  // outDs	  	  
	    ,  "" // args                                  
		,"lfn_AftersearchCustSysdate"
		,false
		,""
		,true
	);	
	
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AftersearchCustSysdate(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
      
}
     
/*
 * 기능 : 소방관서 자료 비교를 위해 db에 insert 함
 */
function FireStationFiremanagerData_Insert(obj) {
     
    /*
    if (!Confirm("선임자료 비교를 시작하시겠습니까? (약간의 시간이 소요됩니다.)")) {
        return false;
	} 
	*/	
    /*  
    if (!gfn_FormValidate(this)) { // 입력 Validation Check
        return false;
    }    
    */
     
    tit_clearActionInfo();
	tit_AddMultiActionInfo(    
        "cust:insertCust4050MFireStationFiremanagerData"	// insert  		 // 소방관서 선임자료 비교위해 insert 함
        , ""	// update  
        , ""	// delete
        , ""	// flag column 명
        , ""	// key sql id
        , 0	// key 증가 값
        , "" 
        , 0 
        , "N"	// 실행타입
    );
			
	// 서버 호출 
	tit_callService( 
		""
		,""
		,"ds_iFireStationFiremanagerDataCheck=ds_ioFireStationFiremanagerData:U"	// inDs
		,""  // outDs	  	  
	    ,  "cbxJibu=" + quote(cbxJibu.value)               //지부
        + " cbxCourse1=" + quote(cbxCourse1.Value)          //직능
        + " KeyDate=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD") + ds_ioGetSysdateSearch.GetColumn(0, "KEYSYSDATE"))          //key date                 
        + " radRegin=" + quote(radRegin.value)             //지역전체_선택 유무
        + " cbxRegion2=" + quote(cbxRegion2.value)             //지역1 (from)
        + " cbxRegion3=" + quote(cbxRegion3.value)             //지역2 (to)
        + " calStartDate1=" + quote(mid(calStartDate1.value,0,8)) //선임일자1
        + " calEndDate1=" + quote(mid(calEndDate1.value,0,8))     //선임일자2    // args                                  
		,"lfn_AftertCustInsert"
		,false
		,""
		,true
	);	
	
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AftertCustInsert(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }     

}
 

/*
 * 기능 : 안전원 자료 기준으로 대상물명, 주소, 성명 합쳐서 비교 한 DATA를 가져옴
 */
function FireStationAssociationBnmaAddrFmnmCheckData(obj) {
     
    ds_ioAssociationFireStationBnmaAddrFmnm.Clear();        
    tit_clearActionInfo();
	tit_addCSVSearchActionInfo("cust:searchCust4050AssociationFireStationBnmaAddrFmnm", false);     // db sysdate 조회하기 key값
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"ds_ioAssociationFireStationBnmaAddrFmnm=ds_oAssociationFireStationBnmaAddrFmnm"  // outDs	  	  
	    ,  "cbxJibu=" + quote(cbxJibu.value)               //지부
        + " cbxCourse1=" + quote(cbxCourse1.Value)          //직능
        + " KeyDate=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD") + ds_ioGetSysdateSearch.GetColumn(0, "KEYSYSDATE"))          //key date                 
        + " radRegin=" + quote(radRegin.value)             //지역전체_선택 유무
        + " cbxRegion2=" + quote(cbxRegion2.value)             //지역1 (from)
        + " cbxRegion3=" + quote(cbxRegion3.value)             //지역2 (to)
        + " calStartDate1=" + quote(mid(calStartDate1.value,0,8)) //선임일자1
        + " calEndDate1=" + quote(mid(calEndDate1.value,0,8))     //선임일자2    // args                                  
		, "lfn_AftertCustInsert"
		,false
		,""
		,true
	);	
	
}
    
/*
 * 기능 : 소방관서 자료 기준으로 비교 한 DATA를 가져옴
 */
function FireStationAssociationCheckData(obj) {
     
    ds_ioFireStationAssociation.Clear();        
    tit_clearActionInfo();
	tit_addCSVSearchActionInfo("cust:searchCust4050FireStationAssociation", false);     // db sysdate 조회하기 key값
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"ds_ioFireStationAssociation=ds_oFireStationAssociation"  // outDs	  	  
	    ,  "cbxJibu=" + quote(cbxJibu.value)               //지부
        + " cbxCourse1=" + quote(cbxCourse1.Value)          //직능
        + " KeyDate=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD") + ds_ioGetSysdateSearch.GetColumn(0, "KEYSYSDATE"))          //key date                 
        + " radRegin=" + quote(radRegin.value)             //지역전체_선택 유무
        + " cbxRegion2=" + quote(cbxRegion2.value)             //지역1 (from)
        + " cbxRegion3=" + quote(cbxRegion3.value)             //지역2 (to)
        + " calStartDate1=" + quote(mid(calStartDate1.value,0,8)) //선임일자1
        + " calEndDate1=" + quote(mid(calEndDate1.value,0,8))     //선임일자2    // args                                  
		, "lfn_AftertCustInsert"
		,false
		,""
		,true
	);	
	
}
  
/*
 * 기능 : 안전원자료 기준으로 비교 한 DATA를 가져옴
 */
function AssociationFireStationCheckData(obj) {
     
    /*
    if (!Confirm("선임자료 비교를 시작하시겠습니까? (약간의 시간이 소요됩니다.)")) {
        return false;
	} 
	*/ 	
      
    /*  
    if (!gfn_FormValidate(this)) { // 입력 Validation Check
        return false;
    }
    */    
    
    ds_ioAssociationFireStation.Clear();        
    tit_clearActionInfo();
	tit_addCSVSearchActionInfo("cust:searchCust4050AssociationFireStation", false);     // db sysdate 조회하기 key값
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"ds_ioAssociationFireStation=ds_oAssociationFireStation"  // outDs	  	  
	    ,  "cbxJibu=" + quote(cbxJibu.value)               //지부
        + " cbxCourse1=" + quote(cbxCourse1.Value)          //직능
        + " KeyDate=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD") + ds_ioGetSysdateSearch.GetColumn(0, "KEYSYSDATE"))          //key date                 
        + " radRegin=" + quote(radRegin.value)             //지역전체_선택 유무
        + " cbxRegion2=" + quote(cbxRegion2.value)             //지역1 (from)
        + " cbxRegion3=" + quote(cbxRegion3.value)             //지역2 (to)
        + " calStartDate1=" + quote(mid(calStartDate1.value,0,8)) //선임일자1
        + " calEndDate1=" + quote(mid(calEndDate1.value,0,8))     //선임일자2    // args                                  
		,"lfn_AftertCustDefult"
		,false
		,""
		,true
	);	
	
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AftertCustDefult(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }     
    alert("선임 자료 비교가 완료 되었습니다.");
}
    
/*
* 자료 비교하기 // DB에 자료 insert 하여 비교를 시작함
*/
function btnFireStationCheck_OnClick(obj)
{
	if (ds_ioAssociationFiremanagerData.count == "0") {
        alert("안전원자료를 조회하지 않았습니다. 안전원 자료 조회 후 비교를 하시기 바랍니다.");
        return false;
	}
	
	if (ds_ioFireStationFiremanagerData.count == "0") {
        alert("소방관서 자료를 조회하지 않았습니다. 안전원 자료 조회 후 비교를 하시기 바랍니다.");
        return false;
	}
		
	////////////////////////////////////
	
	if (                                                   
       cbxJibuV != cbxJibu.Value ||        //지부
       cbxCourse1V != cbxCourse1.Value ||        //직능
        //var radRegin      //지역전체_선택 유무
       cbxRegion2V != cbxRegion2.Value||        //지역1 (from)
       cbxRegion3V != cbxRegion3.Value||            //지역2 (to)
       calStartDate1V != calStartDate1.Value||  //선임일자1
       calEndDate1V != calEndDate1.Value  //선임일자2    // args 
       ) {
       alert("안전원 자료 조회 조건이 조회 자료와 맞지 않습니다. 다시 조회 후 비교하시시기 바랍니다.");
       return false;
       
    }
	
	/*
	for(i = 0; i < ds_ioFireStationFiremanagerData.RowCount(); i++) {   /// 넣기위한 트랜잭션      
            ds_ioFireStationFiremanagerData.SetColumn(i, "SEL", "1") ;      
    }
    */ 
    
    if (!Confirm("선임자료 비교를 시작하시겠습니까? (약간의 시간이 소요됩니다.)")) {
        return false;
	}	    
    
    
    if(ds_ioFireStationFiremanagerData.GetColumn(0, "SEL") == "0") {
        for(i = 0; i < ds_ioFireStationFiremanagerData.RowCount(); i++) {        
            ds_ioFireStationFiremanagerData.SetColumn(i, "SEL", "i");                      
         }       
    
    } else {
        // inset 할 데이터를 특정 컬럼명에 넣어준다. (명확히 구분하기 위함) // load한 데이터가 직접 x프레임워크에서 인삭하지 않아서 명확히 지정함
        ds_ioFireStationFiremanagerData.AddColumn("SEL"); // DS변경 구분 셀 추가 
        ds_ioFireStationFiremanagerData.AddColumn("GUBUN_COL01"); // 셀 추가 
        ds_ioFireStationFiremanagerData.AddColumn("GUBUN_COL02"); // 셀 추가 
        ds_ioFireStationFiremanagerData.AddColumn("GUBUN_COL03"); // 셀 추가 
    
        for(i = 0; i < ds_ioFireStationFiremanagerData.RowCount(); i++) {        
            ds_ioFireStationFiremanagerData.SetColumn(i, "SEL", "0");     
            ds_ioFireStationFiremanagerData.SetColumn(i, "GUBUN_COL01", ds_ioFireStationFiremanagerData.GetColumn(i, "COL" + edBnm.text));                 
            ds_ioFireStationFiremanagerData.SetColumn(i, "GUBUN_COL02", ds_ioFireStationFiremanagerData.GetColumn(i, "COL" + edAddr12.Text));                 
            ds_ioFireStationFiremanagerData.SetColumn(i, "GUBUN_COL03", ds_ioFireStationFiremanagerData.GetColumn(i, "COL" + edFmnm.text));
            
         //   ds_ioFireStationFiremanagerData.copyColumn(i,"GUBUN_COL01",ds_ioFireStationFiremanagerData, i, "COL" + edBnm.text);
         //   ds_ioFireStationFiremanagerData.copyColumn(i,"GUBUN_COL02",ds_ioFireStationFiremanagerData, i, "COL" + edAddr12.text);
         //   ds_ioFireStationFiremanagerData.copyColumn(i,"GUBUN_COL03",ds_ioFireStationFiremanagerData, i, "COL" + edFmnm.text);
          
         }   
        
    }  
    
    GetSysdateSearch(); // 날짜 KEY가져오기 
    FireStationFiremanagerData_Insert(); // key값으로 데이터 추가 함
    AssociationFireStationCheckData();  // 비교후 data가져오기( 안전원기준 )
    FireStationAssociationCheckData();  // 비교후 data가져오기( 소방관서 기준 )
    FireStationAssociationBnmaAddrFmnmCheckData(); //안전원 기준 3가지 합쳐서 비교
    
}


function gdAssociationFiremanagerData_OnHeadDblClick(obj,nCell,nX,nY,nPivotIndex)
{
    var lobj_Dataset = object(obj.BindDataset);
	if (nCell == 0) { // 선택
        if (obj.GetCellProp("head", nCell, "text") == 1) { // 전체가 이미 선택된 경우
            obj.SetCellProp("head", nCell, "text", 0);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                lobj_Dataset.SetColumn(i, "SEL", "0");
            }
        } else { // 전체가 이미 선택되지 않은 경우
            obj.SetCellProp("head", nCell, "text", 1);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                lobj_Dataset.SetColumn(i, "SEL", "1");
            }
        }
	} else { // 헤드 정렬
        lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex);
	}
}

/*
* 대상물 위치 입력 후 
*/
function edBnm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
    if (nChar == 13) {edBnm.Value = lpad(edBnm.Value, "0", 2);        
    gfn_EnterNextFocus();    } 
}

/*
* 주소 위치 입력 후 
*/
function edAddr12_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
    if (nChar == 13) {edAddr12.Value = lpad(edAddr12.Value, "0", 2);        
    gfn_EnterNextFocus();    } 	
}

/*
* 성명 위치 입력 후 
*/
function edFmnm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
    if (nChar == 13) {edFmnm.Value = lpad(edFmnm.Value, "0", 2);        
    gfn_EnterNextFocus();    } 		
}

/*
* 자료시작행 위치 입력 후 
*/
function edStartRow_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
    if (nChar == 13) {edStartRow.Value = lpad(edStartRow.Value, "0", 2);        
    gfn_EnterNextFocus();    } 		
}









function Form_OnActivate(obj)
{
	gs_SysID = "[stm_01,bsn_1005,dsc_0001]";	// 개인정보접속기록 시스템ID 
}
]]></Script>
</Window>
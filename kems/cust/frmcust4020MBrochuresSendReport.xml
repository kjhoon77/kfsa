<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="312" Id="frmcust4040MAddressChange" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="홍보과&#32;회지발송자료" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="550" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SearchJogeon">
				<Contents>
					<colinfo id="JIBU" size="256" summ="default" type="STRING"/>
					<colinfo id="RETURN_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_ALL" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="FEEMODE" size="256" summ="default" type="STRING"/>
					<colinfo id="BIZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOPEDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SendList">
				<Contents>
					<colinfo id="JIBU_CNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTZIPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTADDR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTPLACE" size="256" summ="default" type="STRING"/>
					<colinfo id="CGROUPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FMBIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CGROUPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTINCT_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="COURSECD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioReport">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>발송대상</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>중복</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SendList_D">
				<Contents>
					<colinfo id="JIBU_CNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTZIPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTADDR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUPOSTPLACE" size="256" summ="default" type="STRING"/>
					<colinfo id="CGROUPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FMBIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CGROUPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DISTINCT_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="COURSECD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SendList_Report">
				<Contents>
					<colinfo id="CGROUPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CGROUPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="COURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBU1" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU2" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU3" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU4" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU5" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU6" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU7" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU8" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU9" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU10" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU11" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU12" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU13" size="256" summ="default" type="INT"/>
					<colinfo id="JIBU14" size="256" summ="default" type="INT"/>
					<record>
						<CGROUPCD>10</CGROUPCD>
						<CGROUPNM>1급소방안전관리자</CGROUPNM>
						<COURSECD>11</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>10</CGROUPCD>
						<CGROUPNM>2급소방안전관리자</CGROUPNM>
						<COURSECD>12</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>10</CGROUPCD>
						<CGROUPNM>공공1급소방안전관리자</CGROUPNM>
						<COURSECD>13</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>10</CGROUPCD>
						<CGROUPNM>공공2급소방안전관리자</CGROUPNM>
						<COURSECD>14</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>10</CGROUPCD>
						<CGROUPNM>특급소방안전관리자</CGROUPNM>
						<COURSECD>15</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>30</CGROUPCD>
						<CGROUPNM>위험물안전관리자</CGROUPNM>
						<COURSECD>30</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>50</CGROUPCD>
						<CGROUPNM>소방기술자</CGROUPNM>
						<COURSECD>50</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>60</CGROUPCD>
						<CGROUPNM>개인</CGROUPNM>
						<COURSECD>61</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
					<record>
						<CGROUPCD>70</CGROUPCD>
						<CGROUPNM>단체</CGROUPNM>
						<COURSECD>71</COURSECD>
						<JIBU1/>
						<JIBU10/>
						<JIBU11/>
						<JIBU12/>
						<JIBU13/>
						<JIBU14/>
						<JIBU2/>
						<JIBU3/>
						<JIBU4/>
						<JIBU5/>
						<JIBU6/>
						<JIBU7/>
						<JIBU8/>
						<JIBU9/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioBizGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>소방안전지(홍보과)</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>소방기술지(연구실)</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCreateMode">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>일반자료생성</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>회비완납자만&#32;(회비고지서와&#32;병행발송&#32;방식시&#32;선택)</DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="306" Height="248" Id="Shape2" Left="4" LineColor="user15" Right="544" TabOrder="11" Top="58" Type="Rectangle" Width="540"></Shape>
		<Shape Bottom="273" Height="105" Id="Shape0" Left="72" LineColor="user15" Right="540" TabOrder="15" Top="168" Type="Rectangle" Width="468"></Shape>
		<Shape Bottom="52" Height="52" Id="Shape3" Left="260" LineColor="user14" Right="544" TabOrder="10" Top="0" Type="Rectangle" Width="284"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="9" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="232">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="457" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFileCreate" ImageID="BTN_TEXT_07" Left="350" OnClick="textSave_OnClick" Style="sty_Button" TabOrder="1" Text="2.Text파일변환" ToolTipText="선택" Top="3" Transparent="TRUE" Width="107"></Button>
		<Checkbox FalseValue="N" Height="20" Id="chkAll" Left="80" OnClick="chkAll_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="3" Text="전체" ToolTipText="전체선택" Top="173" TrueValue="Y" UserData="S" Value="FALSE" Width="80"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkBang1" Left="80" OnClick="chkBang1_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="4" Text="1급소방안전관리자" Top="197" TrueValue="Y" UserData="S" Value="FALSE" Width="132"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkSobang" Left="80" OnClick="chkSobang_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="7" Text="소방기술자" Top="245" TrueValue="Y" UserData="S" Value="FALSE" Width="98"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkDanger" Left="383" OnClick="chkDanger_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="5" Text="위험물안전관리자" Top="221" TrueValue="Y" UserData="S" Value="FALSE" Width="127"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkDanche" Left="383" OnClick="chkDanche_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="8" Text="단체회원" Top="245" TrueValue="Y" UserData="S" Value="FALSE" Width="97"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkPerson" Left="239" OnClick="chkPerson_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="6" Text="개인회원" Top="245" TrueValue="Y" UserData="S" Value="FALSE" Width="92"></Checkbox>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="13" Text="지부" Top="145" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_ioJibu" Left="71" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="12" Top="144" UserData="I" Width="102"></Combo>
		<Static Align="Center" Height="20" Id="Static0" Left="8" Style="sty_Label" TabOrder="14" Text="직능" Top="169" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Height="20" Id="Static1" Left="8" Style="sty_Label" TabOrder="16" Text="반송체크" Top="279" VAlign="Middle" Width="60"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medReturn" Left="72" MaxLength="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="17" Top="279" UserData="S" Width="64"></MaskEdit>
		<Static BKColor="user0" BorderColor="user0" Color="user1" Height="20" Id="Static2" Left="140" Style="sty_Label" TabOrder="18" Text="번&#32;이하&#32;반송" Top="279" VAlign="Middle" Width="84"></Static>
		<File Bottom="84" Height="24" Id="filSaveFile" Left="464" Right="488" TabOrder="19" Top="60" Width="24"></File>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint2" ImageID="BTN_TEXT_07" Left="436" OnClick="lfn_Print2" Style="sty_Button" TabOrder="19" Text="4.보고서(중복)" Top="27" Transparent="TRUE" Width="106"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint1" ImageID="BTN_TEXT_07" Left="329" OnClick="lfn_Print1" Style="sty_Button" TabOrder="20" Text="3.보고서(발송)" Top="27" Transparent="TRUE" Width="107"></Button>
		<File Bottom="84" Height="24" Id="filSaveFile_D" Left="436" Right="460" TabOrder="20" Top="60" Width="24"></File>
		<FileDialog Bottom="84" Height="24" Id="fdOpenFile" Left="408" Right="432" TabOrder="20" Top="60" Width="24"></FileDialog>
		<Checkbox FalseValue="N" Height="20" Id="chkBang2" Left="239" OnClick="chkBang2_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="21" Text="2급소방안전관리자" Top="197" TrueValue="Y" UserData="S" Value="FALSE" Width="130"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkGong1" Left="383" OnClick="chkGong1_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="22" Text="공공1급소방안전관리자" Top="197" TrueValue="Y" UserData="S" Value="FALSE" Width="155"></Checkbox>
		<Checkbox FalseValue="N" Height="20" Id="chkGong2" Left="80" OnClick="chkGong2_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="23" Text="공공2급소방안전관리자" Top="221" TrueValue="Y" UserData="S" Value="FALSE" Width="156"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_TEXT_COM" Left="264" OnClick="lfn_Search" OnKeyDown="Form_OnKeyDown" Style="sty_Button" TabOrder="24" Text="1.자료생성" ToolTipText="선택" Top="3" Transparent="TRUE" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static3" Left="8" Style="sty_Label" TabOrder="25" Text="구분" Top="68" VAlign="Middle" Width="60"></Static>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radBizgubun" INDEX="0" InnerDataset="ds_ioBizGubun" Left="72" LeftMargin="4" OnChanged="radBizgubun_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="26" Top="68" Value="1" Width="312"></Radio>
		<Checkbox FalseValue="N" Height="20" Id="chkSpecialBang" Left="239" OnClick="chkSpecialBang_OnClick" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="27" Text="특급소방안전관리자" Top="221" TrueValue="Y" UserData="S" Value="FALSE" Width="135"></Checkbox>
		<Static Align="Center" Height="20" Id="Static4" Left="8" Style="sty_Label" TabOrder="28" Text="생성방식" Top="92" VAlign="Middle" Width="60"></Static>
		<Radio Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="48" Id="radMode" INDEX="-1" InnerDataset="ds_oCreateMode" Left="72" LeftMargin="4" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="29" Top="92" Value="1" Width="344"></Radio>
		<Checkbox BKColor="user30" Color="user0" Height="20" Id="chkDateChoice" Left="248" OnClick="chkDateChoice_OnClick" TabOrder="30" Text="수령희망&#32;날자지정" Top="278" Width="130"></Checkbox>
		<Calendar Height="21" Id="CalDate" Left="382" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="31" Top="278" Width="97"></Calendar>
		<Static Height="13" Id="lbDate" Left="480" TabOrder="32" Text="이후자료" Top="282" Width="55"></Static>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust4020MBrochuresSendReport.xml
 * 설명 : 홍보팀회지발송자료
 * 작성일 : 2010.01.12
 * 작성자 : 최규원
 */

#include "LIB::cust.js"; // 공통업무 관련

function Form_OnLoadCompleted(obj)
{
	gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
	
    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }
	gfn_SearchAllJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회
	
	chkAll.Value = "Y";
	chkAll_OnClick(); 
	
	radBizgubun.Index = 0;
	radMode.Index = 0;
	
	chkDateChoice.Value = 0;	// 수령희망 날자지정
	chkDateChoice_OnClick(obj,chkDateChoice.Value);
}

function lfn_SetFormAuth(bStatus) {

}

function lfn_Search(obj)
{
	if(!gfn_Confirm("자료를 생성하시겠습니까?")){
		return;
	}

	if(chkAll.Value == "N" && chkBang1.Value == "N" && chkBang2.Value == "N" && chkGong1.Value == "N" && chkGong2.Value == "N" 
	   && chkSpecialBang.Value == "N"
	   && chkDanger.Value == "N" && chkSobang.Value == "N" && chkPerson.Value == "N" && chkDanche.Value == "N"){
		alert("직능을 선택체크하세요.");
	}

	tit_clearActionInfo();
	
	tit_addSingleActionInfo("cust:executeCust4020BrochuresStore", false);
	
	//tit_addCsvSearchActionInfo("cust:searchCust4020BrochuresSendReportList", false);
	
	ds_SearchJogeon.DeleteAll();		ds_SearchJogeon.AddRow();
	ds_SendList.Clear();
	ds_SearchJogeon.setColumn(0, "JIBU", cbxJibu.Value);	
	
	var Check = "";
	
	if(chkBang1.Value != "N")
		Check += "'11'" + ",";
	if(chkBang2.Value != "N")
		Check += "'12'" + ",";
	if(chkGong1.Value != "N")
		Check += "'13'" + ",";
	if(chkGong2.Value != "N")
		Check += "'14'" + ",";
	if(chkSpecialBang.Value != "N")
		Check += "'15'" + ",";
	if(chkDanger.Value != "N")
		Check += "'31','32','33','34','35','36'" + ",";
    if(chkSobang.Value != "N")
		Check += "'51','52','53','54','55'" + ",";
	if(chkPerson.Value != "N")
		Check += "'61'" + ",";	
	if(chkDanche.Value != "N")
		Check += "'71'" + ",";
		
	ds_SearchJogeon.setColumn(0, "CHECK_IN", left(Check, length(Check)-1));	  // 직능선택
	
	ds_SearchJogeon.setColumn(0, "CHECK_ALL", chkAll.Value);	// 전체직능 체크
	
	ds_SearchJogeon.setColumn(0, "RETURN_CNT", medReturn.Text);	// 반송회수
	
	ds_SearchJogeon.setColumn(0, "FEEMODE", radMode.Value);	// 생성방식
	
	ds_SearchJogeon.setColumn(0, "BIZGUBUN", radBizgubun.Value);	// 소방안전지, 소방기술지 구분
	
	ds_SearchJogeon.setColumn(0, "HOPEDATE", CalDate.Value);	// 수령희망 날자지정 (날자이후자료 조회)

	tit_callService(  
	                 ""
	               , ""  
	               , "ds_iSendList=ds_SearchJogeon"//inDs 
	               , "" //outDs
	               , ""
	               , "afterSearch"  //callBack
	               , ""
	               ,true
				   ,true
	               ); 
               
	               
}

// 조회 후 callbackfunction afterSearch(errCode, errMsg){
	//trace(ds_CustomerList.SaveXML());
	if(errCode != 0 ){
		alert("오류가 발생했습니다.");
		return;
	}
	else{
	// 임시저장소BrochuresStore 조회
	tit_clearActionInfo();
	ds_SearchJogeon.setColumn(0, "JIBU", cbxJibu.Value);		
	tit_addcsvSearchActionInfo("cust:searchCust4020BrochuresStore", false);	
	tit_callService(  
					 ""
				   , ""  
				   , "ds_iSendList=ds_SearchJogeon"//inDs 
				   , "ds_SendList=ds_oSendList" //outDs
				   , ""
				   , ""  //callBack
				   , ""
				   , ""
				   ,true
				   ); 		
	
	alert(ds_SendList.GetRowCount()+ "건의 자료가 생성되었습니다.");	

	}}

function textSave_OnClick(obj) 
{
	if(!gfn_Confirm("Text 파일로 변환하시겠습니까? \n\n시간이 오래걸릴 수 있습니다.")){
		return;
	}						   	

	// 임시저장소BrochuresStore 조회
	ds_SearchJogeon.DeleteAll();		ds_SearchJogeon.AddRow();
	tit_clearActionInfo();
	ds_SearchJogeon.setColumn(0, "JIBU", cbxJibu.Value);
			
			
	tit_addcsvSearchActionInfo("cust:searchCust4020BrochuresStore", false);	
	tit_callService(  
					 ""
				   , ""  
				   , "ds_iSendList=ds_SearchJogeon"//inDs 
				   , "ds_SendList=ds_oSendList" //outDs
				   , ""
				   , ""  //callBack
				   , ""
				   , true
				   , true
				   ); 	

	if(ds_SendList.rowcount == 0){
		alert("데이터가 없습니다.");
		return;
	}
	
	var nRow = ds_SendList.GetRowCount();
	
	for(var i=nRow;i>0;i--){
		var bfGubun = trim(ds_SendList.GetColumn(i, "DISTINCT_GUBUN"));
		var afGubun = trim(ds_SendList.GetColumn(i-1, "DISTINCT_GUBUN"));
		if(toString(bfGubun) == toString(afGubun)){
			ds_SendList_D.InsertRow(0);
			ds_SendList_D.CopyRow(0, ds_SendList, i);
			ds_SendList.DeleteRow(i);
		}
	}
	
	filSaveFile.MakeDir("C:\\KFSA\\KEMS\\DATA\\회지(대상)");
	filSaveFile = "C:\\KFSA\\KEMS\\DATA\\회지(대상)" + "\\" + substr(getDate(),0,8)+"_회지발송자료.txt";
    filSaveFile.Open("wt");  // Option ( r:read, t:text, b:binary, w:write, a:append +:read/write )
        
    for(var i=0;i<ds_SendList.GetRowCount();i++){
        filSaveFile.Write(ds_SendList.GetColumn(i,"JIBU_CNO")+ds_SendList.GetColumn(i,"BNM")+ds_SendList.GetColumn(i,"CEDUPOSTZIPCD")
                         +ds_SendList.GetColumn(i,"CEDUPOSTADDR1")+ds_SendList.GetColumn(i,"CEDUPOSTADDR2")+ds_SendList.GetColumn(i,"CEDUPOSTPLACE")
                         +ds_SendList.GetColumn(i,"CGROUPNM")+ds_SendList.GetColumn(i,"FMNM")+ds_SendList.GetColumn(i,"COURSECD")+"\r\n");
	}
	//alert("화일을 생성하였습니다.");
	filSaveFile.Close();
 
	filSaveFile_D.MakeDir("C:\\KFSA\\KEMS\\DATA\\회지(중복)");
	filSaveFile_D = "C:\\KFSA\\KEMS\\DATA\\회지(중복)" + "\\" + substr(getDate(),0,8)+"_회지발송자료(중복).txt";
    filSaveFile_D.Open("wt");  // Option ( r:read, t:text, b:binary, w:write, a:append +:read/write )
        
    for(var i=0;i<ds_SendList_D.GetRowCount();i++){
        filSaveFile_D.Write(ds_SendList_D.GetColumn(i,"JIBU_CNO")+ds_SendList_D.GetColumn(i,"BNM")+ds_SendList_D.GetColumn(i,"CEDUPOSTZIPCD")
                         +ds_SendList_D.GetColumn(i,"CEDUPOSTADDR1")+ds_SendList_D.GetColumn(i,"CEDUPOSTADDR2")+ds_SendList_D.GetColumn(i,"CEDUPOSTPLACE")
                         +ds_SendList_D.GetColumn(i,"CGROUPNM")+ds_SendList_D.GetColumn(i,"FMNM")+ds_SendList.GetColumn(i,"COURSECD")+"\r\n");
	}
	
	alert("Text 파일을 생성하였습니다.");
	filSaveFile_D.Close();

}

function lfn_Print1(obj)
{
	filSaveFile.MakeDir("C:\\KFSA\\KEMS\\DATA\\회지(대상)");
	
	fdOpenFile.Type = "OPEN";
	fdOpenFile.FileName = "C:\\KFSA\\KEMS\\DATA\\회지(대상)" + "\\" + substr(getDate(),0,8)+"_회지발송자료.txt";
	
    if (fdOpenFile.open()) {
		var FileName = fdOpenFile.FileName;
        filSaveFile.FileName = "C:\\KFSA\\KEMS\\DATA\\회지(대상)" + "\\" + FileName;
        filSaveFile.Open("rt");
        vSendData = filSaveFile.Read();
        filSaveFile.Close();
        
		vSendData = split(vSendData, "\n");
		var vSendRow = 0;
		ds_SendList.ClearData();
		
		// 텍스트파일을 데이터셋으로 잘라서 저장
        for (var i=0; i<length(vSendData); i++) {
			vSendRow = ds_SendList.AddRow();
			ds_SendList.SetColumn(vSendRow, "JIBU_CNO", Midb(vSendData[i],0,11));
			ds_SendList.SetColumn(vSendRow, "BNM", Midb(vSendData[i],11,50));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTZIPCD", Midb(vSendData[i],61,6));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTADDR1", Midb(vSendData[i],67,60));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTADDR2", Midb(vSendData[i],127,50));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTPLACE", Midb(vSendData[i],177,30));
			ds_SendList.SetColumn(vSendRow, "CGROUPNM", Midb(vSendData[i],207,20));
			ds_SendList.SetColumn(vSendRow, "FMNM", Midb(vSendData[i],227,20));
			ds_SendList.SetColumn(vSendRow, "COURSECD", Midb(vSendData[i],247,2));
        }
    }else{
		return;
    }
    
	//레포트에 넘겨줄 데이터셋 셋팅
	ds_SendList_Report.ClearData();
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(0,"CGROUPNM","1급소방안전관리자");
	ds_SendList_Report.SetColumn(0,"COURSECD","11");
	ds_SendList_Report.SetColumn(0,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(1,"CGROUPNM","2급소방안전관리자");
	ds_SendList_Report.SetColumn(1,"COURSECD","12");
	ds_SendList_Report.SetColumn(1,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(2,"CGROUPNM","공공1급소방안전관리자");
	ds_SendList_Report.SetColumn(2,"COURSECD","13");
	ds_SendList_Report.SetColumn(2,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(3,"CGROUPNM","공공2급소방안전관리자");
	ds_SendList_Report.SetColumn(3,"COURSECD","14");
	ds_SendList_Report.SetColumn(3,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(4,"CGROUPNM","특급소방안전관리자");
	ds_SendList_Report.SetColumn(4,"COURSECD","15");
	ds_SendList_Report.SetColumn(4,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(5,"CGROUPNM","위험물안전관리자");
	ds_SendList_Report.SetColumn(5,"COURSECD","30");
	ds_SendList_Report.SetColumn(5,"CGROUPCD","30");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(6,"CGROUPNM","소방기술자");
	ds_SendList_Report.SetColumn(6,"COURSECD","50");
	ds_SendList_Report.SetColumn(6,"CGROUPCD","50");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(7,"CGROUPNM","개인");
	ds_SendList_Report.SetColumn(7,"COURSECD","61");
	ds_SendList_Report.SetColumn(7,"CGROUPCD","60");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(8,"CGROUPNM","단체");
	ds_SendList_Report.SetColumn(8,"COURSECD","71");
	ds_SendList_Report.SetColumn(8,"CGROUPCD","70");
	 
	 
	//로우데이타를 집계데이터셋으로 생성
	for(var i = 0; i<ds_SendList.GetRowCount(); i++){
		var Jibu = substr(ds_SendList.GetColumn(i,"JIBU_CNO"),0,4);
		var Course = ds_SendList.GetColumn(i,"COURSECD");
		var ColNm = lfn_FindColNm(Jibu);
		var CourseIndex = lfn_FindCourseNm(Course);
		ds_SendList_Report.SetColumn(CourseIndex, ColNm, toNumber(ds_SendList_Report.GetColumn(CourseIndex, ColNm))+1);
	}
	
	trace(ds_SendList_Report.SaveXML());
	
	gfn_CallReportPopup("frmCust4020R01BrochuresSendReport.rex"
				  , "ds_SendList_Report"
				  , "REPORT_GUBUN=" + "1"
				  , true);
	
}

function lfn_FindColNm(jibuCd) {
	var rtnVal = "";
	
	switch(jibuCd) {
		
		case "1011" :
			rtnVal = "JIBU1";
		break;
		case "1021" :
			rtnVal = "JIBU2";
		break;
		case "1031" :
			rtnVal = "JIBU3";
		break;
		case "1041" :
			rtnVal = "JIBU4";
		break;
		case "1051" :
			rtnVal = "JIBU5";
		break;
		case "1061" :
			rtnVal = "JIBU6";
		break;
		case "1131" :
			rtnVal = "JIBU7";
		break;
		case "1081" :
			rtnVal = "JIBU8";
		break;
		case "1141" :
			rtnVal = "JIBU9";
		break;
		case "1091" :
			rtnVal = "JIBU10";
		break;
		case "1101" :
			rtnVal = "JIBU11";
		break;
		case "1111" :
			rtnVal = "JIBU12";
		break;
		case "1071" :
			rtnVal = "JIBU13";
		break;
		case "1121" :
			rtnVal = "JIBU14";
		break;
	}
	
	return rtnVal;
}
function lfn_FindCourseNm(course) {
	var rtnVal = "";
	
	switch(course) {
		
		case "11" :
			rtnVal = 0;
		break;
		case "12" :
			rtnVal = 1;
		break;
		case "13" :
			rtnVal = 2;
		break;
		case "14" :
			rtnVal = 3;
		break;
		case "15" :
			rtnVal = 4;
		break;
		case "31" :
			rtnVal = 5;
		break;	
		case "32" :
			rtnVal = 5;
		break;	
		case "33" :
			rtnVal = 5;
		break;	
		case "34" :
			rtnVal = 5;
		break;	
		case "35" :
			rtnVal = 5;
		break;	
		case "51" :
			rtnVal = 6;
		break;	
		case "52" :
			rtnVal = 6;
		break;	
		case "53" :
			rtnVal = 6;
		break;	
		case "54" :
			rtnVal = 6;
		break;	
		case "55" :
			rtnVal = 6;
		break;	
		case "61" :
			rtnVal = 7;
		break;	
		case "71" :
			rtnVal = 8;
		break;	
	}
	
	return rtnVal;
}


function lfn_Print2(obj)
{
	filSaveFile_D.MakeDir("C:\\KFSA\\KEMS\\DATA\\회지(중복)");
	
	fdOpenFile.Type = "OPEN";
	fdOpenFile.FileName = "C:\\KFSA\\KEMS\\DATA\\회지(중복)" + "\\" + substr(getDate(),0,8)+"_회지발송자료(중복).txt";
	
    if (fdOpenFile.open()) {
		var FileName = fdOpenFile.FileName;
        filSaveFile.FileName = "C:\\KFSA\\KEMS\\DATA\\회지(중복)" + "\\" + FileName;
        filSaveFile.Open("rt");
        vSendData = filSaveFile.Read();
        filSaveFile.Close();
        
		vSendData = split(vSendData, "\n");
		var vSendRow = 0;
		ds_SendList.ClearData();
		
		// 텍스트파일을 데이터셋으로 잘라서 저장
        for (var i=0; i<length(vSendData); i++) {
			vSendRow = ds_SendList.AddRow();
			ds_SendList.SetColumn(vSendRow, "JIBU_CNO", Midb(vSendData[i],0,11));
			ds_SendList.SetColumn(vSendRow, "BNM", Midb(vSendData[i],11,50));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTZIPCD", Midb(vSendData[i],61,6));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTADDR1", Midb(vSendData[i],67,60));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTADDR2", Midb(vSendData[i],127,50));
			ds_SendList.SetColumn(vSendRow, "CEDUPOSTPLACE", Midb(vSendData[i],177,30));
			ds_SendList.SetColumn(vSendRow, "CGROUPNM", Midb(vSendData[i],207,20));
			ds_SendList.SetColumn(vSendRow, "FMNM", Midb(vSendData[i],227,20));
			ds_SendList.SetColumn(vSendRow, "COURSECD", Midb(vSendData[i],247,2));
        }
    }else{
		return;
    }
    
	//레포트에 넘겨줄 데이터셋 셋팅
	ds_SendList_Report.ClearData();
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(0,"CGROUPNM","1급소방안전관리자");
	ds_SendList_Report.SetColumn(0,"COURSECD","11");
	ds_SendList_Report.SetColumn(0,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(1,"CGROUPNM","2급소방안전관리자");
	ds_SendList_Report.SetColumn(1,"COURSECD","12");
	ds_SendList_Report.SetColumn(1,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(2,"CGROUPNM","공공1급소방안전관리자");
	ds_SendList_Report.SetColumn(2,"COURSECD","13");
	ds_SendList_Report.SetColumn(2,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(3,"CGROUPNM","공공2급소방안전관리자");
	ds_SendList_Report.SetColumn(3,"COURSECD","14");
	ds_SendList_Report.SetColumn(3,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(4,"CGROUPNM","특급소방안전관리자");
	ds_SendList_Report.SetColumn(4,"COURSECD","15");
	ds_SendList_Report.SetColumn(4,"CGROUPCD","10");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(5,"CGROUPNM","위험물안전관리자");
	ds_SendList_Report.SetColumn(5,"COURSECD","30");
	ds_SendList_Report.SetColumn(5,"CGROUPCD","30");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(6,"CGROUPNM","소방기술자");
	ds_SendList_Report.SetColumn(6,"COURSECD","50");
	ds_SendList_Report.SetColumn(6,"CGROUPCD","50");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(7,"CGROUPNM","개인");
	ds_SendList_Report.SetColumn(7,"COURSECD","61");
	ds_SendList_Report.SetColumn(7,"CGROUPCD","60");
	ds_SendList_Report.AddRow();
	ds_SendList_Report.SetColumn(8,"CGROUPNM","단체");
	ds_SendList_Report.SetColumn(8,"COURSECD","71");
	ds_SendList_Report.SetColumn(8,"CGROUPCD","70");
	 
	 
	//로우데이타를 집계데이터셋으로 생성
	for(var i = 0; i<ds_SendList.GetRowCount(); i++){
		var Jibu = substr(ds_SendList.GetColumn(i,"JIBU_CNO"),0,4);
		var Course = ds_SendList.GetColumn(i,"COURSECD");
		var ColNm = lfn_FindColNm(Jibu);
		var CourseIndex = lfn_FindCourseNm(Course);
		ds_SendList_Report.SetColumn(CourseIndex, ColNm, toNumber(ds_SendList_Report.GetColumn(CourseIndex, ColNm))+1);
	}
	
	gfn_CallReportPopup("frmCust4020R01BrochuresSendReport.rex"
				  , "ds_SendList_Report"
				  , "REPORT_GUBUN=" + "2"
				  , true);
}


function chkAll_OnClick(obj,strValue)
{
	if(chkAll.Value == "Y"){
		chkBang1.Value = "N";
		chkBang2.Value = "N";
		chkGong1.Value = "N";
		chkGong2.Value = "N";
		chkSpecialBang.Value = "N";
		chkDanger.Value = "N";
		chkSobang.Value = "N";
		chkPerson.Value = "N";
		chkDanche.Value = "N";
	}
}

function chkBang1_OnClick(obj,strValue)
{
	if(chkBang1.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkBang2_OnClick(obj,strValue)
{
	if(chkBang2.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkGong1_OnClick(obj,strValue)
{
	if(chkGong1.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkGong2_OnClick(obj,strValue)
{
	if(chkGong2.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkSpecialBang_OnClick(obj,strValue)
{
	if(chkSpecialBang.Value == "Y"){
		chkAll.Value = "N";
	}	
}

function chkDanger_OnClick(obj,strValue)
{
	if(chkDanger.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkSobang_OnClick(obj,strValue)
{
	if(chkSobang.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkPerson_OnClick(obj,strValue)
{
	if(chkPerson.Value == "Y"){
		chkAll.Value = "N";
	}
}

function chkDanche_OnClick(obj,strValue)
{
	if(chkDanche.Value == "Y"){
		chkAll.Value = "N";
		
	}
}

// 업무구분
function radBizgubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(radBizgubun.value == "0") {
		chkAll.Enable = true;
		chkAll.Value = "Y";
		chkBang1.Value = "N";
		chkBang2.Value = "N";
		chkGong1.Value = "N";
		chkGong2.Value = "N";
		chkSpecialBang.Value = "N";
		chkDanger.Value = "N";
		chkSobang.Value = "N";
		chkPerson.Value = "N";
		chkDanche.Value = "N";		
		
		radMode.Value = 0;
		radMode.Enable = true;
	} else if(radBizgubun.value == "1") {
		chkAll.Enable = false;
		chkAll.Value = "N";
		chkBang1.Value = "N";
		chkBang2.Value = "N";
		chkGong1.Value = "N";
		chkGong2.Value = "N";
		chkSpecialBang.Value = "N";
		chkDanger.Value = "N";
		chkSobang.Value = "Y";
		chkPerson.Value = "Y";
		chkDanche.Value = "N";
		
		radMode.Value = 0;
		//radMode.Enable = false;
	}
	
	
}



function chkDateChoice_OnClick(obj,strValue)
{
	if (strValue == 1) {
		CalDate.Visible = true;
		CalDate.Value = left(getDate(),8);
		lbDate.Visible = true;
	} else {
		CalDate.Visible = false;
		CalDate.Value = "";
		lbDate.Visible = false;	
	
	}
}

function Form_OnActivate(obj)
{
	gs_SysID = "[stm_01,bsn_1005,dsc_0002]";	// 개인정보접속기록 시스템ID 
}
]]></Script>
</Window>
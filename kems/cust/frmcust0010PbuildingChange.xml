<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="504" Id="frmcust0010PbuildingChange" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="대상물&#32;변경" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="900" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioBuildingInfo">
				<Contents>
					<colinfo id="BMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="BNM" size="40" summ="default" type="STRING"/>
					<colinfo id="BBIZCD" size="2" summ="default" type="STRING"/>
					<colinfo id="BFIREUPCD" size="7" summ="default" type="STRING"/>
					<colinfo id="BFIRECD" size="7" summ="default" type="STRING"/>
					<colinfo id="BFIREMAN" size="20" summ="default" type="STRING"/>
					<colinfo id="BTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="BFAX" size="16" summ="default" type="STRING"/>
					<colinfo id="BSMOKEGUBUN" size="1" summ="default" type="CHAR"/>
					<colinfo id="BAREA" size="22" summ="default" type="STRING"/>
					<colinfo id="BCONO" size="13" summ="default" type="STRING"/>
					<colinfo id="BADDRGUBUN" size="1" summ="default" type="CHAR"/>
					<colinfo id="BZIPCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="BADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="BSIDO" size="20" summ="default" type="STRING"/>
					<colinfo id="BSIGUNGU" size="20" summ="default" type="STRING"/>
					<colinfo id="BDONG" size="20" summ="default" type="STRING"/>
					<colinfo id="BRI" size="20" summ="default" type="STRING"/>
					<colinfo id="BSANGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="BBUNJI1" size="20" summ="default" type="STRING"/>
					<colinfo id="BBUNJI2" size="20" summ="default" type="STRING"/>
					<colinfo id="BROADNM" size="100" summ="default" type="STRING"/>
					<colinfo id="BBULDNM" size="100" summ="default" type="STRING"/>
					<colinfo id="BBULDADDR" size="100" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="201" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCustomerList">
				<Contents>
					<colinfo id="BADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="BADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="BNM" size="40" summ="default" type="STRING"/>
					<colinfo id="BTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="BZIPCD" size="6" summ="default" type="STRING"/>
					<colinfo id="CCOCD" size="2" summ="default" type="STRING"/>
					<colinfo id="CCOURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="CFIREMGNO" size="20" summ="default" type="STRING"/>
					<colinfo id="CGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="CNO" size="6" summ="default" type="STRING"/>
					<colinfo id="COVERCMGNO" size="2" summ="default" type="STRING"/>
					<colinfo id="CREGCD" size="2" summ="default" type="STRING"/>
					<colinfo id="CSTATUSGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EPPASSDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="FMHSTARTDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="FMBIRTHDAY" size="13" summ="default" type="STRING"/>
					<colinfo id="OLHNM" size="200" summ="default" type="STRING"/>
					<colinfo id="CMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CFEEADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="FMPERSONKEY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oStatus">
				<Contents>
					<colinfo id="RETURN" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="332" Height="236" Id="Shape2" Left="36" LineColor="user15" Right="896" TabOrder="10" Top="96" Type="Rectangle" Width="860"></Shape>
		<Shape Bottom="84" Height="52" Id="Shape1" Left="36" LineColor="user15" Right="896" TabOrder="15" Top="32" Type="Rectangle" Width="860"></Shape>
		<Static Height="12" Id="Static2" Left="648" TabOrder="29" Text="(&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;,&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;)" Top="40" Width="141"></Static>
		<Shape Bottom="500" Height="92" Id="Shape0" Left="36" LineColor="user15" Right="896" TabOrder="13" Top="408" Type="Rectangle" Width="860"></Shape>
		<Static Align="Center" Height="20" Id="Static0" Left="48" Style="sty_LabelGruopBox" TabOrder="11" Text="변경할&#32;고객정보" Top="88" VAlign="Middle" Width="112"></Static>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oCustomerList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="328" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="212" Id="gdManagerList" InputPanel="FALSE" Left="40" LineColor="default" OnHeadClick="gdManagerList_OnHeadClick" Right="892" RowHeight="20" Style="sty_Grid" TabOrder="9" TabStop="true" Top="116" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="852">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="60"/>
						<col width="151"/>
						<col width="70"/>
						<col width="260"/>
						<col width="59"/>
						<col width="80"/>
						<col width="59"/>
						<col width="60"/>
						<col width="100"/>
						<col width="94"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="65"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" text="관리번호"/>
						<cell col="2" display="text" text="대상물(업체)명"/>
						<cell col="3" display="text" text="대상물No."/>
						<cell col="4" display="text" text="주소"/>
						<cell col="5" display="text" text="지역"/>
						<cell col="6" display="text" text="직능"/>
						<cell col="7" display="text" text="회원구분"/>
						<cell align="center" col="8" display="text" text="성명"/>
						<cell col="9" display="text" text="생년월일"/>
						<cell col="10" display="text" text="개인식별번호"/>
						<cell col="11" display="text" text="선임일자"/>
						<cell col="12" display="text" text="교육일자"/>
						<cell col="13" display="text" text="미납회비"/>
						<cell col="14" display="text" text="겸직구분"/>
					</head>
					<body>
						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="CNO" display="text"/>
						<cell align="left" col="2" colid="BNM" display="text"/>
						<cell align="center" col="3" colid="BMGNO" display="text"/>
						<cell col="4" colid="BADDR" display="text"/>
						<cell align="center" col="5" colid="RCNM" display="combo"/>
						<cell align="left" col="6" colid="CCOURSECD" combocol="COURSECD" combodataset="gds_oCustomerCourse" combotext="CNICKFULLNM" display="combo"/>
						<cell align="center" col="7" colid="CSTATUSGUBUN" display="text"/>
						<cell align="center" col="8" colid="FMNM" display="text"/>
						<cell align="center" col="9" colid="BIRTHDAY" display="text"/>
						<cell align="center" col="10" colid="FMPERSONKEY" display="text" Mask="A####-#####"/>
						<cell align="center" col="11" colid="FMHSTARTDATE" display="date"/>
						<cell align="center" col="12" colid="EPPASSDATE" display="date"/>
						<cell align="right" col="13" colid="MINAP" display="text"/>
						<cell align="center" col="14" colid="COVERCMGNO" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="Static1" Left="48" Style="sty_LabelGruopBox" TabOrder="12" Text="대상물(업체)정보" Top="400" VAlign="Middle" Width="112"></Static>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="804" LineColor="user14" Right="894" TabOrder="14" Top="1" Type="Rectangle" Width="90"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="806" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbSearch" Left="40" Style="sty_Label" TabOrder="15" Text="대상물명" Top="36" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edBuildindNm" ImeMode="native" Left="144" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="2" Top="36" UserData="S" Width="500"></Edit>
		<Static Align="Center" Height="20" Id="lbBuildingNm" Left="40" Style="sty_Label" TabOrder="17" Text="대상물명" Top="428" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edBuildingNm" ImeMode="native" Left="144" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edBuildingNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="18" Top="428" UserData="S:대상물명" Width="636"></Edit>
		<Static Align="Center" Height="20" Id="lbOldAddr" Left="40" Style="sty_Label" TabOrder="19" Text="주소" Top="452" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edAddr1" ImeMode="native" Left="201" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edOldAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="19" Top="452" UserData="S:구주소1" Width="320"></Edit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BKColor="user4" Border="Flat" Enable="FALSE" Height="20" Id="medOldZipCode" Left="144" LeftMargin="2" Mask="###-###" OnFocus="medOldZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="23" Top="452" Type="STRING" UserData="S:구주소우편번호" Width="54"></MaskEdit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edAddr2" ImeMode="native" Left="524" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edOldAddr2_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="20" Top="452" UserData="S:구주소2" Width="256"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edTelNo" ImeMode="native" Left="144" LeftMargin="2" MaxLength="16" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edTelNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="21" Top="476" UserData="S" Width="140"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edFaxNo" ImeMode="native" Left="392" LeftMargin="2" MaxLength="16" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="22" Top="476" UserData="S" Width="140"></Edit>
		<Static Align="Center" Height="20" Id="lbTelNo" Left="40" Style="sty_Label" TabOrder="17" Text="전화번호" Top="476" VAlign="Middle" Width="100"></Static>
		<Static Align="Center" Height="20" Id="lbFaxNo" Left="288" Style="sty_Label" TabOrder="24" Text="팩스번호" Top="476" VAlign="Middle" Width="100"></Static>
		<Static Color="user6" Height="24" Id="lbText01" Left="112" Style="sty_TextBlue" TabOrder="27" Text="※&#32;선택된&#32;고객들에&#32;대해서&#32;아랫쪽&#32;대상물로&#32;대상처가&#32;변경처리됩니다." Top="4" VAlign="Middle" Width="420"></Static>
		<Checkbox FalseValue="0" Height="14" Id="chkCust" Left="656" TabOrder="28" Text="해당&#32;문자열&#32;포함" Top="40" TrueValue="1" Value="FALSE" Width="119"></Checkbox>
		<Static Align="Center" Height="20" Id="lbAddr" Left="40" Style="sty_Label" TabOrder="30" Text="주소" Top="60" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edAddrSearch" ImeMode="native" Left="144" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="3" Top="60" UserData="S:구주소1" Width="500"></Edit>
		<Static Height="12" Id="Static4" Left="648" TabOrder="32" Text="(&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;,&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;)" Top="64" Width="141"></Static>
		<Checkbox FalseValue="0" Height="14" Id="chkAddr" Left="656" TabOrder="31" Text="해당&#32;문자열&#32;포함" Top="64" TrueValue="1" Value="FALSE" Width="119"></Checkbox>
		<Shape Bottom="396" Height="52" Id="Shape3" Left="36" LineColor="user15" Right="896" TabOrder="32" Top="344" Type="Rectangle" Width="860"></Shape>
		<Static Align="Center" Height="20" Id="lbBuildingNm2" Left="40" Style="sty_Label" TabOrder="33" Text="대상물명" Top="348" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edBuildindNm2" ImeMode="native" Left="144" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="5" Top="348" UserData="S" Width="636"></Edit>
		<Static Align="Center" Height="20" Id="lbAddr2" Left="40" Style="sty_Label" TabOrder="34" Text="주소" Top="372" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edAddrSearch2" ImeMode="native" Left="144" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="6" Top="372" UserData="S:구주소1" Width="636"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_TEXT_COM" Left="806" OnClick="lfn_Search" Style="sty_Button" TabOrder="4" Text="고객조회(F2)" ToolTipText="고객조회" Top="36" Transparent="TRUE" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchBuilding" ImageID="BTN_TEXT_07" Left="787" OnClick="lfn_SearchBuilding" Style="sty_Button" TabOrder="7" Text="대상물조회" ToolTipText="대상물조회" Top="347" Transparent="TRUE" Width="109"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnNewBuilding" ImageID="BTN_TEXT_07" Left="787" OnClick="btnNewBuilding_OnClick" Style="sty_Button" TabOrder="8" Text="신규추가" ToolTipText="신규추가" Top="371" Transparent="TRUE" Width="108"></Button>
		<Shape BKColor="#cc0000" Bottom="340" Height="4" Id="shpBox1" Left="4" LineColor="#cc0000" Right="894" TabOrder="36" Top="336" Type="Rectangle" Width="890"></Shape>
		<Static Align="Center" BKColor="blueviolet" Height="300" Id="Static5" Left="4" Style="sty_LabelGruopBox" TabOrder="38" Text="변&#10;경&#10;&#10;전" Top="32" VAlign="Middle" Width="28"></Static>
		<Static Align="Center" BKColor="brown" Height="156" Id="Static8" Left="4" Style="sty_LabelGruopBox" TabOrder="37" Text="변&#13;&#10;경&#13;&#10;&#10;후" Top="344" VAlign="Middle" Width="28"></Static>
		<Button BKColor="user17" ButtonStyle="TRUE" Cursor="HAND" Height="84" Id="btnSave" Left="788" OnClick="btnSave_OnClick" Style="sty_Button" TabOrder="39" Text="대상물변경" ToolTipText="대상물변경" Top="412" Width="104"></Button>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust0010PbuildingChange.xml
 * 설명 : 대상물 변경처리
 * 작성일 : 2010.01.12
 * 작성자 : 이규희
 */

#include "LIB::cust.js"; // 공통업무 관련

var BMGNO = ""; // 대상물관리번호
/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
    
    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정        lfn_SetFormAuth(true); // 저장 권한    } else if (ms_FormAuth == "R") {        lfn_SetFormAuth(false); // 읽기 권한    } else {        gfn_Alert(MSGI00080);        close();    }
    
    // 공통 코드 조회
    /*
    if (IsExistVar("sBmgno")) {
        BMGNO = sBmgno;
        edBuildindNm.SetFocus();
        //lfn_SearchBuildingInfo();
    }
    */
    edBuildindNm.SetFocus();
}

function Form_OnUnloadCompleted(obj) {
    Close();
}

/*
 * 기능 : 종료
 */
function lfn_End(obj) {
    Close();
}

/* * 기능 : 버튼 활성/비활성시킨다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetFormAuth(bStatus) {	btnNewBuilding.Enable = bStatus; // 신규추가 버튼
	btnSave.Enable = bStatus; // 수정&저장 버튼}

/*
 * 기능 : 조회
 */
function lfn_Search(obj)
{
    if (gfn_IsNull(edBuildindNm.Text) && gfn_IsNull(edAddrSearch.Text)) {
        gfn_Alert("최소 하나의 검색조건을 입력하십시오.");
        edBuildindNm.SetFocus();
        return false;
    }
    
    var sKeyWord = edBuildindNm.Text;
    if (chkCust.Value == "0") {
        sKeyWord = lfn_ReplaceBnm(sKeyWord);  // 검색대상물명
    }
    
	ds_oCustomerList.ClearData(); // 데이타셋 초기화
    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust0010PManagerList", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oCustomerList=ds_oCustomerList"	// outDs
		,"BNM=" + quote(sKeyWord)
          + " BADDR=" + quote(edAddrSearch.Text)
          + " CGTMGNO=" + quote(Parent.cbxJibu.Value)
          + " CHECK=" + quote(chkCust.Value)
          + " CHECK2=" + quote(chkAddr.Value)
		,"lfn_AfterSearchManager"
		,false
	);
}

function lfn_AfterSearchManager(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    //trace(ds_oManagerList.SaveXML());

    gfn_SearchMessage(gdManagerList); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

function lfn_SearchBuildingInfo(obj) {
    ds_ioBuildingInfo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("cust:searchCust0010BuildingInfo", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioBuildingInfo=ds_ioBuildingInfo"	// outDs
		,"BMGNO=" + quote(BMGNO)
		,"lfn_AfterSearchbuilding"
		,false
	);
}

/* 공통 필수 종료 */

/*
 * 기능 : 공통코드 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchbuilding(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    //trace(ds_ioBuildingInfo.SaveXML());
    edBuildingNm.Text = ds_ioBuildingInfo.GetColumn(0, "BNM");
    medOldZipCode.Value = ds_ioBuildingInfo.GetColumn(0, "BZIPCD");
    if (ds_ioBuildingInfo.GetColumn(0, "BADDRGUBUN") == "0") {
		edAddr1.Text = ds_ioBuildingInfo.GetColumn(0, "BADDR1");
		edAddr2.Text = ds_ioBuildingInfo.GetColumn(0, "BADDR2");
	} else {
		edAddr1.Text = ds_ioBuildingInfo.GetColumn(0, "BROADADDR1");
		edAddr2.Text = ds_ioBuildingInfo.GetColumn(0, "BROADADDR2");
	}
    edTelNo.Text = ds_ioBuildingInfo.GetColumn(0, "BTEL");
    edFaxNo.Text = ds_ioBuildingInfo.GetColumn(0, "BFAX");
}

/* 이벤트 함수 종료 */

/* 사용자 함수 */
function edBuildingNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) { // Enter Key
        lfn_Search();
    }
}

function gdManagerList_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	var lobj_Dataset = object(obj.BindDataset);
	if (nCell == 0) { // 선택
        if (obj.GetCellProp("head", nCell, "text") == 1) { // 전체가 이미 선택된 경우
            obj.SetCellProp("head", nCell, "text", 0);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                lobj_Dataset.SetColumn(i, "SEL", "0");
            }
        } else { // 전체가 이미 선택되지 않은 경우
            obj.SetCellProp("head", nCell, "text", 1);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                lobj_Dataset.SetColumn(i, "SEL", "1");
            }
        }
	} else { // 헤드 정렬
        lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex);
	}
}

// 대상물변경 처리
function btnSave_OnClick(obj)
{	
    var cnt = 0;
    for (var i=0;i<ds_oCustomerList.GetCount();i++) {
        if (ds_oCustomerList.GetColumn(i, "SEL") == "1") {
            cnt += 1;
        }
    }
    if (cnt == 0) {
        gfn_Alert("변경할 데이터가 없습니다.");
        return;
    }
    if (ds_ioBuildingInfo.GetCount() < 1) {
        gfn_Alert("변경될 대상물을 선택하여 주십시오.");
        edBuildindNm2.SetFocus();
        return;
    }
    
    if(!gfn_Confirm("선택된 항목들에 대해서 대상물 변경처리를 하시겠습니까?")) {
        return false;
    }
	for (var i=0;i<ds_oCustomerList.GetCount();i++) {
        if (ds_oCustomerList.GetColumn(i, "SEL") == "1") {            
            tit_clearActionInfo();
            if (!gfn_IsNull(ds_oCustomerList.GetColumn(i, "COBMGNO"))) {
                tit_addSingleActionInfo("cust:executeCust0010PBuildingChangeOverbizEnd", "", 0, "");
            }
            tit_addSingleActionInfo("cust:executeCust0010PBuildingChange", "", 0, "");
            // 서버 호출 
            tit_callService(
                ""
                ,""
                ,""	// inDs
                ,"ds_oStatus=ds_oStatus"	// outDs
                ,"BMGNO=" + quote(ds_ioBuildingInfo.GetColumn(0, "BMGNO"))	
                  + " BNM=" + quote(ds_ioBuildingInfo.GetColumn(0, "BNM"))	
                  + " BZIPCD=" + quote(ds_ioBuildingInfo.GetColumn(0, "BZIPCD"))
                  + " BADDR1=" + quote(ds_ioBuildingInfo.GetColumn(0, "BADDR1"))
                  + " BADDR2=" + quote(ds_ioBuildingInfo.GetColumn(0, "BADDR2"))
                  + " BROADADDR1=" + quote(ds_ioBuildingInfo.GetColumn(0, "BROADADDR1"))
                  + " BROADADDR2=" + quote(ds_ioBuildingInfo.GetColumn(0, "BROADADDR2"))
                  
                  + " CMGNO=" + quote(ds_oCustomerList.GetColumn(i, "CMGNO"))
                  + " FMHFMMGNO=" + quote(ds_oCustomerList.GetColumn(i, "FMHFMMGNO"))
                  + " FMHSEQ=" + quote(ds_oCustomerList.GetColumn(i, "FMHSEQ"))
                  + " CFEEPOSTGUBUN=" + quote(ds_oCustomerList.GetColumn(i, "CFEEPOSTGUBUN"))
                  + " CEDUPOSTGUBUN=" + quote(ds_oCustomerList.GetColumn(i, "CEDUPOSTGUBUN"))
                  + " CFEEADDRGUBUN=" + quote(ds_oCustomerList.GetColumn(i, "CFEEADDRGUBUN"))
                  + " CEDUADDRGUBUN=" + quote(ds_oCustomerList.GetColumn(i, "CEDUADDRGUBUN"))
                  + " COBMGNO=" + quote(ds_oCustomerList.GetColumn(i, "COBMGNO"))// args 
                ,""
                ,false
                ,false
                ,true
            );
        }        
    }
    //alert(ds_oStatus.GetColumn(0, "RETURN"));
    gfn_Alert("대상물 변경처리를 완료하였습니다.");
    lfn_Search();
}

// 대상물검색
function lfn_SearchBuilding(obj)
{
	//팝업
	var sArg  = "sBuildingNm=" + quote(trim(edBuildindNm2.Text));
		sArg += " sBuildingAddr=" + quote(trim(edAddrSearch2.Text));
		sArg += " sCgtmgno=" + quote(Parent.cbxJibu.Value);

    var arrNo = Dialog(ls_Prefix + "::frmcust0010PBCSearchbuilding.xml", sArg, 700, 380, "", -1, -1);
    if (length(arrNo) > 0) {
		BMGNO = arrNo[0];
		lfn_SearchBuildingInfo();
    }
}

// 대상물 신규
function btnNewBuilding_OnClick(obj)
{
	var arrNo = Dialog(ls_Prefix + "::frmcust0010PBCNewBuilding.xml", "", 496, 484, "", -1, -1);
    if (length(arrNo) > 0) {
		BMGNO = arrNo[0];
		lfn_SearchBuildingInfo();
    }
}

/*
 * 기능 : 검색을 위한 대상물명 변환
 * parameter : 대상물명
 * return : 대상물명(BSEARCHNM)
 */
function lfn_ReplaceBnm(sBnm) {
    var sBSEARCHNM = sBnm;
    ds_oBnmCode.ClearData();
    
    tit_clearActionInfo();
    tit_addCsvSearchActionInfo("cust:searchCust0010BnmReplaceCode", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oBnmCode=ds_oBnmCode" // outDs
        , ""
        , ""
        ,false
        ,false
        ,true
    );
    
    for (i=0;i<ds_oBnmCode.GetCount();i++) {
        sBSEARCHNM = Replace(sBSEARCHNM, ds_oBnmCode.GetColumn(i, "CCCDNM"), "");
    }
    
    return sBSEARCHNM;
}
]]></Script>
</Window>
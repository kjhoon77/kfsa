<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="192" Id="frmcust4010EduYearCont" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="교육년도&#32;관리" TooltipFont="Default,0" Top="8" Ver="1.0" Width="724" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTrainingOrder" OnRowPosChanged="ds_ioTrainingOrder_OnRowPosChanged">
				<Contents>
					<colinfo id="EYGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EYDEFYEAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="EYDEFYEAR2" size="256" summ="default" type="STRING"/>
					<colinfo id="EYDEFYEAR3" size="256" summ="default" type="STRING"/>
					<colinfo id="EYDANGERYEAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="EYDANGERYEAR2" size="256" summ="default" type="STRING"/>
					<colinfo id="EYDANGERYEAR3" size="256" summ="default" type="STRING"/>
					<colinfo id="EYENGRYEAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="EYENGRYEAR2" size="256" summ="default" type="STRING"/>
					<colinfo id="EYENGRYEAR3" size="256" summ="default" type="STRING"/>
					<colinfo id="EYTRANSYEAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="EYTRANSYEAR2" size="256" summ="default" type="STRING"/>
					<colinfo id="EYTRANSYEAR3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_RowCnt">
				<Contents>
					<colinfo id="RowCnt" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="80" Height="41" Id="Shape0" Left="3" LineColor="user15" Right="720" TabOrder="32" Top="39" Type="Rectangle" Width="717"></Shape>
		<Shape Bottom="179" Height="88" Id="shpGubunBox3" Left="4" LineColor="user15" Right="180" TabOrder="14" Top="91" Type="Rectangle" Width="176"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="14" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="284">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="20" Id="lbTrainingPersonInfo" Left="20" Style="sty_LabelGruopBox" TabOrder="14" Text="소방안전관리자" Top="83" VAlign="Middle" Width="144"></Static>
		<Static Align="Center" Height="20" Id="lbEduDate" Left="8" Style="sty_Label" TabOrder="17" Text="교육년도" Top="107" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edDefYear1" ImeMode="native" Left="100" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="2" Top="107" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edDefYear2" ImeMode="native" Left="100" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="3" Top="131" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edDefYear3" ImeMode="native" Left="100" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="4" Top="155" UserData="S:주소" Width="72"></Edit>
		<Shape Bottom="179" Height="88" Id="Shape1" Left="184" LineColor="user15" Right="360" TabOrder="18" Top="91" Type="Rectangle" Width="176"></Shape>
		<Static Align="Center" Height="20" Id="Static0" Left="200" Style="sty_LabelGruopBox" TabOrder="18" Text="위험물관리자" Top="83" VAlign="Middle" Width="144"></Static>
		<Static Align="Center" Height="20" Id="Static1" Left="188" Style="sty_Label" TabOrder="19" Text="교육년도" Top="107" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edDangerYear1" ImeMode="native" Left="280" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="5" Top="107" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edDangerYear2" ImeMode="native" Left="280" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="6" Top="131" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edDangerYear3" ImeMode="native" Left="280" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="7" Top="155" UserData="S:주소" Width="72"></Edit>
		<Shape Bottom="179" Height="88" Id="Shape2" Left="364" LineColor="user15" Right="540" TabOrder="21" Top="91" Type="Rectangle" Width="176"></Shape>
		<Static Align="Center" Height="20" Id="Static2" Left="380" Style="sty_LabelGruopBox" TabOrder="21" Text="소방기술자" Top="83" VAlign="Middle" Width="144"></Static>
		<Static Align="Center" Height="20" Id="Static3" Left="368" Style="sty_Label" TabOrder="22" Text="교육년도" Top="107" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edEngrYear1" ImeMode="native" Left="460" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="8" Top="107" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edEngrYear2" ImeMode="native" Left="460" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="9" Top="131" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edEngrYear3" ImeMode="native" Left="460" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="10" Top="155" UserData="S:주소" Width="72"></Edit>
		<Shape Bottom="179" Height="88" Id="Shape3" Left="544" LineColor="user15" Right="720" TabOrder="24" Top="91" Type="Rectangle" Width="176"></Shape>
		<Static Align="Center" Height="20" Id="Static4" Left="560" Style="sty_LabelGruopBox" TabOrder="24" Text="위험물운송자" Top="83" VAlign="Middle" Width="144"></Static>
		<Static Align="Center" Height="20" Id="Static5" Left="548" Style="sty_Label" TabOrder="25" Text="교육년도" Top="107" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTransYear1" ImeMode="native" Left="640" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="11" Top="107" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTransYear2" ImeMode="native" Left="640" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="12" Top="131" UserData="S:주소" Width="72"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTransYear3" ImeMode="native" Left="640" LeftMargin="2" MaxLength="4" Number="TRUE" Style="sty_Edit" TabOrder="13" Top="155" UserData="S:주소" Width="72"></Edit>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="370" LineColor="user14" Right="722" TabOrder="31" Top="1" Type="Rectangle" Width="352"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="373" OnClick="lfn_Save" Style="sty_Button" TabOrder="30" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="460" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="27" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="547" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="28" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="634" OnClick="lfn_End" Style="sty_Button" TabOrder="29" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static6" Left="19" Style="sty_LabelGruopBox" TabOrder="33" Text="조회조건" Top="31" VAlign="Middle" Width="112"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="71" OnChanged="cbxJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="1" Top="55" UserData="S" Width="104"></Combo>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="34" Text="지부" Top="56" VAlign="Middle" Width="60"></Static>
		<Static Color="user6" Font="굴림,11,Bold" Height="20" Id="Static7" Left="190" TabOrder="35" Text="※&#32;교육년도를&#32;위에서&#32;아래로&#32;순차적(오름차순)으로&#32;입력하세요!!" Top="59" Width="474"></Static>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : 
 * 설명 : 
 * 작성일 : 
 * 작성자 : 
 */

#include "LIB::COM.js";  // 공통업무 관련
#include "LIB::cust.js"; // 공통업무 관련

 var ls_IsUpdateYN = false; 
 var ls_grdEsmgNo;//수정후 해당 로우에 포커스 이동. 
 
/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    //alert(ms_FormAuth);
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }

    // 공통 코드 조회
    gfn_SearchJibu(cbxJibu, "Y", ""); // 지부 코드 조회
    cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD"); 
    
    cbxJibu.SetFocus();
    
    lfn_Search();
}

/*
 * 기능 : 지부 콤보 변경시
 */
function cbxJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    lfn_Search();
}



/*
 * 기능 : 조회
 */
function lfn_Search(obj) {

    
    ds_ioTrainingOrder.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust4010EduYear", false);
	
	// 서버 호출
 	var sParm = "";
	sParm  = " EYGTMGNO=" + quote(cbxJibu.Value);   
	
	//alert(sParm);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioTrainingOrder=ds_oTrainingOrder"	// outDs
		, sParm  // args 
		,"lfn_AfterSearchTrainingOrder"
		,false
	);
}

/*
 * 기능 : 저장
 */
function lfn_Save(obj)
{

    ds_RowCnt.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust4010EduYearCount", false);
	
	// 서버 호출
 	var sParm = "";
	sParm  = " EYGTMGNO=" + quote(cbxJibu.Value);   
	
	//alert(sParm);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_RowCnt=ds_oRowCnt"	// outDs
		, sParm  // args 
		,"lfn_AfterSearchEduYearRowCnt"
		,false
	);
}
	
	
function lfn_AfterSearchEduYearRowCnt(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    } 
    var RowCntSaveYn = ds_RowCnt.GetColumn(0,"RowCnt");
    
    //alert("RowCntSaveYn:"+RowCntSaveYn);
    
    if (RowCntSaveYn == 0) {
        //입력
        lfn_Insert();
    } else {
        //수정
        lfn_Update();
    }
    
}


	
	
    
function lfn_Insert(obj) 
{
    var message = "자료를 저장하시겠습니까?";
    if(!confirm(message)) {   
      return false;
    }
 
    ds_ioTrainingOrder.InsertRow(0);
    ds_ioTrainingOrder.SetColumn(0, "EYGTMGNO", cbxJibu.Value);//지부
    
    ds_ioTrainingOrder.SetColumn(0, "EYDEFYEAR1", edDefYear1.Text);//방관교육년도1
    ds_ioTrainingOrder.SetColumn(0, "EYDEFYEAR2", edDefYear2.Text);//방관교육년도2
    ds_ioTrainingOrder.SetColumn(0, "EYDEFYEAR3", edDefYear3.Text);//방관교육년도3
    
    ds_ioTrainingOrder.SetColumn(0, "EYDANGERYEAR1", edDangerYear1.Text);//위관교육년도1 
    ds_ioTrainingOrder.SetColumn(0, "EYDANGERYEAR2", edDangerYear2.Text);//위관교육년도2 
    ds_ioTrainingOrder.SetColumn(0, "EYDANGERYEAR3", edDangerYear3.Text);//위관교육년도3 
  
    ds_ioTrainingOrder.SetColumn(0, "EYENGRYEAR1", edEngrYear1.Text);//소방기술자교육년도1
    ds_ioTrainingOrder.SetColumn(0, "EYENGRYEAR2", edEngrYear2.Text);//소방기술자교육년도2
    ds_ioTrainingOrder.SetColumn(0, "EYENGRYEAR3", edEngrYear3.Text);//소방기술자교육년도3
  
    ds_ioTrainingOrder.SetColumn(0, "EYTRANSYEAR1", edTransYear1.Text);//위운교육년도1
    ds_ioTrainingOrder.SetColumn(0, "EYTRANSYEAR2", edTransYear2.Text);//위운교육년도2
    ds_ioTrainingOrder.SetColumn(0, "EYTRANSYEAR3", edTransYear3.Text);//위운교육년도3
    
 
    tit_clearActionInfo();
    tit_addSaveActionInfo(
        "cust:insertCust4010EduYear"	// insert
        , ""	// update
        , ""	// delete
        , ""	// flag column 명
        , ""	// key sql id
        , 0	// key 증가 값
        , "" 
        , 0 
        , "N"  );
        
    tit_callService(
         ""
        ,""
        ,"ds_iTrainingOrder=ds_ioTrainingOrder:U"	
        ,"" // outDs
        ,""	// args 
        ,"lfn_AfterSearchTrainingOrder"
        ,false  );	
 	
}

	
    
function lfn_Update(obj) 
{
    var message = "자료를 수정하시겠습니까?";
    if(!confirm(message)) {   
      return false;
    }


    
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYGTMGNO", cbxJibu.Value);//지부
    
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYDEFYEAR1", edDefYear1.Text);//방관교육년도1
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYDEFYEAR2", edDefYear2.Text);//방관교육년도2
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYDEFYEAR3", edDefYear3.Text);//방관교육년도3
  
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYDANGERYEAR1", edDangerYear1.Text);//위관교육년도1 
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYDANGERYEAR2", edDangerYear2.Text);//위관교육년도2 
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYDANGERYEAR3", edDangerYear3.Text);//위관교육년도3 
  
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYENGRYEAR1", edEngrYear1.Text);//소방기술자교육년도1
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYENGRYEAR2", edEngrYear2.Text);//소방기술자교육년도2
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYENGRYEAR3", edEngrYear3.Text);//소방기술자교육년도3
  
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYTRANSYEAR1", edTransYear1.Text);//위운교육년도1
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYTRANSYEAR2", edTransYear2.Text);//위운교육년도2
    ds_ioTrainingOrder.SetColumn(ds_ioTrainingOrder.currow, "EYTRANSYEAR3", edTransYear3.Text);//위운교육년도3
 
    tit_clearActionInfo();
    tit_addSaveActionInfo(
          ""	// insert
        , "cust:updateCust4010EduYear"	// update
        , ""	// delete
        , ""	// flag column 명
        , ""	// key sql id
        , 0	// key 증가 값
        , "" 
        , 0 
        , "N"  );

    tit_callService(
         ""
        ,""
        ,"ds_iTrainingOrder=ds_ioTrainingOrder:U"	
        ,""	// outDs
        ,""	// args 
        ,"lfn_AfterSearchTrainingOrder"
        ,false  );	
 	
}

function lfn_AfterSearchTrainingOrder(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    } 
}




function ds_ioTrainingOrder_OnRowPosChanged(obj,nOldRow,nRow)
{
    if (obj.GetRowType(nRow) <> "insert" ) {
        edDefYear1.Text    = obj.GetColumn(nRow, "EYDEFYEAR1");//방관교육년도1
		edDefYear2.Text    = obj.GetColumn(nRow, "EYDEFYEAR2");//방관교육년도2
		edDefYear3.Text    = obj.GetColumn(nRow, "EYDEFYEAR3");//방관교육년도3
		
		edDangerYear1.Text = obj.GetColumn(nRow, "EYDANGERYEAR1");//위관교육년도1
		edDangerYear2.Text = obj.GetColumn(nRow, "EYDANGERYEAR2");//위관교육년도2
		edDangerYear3.Text = obj.GetColumn(nRow, "EYDANGERYEAR3");//위관교육년도3

        edEngrYear1.Text   = obj.GetColumn(nRow, "EYENGRYEAR1");//소방기술자교육년도1
        edEngrYear2.Text   = obj.GetColumn(nRow, "EYENGRYEAR2");//소방기술자교육년도2
        edEngrYear3.Text   = obj.GetColumn(nRow, "EYENGRYEAR3");//소방기술자교육년도3
         
        edTransYear1.Text  = obj.GetColumn(nRow, "EYTRANSYEAR1");//위운교육년도1
        edTransYear2.Text  = obj.GetColumn(nRow, "EYTRANSYEAR2");//위운교육년도2
        edTransYear3.Text  = obj.GetColumn(nRow, "EYTRANSYEAR3");// 위운교육년도3
    }     
   
	
}




/*-----------------------------------------------------------------
 * 기능 : 버튼 활성/비활성시킨다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 *----------------------------------------------------------------*/
function lfn_SetFormAuth(bStatus) {
    btnSave.Enable = bStatus; // 수정&저장 버튼
}




function btnPrintScreen_OnClick(obj)
{
	printscreen();
}

]]></Script>
</Window>
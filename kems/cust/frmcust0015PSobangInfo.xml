<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="324" Id="frmcust0015PSobangInfo" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="소방본부&#32;연계&#32;현황" Top="8" Ver="1.0" Width="500" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioMemberGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>0</CD>
						<DATA>정상&#32;자료</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>취소된&#32;자료</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioOrder">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>고객번호</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>대상물(업체)명,&#32;고객번호</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>지역,&#32;주소,&#32;대상물(업체)명</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>소방본부&#32;연계관리번호</DATA>
					</record>
					<record>
						<CD>5</CD>
						<DATA>주소,&#32;대상물(업체)명</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioCourseYn">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>선택&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>다중선택</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioChoiceYn">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>선택</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioYn">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>0</CD>
						<DATA>입력된&#32;자료</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>입력안된&#32;자료</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRegion">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="GTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oList">
				<Contents>
					<colinfo id="MGNO" size="12" summ="default" type="STRING"/>
					<colinfo id="BNM" size="40" summ="default" type="STRING"/>
					<colinfo id="CFIREMGNO" size="20" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="FMBIRTHDAY" size="13" summ="default" type="STRING"/>
					<colinfo id="CREGISTERYYMM" size="6" summ="default" type="STRING"/>
					<colinfo id="CFEEYYMM" size="6" summ="default" type="STRING"/>
					<colinfo id="FMHSTARTDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="FMHENDDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="FMHADDR" size="201" summ="default" type="STRING"/>
					<colinfo id="FMHHPTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="81" summ="default" type="STRING"/>
					<colinfo id="FMHTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="FMPERSONKEY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oState">
				<Contents>
					<colinfo id="CREGCD" size="2" summ="default" type="STRING"/>
					<colinfo id="RCNM" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT" size="22" summ="default" type="STRING"/>
					<colinfo id="CFIREMGNO1" size="22" summ="default" type="STRING"/>
					<colinfo id="CFIREMGNO2" size="22" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="319" Height="84" Id="Shape1" Left="4" LineColor="user15" Right="496" TabOrder="7" Top="235" Type="Rectangle" Width="492"></Shape>
		<Shape Bottom="224" Height="184" Id="Shape0" Left="4" LineColor="user15" Right="496" TabOrder="3" Top="40" Type="Rectangle" Width="492"></Shape>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="156" LineColor="user14" Right="496" TabOrder="2" Top="1" Type="Rectangle" Width="340"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="408" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static1" Left="20" Style="sty_LabelGruopBox" TabOrder="4" Text="조회&#32;조건" Top="32" VAlign="Middle" Width="112"></Static>
		<Static Align="Center" Height="20" Id="lbMemberGubun" Left="8" Style="sty_Label" TabOrder="5" Text="취소여부" Top="176" VAlign="Middle" Width="76"></Static>
		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radMemberGubun" INDEX="0" InnerDataset="ds_ioMemberGubun" Left="92" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="6" Top="176" UserData="S" Width="328"></Radio>
		<Static Align="Center" Height="20" Id="Static13" Left="20" Style="sty_LabelGruopBox" TabOrder="8" Text="정렬순서" Top="227" VAlign="Middle" Width="112"></Static>
		<Radio BindDataset="ds_ioOrder" Border="None" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="64" Id="radOrder" INDEX="0" InnerDataset="ds_ioOrder" Left="20" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="9" Top="252" UserData="S" Value="1" Width="432"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_COM_PRINT" Left="504" OnClick="lfn_Print" Style="sty_Button" TabOrder="10" ToolTipText="출력" Top="4" Visible="FALSE" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="321" OnClick="lfn_ToExcel" Style="sty_Button" TabOrder="11" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static0" Left="8" Style="sty_Label" TabOrder="12" Text="입력여부" Top="200" VAlign="Middle" Width="76"></Static>
		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radYn" INDEX="0" InnerDataset="ds_ioYn" Left="92" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="13" Top="200" UserData="S" Width="328"></Radio>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="452" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="116" Id="gdManagerList" InputPanel="FALSE" LineColor="default" OnHeadClick="gdManagerList_OnHeadClick" Right="500" RowHeight="20" Style="sty_Grid" TabOrder="14" TabStop="true" Top="336" UseDBuff="true" UsePopupMenu="true" UserData="소방본부연계현황" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="500">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="180"/>
						<col width="170"/>
						<col width="80"/>
						<col width="110"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="240"/>
						<col width="100"/>
						<col width="120"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="안전원관리번호"/>
						<cell col="1" display="text" text="대상물(업체)명"/>
						<cell col="2" display="text" text="소방본부대상처관리번호"/>
						<cell col="3" display="text" text="성명"/>
						<cell col="4" display="text" text="생년월일"/>
						<cell col="5" display="text" text="입회년월"/>
						<cell col="6" display="text" text="회비부과년월"/>
						<cell col="7" display="text" text="선임일자"/>
						<cell col="8" display="text" text="취소일자"/>
						<cell col="9" display="text" text="주소"/>
						<cell col="10" display="text" text="휴대폰"/>
						<cell col="11" display="text" text="이메일"/>
						<cell col="12" display="text" text="연락처"/>
					</head>
					<body>
						<cell align="center" col="0" colid="MGNO" display="text"/>
						<cell col="1" colid="BNM" display="text"/>
						<cell align="center" col="2" colid="CFIREMGNO" display="text"/>
						<cell align="center" col="3" colid="FMNM" display="text"/>
						<cell align="center" col="4" colid="BIRTHDAY" display="text" Mask="######-#######"/>
						<cell align="center" col="5" colid="CREGISTERYYMM" display="text"/>
						<cell align="center" col="6" colid="CFEEYYMM" display="text"/>
						<cell align="center" col="7" colid="FMHSTARTDATE" display="text"/>
						<cell align="center" col="8" colid="FMHENDDATE" display="text"/>
						<cell col="9" colid="FMHADDR" display="text"/>
						<cell align="center" col="10" colid="FMHHPTEL" display="text"/>
						<cell align="center" col="11" colid="EMAIL" display="text"/>
						<cell align="center" col="12" colid="FMHTEL" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="Static2" Left="8" Style="sty_Label" TabOrder="21" Text="지부" Top="56" VAlign="Middle" Width="76"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="87" OnChanged="cbxJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="20" Top="55" UserData="I" Width="106"></Combo>
		<Static Align="Center" Height="20" Id="lbRegion" Left="8" Style="sty_Label" TabOrder="19" Text="지역" Top="80" VAlign="Middle" Width="76"></Static>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radRegion" INDEX="0" InnerDataset="ds_ioChoiceYn" Left="88" LeftMargin="4" OnChanged="radRegion_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="17" Top="80" UserData="S" Width="108"></Radio>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxRegion1" INDEX="0" InnerDataset="ds_oRegion" Left="199" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="18" Top="79" UserData="S" Value="B" Width="125"></Combo>
		<Static Align="Center" Height="20" Id="lbText" Left="324" Style="sty_Text" TabOrder="15" Text="~" Top="80" VAlign="Middle" Width="20"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxRegion2" INDEX="0" InnerDataset="ds_oRegion" Left="343" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="16" Top="79" UserData="S" Value="B" Width="125"></Combo>
		<Static Align="Center" Height="20" Id="lbCourse" Left="8" Style="sty_Label" TabOrder="22" Text="직능" Top="104" VAlign="Middle" Width="76"></Static>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radCourse" INDEX="0" InnerDataset="ds_ioCourseYn" Left="88" LeftMargin="4" OnChanged="radCourse_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="24" Top="104" UserData="S" Width="348"></Radio>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse" INDEX="0" InnerDataset="ds_ioCourse" Left="212" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="23" Top="103" UserData="S" Width="121"></Combo>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse1" INDEX="0" InnerDataset="ds_ioCourse" Left="87" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="30" Top="127" UserData="S" Width="122"></Combo>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse2" INDEX="0" InnerDataset="ds_ioCourse" Left="211" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="25" Top="127" UserData="S" Width="122"></Combo>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse4" INDEX="0" InnerDataset="ds_ioCourse" Left="87" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="27" Top="151" UserData="S" Width="122"></Combo>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse5" INDEX="0" InnerDataset="ds_ioCourse" Left="211" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="28" Top="151" UserData="S" Width="122"></Combo>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse6" INDEX="0" InnerDataset="ds_ioCourse" Left="335" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="29" Top="151" UserData="S" Width="122"></Combo>
		<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxCourse3" INDEX="0" InnerDataset="ds_ioCourse" Left="335" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="26" Top="127" UserData="S" Width="122"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="504" OnClick="lfn_Search" Style="sty_Button" TabOrder="31" ToolTipText="조회" Top="52" Visible="FALSE" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSumList" ImageID="BTN_TEXT_05" Left="159" OnClick="lfn_PrintState" Style="sty_Button" TabOrder="32" Text="현황출력" ToolTipText="현황출력" Top="4" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnList" ImageID="BTN_TEXT_05" Left="240" OnClick="lfn_PrintList" Style="sty_Button" TabOrder="33" Text="리스트출력" ToolTipText="리스트출력" Top="4" Width="80"></Button>
		<Static Color="user6" Height="28" Id="lbText01" Left="208" Style="sty_TextBlue" TabOrder="36" Text="※리스트출력은&#32;최대&#32;10000건으로&#32;제한됩니다.&#10;&#32;&#32;&#32;상세한조건으로&#32;출력바랍니다." Top="48" VAlign="Middle" Width="288"></Static>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust0015PSobangInfo.xml
 * 설명 : 소방본부 연계 현황
 * 작성일 : 2009.12.26
 * 작성자 : 이규희
 */

#include "LIB::cust.js"; // 공통업무 관련

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 공통 코드 조회    
    gfn_SearchJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회
	gfn_SearchCustomerCourseFullName(ds_ioCourse, "0", "선택");	// 대표고객직능 조회
	radCourse.Value = "";
	
	//콤보박스-지역
	cbxJibu_OnChanged("",cbxJibu.Value);//지역 코드 조회
    cbxRegion1.Index = 0;
    cbxRegion2.index = ds_oRegion.rowcount-1;
	
    cbxCourse.index=0;
	cbxCourse1.index=0;      
	cbxCourse2.index=0;
	cbxCourse3.index=0;
	cbxCourse4.index=0;
	cbxCourse5.index=0;
	cbxCourse6.index=0; 
}

function Form_OnUnloadCompleted(obj) {
    Close();
}

/*
 * 기능 : 종료
 */
function lfn_End(obj) {
    Close();
}

/*
*콤보박스 변경 이벤트 시작
*/
//지부
function cbxJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
//    ds_oRegion.ClearData();
	gfn_SearchCodeRegion(strCode, ds_oRegion, "0");	//지역 코드 조회
    cbxRegion1.Index = 0;
    cbxRegion2.index = ds_oRegion.rowcount-1;
}

//지역--라디오 버튼 선택시
function radRegion_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    if (radRegion.Value == "1") { // 선택 
        cbxRegion1.Enable =  true;
        cbxRegion2.Enable =  true;                       
        cbxRegion1.SetFocus();
        cbxRegion1.Index = 0;
        cbxRegion2.index = ds_oRegion.rowcount-1;    
	} else {              // 전체
        cbxRegion1.Enable =  false;
        cbxRegion2.Enable =  false;                
        cbxRegion1.Index = 0;
        cbxRegion2.index = ds_oRegion.rowcount-1;    
	}
}

// 직능
function radCourse_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == 1) {          //선택
        cbxCourse.SetFocus();
        cbxCourse.Enable = true;
        cbxCourse1.Enable = false;
        cbxCourse2.Enable = false;
        cbxCourse3.Enable = false;
        cbxCourse4.Enable = false;
        cbxCourse5.Enable = false;
        cbxCourse6.Enable = false;        
        cbxCourse.index=0;
        cbxCourse1.index=0;
        cbxCourse2.index=0;
        cbxCourse3.index=0;
        cbxCourse4.index=0;
        cbxCourse5.index=0;
        cbxCourse6.index=0;
	} else if(strCode == 2){     //다중선택
        cbxCourse1.SetFocus();
        cbxCourse.Enable = false;
        cbxCourse1.Enable = true;
        cbxCourse2.Enable = true;
        cbxCourse3.Enable = true;
        cbxCourse4.Enable = true;
        cbxCourse5.Enable = true;
        cbxCourse6.Enable = true;        
        cbxCourse.index=0;
        cbxCourse1.index=0;
        cbxCourse2.index=0;
        cbxCourse3.index=0;
        cbxCourse4.index=0;
        cbxCourse5.index=0;
        cbxCourse6.index=0;
	} else {                    //전체
        cbxCourse.Enable = false;
        cbxCourse1.Enable = false;
        cbxCourse2.Enable = false;
        cbxCourse3.Enable = false;
        cbxCourse4.Enable = false;
        cbxCourse5.Enable = false;
        cbxCourse6.Enable = false;
        cbxCourse.index=0;
        cbxCourse1.index=0;
        cbxCourse2.index=0;
        cbxCourse3.index=0;
        cbxCourse4.index=0;
        cbxCourse5.index=0;
        cbxCourse6.index=0;
	}
}

/*
 * 기능 : 현황 출력
 */
function lfn_PrintState(obj) {       
    // 조회이력을 저장한다.  
    ls_HistoryArg = "지부=" + quote(cbxJibu.Text)
                + ",지역=" + quote(cbxRegion1.Text) + "~" + quote(cbxRegion2.Text);
    gfn_InsertSearchPrintHistory(
        "S"
        , this.ID
        , global.mnuLeft.cbxOpenForm.Text
        , ls_HistoryArg
    );
    
    // 직능 다중선택
    var COURSECD = "";
    if (radCourse.Value == 2) {
        for ( var i=1; i < 7; i++ ) {
            if (!gfn_IsNull(object("cbxCourse" + toString(i)).Value)) {
                COURSECD += left(object("cbxCourse" + toString(i)).Value, 1) + ",";
            }
        }        
    }    
    COURSECD = left(COURSECD, length(COURSECD)-1);
    
    ds_oList.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust0015SobangState", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oState=ds_oState"	// outDs
		,"CGTMGNO=" + quote(cbxJibu.Value)
          + " CREGCD1=" + quote(cbxRegion1.Value)
          + " CREGCD2=" + quote(cbxRegion2.Value)
          + " CCOURSECD=" + quote(left(cbxCourse.Value, 1))          
          + " REGIONGUBUN=" + quote(radRegion.Value)
          + " COURSEGUBUN=" + quote(radCourse.Value)
          + " DELGUBUN=" + quote(radMemberGubun.Value)
          + " GUBUN=" + quote(radYn.Value)
          + " CCOURSECDSELECT=" + quote(COURSECD)// args 
		,"lfn_AfterSearchManagerState"
		,false
	);
}

/*
 * 기능 : 리스트 출력
 */
function lfn_PrintList(obj) {       
    lfn_SearchList();
    gfn_CallReportPopup("frmcust0015R02SobangInfoList.rex"
                       , "ds_oList"
                       , ""
    );
}

/*
 * 기능 : 리스트 엑셀 다운로드
 */
function lfn_ToExcel(obj)
{
	lfn_SearchList();
    if (ds_oList.GetRowCount() < 1) {
        gfn_Alert("출력할 데이터가 존재하지 않습니다.");
        return false;
    }
	lfn_Excel(obj);
}

/*
 * 기능 : 리스트 출력
 */
function lfn_SearchList() {       
    // 조회이력을 저장한다.  
    ls_HistoryArg = "지부=" + quote(cbxJibu.Text)
                + ",지역=" + quote(cbxRegion1.Text) + "~" + quote(cbxRegion2.Text);
    gfn_InsertSearchPrintHistory(
        "S"
        , this.ID
        , global.mnuLeft.cbxOpenForm.Text
        , ls_HistoryArg
    );
    
    // 직능 다중선택
    var COURSECD = "";
    if (radCourse.Value == 2) {
        for ( var i=1; i < 7; i++ ) {
            if (!gfn_IsNull(object("cbxCourse" + toString(i)).Value)) {
                COURSECD += left(object("cbxCourse" + toString(i)).Value, 1) + ",";
            }
        }        
    }    
    COURSECD = left(COURSECD, length(COURSECD)-1);
    
    ds_oList.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust0015SobangInfo", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oList=ds_oList"	// outDs
		,"CGTMGNO=" + quote(cbxJibu.Value)
          + " CREGCD1=" + quote(cbxRegion1.Value)
          + " CREGCD2=" + quote(cbxRegion2.Value)
          + " CCOURSECD=" + quote(left(cbxCourse.Value, 1))          
          + " REGIONGUBUN=" + quote(radRegion.Value)
          + " COURSEGUBUN=" + quote(radCourse.Value)
          + " DELGUBUN=" + quote(radMemberGubun.Value)
          + " GUBUN=" + quote(radYn.Value)
          + " ORDER=" + quote(radOrder.Value)
          + " CCOURSECDSELECT=" + quote(COURSECD)// args 
		,""
		,false
		,""
		,true
	);
}

/* 공통 필수 종료 */

/* 사용자 함수 */
/*
 * 기능 : 교육일정관리 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchManagerList(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
}

function lfn_AfterSearchManagerState(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    gfn_CallReportPopup("frmcust0015R01SobangInfoState.rex"
                       , "ds_oState"
                       , ""
    );
}
]]></Script>
</Window>
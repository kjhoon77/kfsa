<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="768" Id="frmcust6100MDataConnectionDangerManage" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="위험물안전관리자&#32;일치화관리(frmcust6100MDataConnectionDangerManage)" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1048" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireCd">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireCenterCd">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="UPCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireHead">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMNFCTRETCGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioSelectGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>일치완료</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>미처리</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>연계제외</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObj">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioKFFireObj">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFKeyfield">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>대상물명</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>주소(번지)</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>전화번호</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>허가번호</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRegion">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="GTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioCourseD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioFireManagerInfo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFire">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioPBLINSTT">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>Y</CD>
						<DATA>Y</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>N</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObjD">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMNFCTRETCGubunD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioObjGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>P02090100</CD>
						<DATA>1급대상</DATA>
					</record>
					<record>
						<CD>P02090200</CD>
						<DATA>2급대상</DATA>
					</record>
					<record>
						<CD>P02090300</CD>
						<DATA>일반</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>그외</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioDangerInfo">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObj2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioKFFireObj2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioFireManagerInfo2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObjD2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioDangerInfo2">
				<Contents>
					<colinfo id="DBMGNO" size="22" type="DECIMAL"/>
					<colinfo id="DGATEWAYDAN" size="18" type="STRING"/>
					<colinfo id="DPERMISSIONNO" size="20" type="STRING"/>
					<colinfo id="DREMARK" size="200" type="STRING"/>
					<colinfo id="DSEQ" size="22" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>기존&#32;대상&#32;일치화</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>신규&#32;대상&#32;연계</DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="28" Height="28" Id="shpBtnBox" Left="761" LineColor="user14" Right="1045" TabOrder="3" Top="0" Type="Rectangle" Width="284"></Shape>
		<Tab BKSelColor="lightskyblue" Height="744" Id="tab" OnChanged="tab_OnChanged" TabOrder="4" Top="24" Width="1048">
			<Contents>
				<TabPage BorderColor="black" Height="720" Id="page1" Left="2" TabOrder="121" Text="&#32;청기준&#32;" Top="22" Width="1044">
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchCancel" ImageID="BTN_연계제외취소" Left="868" OnClick="lfn_KFMatchExceptCancel" Style="sty_Button" TabOrder="109" Top="160" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchCancel" ImageID="BTN_연계제외취소" Left="345" OnClick="lfn_MFMatchExceptCancel" Style="sty_Button" TabOrder="108" Top="160" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExcept" ImageID="BTN_연계제외처리" Left="345" OnClick="lfn_MFMatchExcept" Style="sty_Button" TabOrder="23" Top="160" Visible="FALSE" Width="98"></Button>
					<Shape Bottom="157" Height="138" Id="Shape1" Left="523" LineColor="user1" Right="1042" TabOrder="10" Top="19" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="718" Height="60" Id="Shape3" Left="523" LineColor="user1" Right="1042" TabOrder="89" Top="658" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="642" Height="230" Id="Shape2" Left="523" LineColor="user1" Right="1042" TabOrder="44" Top="412" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="612" Height="206" Id="Shape4" Left="0" LineColor="user1" Right="519" TabOrder="42" Top="406" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="157" Height="138" Id="Shape0" Left="0" LineColor="user1" Right="519" TabOrder="4" Top="19" Type="Rectangle" Width="519"></Shape>
					<Static Align="Center" BKColor="user36" Height="20" Id="lbJubsu" Left="117" Style="sty_LabelGruopBox" TabOrder="5" Text="소방청(소방민원정보시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFHead" ImeMode="none" INDEX="0" InnerDataset="ds_oFireHead" Left="97" OnChanged="cbxMFHead_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="1" Top="48" UserData="S" Value="B" Width="122"></Combo>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFStation" INDEX="0" InnerDataset="ds_oFireCd" Left="222" OnChanged="cbxMFStation_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="2" Top="49" UserData="S" Width="134"></Combo>
					<Static Align="Center" Height="20" Id="Static3" Left="4" Style="sty_Label" TabOrder="6" Text="소방관서" Top="49" VAlign="Middle" Width="90"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="21" Id="medMFModDate1" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="8" Top="90" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" Height="20" Id="Static12" Left="217" Style="sty_Text" TabOrder="7" Text="~" Top="91" VAlign="Middle" Width="20"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate2" Left="236" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="9" Top="91" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static5" Left="640" Style="sty_LabelGruopBox" TabOrder="11" Text="안전원(교육종합관리시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Static Align="Center" Height="20" Id="Static6" Left="4" Style="sty_Label" TabOrder="12" Text="제조소구분" Top="70" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="lbMFDate" Left="4" Style="sty_Label" TabOrder="13" Text="안전원수신일자" Top="91" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static8" Left="4" Style="sty_Label" TabOrder="14" Text="검색조건" Top="112" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static9" Left="4" Style="sty_Label" TabOrder="15" Text="검색어" Top="133" VAlign="Middle" Width="90"></Static>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFCenter" INDEX="0" InnerDataset="ds_oFireCenterCd" Left="358" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="3" Top="48" UserData="S" Width="157"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFMnfctretcGubun" INDEX="0" InnerDataset="ds_ioMNFCTRETCGubun" Left="97" OnChanged="tab_page1_cbxMFMnfctretcGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="16" Top="69" UserData="S" Value="B" Width="122"></Combo>
					<Static Align="Center" Height="20" Id="Static10" Left="359" Style="sty_Label" TabOrder="17" Text="조회건수" Top="91" VAlign="Middle" Width="59"></Static>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radMFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun" Left="98" OnChanged="tab_page1_radMFSelectGubun_OnChanged" TabOrder="18" Top="112" Width="417"></Radio>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edMFKeyword" ImeMode="native" Left="166" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page1_edMFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="19" Top="133" UserData="S:구주소2" Width="176"></Edit>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="97" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="20" Top="132" UserData="S" Value="B" Width="69"></Combo>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFSearch" ImageID="청자료조회" Left="429" OnClick="lfn_MFSearch" Style="sty_Button" TabOrder="21" ToolTipText="조회" Top="133" Width="85"></Button>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioKFFireObj" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="298" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="117" Id="gdKFOBJList" InputPanel="FALSE" Left="523" LineColor="default" OnCellClick="tab_page1_gdKFOBJList_OnCellClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="1042" RowHeight="20" Style="sty_Grid" TabOrder="22" TabStop="true" Top="181" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="50"/>
									<col width="36"/>
									<col width="93"/>
									<col width="62"/>
									<col width="67"/>
									<col width="80"/>
									<col width="51"/>
									<col width="46"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="매칭율"/>
									<cell bkcolor="user7" col="2" display="text" text="연계"/>
									<cell bkcolor="user7" col="3" display="text" text="대상물명"/>
									<cell bkcolor="user7" col="4" display="text" text="직능"/>
									<cell bkcolor="user7" col="5" display="text" text="선임자"/>
									<cell bkcolor="user7" col="6" display="text" text="동명"/>
									<cell bkcolor="user7" col="7" display="text" text="주번지"/>
									<cell bkcolor="user7" col="8" display="text" text="부번지"/>
									<cell bkcolor="user7" col="9" display="text" text="주소"/>
									<cell bkcolor="user7" col="10" display="text" text="지역"/>
									<cell bkcolor="user7" col="11" display="text" text="선임일자"/>
									<cell bkcolor="user7" col="12" display="text" text="고객번호"/>
									<cell align="center" bkcolor="user7" col="13" display="text" text="삭제여부"/>
								</head>
								<body>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="0" display="text" expr="currow&#32;+&#32;1" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)' text="0"/>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="1" colid="TOTSUM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="2" display="text" expr="DECODE(RFLAGEE,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,RFLAGEE+&apos;건&apos;)" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="3" colid="BNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="4" colid="CNICKNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="5" colid="FMNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="6" colid="BADDRDONGNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="7" colid="BADDRMAINNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="8" colid="BADDRSUBNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="9" colid="ADDR" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="10" colid="RCNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="11" colid="FMHSTARTDATE" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="12" colid="CNO" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="13" colid="DELGUBUN" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchExcept" ImageID="BTN_연계제외처리" Left="852" OnClick="lfn_KFMatchExcept" Style="sty_Button" TabOrder="24" Top="160" Visible="FALSE" Width="98"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnKFExcel" ImageID="엑셀" Left="967" OnClick="tab_page1_btnKFExcel_OnClick" Style="sty_Button" TabOrder="26" Top="160" Transparent="TRUE" Width="74"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFExcel" ImageID="엑셀" Left="444" OnClick="tab_page1_btnMFExcel_OnClick" Style="sty_Button" TabOrder="25" Top="160" Transparent="TRUE" Width="74"></Button>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static0" Left="527" Style="sty_Label" TabOrder="27" Text="지부명" Top="27" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static1" Left="527" Style="sty_Label" TabOrder="28" Text="세부직능" Top="69" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static2" Left="527" Style="sty_Label" TabOrder="29" Text="검색조건" Top="90" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static4" Left="527" Style="sty_Label" TabOrder="30" Text="검색어" Top="111" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static13" Left="527" Style="sty_Label" TabOrder="31" Text="지역" Top="48" VAlign="Middle" Width="90"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFJibu" INDEX="0" InnerDataset="ds_ioJibu" Left="621" OnChanged="tab_page1_cbxKFJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="32" Top="26" UserData="S" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion1" INDEX="0" InnerDataset="ds_oRegion" Left="621" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="33" Top="47" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion2" INDEX="0" InnerDataset="ds_oRegion" Left="764" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="34" Top="47" Value="B" Width="122"></Combo>
					<Static Align="Center" Height="20" Id="Static14" Left="744" Style="sty_Text" TabOrder="35" Text="~" Top="48" VAlign="Middle" Width="20"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="20" Id="cbxKFCourseD" INDEX="0" InnerDataset="ds_ioCourseD" Left="621" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="36" Top="68" UserData="S" Width="122"></Combo>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radKFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun" Left="622" TabOrder="38" Top="90" Width="415"></Radio>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static11" Left="890" Style="sty_Label" TabOrder="37" Text="조회건수" Top="68" VAlign="Middle" Width="56"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="621" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="40" Top="110" UserData="S" Value="B" Width="106"></Combo>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edKFKeyword" ImeMode="native" Left="727" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page1_edKFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="39" Top="111" UserData="S:구주소2" Width="219"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnKFSearch" ImageID="BTN_TEXT_06" Left="948" OnClick="tab_page1_btnKFSearch_OnClick" Style="sty_Button" TabOrder="41" Text="안전원자료조회" ToolTipText="조회" Top="110" Width="92"></Button>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static15" Left="4" Style="sty_LabelGruopBox" TabOrder="43" Text="제조소등&#32;정보" Top="398" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static16" Left="527" Style="sty_LabelGruopBox" TabOrder="45" Text="고객&#32;정보" Top="403" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" Height="20" Id="Static17" Left="4" Style="sty_Label" TabOrder="46" Text="대상물명" Top="420" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static18" Left="4" Style="sty_Label" TabOrder="47" Text="설치장소" Top="441" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="43" Id="Static19" Left="4" Style="sty_Label" TabOrder="48" Text="매칭주소" Top="462" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static20" Left="4" Style="sty_Label" TabOrder="49" Text="소방관서" Top="506" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static21" Left="4" Style="sty_Label" TabOrder="50" Text="제조소등구분" Top="527" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static23" Left="263" Style="sty_Label" TabOrder="51" Text="완공일자" Top="569" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="OBJ_NM" DisableBKColor="user0" Height="20" Id="edMFOBJ_NM" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="52" Top="420" Width="204"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="ADDR" DisableBKColor="user0" Height="20" Id="edMFADDR" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="53" Top="441" Width="421"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="COMPET_DE" DisableBKColor="user0" Height="20" Id="edMFCOMPET_DE" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="54" Top="569" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="CMPN119SC_ID" DisableBKColor="user0" Height="20" Id="edMFCMPN119SC_ID" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="55" Top="506" Width="421"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="MNFCTRETCNM" DisableBKColor="user0" Height="20" Id="edMFMNFCTRETCNM" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="56" Top="527" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static31" Left="263" Style="sty_Label" TabOrder="57" Text="제조소등상세구분" Top="527" VAlign="Middle" Width="111"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="MNFCTRETCDETAILNM" DisableBKColor="user0" Height="20" Id="edMFMNFCTRETCDETAILNM" ImeMode="native" Left="375" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="58" Top="527" UserData="S:구주소2" Width="141"></Edit>
					<Static Align="Center" Height="20" Id="Static32" Left="4" Style="sty_Label" TabOrder="59" Text="전화번호" Top="569" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="INSTLR_TELNO" DisableBKColor="user0" Height="20" Id="edMFINSTLR_TELNO" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="60" Top="569" Width="167"></Edit>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static24" Left="4" Style="sty_LabelGruopBox" TabOrder="61" Text="선임자&#32;정보" Top="614" VAlign="Middle" Width="125"></Static>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioFireManagerInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="719" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="83" Id="gdMFManager" InputPanel="FALSE" Left="4" LineColor="default" OnCellClick="tab_page1_gdMFManager_OnCellClick" OnCellDBLClick="tab_page1_gdMFManager_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="517" RowHeight="20" Style="sty_Grid" TabOrder="62" TabStop="true" Top="636" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="513">
						<contents>
							<format id="Default">
								<columns>
									<col width="39"/>
									<col width="39"/>
									<col width="100"/>
									<col width="106"/>
									<col width="100"/>
									<col width="100"/>
									<col width="200"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="연계"/>
									<cell bkcolor="user7" col="2" display="text" text="선임자명"/>
									<cell bkcolor="user7" col="3" display="text" text="생년월일"/>
									<cell bkcolor="user7" col="4" display="text" text="선임일자"/>
									<cell bkcolor="user7" col="5" display="text" text="해임일자"/>
									<cell bkcolor="user7" col="6" display="text" text="주소"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" display="text" expr="DECODE(DMSTATUS,&apos;1&apos;,&apos;○&apos;,&apos;0&apos;,&apos;X&apos;,&apos;-1&apos;,&apos;제외&apos;)"/>
									<cell align="center" col="2" colid="NM" display="text"/>
									<cell align="center" col="3" colid="BIRTHDAY" display="text"/>
									<cell align="center" col="4" colid="DMINDATE" display="text"/>
									<cell align="center" col="5" colid="DMOUTDATE" display="text"/>
									<cell align="left" col="6" colid="ADDR" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static25" Left="527" Style="sty_Label" TabOrder="63" Text="대상물명" Top="426" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static26" Left="527" Style="sty_Label" TabOrder="69" Text="안전원등록년월" Top="594" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static27" Left="527" Style="sty_Label" TabOrder="68" Text="전화번호" Top="573" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static28" Left="527" Style="sty_Label" TabOrder="67" Text="직능" Top="531" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static29" Left="527" Style="sty_Label" TabOrder="66" Text="지역" Top="510" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="41" Id="Static30" Left="527" Style="sty_Label" TabOrder="65" Text="매칭주소" Top="468" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static33" Left="527" Style="sty_Label" TabOrder="64" Text="주소" Top="447" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="ADDR" DisableBKColor="user0" Height="20" Id="edKFBADDR1" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="70" Top="447" Width="420"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BNM" DisableBKColor="user0" Height="20" Id="edKFBNM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="71" Top="426" Width="253"></Edit>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Enable="FALSE" Height="20" Id="edKFMatch" ImeMode="native" Left="969" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="72" Top="426" Width="71"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static34" Left="876" Style="sty_Label" TabOrder="73" Text="연계구분" Top="426" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RCNM" DisableBKColor="user0" Height="20" Id="edKFRCNM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="74" Top="510" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CCCDNM" DisableBKColor="user0" Height="20" Id="edKFCCCDNM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="75" Top="552" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CGROUPNM" DisableBKColor="user0" Height="20" Id="edKFCGROUPNM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="77" Top="531" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static35" Left="785" Style="sty_Label" TabOrder="76" Text="세부직능" Top="531" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CNM" DisableBKColor="user0" Height="20" Id="edKFCNM" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="78" Top="531" Width="161"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BTEL" DisableBKColor="user0" Height="20" Id="edKFBTEL" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="80" Top="573" Width="98"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static36" Left="905" Style="sty_Label" TabOrder="79" Text="인력구분" Top="573" VAlign="Middle" Width="76"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CPERSONGUBUN" DisableBKColor="user0" Height="20" Id="edKFCPERSONGUBUN" ImeMode="native" Left="982" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="81" Top="573" Width="58"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CAGGUBUN" DisableBKColor="user0" Height="20" Id="edKFCAGGUBUN" ImeMode="native" Left="814" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="83" Top="573" Width="90"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static37" Left="720" Style="sty_Label" TabOrder="82" Text="업무대행" Top="573" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CREGISTERYYMM" DisableBKColor="user0" Height="20" Id="edKFCREGISTERYYMM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="84" Top="594" Width="98"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CFEEYYMM" DisableBKColor="user0" Height="20" Id="edKFCFEEYYMM" ImeMode="native" Left="814" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="86" Top="594" Width="90"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static38" Left="720" Style="sty_Label" TabOrder="85" Text="회비부과월" Top="594" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="DELGUBUN" DisableBKColor="user0" Height="20" Id="edKFDELGUBUN" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="88" Top="552" Width="161"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static39" Left="785" Style="sty_Label" TabOrder="87" Text="상태" Top="552" VAlign="Middle" Width="92"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static40" Left="527" Style="sty_LabelGruopBox" TabOrder="90" Text="선임자정보" Top="648" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static41" Left="527" Style="sty_Label" TabOrder="91" Text="선임자명" Top="671" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="FMNM" DisableBKColor="user0" Height="20" Id="edKFFMNM" ImeMode="native" Left="590" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="92" Top="671" Width="95"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static43" Left="527" Style="sty_Label" TabOrder="93" Text="선임일자" Top="693" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="FMHSTARTDATE" DisableBKColor="user0" Height="20" Id="edKFFMHSTARTDATE" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="95" Top="693" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static44" Left="785" Style="sty_Label" TabOrder="94" Text="해임일자" Top="693" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="FMHENDDATE" DisableBKColor="user0" Height="20" Id="edKFFMHENDDATE" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="96" Top="693" Width="161"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFPISInfo" ImageID="BTN_TEXT_09" Left="388" OnClick="tab_page1_btnFPISInfo_OnClick" Style="sty_Button" TabOrder="97" Text="청시스템상세보기" Top="396" Transparent="TRUE" Width="132"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnKFSunapEduInfo" ImageID="BTN_TEXT_09" Left="911" OnClick="lfn_SunapEduInfo" Style="sty_Button" TabOrder="98" Text="회비/교육정보" Top="401" Transparent="TRUE" Width="132"></Button>
					<Checkbox Height="12" Id="chkMFPerson" Left="343" Style="sty_Checkbox" TabOrder="99" Text="문자열포함" Top="138" TrueValue="1" Value="FALSE" Width="84"></Checkbox>
					<Checkbox Height="12" Id="chkKFPerson" Left="853" Style="sty_Checkbox" TabOrder="100" Text="문자열&#32;포함" Top="132" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edMFCount" ImeMode="native" Left="55" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="101" Text="0" Top="160" UserData="S:구주소2" Width="41"></Edit>
					<Static Align="Center" Height="20" Id="Static45" Left="-2" Style="sty_LabelStat" TabOrder="102" Text="총건수" Top="160" VAlign="Middle" Width="56"></Static>
					<Static Align="Center" Height="20" Id="Static46" Left="523" Style="sty_LabelStat" TabOrder="104" Text="총건수" Top="160" VAlign="Middle" Width="56"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edKFCount" ImeMode="native" Left="580" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="103" Text="0" Top="160" UserData="S:구주소2" Width="41"></Edit>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatch" ImageID="BTN_TEXT_08" Left="738" OnClick="lfn_NowMatch" TabOrder="105" Text="수정없이연계처리" Top="377" Transparent="TRUE" Width="119"></Button>
					<Button ButtonStyle="TRUE" Height="22" Id="btnNewMatch" ImageID="BTN_TEXT_06" Left="857" OnClick="btnNewMatch_OnClick" TabOrder="106" Text="신규연계등록" Top="377" Transparent="TRUE" Width="92"></Button>
					<Button ButtonStyle="TRUE" Height="22" Id="btnModMatch" ImageID="BTN_TEXT_06" Left="950" OnClick="btnModMatch_OnClick" TabOrder="107" Text="수정연계처리" Top="377" Transparent="TRUE" Width="92"></Button>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="INSTLR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_NM" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="110" Top="548" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static47" Left="236" Style="sty_Label" TabOrder="111" Text="제조소상세구분" Top="70" VAlign="Middle" Width="119"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFMnfctretcGubunD" INDEX="0" InnerDataset="ds_ioMNFCTRETCGubunD" Left="358" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="112" Top="69" UserData="S" Value="B" Width="157"></Combo>
					<Static Align="Center" Height="20" Id="Static48" Left="263" Style="sty_Label" TabOrder="113" Text="설치자명" Top="548" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static52" Left="301" Style="sty_Label" TabOrder="115" Text="허가번호" Top="420" VAlign="Middle" Width="58"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="PRMISN_NO" DisableBKColor="user0" Height="20" Id="edMFPRMISN_NO" ImeMode="native" Left="360" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="114" Top="420" Width="60"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static56" Left="527" Style="sty_Label" TabOrder="116" Text="용도" Top="552" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static57" Left="4" Style="sty_Label" TabOrder="117" Text="최초등록일" Top="590" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="REGIST_DE_14" DisableBKColor="user0" Height="20" Id="Edit0" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="118" Top="590" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static58" Left="263" Style="sty_Label" TabOrder="119" Text="최종수정일" Top="590" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="UPDT_DE_14" DisableBKColor="user0" Height="20" Id="Edit1" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="120" Top="590" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static59" Left="905" Style="sty_Label" TabOrder="121" Text="고객번호" Top="594" VAlign="Middle" Width="76"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CNO" DisableBKColor="user0" Height="20" Id="Edit2" ImeMode="native" Left="982" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="122" Top="594" Width="58"></Edit>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatchCancel" ImageID="BTN_TEXT_06" Left="645" OnClick="lfn_CancelMatch" TabOrder="123" Text="연계해지처리" Top="377" Transparent="TRUE" Width="92"></Button>
					<Checkbox Height="12" Id="chkKFDelUser" Left="759" Style="sty_Checkbox" TabOrder="124" Text="삭제자포함" Top="132" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Static Height="20" Id="Static60" Left="1" TabOrder="125" Text="※&#32;대상물&#32;또는&#32;선임자&#32;정보를&#32;더블클릭&#32;시&#32;우측&#32;안전원자료&#32;자동조회" Top="378" VAlign="Middle" Width="514"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static61" Left="785" Style="sty_Label" TabOrder="126" Text="회원구분" Top="510" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CSTATUSGUBUN" DisableBKColor="user0" Height="20" Id="edKFCSTATUSGUBUN" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="127" Top="510" Width="161"></Edit>
					<Static Align="Center" Height="20" Id="Static49" Left="98" TabOrder="131" Text="동명" Top="462" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="SEARCHDONGFNM" DisableBKColor="user0" Height="20" Id="edMFFDong" ImeMode="native" Left="132" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="128" Top="462" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="SEARCHDONGNM" DisableBKColor="user0" Height="20" Id="edMFDong" ImeMode="native" Left="229" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="134" Top="462" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static50" Left="322" TabOrder="132" Text="주번지" Top="462" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="SEARCHMAINADDR" DisableBKColor="user0" Height="20" Id="edMFMainAddr" ImeMode="native" Left="366" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="129" Top="462" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static51" Left="420" TabOrder="133" Text="부번지" Top="462" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="SEARCHSUBADDR" DisableBKColor="user0" Height="20" Id="edMFSubAddr" ImeMode="native" Left="463" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="130" Top="462" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static62" Left="4" Style="sty_Label" TabOrder="136" Text="설치법인명" Top="548" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="INSTLR_CPR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_CPR_NM" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="135" Top="548" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static53" Left="622" TabOrder="140" Text="동명" Top="468" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BADDRDONGFNM" DisableBKColor="user0" Height="20" Id="edKFFDong" ImeMode="native" Left="656" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="137" Top="468" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BADDRDONGNM" DisableBKColor="user0" Height="20" Id="edKFDong" ImeMode="native" Left="752" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="143" Top="468" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static54" Left="846" TabOrder="141" Text="주번지" Top="468" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BADDRMAINNM" DisableBKColor="user0" Height="20" Id="edKFMainAddr" ImeMode="native" Left="890" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="138" Top="468" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static55" Left="941" TabOrder="142" Text="부번지" Top="468" VAlign="Middle" Width="46"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BADDRSUBNM" DisableBKColor="user0" Height="20" Id="edKFSubAddr" ImeMode="native" Left="987" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="139" Top="468" Width="53"></Edit>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ioDangerInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="376" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="77" Id="gdDangerInfo" InputPanel="FALSE" Left="523" LineColor="default" MinWidth="100" Right="1042" Style="sty_Grid" TabOrder="144" TabStop="true" Top="299" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="97"/>
									<col width="182"/>
								</columns>
								<head>
									<cell col="0" display="text" text="허가번호"/>
									<cell col="1" display="text" text="기타사항"/>
								</head>
								<body>
									<cell col="0" colid="DPERMISSIONNO" display="text"/>
									<cell col="1" colid="DREMARK" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Height="22" Id="btnDanger" ImageID="BTN_TEXT_06" Left="552" OnClick="lfn_NowMatch" TabOrder="145" Text="허가번호&#32;추가" Top="377" Transparent="TRUE" Width="92"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExceptCancelM" ImageID="BTN_연계제외취소" Left="418" OnClick="lfn_MFMatchExceptCancelM" Style="sty_Button" TabOrder="146" Top="614" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExceptM" ImageID="BTN_연계제외처리" Left="418" OnClick="lfn_MFMatchExceptM" Style="sty_Button" TabOrder="147" Top="614" Visible="FALSE" Width="98"></Button>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioMFFireObj" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="377" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="196" Id="gdMFOBJList" InputPanel="FALSE" Left="1" LineColor="default" OnCellClick="tab_page1_gdMFOBJList_OnCellClick" OnCellDBLClick="tab_page1_gdMFOBJList_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="520" RowHeight="20" Style="sty_Grid" TabOrder="148" TabStop="true" Top="181" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="45"/>
									<col width="37"/>
									<col width="145"/>
									<col width="60"/>
									<col width="80"/>
									<col width="80"/>
									<col width="40"/>
									<col width="40"/>
									<col width="151"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="연계"/>
									<cell bkcolor="user7" col="2" display="text" text="상태"/>
									<cell bkcolor="user7" col="3" display="text" text="대상물명"/>
									<cell bkcolor="user7" col="4" display="text" text="허가번호"/>
									<cell bkcolor="user7" col="5" display="text" text="대상구분"/>
									<cell bkcolor="user7" col="6" display="text" text="동주소"/>
									<cell bkcolor="user7" col="7" display="text" text="주번지"/>
									<cell bkcolor="user7" col="8" display="text" text="부번지"/>
									<cell bkcolor="user7" col="9" display="text" text="주소"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" display="text" expr="DECODE(MSTATUS,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,&apos;○&#32;(&apos;+MANAGERMATCHCNT&#32;+&#32;&apos;/&apos;&#32;+&#32;MANAGERCNT+&apos;)&apos;)"/>
									<cell align="center" col="2" colid="DELETE_AT" display="text"/>
									<cell align="left" col="3" colid="OBJ_NM2" display="text"/>
									<cell align="left" col="4" colid="PRMISN_NO" display="text"/>
									<cell align="left" col="5" colid="MNFCTRETCNM" display="text"/>
									<cell align="left" col="6" colid="SEARCHDONGFNM" display="text"/>
									<cell align="left" col="7" colid="SEARCHMAINADDR" display="text"/>
									<cell align="left" col="8" colid="SEARCHSUBADDR" display="text"/>
									<cell align="left" col="9" colid="ADDR" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" Height="20" Id="Static63" Left="421" Style="sty_Label" TabOrder="150" Text="연계구분" Top="420" VAlign="Middle" Width="57"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Height="20" Id="edMFMatch" ImeMode="native" Left="479" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="149" Top="420" Width="37"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static22" Left="527" Style="sty_Label" TabOrder="154" Text="최초등록일" Top="615" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CREGDATE" DisableBKColor="user0" Height="20" Id="edCREGDATE" ImeMode="native" Left="620" LeftMargin="2" OnChanged="tab_page1_Edit3_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="151" Top="615" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static64" Left="785" Style="sty_Label" TabOrder="152" Text="최종수정일" Top="615" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CMODDATE" DisableBKColor="user0" Height="20" Id="edCMODDATE" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="153" Top="615" Width="161"></Edit>
					<Static Align="Center" Height="20" Id="Static65" Left="4" Style="sty_Label" TabOrder="155" Text="처리구분" Top="27" VAlign="Middle" Width="90"></Static>
					<Radio CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radMFGubun" INDEX="0" InnerDataset="ds_ioGubun" Left="98" OnChanged="tab_page1_radMFGubun_OnChanged" TabOrder="156" Top="28" Width="292"></Radio>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spMFRowNum" Left="419" Max="1000000" TabOrder="157" Text="500" Top="91" Width="94"></Spin>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spKFRowNum" Left="948" Max="1000000" TabOrder="158" Text="500" Top="67" Width="89"></Spin>
					<Static Align="Center" Height="20" Id="Static7" Left="95" TabOrder="159" Text="도로명" Top="483" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="ROAD_NM" DisableBKColor="user0" Height="20" Id="edMFRoadNM" ImeMode="native" Left="132" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="160" Top="484" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static66" Left="336" TabOrder="161" Text="건물번호" Top="484" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="MAIN_BDNBR" DisableBKColor="user0" Height="20" Id="edMFMainNO" ImeMode="native" Left="396" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="162" Top="484" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static67" Left="448" TabOrder="164" Text="-" Top="484" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="SEC_BDNBR" DisableBKColor="user0" Height="20" Id="edMFSubNO" ImeMode="native" Left="463" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="163" Top="484" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static68" Left="619" TabOrder="165" Text="도로명" Top="488" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RROADNM" DisableBKColor="user0" Height="20" Id="edKFRoadNM" ImeMode="native" Left="656" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="166" Top="489" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static69" Left="860" TabOrder="167" Text="건물번호" Top="489" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RBUILDMAINNO" DisableBKColor="user0" Height="20" Id="edKFMainNO" ImeMode="native" Left="920" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="168" Top="489" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static70" Left="973" TabOrder="170" Text="-" Top="489" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RBUILDSUBNO" DisableBKColor="user0" Height="20" Id="edKFSubNO" ImeMode="native" Left="987" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="169" Top="489" Width="53"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static42" Left="689" Style="sty_Label" TabOrder="171" Text="생년월일" Top="671" VAlign="Middle" Width="65"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="FBIRTHDAY" DisableBKColor="user0" Height="20" Id="edKFFMBIRTHDAY" ImeMode="native" Left="757" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="172" Top="671" Width="110"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static71" Left="871" Style="sty_Label" TabOrder="173" Text="개인식별번호" Top="671" VAlign="Middle" Width="80"></Static>
					<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="FMPERSONKEY" Font="굴림,10" Height="20" Id="edKFFMPersonKey" Left="954" LeftMargin="2" Mask="A####-#####" OnChanged="edKFFMPersonKey_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="174" Top="671" Type="STRING" Width="84"></MaskEdit>
				</TabPage>
				<TabPage BorderColor="black" Height="720" Id="page2" Left="2" TabOrder="2" Text="안전원기준" Top="22" Width="1044">
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExceptCancelM" ImageID="BTN_연계제외취소" Left="939" OnClick="lfn_MFMatchExceptCancelM2" Style="sty_Button" TabOrder="112" Top="616" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchCancel" ImageID="BTN_연계제외취소" Left="865" OnClick="lfn_MFMatchExceptCancel2" Style="sty_Button" TabOrder="108" Top="152" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExcept" ImageID="BTN_연계제외처리" Left="865" OnClick="lfn_MFMatchExcept2" Style="sty_Button" TabOrder="98" Top="152" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExceptM" ImageID="BTN_연계제외처리" Left="939" OnClick="lfn_MFMatchExceptM2" Style="sty_Button" TabOrder="113" Top="616" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchCancel" ImageID="BTN_연계제외취소" Left="345" OnClick="lfn_KFMatchExceptCancel2" Style="sty_Button" TabOrder="63" Top="152" Visible="FALSE" Width="98"></Button>
					<Static Height="20" Id="lbsearchNotice" Left="-1" TabOrder="111" Text="※&#32;고객정보를&#32;더블클릭&#32;시&#32;우측&#32;소방청&#32;자료&#32;자동조회" Top="369" VAlign="Middle" Width="514"></Static>
					<Shape Bottom="149" Height="138" Id="Shape1" Left="0" LineColor="user1" Right="519" TabOrder="1" Top="11" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="714" Height="62" Id="Shape3" Left="0" LineColor="user1" Right="519" TabOrder="49" Top="652" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="635" Height="230" Id="Shape2" Left="0" LineColor="user1" Right="519" TabOrder="21" Top="405" Type="Rectangle" Width="519"></Shape>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static5" Left="117" Style="sty_LabelGruopBox" TabOrder="2" Text="안전원(교육종합관리시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioKFFireObj2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="298" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="125" Id="gdKFOBJList" InputPanel="FALSE" LineColor="default" OnCellClick="tab_page2_gdKFOBJList_OnCellClick" OnCellDBLClick="tab_page2_gdKFOBJList_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="519" RowHeight="20" Style="sty_Grid" TabOrder="3" TabStop="true" Top="173" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="36"/>
									<col width="33"/>
									<col width="111"/>
									<col width="72"/>
									<col width="75"/>
									<col width="80"/>
									<col width="46"/>
									<col width="43"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="연계"/>
									<cell bkcolor="user7" col="2" display="text" text="상태"/>
									<cell bkcolor="user7" col="3" display="text" text="대상물명"/>
									<cell bkcolor="user7" col="4" display="text" text="직능"/>
									<cell bkcolor="user7" col="5" display="text" text="선임자"/>
									<cell bkcolor="user7" col="6" display="text" text="동명"/>
									<cell bkcolor="user7" col="7" display="text" text="주번지"/>
									<cell bkcolor="user7" col="8" display="text" text="부번지"/>
									<cell bkcolor="user7" col="9" display="text" text="주소"/>
									<cell bkcolor="user7" col="10" display="text" text="지역"/>
									<cell bkcolor="user7" col="11" display="text" text="선임일자"/>
									<cell bkcolor="user7" col="12" display="text" text="고객번호"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" display="text" expr="DECODE(RFLAGEE,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,RFLAGEE+&apos;건&apos;)"/>
									<cell align="left" col="2" colid="DELGUBUN" display="text"/>
									<cell align="left" col="3" colid="BNM" display="text"/>
									<cell align="left" col="4" colid="CNICKNM" display="text"/>
									<cell align="left" col="5" colid="FMNM" display="text"/>
									<cell align="left" col="6" colid="BADDRDONGNM" display="text"/>
									<cell align="left" col="7" colid="BADDRMAINNM" display="text"/>
									<cell align="left" col="8" colid="BADDRSUBNM" display="text"/>
									<cell align="left" col="9" colid="ADDR" display="text"/>
									<cell align="left" col="10" colid="RCNM" display="text"/>
									<cell align="left" col="11" colid="FMHSTARTDATE" display="text"/>
									<cell align="left" col="12" colid="CNO" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchExcept" ImageID="BTN_연계제외처리" Left="345" OnClick="lfn_KFMatchExcept2" Style="sty_Button" TabOrder="4" Top="152" Visible="FALSE" Width="98"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnKFExcel" ImageID="엑셀" Left="444" OnClick="tab_page2_btnKFExcel_OnClick" Style="sty_Button" TabOrder="5" Top="152" Transparent="TRUE" Width="74"></Button>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static0" Left="4" Style="sty_Label" TabOrder="6" Text="지부명" Top="27" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static1" Left="4" Style="sty_Label" TabOrder="7" Text="세부직능" Top="69" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static2" Left="4" Style="sty_Label" TabOrder="8" Text="검색조건" Top="90" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static4" Left="4" Style="sty_Label" TabOrder="9" Text="검색어" Top="111" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static13" Left="4" Style="sty_Label" TabOrder="10" Text="지역" Top="48" VAlign="Middle" Width="90"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFJibu" INDEX="0" InnerDataset="ds_ioJibu" Left="98" OnChanged="tab_page2_cbxKFJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="11" Top="26" UserData="S" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion1" INDEX="0" InnerDataset="ds_oRegion" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="12" Top="47" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion2" INDEX="0" InnerDataset="ds_oRegion" Left="241" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="13" Top="47" Value="B" Width="122"></Combo>
					<Static Align="Center" Height="20" Id="Static14" Left="221" Style="sty_Text" TabOrder="14" Text="~" Top="48" VAlign="Middle" Width="20"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="20" Id="cbxKFCourseD" INDEX="0" InnerDataset="ds_ioCourseD" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="15" Top="68" UserData="S" Width="122"></Combo>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radKFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun" Left="99" OnChanged="tab_page2_radKFSelectGubun_OnChanged" TabOrder="17" Top="90" Width="416"></Radio>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static11" Left="367" Style="sty_Label" TabOrder="16" Text="조회건수" Top="68" VAlign="Middle" Width="56"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="19" Top="110" UserData="S" Value="B" Width="106"></Combo>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edKFKeyword" ImeMode="native" Left="204" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page2_edKFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="18" Top="111" UserData="S:구주소2" Width="219"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnKFSearch" ImageID="BTN_TEXT_06" Left="424" OnClick="lfn_KFSearch2" Style="sty_Button" TabOrder="20" Text="안전원자료조회" ToolTipText="조회" Top="111" Width="92"></Button>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static16" Left="4" Style="sty_LabelGruopBox" TabOrder="22" Text="고객&#32;정보" Top="396" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static25" Left="4" Style="sty_Label" TabOrder="23" Text="대상물명" Top="419" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static26" Left="4" Style="sty_Label" TabOrder="29" Text="안전원등록년월" Top="590" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static27" Left="4" Style="sty_Label" TabOrder="28" Text="전화번호" Top="569" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static28" Left="4" Style="sty_Label" TabOrder="27" Text="직능" Top="527" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static29" Left="4" Style="sty_Label" TabOrder="26" Text="지역" Top="506" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="44" Id="Static30" Left="4" Style="sty_Label" TabOrder="25" Text="매칭주소" Top="461" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static33" Left="4" Style="sty_Label" TabOrder="24" Text="주소" Top="440" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="ADDR" DisableBKColor="user0" Height="20" Id="edKFBADDR1" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="30" Top="440" Width="420"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BNM" DisableBKColor="user0" Height="20" Id="edKFBNM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="31" Top="419" Width="253"></Edit>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Enable="FALSE" Height="20" Id="edKFMatch" ImeMode="native" Left="446" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="32" Top="419" Width="71"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static34" Left="353" Style="sty_Label" TabOrder="33" Text="연계구분" Top="419" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RCNM" DisableBKColor="user0" Height="20" Id="edKFRCNM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="34" Top="506" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CCCDNM" DisableBKColor="user0" Height="20" Id="edKFCCCDNM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="35" Top="548" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CGROUPNM" DisableBKColor="user0" Height="20" Id="edKFCGROUPNM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="37" Top="527" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static35" Left="262" Style="sty_Label" TabOrder="36" Text="세부직능" Top="527" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CNM" DisableBKColor="user0" Height="20" Id="edKFCNM" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="38" Top="527" Width="161"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BTEL" DisableBKColor="user0" Height="20" Id="edKFBTEL" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="40" Top="569" Width="98"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static36" Left="382" Style="sty_Label" TabOrder="39" Text="인력구분" Top="569" VAlign="Middle" Width="76"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CPERSONGUBUN" DisableBKColor="user0" Height="20" Id="edKFCPERSONGUBUN" ImeMode="native" Left="459" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="41" Top="569" Width="58"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CAGGUBUN" DisableBKColor="user0" Height="20" Id="edKFCAGGUBUN" ImeMode="native" Left="291" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="43" Top="569" Width="90"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static37" Left="197" Style="sty_Label" TabOrder="42" Text="업무대행" Top="569" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CREGISTERYYMM" DisableBKColor="user0" Height="20" Id="edKFCREGISTERYYMM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="44" Top="590" Width="98"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CFEEYYMM" DisableBKColor="user0" Height="20" Id="edKFCFEEYYMM" ImeMode="native" Left="291" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="46" Top="590" Width="90"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static38" Left="197" Style="sty_Label" TabOrder="45" Text="회비부과월" Top="590" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="DELGUBUN" DisableBKColor="user0" Height="20" Id="edKFDELGUBUN" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="48" Top="548" Width="161"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static39" Left="262" Style="sty_Label" TabOrder="47" Text="상태" Top="548" VAlign="Middle" Width="92"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static40" Left="4" Style="sty_LabelGruopBox" TabOrder="50" Text="선임자정보" Top="642" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static41" Left="4" Style="sty_Label" TabOrder="51" Text="선임자명" Top="664" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="FMNM" DisableBKColor="user0" Height="20" Id="edKFFMNM" ImeMode="native" Left="67" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="52" Top="664" Width="95"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static43" Left="4" Style="sty_Label" TabOrder="53" Text="선임일자" Top="686" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="FMHSTARTDATE" DisableBKColor="user0" Height="20" Id="edKFFMHSTARTDATE" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="55" Top="686" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static44" Left="262" Style="sty_Label" TabOrder="54" Text="해임일자" Top="686" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="FMHENDDATE" DisableBKColor="user0" Height="20" Id="edKFFMHENDDATE" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="56" Top="686" Width="161"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnKFSunapEduInfo" ImageID="BTN_TEXT_09" Left="388" OnClick="lfn_SunapEduInfo2" Style="sty_Button" TabOrder="57" Text="회비/교육정보" Top="394" Transparent="TRUE" Width="132"></Button>
					<Checkbox Height="12" Id="chkKFPerson" Left="332" Style="sty_Checkbox" TabOrder="58" Text="문자열&#32;포함" Top="132" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Static Align="Center" Height="20" Id="Static46" Style="sty_LabelStat" TabOrder="60" Text="총건수" Top="152" VAlign="Middle" Width="56"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edKFCount" ImeMode="native" Left="57" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="59" Text="0" Top="152" UserData="S:구주소2" Width="41"></Edit>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatch" ImageID="BTN_TEXT_08" Left="828" OnClick="lfn_NowMatch2" TabOrder="61" Text="수정없이연계처리" Top="371" Transparent="TRUE" Width="119"></Button>
					<Button ButtonStyle="TRUE" Height="22" Id="btnModMatch" ImageID="BTN_TEXT_06" Left="947" OnClick="btnModMatch_OnClick2" TabOrder="62" Text="수정연계처리" Top="371" Transparent="TRUE" Width="92"></Button>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static56" Left="4" Style="sty_Label" TabOrder="64" Text="용도" Top="548" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static59" Left="382" Style="sty_Label" TabOrder="65" Text="고객번호" Top="590" VAlign="Middle" Width="76"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CNO" DisableBKColor="user0" Height="20" Id="Edit2" ImeMode="native" Left="459" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="66" Top="590" Width="58"></Edit>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatchCancel" ImageID="BTN_TEXT_06" Left="735" OnClick="lfn_CancelMatch2" TabOrder="67" Text="연계해지처리" Top="371" Transparent="TRUE" Width="92"></Button>
					<Checkbox Height="12" Id="chkKFDelUser" Left="236" Style="sty_Checkbox" TabOrder="68" Text="삭제자포함" Top="132" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static61" Left="262" Style="sty_Label" TabOrder="69" Text="회원구분" Top="506" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="CSTATUSGUBUN" DisableBKColor="user0" Height="20" Id="edKFCSTATUSGUBUN" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="70" Top="506" Width="161"></Edit>
					<Static Align="Center" Height="20" Id="Static53" Left="99" TabOrder="74" Text="동명" Top="461" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BADDRDONGFNM" DisableBKColor="user0" Height="20" Id="edKFFDong" ImeMode="native" Left="133" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="71" Top="461" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BADDRDONGNM" DisableBKColor="user0" Height="20" Id="edKFDong" ImeMode="native" Left="229" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="77" Top="461" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static54" Left="323" TabOrder="75" Text="주번지" Top="461" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BADDRMAINNM" DisableBKColor="user0" Height="20" Id="edKFMainAddr" ImeMode="native" Left="367" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="72" Top="461" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static55" Left="418" TabOrder="76" Text="부번지" Top="461" VAlign="Middle" Width="46"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BADDRSUBNM" DisableBKColor="user0" Height="20" Id="edKFSubAddr" ImeMode="native" Left="464" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="73" Top="461" Width="53"></Edit>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ioDangerInfo2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="370" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="70" Id="gdDangerInfo" InputPanel="FALSE" LineColor="default" MinWidth="100" Right="519" Style="sty_Grid" TabOrder="78" TabStop="true" Top="300" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="97"/>
									<col width="182"/>
								</columns>
								<head>
									<cell col="0" display="text" text="허가번호"/>
									<cell col="1" display="text" text="기타사항"/>
								</head>
								<body>
									<cell col="0" colid="DPERMISSIONNO" display="text"/>
									<cell col="1" colid="DREMARK" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Shape Bottom="613" Height="208" Id="Shape4" Left="521" LineColor="user1" Right="1040" TabOrder="100" Top="405" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="149" Height="138" Id="Shape0" Left="520" LineColor="user1" Right="1039" TabOrder="82" Top="11" Type="Rectangle" Width="519"></Shape>
					<Static Align="Center" BKColor="user36" Height="20" Id="lbJubsu" Left="637" Style="sty_LabelGruopBox" TabOrder="83" Text="소방청(소방민원정보시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFHead" ImeMode="none" INDEX="0" InnerDataset="ds_oFireHead" Left="617" OnChanged="cbxMFHead_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="79" Top="26" UserData="S" Value="B" Width="122"></Combo>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFStation" INDEX="0" InnerDataset="ds_oFireCd" Left="742" OnChanged="cbxMFStation_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="80" Top="27" UserData="S" Width="134"></Combo>
					<Static Align="Center" Height="20" Id="Static3" Left="524" Style="sty_Label" TabOrder="84" Text="소방관서" Top="27" VAlign="Middle" Width="90"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate1" Left="618" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="86" Top="69" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" Height="20" Id="Static12" Left="737" Style="sty_Text" TabOrder="85" Text="~" Top="69" VAlign="Middle" Width="20"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate2" Left="756" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="87" Top="69" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" Height="20" Id="Static6" Left="524" Style="sty_Label" TabOrder="88" Text="제조소구분" Top="48" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static7" Left="524" Style="sty_Label" TabOrder="89" Text="변경일자" Top="69" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static8" Left="524" Style="sty_Label" TabOrder="90" Text="검색조건" Top="90" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static9" Left="524" Style="sty_Label" TabOrder="91" Text="검색어" Top="111" VAlign="Middle" Width="90"></Static>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFCenter" INDEX="0" InnerDataset="ds_oFireCenterCd" Left="878" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="81" Top="26" UserData="S" Width="157"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFMnfctretcGubun" INDEX="0" InnerDataset="ds_ioMNFCTRETCGubun" Left="617" OnChanged="tab_page1_cbxMFMnfctretcGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="92" Top="47" UserData="S" Width="122"></Combo>
					<Static Align="Center" Height="20" Id="Static10" Left="879" Style="sty_Label" TabOrder="93" Text="조회건수" Top="69" VAlign="Middle" Width="59"></Static>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radMFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun" Left="618" OnChanged="tab_page1_radMFSelectGubun_OnChanged" TabOrder="94" Top="90" Width="416"></Radio>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edMFKeyword" ImeMode="native" Left="726" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page2_edMFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="95" Top="111" UserData="S:구주소2" Width="219"></Edit>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="617" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="96" Top="110" UserData="S" Value="B" Width="106"></Combo>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFSearch" ImageID="청자료조회" Left="949" OnClick="tab_page2_btnMFSearch_OnClick" Style="sty_Button" TabOrder="97" ToolTipText="조회" Top="110" Width="85"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFExcel" ImageID="엑셀" Left="964" Style="sty_Button" TabOrder="99" Top="152" Transparent="TRUE" Width="74"></Button>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static15" Left="525" Style="sty_LabelGruopBox" TabOrder="101" Text="제조소등&#32;정보" Top="398" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static24" Left="525" Style="sty_LabelGruopBox" TabOrder="102" Text="선임자&#32;정보" Top="616" VAlign="Middle" Width="125"></Static>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioFireManagerInfo2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="714" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="76" Id="gdMFManager" InputPanel="FALSE" Left="525" LineColor="default" OnCellClick="tab_page2_gdMFManager_OnCellClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="1038" RowHeight="20" Style="sty_Grid" TabOrder="103" TabStop="true" Top="638" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="513">
						<contents>
							<format id="Default">
								<columns>
									<col width="39"/>
									<col width="39"/>
									<col width="96"/>
									<col width="107"/>
									<col width="100"/>
									<col width="100"/>
									<col width="200"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="연계"/>
									<cell bkcolor="user7" col="2" display="text" text="선임자명"/>
									<cell bkcolor="user7" col="3" display="text" text="생년월일"/>
									<cell bkcolor="user7" col="4" display="text" text="선임일자"/>
									<cell bkcolor="user7" col="5" display="text" text="해임일자"/>
									<cell bkcolor="user7" col="6" display="text" text="주소"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" display="text" expr="DECODE(DMSTATUS,&apos;1&apos;,&apos;○&apos;,&apos;0&apos;,&apos;X&apos;,&apos;-1&apos;,&apos;제외&apos;)"/>
									<cell align="center" col="2" colid="NM" display="text"/>
									<cell align="center" col="3" colid="BIRTHDAY" display="text"/>
									<cell align="center" col="4" colid="DMINDATE" display="text"/>
									<cell align="center" col="5" colid="DMOUTDATE" display="text"/>
									<cell align="left" col="6" colid="ADDR" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFPISInfo" ImageID="BTN_TEXT_09" Left="911" OnClick="tab_page2_btnFPISInfo_OnClick" Style="sty_Button" TabOrder="104" Text="청시스템상세보기" Top="396" Transparent="TRUE" Width="132"></Button>
					<Checkbox Height="12" Id="chkMFPerson" Left="858" Style="sty_Checkbox" TabOrder="105" Text="문자열&#32;포함" Top="132" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edMFCount" ImeMode="native" Left="578" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="106" Text="0" Top="151" UserData="S:구주소2" Width="41"></Edit>
					<Static Align="Center" Height="20" Id="Static45" Left="521" Style="sty_LabelStat" TabOrder="107" Text="총건수" Top="151" VAlign="Middle" Width="56"></Static>
					<Static Align="Center" Height="20" Id="Static47" Left="756" Style="sty_Label" TabOrder="109" Text="제조소상세구분" Top="48" VAlign="Middle" Width="119"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFMnfctretcGubunD" INDEX="0" InnerDataset="ds_ioMNFCTRETCGubunD" Left="878" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="110" Top="47" UserData="S" Value="B" Width="157"></Combo>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioMFFireObj2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="370" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="197" Id="gdMFOBJList" InputPanel="FALSE" Left="521" LineColor="default" OnCellClick="tab_page2_gdMFOBJList_OnCellClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="1040" RowHeight="20" Style="sty_Grid" TabOrder="114" TabStop="true" Top="173" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="46"/>
									<col width="37"/>
									<col width="75"/>
									<col width="60"/>
									<col width="49"/>
									<col width="71"/>
									<col width="59"/>
									<col width="50"/>
									<col width="50"/>
									<col width="151"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="매칭율"/>
									<cell bkcolor="user7" col="2" display="text" text="연계"/>
									<cell bkcolor="user7" col="3" display="text" text="대상물명"/>
									<cell bkcolor="user7" col="4" display="text" text="허가번호"/>
									<cell bkcolor="user7" col="5" display="text" text="선임자"/>
									<cell bkcolor="user7" col="6" display="text" text="대상구분"/>
									<cell bkcolor="user7" col="7" display="text" text="동주소"/>
									<cell bkcolor="user7" col="8" display="text" text="주번지"/>
									<cell bkcolor="user7" col="9" display="text" text="부번지"/>
									<cell bkcolor="user7" col="10" display="text" text="주소"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" colid="TOTSUM" display="text"/>
									<cell align="center" col="2" display="text" expr="DECODE(MSTATUS,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,&apos;○&#32;(&apos;+MANAGERMATCHCNT&#32;+&#32;&apos;/&apos;&#32;+&#32;MANAGERCNT+&apos;)&apos;)"/>
									<cell align="left" col="3" colid="OBJ_NM2" display="text"/>
									<cell align="left" col="4" colid="PRMISN_NO" display="text"/>
									<cell align="left" col="5" colid="NM" display="text"/>
									<cell align="left" col="6" colid="MNFCTRETCNM" display="text"/>
									<cell align="left" col="7" colid="SEARCHDONGFNM" display="text"/>
									<cell align="left" col="8" colid="SEARCHMAINADDR" display="text"/>
									<cell align="left" col="9" colid="SEARCHSUBADDR" display="text"/>
									<cell align="left" col="10" colid="ADDR" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" Height="20" Id="Static17" Left="525" Style="sty_Label" TabOrder="115" Text="대상물명" Top="419" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="OBJ_NM" DisableBKColor="user0" Height="20" Id="edMFOBJ_NM" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="121" Top="419" Width="204"></Edit>
					<Static Align="Center" Height="20" Id="Static52" Left="822" Style="sty_Label" TabOrder="133" Text="허가번호" Top="419" VAlign="Middle" Width="58"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="PRMISN_NO" DisableBKColor="user0" Height="20" Id="edMFPRMISN_NO" ImeMode="native" Left="881" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="132" Top="419" Width="60"></Edit>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Height="20" Id="edMFMatch" ImeMode="native" Left="1000" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="147" Top="419" Width="37"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="ADDR" DisableBKColor="user0" Height="20" Id="edMFADDR" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="122" Top="440" Width="421"></Edit>
					<Static Align="Center" Height="44" Id="Static19" Left="525" Style="sty_Label" TabOrder="117" Text="매칭주소" Top="461" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static18" Left="525" Style="sty_Label" TabOrder="116" Text="설치장소" Top="440" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static49" Left="619" TabOrder="141" Text="동명" Top="461" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="SEARCHDONGFNM" DisableBKColor="user0" Height="20" Id="edMFFDong" ImeMode="native" Left="653" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="138" Top="461" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="SEARCHDONGNM" DisableBKColor="user0" Height="20" Id="edMFDong" ImeMode="native" Left="750" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="144" Top="461" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static50" Left="843" TabOrder="142" Text="주번지" Top="461" VAlign="Middle" Width="42"></Static>
					<Static Align="Center" Height="20" Id="Static51" Left="941" TabOrder="143" Text="부번지" Top="461" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="SEARCHMAINADDR" DisableBKColor="user0" Height="20" Id="edMFMainAddr" ImeMode="native" Left="887" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="139" Top="461" Width="53"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="SEARCHSUBADDR" DisableBKColor="user0" Height="20" Id="edMFSubAddr" ImeMode="native" Left="984" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="140" Top="461" Width="53"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="CMPN119SC_ID" DisableBKColor="user0" Height="20" Id="edMFCMPN119SC_ID" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="124" Top="506" Width="421"></Edit>
					<Static Align="Center" Height="20" Id="Static20" Left="525" Style="sty_Label" TabOrder="118" Text="소방관서" Top="506" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static21" Left="525" Style="sty_Label" TabOrder="119" Text="제조소등구분" Top="527" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="MNFCTRETCNM" DisableBKColor="user0" Height="20" Id="edMFMNFCTRETCNM" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="125" Top="527" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static31" Left="784" Style="sty_Label" TabOrder="126" Text="제조소등상세구분" Top="527" VAlign="Middle" Width="111"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="MNFCTRETCDETAILNM" DisableBKColor="user0" Height="20" Id="edMFMNFCTRETCDETAILNM" ImeMode="native" Left="896" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="127" Top="527" UserData="S:구주소2" Width="141"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="INSTLR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_NM" ImeMode="native" Left="875" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="130" Top="548" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static48" Left="784" Style="sty_Label" TabOrder="131" Text="설치자명" Top="548" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="INSTLR_CPR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_CPR_NM" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="145" Top="548" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static62" Left="525" Style="sty_Label" TabOrder="146" Text="설치법인명" Top="548" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static32" Left="525" Style="sty_Label" TabOrder="128" Text="전화번호" Top="569" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="INSTLR_TELNO" DisableBKColor="user0" Height="20" Id="edMFINSTLR_TELNO" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="129" Top="569" Width="167"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="REGIST_DE_14" DisableBKColor="user0" Height="20" Id="Edit0" ImeMode="native" Left="616" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="135" Top="590" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static57" Left="525" Style="sty_Label" TabOrder="134" Text="최초등록일" Top="590" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static58" Left="784" Style="sty_Label" TabOrder="136" Text="최종수정일" Top="590" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static23" Left="784" Style="sty_Label" TabOrder="120" Text="완공일자" Top="569" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="COMPET_DE" DisableBKColor="user0" Height="20" Id="edMFCOMPET_DE" ImeMode="native" Left="875" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="123" Top="569" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="UPDT_DE_14" DisableBKColor="user0" Height="20" Id="Edit1" ImeMode="native" Left="875" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="137" Top="590" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static63" Left="942" Style="sty_Label" TabOrder="148" Text="연계구분" Top="419" VAlign="Middle" Width="57"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static22" Left="4" Style="sty_Label" TabOrder="152" Text="최초등록일" Top="612" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CREGDATE" DisableBKColor="user0" Height="20" Id="edCREGDATE" ImeMode="native" Left="97" LeftMargin="2" OnChanged="tab_page1_Edit3_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="149" Top="612" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static64" Left="262" Style="sty_Label" TabOrder="150" Text="최종수정일" Top="612" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="CMODDATE" DisableBKColor="user0" Height="20" Id="edCMODDATE" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="151" Top="612" Width="161"></Edit>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spMFRowNum" Left="940" Max="1000000" TabOrder="153" Text="500" Top="69" Width="94"></Spin>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spKFRowNum" Left="425" Max="1000000" TabOrder="154" Text="500" Top="68" Width="89"></Spin>
					<Static Align="Center" Height="20" Id="Static60" Left="616" TabOrder="155" Text="도로명" Top="483" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="ROAD_NM" DisableBKColor="user0" Height="20" Id="edMFRoadNM" ImeMode="native" Left="653" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="156" Top="484" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static66" Left="857" TabOrder="157" Text="건물번호" Top="484" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="MAIN_BDNBR" DisableBKColor="user0" Height="20" Id="edMFMainNO" ImeMode="native" Left="917" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="158" Top="484" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static67" Left="969" TabOrder="160" Text="-" Top="484" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="SEC_BDNBR" DisableBKColor="user0" Height="20" Id="edMFSubNO" ImeMode="native" Left="984" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="159" Top="484" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static68" Left="96" TabOrder="161" Text="도로명" Top="482" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RROADNM" DisableBKColor="user0" Height="20" Id="edKFRoadNM" ImeMode="native" Left="133" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="162" Top="483" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static69" Left="337" TabOrder="163" Text="건물번호" Top="483" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RBUILDMAINNO" DisableBKColor="user0" Height="20" Id="edKFMainNO" ImeMode="native" Left="397" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="164" Top="483" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static70" Left="450" TabOrder="166" Text="-" Top="483" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RBUILDSUBNO" DisableBKColor="user0" Height="20" Id="edKFSubNO" ImeMode="native" Left="464" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="165" Top="483" Width="53"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static42" Left="166" Style="sty_Label" TabOrder="167" Text="생년월일" Top="664" VAlign="Middle" Width="65"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="FBIRTHDAY" DisableBKColor="user0" Height="20" Id="edKFFMBIRTHDAY" ImeMode="native" Left="234" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="168" Top="664" Width="110"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static65" Left="348" Style="sty_Label" TabOrder="170" Text="개인식별번호" Top="664" VAlign="Middle" Width="80"></Static>
					<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="FMPERSONKEY" DisableBKColor="user0" Font="굴림,10" Height="20" Id="edKFFMPersonKey" Left="432" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="169" Top="664" Type="STRING" Width="84"></MaskEdit>
				</TabPage>
			</Contents>
		</Tab>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="870" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="1" ToolTipText="화면&#32;출력" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="957" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="3" Width="85"></Button>
		<Static Color="user11" Font="굴림,12,Bold" Height="20" Id="Static25" Left="4" Style="sty_Text" TabOrder="5" Text="위험물안전관리자&#32;일치화관리" Top="4" VAlign="Middle" VClip="Both" Width="436"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnDataHistory" ImageID="BTN_TEXT_07" Left="764" OnClick="btnDataHistory_OnClick" Style="sty_Button" TabOrder="6" Text="데이터조회이력" ToolTipText="조회" Top="3" Width="106"></Button>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust6100MDataConnectionDangerManage.xml
 * 설명 : 데이타 연계 위험물안전관리자
 * 작성일 : 2010.05.19
 * 작성자 : 김민호
 */

#include "LIB::cust.js"; // 공통업무 관련

var menuId = "";	// 메뉴 아이디 
var setRow = "";	// 로우값 셋팅
var ORGNM = "";		// 기관명

/* 연계관련 */
var managerMatchYN = ""; // 선임자 연계여부 

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
   gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    //폼 환경설정
  //  ls_SystemGubun = gs_SystemGubun;
  //  ls_SystemMenuId = gs_SystemMenuId;
    
    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
     //   lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
     //   lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }
    
    // 메뉴 아이디 
	menuId = gds_oLeftMenu.GetColumn(gds_oLeftMenu.currow,"MMENUID");

    // 공통 코드 조회       
    ds_oFireHead.Copy("gds_oFireBonbuCode");		 				//소방본부 콤보세팅
	ds_oFireCd.Copy("gds_oFireCode");  				 				//소방서 콤보세팅		
	ds_oFireCenterCd.Copy("gds_oFireCenterCode");    				//소방센터 콤보세팅
    gfn_SearchAllJibu(tab.page1.cbxKFJibu, "Y");           			// 지부 코드 조회    청기준
    tab.page2.cbxKFJibu.Value = tab.page1.cbxKFJibu.Value;
	gfn_SearchCustomerCourseFullName(ds_ioCourse, "0", "전체");		// 대표고객직능 조회
	gfn_SearchCustomerDetailCourse("30",ds_ioCourseD, "0", "전체");// 세부고객직능 조회	
	tab.page1.cbxKFCourseD.Index = 0;
	tab.page2.cbxKFCourseD.Index = 0;

    // 콤보박스-지역
	tab_page1_cbxKFJibu_OnChanged("",tab.page1.cbxKFJibu.Value);//지역 코드 조회
    tab.page1.cbxKFRegion1.Index = 0;
    tab.page1.cbxKFRegion2.index = ds_oRegion.rowcount-1; 
    tab_page2_cbxKFJibu_OnChanged("",tab.page2.cbxKFJibu.Value);//지역 코드 조회
    tab.page2.cbxKFRegion1.Index = 0;
    tab.page2.cbxKFRegion2.index = ds_oRegion.rowcount-1;
    
    
    // 소속지부 셋팅
    if (gds_oUserInfo.GetColumn(0, "PDEPTCD") > 1000) {
		var PDEPTCD = gds_oUserInfo.GetColumn(0, "PDEPTCD");
		if (ds_ioJibu.FindRow("CD", PDEPTCD) <> -1) {
			if(PDEPTCD <> tab.page1.cbxKFJibu.Value) {	
				tab.page1.cbxKFJibu.Value = PDEPTCD;	
				tab.page2.cbxKFJibu.Value = PDEPTCD;	
				lfn_JibuChange(tab.page1.cbxKFJibu.Value);	//지부변경	
			}
		}
		
		// 경기 북부는 경기로 .. 나머진 그대
		var chkPDEPTCD = "";      // 경기북부 경우 체크 
//		if (PDEPTCD == "1141") {
//			chkPDEPTCD = "1081";
//		} else {
			chkPDEPTCD = PDEPTCD;
//		}
		
		if(ds_oFireHead.FindRow("JIBUCD", chkPDEPTCD) <> -1) {
			ds_oFireHead.Filter("JIBUCD="+quote(chkPDEPTCD));
		} 
		
		if(ds_ioJibu.FindRow("CD", PDEPTCD) <> -1) {
			ds_ioJibu.Filter("CD="+quote(PDEPTCD));
		}
	}
	
	if (tab.page1.cbxMFHead.value == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}
	
	//소방서 필터링
    var ctcd = ds_oFireHead.GetColumn(0,"CD"); 						// 기본값 인덱스 0번값 지정
    tab.page1.cbxMFHead.Value = ctcd;
    tab.page2.cbxMFHead.Value = ctcd;
    lfn_FilterFireStation(ctcd);
    
	// 제조소구분, 제조소상세구분
	lfn_searchMnfctretcCode();	
	ds_ioMNFCTRETCGubun.InsertRow(0);
	ds_ioMNFCTRETCGubun.SetColumn(0,"DATA","전체");	
	lfn_FilterMnfctretcGubun(ds_ioMNFCTRETCGubun.GetColumn(1,"CD"));
	tab.page1.cbxMFMnfctretcGubun.Index = 0;
	tab.page1.cbxMFMnfctretcGubunD.Index = 0;
	tab.page1.cbxMFMnfctretcGubunD.Enable =false;
	tab.page2.cbxMFMnfctretcGubun.Index = 0;
	tab.page2.cbxMFMnfctretcGubunD.Index = 0;
	tab.page2.cbxMFMnfctretcGubunD.Enable =false;
	
	// 청기준 연계관련버튼 처리
	tab.page1.btnDanger.Enable = false;
	tab.page1.btnMatch.Enable = false;
	tab.page1.btnMatchCancel.Enable = false;
	tab.page1.btnNewMatch.Enable = false;
	tab.page1.btnModMatch.Enable = false;
	
	// 안전원기준 연계관련버튼 처리
	tab.page2.btnMatch.Enable = false;
	tab.page2.btnMatchCancel.Enable = false;
	tab.page2.btnModMatch.Enable = false;
}


/*************************************************************************************************************
													청기준
**************************************************************************************************************/

/*============================================	소방청 정보=================================*/

// 제조소 및 제조소 상세구분 
function lfn_searchMnfctretcCode(obj) {
	ds_ioMNFCTRETCGubun.ClearData();		// 제조소 구분
	ds_ioMNFCTRETCGubunD.ClearData();		// 제조소 상세구분 
 
    tit_clearActionInfo();    
    tit_addSearchActionInfo("cust:searchCust6100MnfctretcSeCode", false);
    tit_addSearchActionInfo("cust:searchCust6100MnfctretcDetailSeCode", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_ioMNFCTRETCGubun=ds_oMNFCTRETCGubun ds_ioMNFCTRETCGubunD=ds_oMNFCTRETCGubunD" // outDs
        , "CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2))	//args
        , ""	//callBackFunc
        ,false
        ,false
        ,true
    );
}


/*
 * 기능 : 구분 기존, 신규 (기존 : 0, 신규 : 1)
*/
function tab_page1_radMFGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == 0) {
		tab.page1.lbMFDate.Text = "안전원수신일자";
		tab.page1.cbxMFStation.Index = 1;
		tab.page1.radMFGubun.BkColor = default;
	} else if (strCode == 1) {
		tab.page1.lbMFDate.Text = "신규등록일자";
		tab.page1.cbxMFStation.Index = 0;		
		tab.page1.medMFModDate1.Value = substr(GetDate(),0,6) + "01";
		tab.page1.medMFModDate2.Value = GetDate();
		tab.page1.radMFGubun.BkColor = "khaki";
	}
}

// 지역 선택시
function cbxMFHead_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 청조회조건 변경시 안전원 조건 연동 
	lfn_SearchBalance("11");
	lfn_FilterFireStation(strCode);
	if (strCode == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}
	
	// 제조소구분, 제조소상세구분
	lfn_searchMnfctretcCode();	
	ds_ioMNFCTRETCGubun.InsertRow(0);
	ds_ioMNFCTRETCGubun.SetColumn(0,"DATA","전체");	
	lfn_FilterMnfctretcGubun(ds_ioMNFCTRETCGubun.GetColumn(1,"CD"));
	tab.page1.cbxMFMnfctretcGubun.Index = 0;
	tab.page1.cbxMFMnfctretcGubunD.Index = 0;
	tab.page1.cbxMFMnfctretcGubunD.Enable =false;
	tab.page2.cbxMFMnfctretcGubun.Index = 0;
	tab.page2.cbxMFMnfctretcGubunD.Index = 0;
	tab.page2.cbxMFMnfctretcGubunD.Enable =false;
}

// 소방 본부 선택시 본부 포함된 서센터 정보 필터링
function lfn_FilterFireStation(sFilterGubun) {	
	ds_oFireCd.UnFilter();
	ds_oFireCenterCd.UnFilter();
	
	//  필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "CTCD='" + trim(sFilterGubun) + "'";
    }  

    ds_oFireCd.Filter(ls_FilterExpr);        
    ds_oFireCenterCd.Filter(ls_FilterExpr); 
   
    if( ds_oFireCd.FindRow("DATA", tab.page1.cbxMFStation.Text) == -1) {
		tab.page1.cbxMFStation.Text = "";
		tab.page2.cbxMFStation.Text = "";
    }
    
    if (ds_oFireCd.GetColumn(0,"DATA") == "전체") {
		ds_oFireCd.AddRow(0);
    } else {
		ds_oFireCd.InsertRow(0);
    }
	ds_oFireCd.SetColumn(0,"DATA","전체");
	ds_oFireCd.SetColumn(0,"CTCD",trim(sFilterGubun));    
	if (ds_oFireCenterCd.GetColumn(0,"DATA") == "전체") {
		ds_oFireCenterCd.AddRow(0);
    } else {
		ds_oFireCenterCd.InsertRow(0);
    }	
	ds_oFireCenterCd.SetColumn(0,"DATA","전체");
	ds_oFireCenterCd.SetColumn(0,"CTCD",trim(sFilterGubun));    
	
    tab.page1.cbxMFStation.Index = 1; 
    tab.page1.cbxMFCenter.Index = 0; 
    tab.page2.cbxMFStation.Index = 0; 
    tab.page2.cbxMFCenter.Index = 0; 
}

// 소방서 변경시 
function cbxMFStation_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_FilterFireCenter(strCode);
}

// 소방서 선택시 소방서에 포함된 센터정보 필터링 
function lfn_FilterFireCenter(sFilterGubun) {	
	ds_oFireCenterCd.UnFilter();
	
	// 필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "UPCD='" + trim(sFilterGubun) + "'";
    }    
    ds_oFireCenterCd.Filter(ls_FilterExpr);    
	if( ds_oFireCenterCd.FindRow("DATA", tab.page1.cbxMFCenter.Text) == -1) {
		tab.page1.cbxMFCenter.Text = "";
		tab.page2.cbxMFCenter.Text = "";
    }
    
    // 전체 항목 추가 
	if (ds_oFireCenterCd.GetColumn(0,"DATA") == "전체") {
		ds_oFireCenterCd.AddRow(0);
    } else {
		ds_oFireCenterCd.InsertRow(0);
    }	
    ds_oFireCenterCd.SetColumn(0,"DATA","전체");
    ds_oFireCenterCd.SetColumn(0,"CTCD",trim(sFilterGubun));     
    
    tab.page1.cbxMFCenter.Index = 0;    
    tab.page2.cbxMFCenter.Index = 0;    
}

// 제조소 구분 변경시 
function tab_page1_cbxMFMnfctretcGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_FilterMnfctretcGubun(strCode);
}

// 제조소 상세구분 필터링
function lfn_FilterMnfctretcGubun(sFilterGubun) {	
	ds_ioMNFCTRETCGubunD.UnFilter();
	
	//  필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
		tab.page1.cbxMFMnfctretcGubunD.Enable = true;
		tab.page2.cbxMFMnfctretcGubunD.Enable = true;
        ls_FilterExpr += "CODE_GROUP='" + trim(sFilterGubun) + "'";    

		ds_ioMNFCTRETCGubunD.Filter(ls_FilterExpr);        
		
		if( ds_ioMNFCTRETCGubun.FindRow("DATA", tab.page1.cbxMFMnfctretcGubun.Text) == -1) {
			tab.page1.cbxMFMnfctretcGubunD.Text = "";
			tab.page2.cbxMFMnfctretcGubunD.Text = "";
		}
		
		if (ds_ioMNFCTRETCGubunD.GetColumn(0,"DATA") == "전체") {
			ds_ioMNFCTRETCGubunD.AddRow(0);
		} else {
			ds_ioMNFCTRETCGubunD.InsertRow(0);
		}
		
		ds_ioMNFCTRETCGubunD.SetColumn(0,"DATA","전체");
		ds_ioMNFCTRETCGubunD.SetColumn(0,"CODE_GROUP",trim(sFilterGubun));  	  
		tab.page1.cbxMFMnfctretcGubunD.Index = 0; 
		tab.page2.cbxMFMnfctretcGubunD.Index = 0; 
    }  else {
		tab.page1.cbxMFMnfctretcGubunD.Enable = false;
		tab.page2.cbxMFMnfctretcGubunD.Enable = false;
    }
}

// 3 청자료 조회 
function lfn_MFSearch(obj)
{
	// 신규대상일 경우는 시작 날짜 체크 
	if (tab.page1.radMFGubun.Value == 1) {
		if (tab.page1.medMFModDate1.Value == "" || tab.page1.medMFModDate1.Value ==null) {
			alert("신규등록일자를 입력하세요.");
			tab.page1.medMFModDate1.SetFocus();
			return;
		}
	}
	
	// 안전원 정보 초기화 
	KfClear();
	lfn_MatchColor();
	
	ds_ioMFFireObj.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD.ClearData(); // 데이타셋 초기화
	ds_ioFireManagerInfo.ClearData(); // 데이타셋 초기화
	tab.page1.edMFMatch.Text = "";

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6100MFDangerAdmin", false);
	
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page1.edMFKeyword.Text != "") {		
		if (tab.page1.chkMFPerson.Value == "1") {
			KEYWORD = "%"+tab.page1.edMFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page1.edMFKeyword.Text+"%";
		}
	}

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObj=ds_oMFFireObj"	// outDs
		,"CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2))   
	   + " BONBUCD=" + quote(tab.page1.cbxMFHead.Value)
	   + " STATION=" + quote(tab.page1.cbxMFStation.Value)
	   + " CENTER=" + quote(tab.page1.cbxMFCenter.Value)
	   + " MNFCTRETCCODE=" + quote(tab.page1.cbxMFMnfctretcGubun.Value)
	   + " MNFCTRETCCODED=" + quote(tab.page1.cbxMFMnfctretcGubunD.Value)
	   + " MODDATE1=" + quote(tab.page1.medMFModDate1.Value)
	   + " MODDATE2=" + quote(tab.page1.medMFModDate2.Value)
	   + " MSTATUS=" + quote(tab.page1.radMFSelectGubun.Value)
	   + " KEYFIELD=" + quote(tab.page1.cbxMFKeyfield.Value)
       + " KEYWORD=" + quote(KEYWORD)
       + " GUBUN=" + quote(tab.page1.radMFGubun.Value)
       + " ROWNUM=" + quote(tab.page1.spMFRowNum.value)  
		,"lfn_MFAfterSearch"
		,false
		,false
		,true
	);
}

// 3 lfn_MFSearch 조회후
function lfn_MFAfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
      
    tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
    lfn_MFMatchExceptBTN();
    
    // 조회로그 남기기 
    logWrite("1");
    
    // 상세조회 
    lfn_MFObjInfoSearch("0");

}

// 청 그리드 셀선택시 선임자 조회 
function tab_page1_gdMFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 안전원 정보 초기 화 
	KfClear();
	lfn_MatchColor();
	
	// 연계 제외 여부 버튼 처리 
	lfn_MFMatchExceptBTN(nRow);
	
	// 대상물 정보 ,선임자 조회 
	lfn_MFObjInfoSearch(nRow);
}

// 청 그리드 셀 더블 클릭시 
function tab_page1_gdMFOBJList_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 안전원 정보 초기 화 
	KfClear();
	lfn_MatchColor();
	
	// 제외 여부 체크 
	if(ds_ioMFFireObj.GetColumn(nRow,"MSTATUS") == -1) {
		alert("제외 대상물입니다.");
		tab.page1.btnMatch.Enable = false;
		tab.page1.btnMatchCancel.Enable = false;
		tab.page1.btnNewMatch.Enable = false;
		tab.page1.btnModMatch.Enable = false;
		return;
	} else {
		tab.page1.btnMatch.Enable = true;
		tab.page1.btnMatchCancel.Enable = true;
		tab.page1.btnNewMatch.Enable = true;
		tab.page1.btnModMatch.Enable = true;
	}
	
	//  안전원데이타조회
	lfn_MatchData();
}

/*
	선임자 그리드 셀 클릭시 
*/
function tab_page1_gdMFManager_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 안전원 정보 초기 화 
	KfClear();
	lfn_MatchColor();
	
	// 선임자 연계제외 버튼처리 
	if(ds_ioFireManagerInfo.GetColumn(nRow,"DMSTATUS") == 0) {
		tab.page1.btnMFMatchExceptM.Visible = true;
		tab.page1.btnMFMatchExceptCancelM.Visible = false;
	} else if (ds_ioFireManagerInfo.GetColumn(nRow,"DMSTATUS") == -1){
		tab.page1.btnMFMatchExceptM.Visible = false;
		tab.page1.btnMFMatchExceptCancelM.Visible = true;
	} else {
		tab.page1.btnMFMatchExceptM.Visible = false;
		tab.page1.btnMFMatchExceptM.Visible = false;
	}
	
	// 삭제된 정보 색 표기 	
	if (ds_ioMFFireObjD.GetColumn(0,"DELETE_AT") == "Y" 
	    || ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "-1"
	    || ds_ioFireManagerInfo.GetColumn(0,"DMSTATUS") == "-1") {
		tab.page1.Shape4.BkColor = "darkgray";
	} else {
		tab.page1.Shape4.BkColor = "white";
	}
}

/*
	선임자 그리드 더블 셀 클릭시
*/
function tab_page1_gdMFManager_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 안전원 정보 초기 화 
	KfClear();
	lfn_MatchColor();
	lfn_MatchData();
}

/*
	대상물 정보 선임자 정보 조회 
*/
function lfn_MFObjInfoSearch(nRow)
{
	ds_ioFireManagerInfo.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("cust:searchCust6100MFDangerAdminD", false);
	tit_addSearchActionInfo("cust:searchCust6100MFDangerAdminManager", false);

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObjD=ds_oMFFireObjD ds_ioFireManagerInfo=ds_oFireManagerInfo"	// outDs
		,"MNFCTRETC_SN=" + quote(ds_ioMFFireObj.GetColumn(nRow,"MNFCTRETC_SN"))  
		 + " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2)) 
		,"lfn_MFFMAfterSearch"
		,false
		,false
		,true
	);
}

/*
	lfn_MFFireManagerSearch 조회후
*/
function lfn_MFFMAfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    if (ds_ioMFFireObjD.GetCount() > 0) {
		// 조회로그 남기기 
		detailLogWrite("M");
    }
    
    
    // 연계 처리 관련버튼 처리
	lfn_AllMatchBTN();
    
    // 하단상세보기 연계 여부 값입력 
	if(ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "-1") {
		tab.page1.edMFMatch.Text = "제외";
	} else if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "0") {
		tab.page1.edMFMatch.Text = "X";
	} else if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") > 0){
		tab.page1.edMFMatch.Text = "○";
	} else {
		tab.page1.edMFMatch.Text = "X";
	}
	
	// 선임자 연계제외 버튼처리 
	if(ds_ioFireManagerInfo.GetColumn(0,"DMSTATUS") == 0) {
		tab.page1.btnMFMatchExceptM.Visible = true;
		tab.page1.btnMFMatchExceptCancelM.Visible = false;
	} else if (ds_ioFireManagerInfo.GetColumn(0,"DMSTATUS") == -1){
		tab.page1.btnMFMatchExceptM.Visible = false;
		tab.page1.btnMFMatchExceptCancelM.Visible = true;
	} else {
		tab.page1.btnMFMatchExceptM.Visible = false;
		tab.page1.btnMFMatchExceptM.Visible = false;
	}
	
	// 삭제된 정보 색 표기 	
	if (ds_ioMFFireObjD.GetColumn(0,"DELETE_AT") == "Y" 
	    || ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "-1"
	    || ds_ioFireManagerInfo.GetColumn(0,"DMSTATUS") == "-1") {
		tab.page1.Shape4.BkColor = "darkgray";
	} else {
		tab.page1.Shape4.BkColor = "white";
	}
}

/*
	연계 제외 버튼 처리 
*/
function lfn_MFMatchExceptBTN(nRow)
{
	var MSTATUS = "";
	if (nRow == "" || nRow == null) {
		MSTATUS = ds_ioMFFireObj.GetColumn(0,"MSTATUS");
	} else {
		MSTATUS = ds_ioMFFireObj.GetColumn(nRow,"MSTATUS");
	}
	
	if (MSTATUS == 0) {
		tab.page1.btnMFMatchCancel.Visible = false;
		tab.page1.btnMFMatchExcept.Visible = true;
	} else if (MSTATUS == -1) {
		tab.page1.btnMFMatchCancel.Visible = true;
		tab.page1.btnMFMatchExcept.Visible = false;		
	} else if (MSTATUS > 0 ) {
		tab.page1.btnMFMatchCancel.Visible = false;
		tab.page1.btnMFMatchExcept.Visible = false;
	} else {
		tab.page1.btnMFMatchCancel.Visible = false;
		tab.page1.btnMFMatchExcept.Visible = false;
	}
}

/*
	연계 제외 처리 
*/
function lfn_MFMatchExcept(obj)
{
	// 안전원 정보 초기 화 
	KfClear();
	
	if(!gfn_Confirm("'"+ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"OBJ_NM2") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}

	var parValue = "GUBUN='1' MNFCTRETC_SN="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN"));
	parValue += " EXCEPTCD="+quote(arrNo[0]);
	parValue += " EXCEPTTXT="+quote(arrNo[1]);
	parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExcept"
		,false
		,false
		,true
	);
}

/*
	lfn_MFMatchCancel, fn_MFMatchExcept 조회후
*/
function lfn_AfterMFMatchExcept(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 연계제외처리후  상태값 변경*/     
    // 연계제외대상 상태 값 -1(연계제외)로 변경 
    ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radMFSelectGubun.Value == "1" || tab.page1.radMFSelectGubun.Value == "2") {
		setRow = ds_ioMFFireObj.currow;
		ds_ioMFFireObj.Filter("MSTATUS!='-1'"); // 연계제외대상 필터링 
		tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();  // 총 건수 변경
		ds_ioMFFireObj.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioMFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN(ds_ioMFFireObj.currow);
	    
	// 대상물 선임자정보 상세조회
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

/*
	연계 제외 취소 
*/
function lfn_MFMatchExceptCancel(obj)
{
	// 안전원 정보 초기 화 
	KfClear();

	if(!gfn_Confirm("'"+ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"OBJ_NM2") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,"GUBUN='1' MNFCTRETC_SN="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN"))
	     + " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2))
		,"lfn_AfterMFMatchCancel"
		,false
		,false
		,true
	);
}

/*
	lfn_MFMatchCancel, fn_MFMatchExcept 조회후
*/
function lfn_AfterMFMatchCancel(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 연계제외처리후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radMFSelectGubun.Value == "3") {
    	setRow = ds_ioMFFireObj.currow;
		ds_ioMFFireObj.Filter("MSTATUS=='-1'"); // 연계제외대상 필터링 
		tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();  // 총 건수 변경
		ds_ioMFFireObj.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioMFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN(ds_ioMFFireObj.currow);
	    
	// 대상물 선임자정보 상세조회
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

//  6 청조회 결과 엑셀 출력 
function tab_page1_btnMFExcel_OnClick(obj)
{
	if (ds_ioMFFireObj.GetCount() > 0) {
		tab.page1.gdMFOBJList.ExportExcelEx("sheet1");
	}
}

// 7 멀티 정렬을 실행한다.
function tab_page1_btnMFMutilSort_OnClick(obj)
{
	gfn_GridMultiSort(ds_ioMFFireObj, 1); 
}


// 처시스템 상세보기 
function tab_page1_btnFPISInfo_OnClick(obj)
{
	if (ds_ioMFFireObj.GetCount() > 0 ) {
		var parValue = "sCourse=30";
		parValue += " sCivilAppeal=1";
		parValue += " sBarCode=''";	
		parValue += " sMFPIS1_SN="+quote(ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " sCTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));		// 지역코드

		var arrNo = Dialog("cust::frmcust5010.xml", parValue, 800, 590, "", -1, -1);
	} else {
		alert("선택된 자료가 없습니다.");
		return;
	}
}

// 선임자 연계 제외 취소
function lfn_MFMatchExceptCancelM(obj)
{
	// 안전원 정보 초기 화 
	KfClear();

	if(!gfn_Confirm("'"+ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"NM") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	var parValue = "DMMGNO=" + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMMGNO"));	
		parValue += " GUBUN='2'";   // 1 : 연계제외 , 2 : 연계제외 취소 
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptM", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExceptCancelM"
		,false
		,false
		,true
	);
}

//  lfn_MFMatchExceptCancelM 조회후
function lfn_AfterMFMatchExceptCancelM(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 상세정보  조회 
    lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

// 선임자 연계 제외
function lfn_MFMatchExceptM(obj)
{
	// 안전원 정보 초기 화 
	KfClear();

	if(!gfn_Confirm("'"+ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"NM") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	var parValue = "DMMGNO=" + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMMGNO"));	
		parValue += " GUBUN='1'";   // 1 : 연계제외 , 2 : 연계제외 취소 
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptM", "", 0, "");
		
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExceptM"
		,false
		,false
		,true
	);	
}


//  lfn_MFMatchExceptM 조회후
function lfn_AfterMFMatchExceptM(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 상세정보  조회 
    lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

/*============================================	소방 안전원 정보  =================================*/

// 1 지부변경 지역목록
function tab_page1_cbxKFJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
	lfn_JibuChange(strCode);
}

// 1 지부변경 지역목록
function lfn_JibuChange(strCode)
{ 
	gfn_SearchCodeRegion(strCode, ds_oRegion, "0");	//지역 코드 조회
    tab.page1.cbxKFRegion1.Index = 0;
    tab.page1.cbxKFRegion2.index = ds_oRegion.rowcount-1;
    tab.page2.cbxKFRegion1.Index = 0;
    tab.page2.cbxKFRegion2.index = ds_oRegion.rowcount-1;
}

//  3 청조회 그리드(gdMFOBJList) 더블 클릭시 소방안전원 정보 조회 
function lfn_MatchData()
{	

	// 대상물을 3글자 조회 
	var SEARCHBNM2 = ds_ioMFFireObjD.GetColumn(0,"SEARCHBNM");	
	SEARCHBNM2 = substr(SEARCHBNM2,0,3);
	
	// 파라미터값 
	var parValue = "";
	parValue = "JIBU="+quote(tab.page1.cbxKFJibu.Value); 										// 지부
	parValue += " REGION1="+quote(tab.page1.cbxKFRegion1.Value); 								// 지역1
	parValue += " REGION2="+quote(tab.page1.cbxKFRegion2.Value); 								// 지역2
	//parValue += " COURSE="+quote(tab.page1.cbxKFCourse.Value); 								// 대표직능
	parValue += " COURSE='30'";							 										// 대표직능
	parValue += " COURSED="+quote(tab.page1.cbxKFCourseD.Value);								// 세부직능
	parValue += " MSTATUS="+quote(tab.page1.radKFSelectGubun.Value);							// 검색조건
	parValue += " ROWNUM="+quote(tab.page1.spKFRowNum.value);									// 조회수
	parValue += " DELUSER=1";																	// 삭제자 포함
	parValue += " GUBUN=1";																		// 검색구분 1: 청그리드 조회 , 2:안전원조회버튼
	parValue += " SEARCHBNM="+quote(ds_ioMFFireObjD.GetColumn(0,"SEARCHBNM"));					// 대상물명
	parValue += " SEARCHBNM2="+quote(SEARCHBNM2);											// 대상물명2 (3자)	
	parValue += " SEARCHDONGFNM="+quote(ds_ioMFFireObjD.GetColumn(0,"SEARCHDONGFNM"));			// 동풀네임
	parValue += " SEARCHDONGNM="+quote(ds_ioMFFireObjD.GetColumn(0,"SEARCHDONGNM"));			// 동
	parValue += " SEARCHMAINADDR="+quote(ds_ioMFFireObjD.GetColumn(0,"SEARCHMAINADDR"));		// 주번지
	parValue += " SEARCHSUBADDR="+quote(ds_ioMFFireObjD.GetColumn(0,"SEARCHSUBADDR"));			// 부번지
	parValue += " SEARCHROADNM="+quote(ds_ioMFFireObjD.GetColumn(0,"ROAD_NM"));					// 도로명
	parValue += " SEARCHMAINBDNBR="+quote(ds_ioMFFireObjD.GetColumn(0,"MAIN_BDNBR"));			// 건물번호(주)
	parValue += " SEARCHSECBDNBR="+quote(ds_ioMFFireObjD.GetColumn(0,"SEC_BDNBR"));				// 건물번호(부)	
	parValue += " SERCHNM="+quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"NM"));				// 선임자명
	var vBirthday = "";
	if (length(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM")) > 8) {
		vBirthday = substr(replace(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM"), "-", ""),0,6);
	} else if (length(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM")) == 8) {
		vBirthday = substr(replace(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM"), "-", ""),2,6);
	} else {
		vBirthday = substr(replace(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM"), "-", ""),0,6);
	}
	parValue += " SERCHBIRTHDAY="+quote(vBirthday);	// 선임자 생년월일
	
	// 이미 연계된 대상 	
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") > 0) {
		if( ds_ioFireManagerInfo.GetCount() < 1 || ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMSTATUS") == "1") {
			if(ds_ioMFFireObjD.GetRowCount() > 1) {
				var mgnoValue = "";
				for(var i=0; i < ds_ioMFFireObjD.GetRowCount(); i++) {			
					mgnoValue +="'"+ds_ioMFFireObjD.GetColumn(i,"MMGNO")+"',";
				}			
				parValue += " MMGNO="+quote(substr(mgnoValue,0,Length(mgnoValue)-1));
				parValue += " MMGNOCHK='Y'";
			} else {
				parValue += " MMGNO="+quote(ds_ioMFFireObjD.GetColumn(0,"MMGNO"));
				parValue += " MMGNOCHK='N'";
			}
		} else if( ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMSTATUS") == "1") {
			parValue += " MMGNO="+quote(ds_ioMFFireObjD.GetColumn(0,"MMGNO"));
			parValue += " MMGNOCHK='N'";
		}
	}
	
	lfn_KFSearch(parValue);
}


// 3 안전원 버튼 조회시 
function tab_page1_btnKFSearch_OnClick(obj)
{
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page1.edKFKeyword.Text != "") {		
		if (tab.page1.chkKFPerson.Value == "1") {
			KEYWORD = "%"+tab.page1.edKFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page1.edKFKeyword.Text+"%";
		}
	}
	
	// 파라미터값 
	var parValue = "";
	parValue = "JIBU="+quote(tab.page1.cbxKFJibu.Value); 										// 지부
	parValue += " REGION1="+quote(tab.page1.cbxKFRegion1.Value); 								// 지역1
	parValue += " REGION2="+quote(tab.page1.cbxKFRegion2.Value); 								// 지역2
	//parValue += " COURSE="+quote(tab.page1.cbxKFCourse.Value); 									// 대표직능
	parValue += " COURSE='30'";								 									// 대표직능
	parValue += " COURSED="+quote(tab.page1.cbxKFCourseD.Value);								// 세부직능
	parValue += " MSTATUS="+quote(tab.page1.radKFSelectGubun.Value);							// 검색조건
	parValue += " ROWNUM="+quote(tab.page1.spKFRowNum.value);									// 조회수	
	parValue += " GUBUN=2";																		// 검색구분 1: 청그리드 조회 , 2:안전원조회버튼	
	parValue += " KEYFIELD="+quote(tab.page1.cbxKFKeyfield.Value);								// 키워드 구분
	parValue += " KEYWORD="+quote(KEYWORD);														// 키워드
	parValue += " DELUSER="+quote(tab.page1.chkKFDelUser.Value);								// 삭제자포함
	
	lfn_KFSearch(parValue);
}


// 3 안전원정보조회
function lfn_KFSearch(parValue)
{	
	ds_ioKFFireObj.ClearData(); // 데이타셋 초기화
	ds_ioDangerInfo.ClearData();
	tab.page1.edKFMatch.Text = "";

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6100KFFireObj", false);	

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioKFFireObj=ds_oKFFireObj"	// outDs
		,parValue
		,"lfn_KFAfterSearch"
		,false
		,false
		,true
	);	
}

// 3 lfn_KFSearch 조회후
function lfn_KFAfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 연계관련 버튼 처리 
	lfn_AllMatchBTN("0");
    // 제외버튼처리 
    lfn_KFMatchExceptBTN();
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus("0");
	// 위험물 허가번호 조회 
	lfn_searchDanger(0);
	
    tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();
    lfn_MatchColor(0, "ON");
}

// 4 안전원  클릭시 
function tab_page1_gdKFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 위험물 허가번호 조회 
	lfn_searchDanger(nRow);	
	// 제외버튼처리 
	lfn_KFMatchExceptBTN(nRow);
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus(nRow);
	// 매칭 데이타 비교
	lfn_MatchColor(nRow, "ON");
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(nRow);
}

function lfn_searchDanger(nRow) {
	ds_ioDangerInfo.ClearData(); 	// 위험물부가정보 초기화


    tit_clearActionInfo();
    tit_addCsvSearchActionInfo("cust:searchCust6100DangerInfoList", false);    

    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_ioDangerInfo=ds_ioDangerInfo" // outDs
        , "DBMGNO=" + quote(ds_ioKFFireObj.GetColumn(nRow, "BMGNO")) // 대상물관리번호
        , ""
        ,false
		,false
		,true
    );
}


// 4 연계 버튼 처리 
function lfn_KFMatchExceptBTN(nRow)
{
	var RFLAGEE = "";
	if (nRow == "" || nRow == null) {
		RFLAGEE = ds_ioKFFireObj.GetColumn(0,"RFLAGEE");
	} else {
		RFLAGEE = ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE");
	}
	
	if (RFLAGEE == "0") {
		tab.page1.btnKFMatchCancel.Visible = false;
		tab.page1.btnKFMatchExcept.Visible = true;
	} else if (RFLAGEE == "-1") {
		tab.page1.btnKFMatchCancel.Visible = true;
		tab.page1.btnKFMatchExcept.Visible = false;
	} else if (RFLAGEE > 0) {
		tab.page1.btnKFMatchCancel.Visible = false;
		tab.page1.btnKFMatchExcept.Visible = false;
	} else {
		tab.page1.btnKFMatchCancel.Visible = false;
		tab.page1.btnKFMatchExcept.Visible = false;
	}	
}

// 4 연계  제외 처리 
function lfn_KFMatchExcept(obj)
{	
	if (ds_ioKFFireObj.GetCount() < 1) {
		alert("연계제외대상을 선택해 주세요.");
		return;
	}
	var MEKFSAPK = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO");
	
	if(!gfn_Confirm("'"+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"BNM") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
	
	var parValue = "GUBUN='2' CMGNO="+quote(MEKFSAPK);
	parValue += " EXCEPTCD="+quote(arrNo[0]);
	parValue += " EXCEPTTXT="+quote(arrNo[1]);
	parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    , parValue
		,"lfn_AfterKFMatchExcept"
		,false
		,false
		,true
	);
}

// 4  lfn_KFMatchCancel, lfn_KFMatchExcept 조회후
function lfn_AfterKFMatchExcept(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 연계제외처리후  상태값 변경*/     
	// 연계제외대상 상태 값 -1(연계제외)로 변경 
	ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radKFSelectGubun.Value == "1" || tab.page1.radKFSelectGubun.Value == "2") {		
		setRow = ds_ioKFFireObj.currow;
		ds_ioKFFireObj.Filter("RFLAGEE!='-1'"); // 연계제외대상 필터링 
		tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();  // 총 건수 변경
		ds_ioKFFireObj.row = setRow;
	}
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioKFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN(ds_ioKFFireObj.currow);
		
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus(ds_ioKFFireObj.currow);
}

// 4 연계 제외 취소 
function lfn_KFMatchExceptCancel(obj)
{
	
	if(!gfn_Confirm("'"+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"BNM") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	var parValue = "GUBUN='2' CMGNO="+quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));
	parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterKFMatchCancel"
		,false
		,false
		,true
	);
}

// 4  lfn_KFMatchCancel, lfn_KFMatchExcept 조회후
function lfn_AfterKFMatchCancel(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 연계제외처리취소후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radKFSelectGubun.Value == "3") {
    	setRow = ds_ioKFFireObj.currow;
		ds_ioKFFireObj.Filter("RFLAGEE=='-1'");	// 연계제외대상 필터링 
		tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();  // 총 건수 변경
		ds_ioKFFireObj.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioKFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN(ds_ioKFFireObj.currow);
	
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus();	
}

// 5  신규 연계
function btnNewMatch_OnClick(obj) {
	// 처
	if (ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN") == "" || ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN") == null) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}
	lfn_Match("I");
}

// 5 수정 연계
function btnModMatch_OnClick(obj) {
	// 청
	if (ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN") == "" || ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN") == null) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}
	
	// 안전원 
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO") == "" || ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO") == null) {
		alert("[한국소방안전원] 연계대상을 지정해주세요.");
		return;
	}
	lfn_Match("U");
}

// 5 연계 창 오픈  
function lfn_Match(mode)
{
	var sStatus = mode;
	var sMNFCTRETC_SN = "";
	var sCMGNO = "";	

	// 연계모드 설정
	if (sStatus == "U") {
		sCMGNO = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO");
	}
	
	//  제조소등 관리번호 설정
	sMNFCTRETC_SN = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN");
	
	        
	// 파라미터값 설정 
 	var parValue = "sStatus=" + quote(sStatus); // 연계모드(I : 신규 , U : 수정 )
	parValue += " sMNFCTRETC_SN=" + quote(sMNFCTRETC_SN); // 제조소등관리번호 
	parValue += " sCMGNO=" + quote(sCMGNO);  // 안전원고객관리번호
	parValue += " sAPNTRLSOFC_DE=" + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMINDATE"));  //선임일자
	parValue += " sMNGR_SN= " + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMINMNGR_SN")); // 안전관리자 선임 관리자 번호 
	parValue += " sAPNTRLSOFC_SE=" + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMOUTDATE")); // 선임 해임 구분
	parValue += " sJIBU=" + quote(tab.page1.cbxKFJibu.Value);
	parValue += " sCTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));

	var arrNo = Dialog("cust::frmcust6101PDataConnectionDangerManageSave.xml", parValue , 800, 700, "", -1, -1);
	
	// 변경, 수정이 된경우 
	if (arrNo == "I") {
		// 매치후 처리 
		lfn_MatchAfter(arrNo);
		// 안전원정보 상태값 변경 
		lfn_KFViewStatus();
	} else if(arrNo == "U"){
		// 매치후 처리 
		lfn_MatchAfter(arrNo);
	}
	
	lfn_MatchData();
	
}

// 6 안전원 조회 결과 엑셀 출력 
function tab_page1_btnKFExcel_OnClick(obj)
{
	if (ds_ioKFFireObj.GetCount() > 0) {
		tab.page1.gdKFOBJList.ExportExcelEx("sheet1");
	}	
}

// 7 멀티 정렬을 실행한다.
function tab_page1_btnKFMutilSort_OnClick(obj)
{
	gfn_GridMultiSort(ds_ioKFFireObj, 1); 
}

// 8 즉시 연계 처리 
function lfn_NowMatch(obj)
{  
	/* 변수 선언 */
	var FMMATCH = "N";   // 선임자만 매치할건지 판단 
	var mfNM = ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"NM");  // 소방청 선임자 이름
	var mfBIRTHDAY = "";
	if (length(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM")) > 8) {
		mfBIRTHDAY = substr(replace(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM"), "-", ""),0,6);
	} else if (length(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM")) == 8) {
		mfBIRTHDAY = substr(replace(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM"), "-", ""),2,6);
	} else {
		mfBIRTHDAY = substr(replace(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM"), "-", ""),0,6);
	}
	var kfNM = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"FMNM"); // 안전원 선임자 이름 
	var kfBIRTHDAY = substr(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"FMBIRTHDAY"),0,6);// 안전원 선임자 생년월일
	
	/* 체크 사항 */
	/// 청
	if (ds_ioMFFireObjD.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}

	
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "1") {
		if (ds_ioFireManagerInfo.GetRowCount() > 1) {
			for(var i = 0; i < ds_ioFireManagerInfo.GetRowCount(); i++) {
				if (ds_ioFireManagerInfo.GetColumn(i,"DMSTATUS") == "0") {
					FMMATCH = "Y";
				}
			}
			if (FMMATCH == "N") {
				alert(ORGNM + " 연계된 대상입니다.");
				return;
			}
		} else {			
			alert(ORGNM + " 연계된 대상입니다.");
			return;
		}
	} 
	
	// 안전원 
	if (ds_ioKFFireObj.GetCount() < 1) {
		alert("[한국소방안전원] 연계할 대상을 지정해주세요.");
		return;
	}
	
	/* 선임자 체크 ( 청과 안전원 선임자 일치 여부) */	
	if (mfNM == kfNM && mfBIRTHDAY == kfBIRTHDAY) {	  // 생년월일과 성명이 같은 경우 
		managerMatchYN = "Y";
	} else if (mfNM == kfNM && (mfBIRTHDAY == null || kfBIRTHDAY == null)) {   // 성명이 같고 생년월일이 청 안전원 둘중 하나라도 없는경우 
		managerMatchYN = "Y";
	} else {
		managerMatchYN = "N";
	} 
	
	/* 선임자만 매치시 선임자체크가 FALSE일경우 */
	if (FMMATCH == "Y" && managerMatchYN = "N") {
		alert("연계하려는 대상이 잘못되었습니다.");
		return;
	}
	
	
	
		
	var meg = "        " + ORGNM + " 대상물 : "+ds_ioMFFireObjD.GetColumn(0,"OBJ_NM") +"\n";
	meg += "     [한국소방안전원] 대상물 : "+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"BNM") +"\n";
	meg +="   연계 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}	

	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:insertCust6100Match", "", 0, "");     // 매치테이블
	tit_addSingleActionInfo("cust:insertCust0010AdditionInfo", "", 0, "");   // 부가정보
	
	// 매치 
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));		
		parValue += " FIRECD=" + quote(ds_ioMFFireObjD.GetColumn(0,"CMPN119SCID"));
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		
		parValue += " SBMGNO=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"BMGNO"));
		parValue += " DPERMISSIONNO=" + quote(ds_ioMFFireObjD.GetColumn(0,"PRMISN_NO"));
		parValue += " DREMARK=" + quote("설치(변경)허가번호 : " + ds_ioMFFireObjD.GetColumn(0,"ITL_NO"));
			
		if (ds_ioFireManagerInfo.GetCount() > 0 && managerMatchYN == "Y") {
			parValue += " GUBUN='1'";  //  연계	
			parValue += " DMMGNO=" + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMMGNO"));
		}
		parValue += " FMMATCH=" + quote(FMMATCH);
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		
		// 부가정보 
		parValue += " SCMGNO=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));
		parValue += " ADCD=8";
		if (substr(tab.page1.cbxMFHead.Value,0,2) == "11") {	// 서울본부
			parValue += " ADCONTENT=" + quote("서울소방본부 연계일치화(" + left(GetDate(), 4)+"-"+mid(GetDate(),4,2)+"-"+mid(GetDate(),6,2)+")");
		} else {	// 서울본부 외
			parValue += " ADCONTENT=" + quote("데이터연계 일치화처리(" + left(GetDate(), 4)+"-"+mid(GetDate(),4,2)+"-"+mid(GetDate(),6,2)+")");
		}
	

	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterNowMatch"
		,false
		,false
		,true
	);
}

// 8  lfn_NowMatch 처리 후 
function lfn_AfterNowMatch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter("U");
    
    lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
    lfn_MatchData();    
    
    alert("연계가 완료되었습니다.");
}


// 9 회비교육비
function lfn_SunapEduInfo(obj)
{
	// 안전원 
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO") == "" || ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO") == null) {
		alert("[한국소방안전원] 대상을 지정해주세요.");
		return;
	}
	var sArg  = "sCmgno=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));			// 고객관리번호
	Dialog("cust::frmcust6002MDataSunapEduInfo.xml", sArg, 600, 398, "", -1, -1);

}

// 안전원정보 상태값변경 
function lfn_KFViewStatus(nRow){
	if (nRow == "" || nRow = null){
		nRow = ds_ioKFFireObj.currow;
	}
	
	// 하단상세보기 연계 여부 값입력 
	if(ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page1.edKFMatch.Text = "제외";
	} else if (ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == "0") {
		tab.page1.edKFMatch.Text = "X";
	} else if (ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") > 0){
		tab.page1.edKFMatch.Text = "○";
	} else {
		tab.page1.edKFMatch.Text = "X";
	}
	
	/* 안전원정보 조회 후 상세보기 배경색 변경 */
    // 삭제된 정보 색 표기 	
	if (ds_ioKFFireObj.GetColumn(nRow,"DELGUBUN") == "삭제" || ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page1.Shape2.BkColor = "darkgray";
		tab.page1.Shape3.BkColor = "darkgray";
	} else {
		tab.page1.Shape2.BkColor = "white";
		tab.page1.Shape3.BkColor = "white";
	}
}

// 8 연계해지  처리 
function lfn_CancelMatch(obj)
{  
	
	/* 체크사항 */
	// 청
	if (ds_ioMFFireObjD.GetCount() < 1) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") < 1) {
		alert(ORGNM + " 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 안전원 
	if (ds_ioKFFireObj.GetCount() < 1) {
		alert("[한국소방안전원] 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE") < 1 ) {
		alert("[한국소방안전원] 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 연계 대상 확인
	var chk = 0;
	for (var i = 0; i < ds_ioMFFireObjD.GetCount(); i++) { 
		if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"MMGNO") == ds_ioMFFireObjD.GetColumn(i,"MMGNO") 
		    && ds_ioDangerInfo.GetColumn(ds_ioDangerInfo.currow,"MFPIS1") == ds_ioMFFireObjD.GetColumn(i,"MNFCTRETC_SN")
		    && ds_ioDangerInfo.GetColumn(ds_ioDangerInfo.currow,"DPERMISSIONNO") == ds_ioMFFireObjD.GetColumn(i,"PRMISN_NO")
		) {
			chk++;
		}
	}	
	if (chk < 1) {
		alert("잘못된 연계대상입니다.");
		return;
	}
	
	// 선임자 연계대상이 존재 할때는 선임자를 선택하도록 
	if (ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT")  > 0) {
		if (ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMSTATUS") < "1") {
			alert("연계된 선임자가 있습니다. 선임자를 선택해주세요"); 
			return;
		} else {
			if (ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"NM")
				!= ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"FMNM")) {
				alert("대상물의 연계된 선임자가 아닙니다. 연계된 선임자를 선택해주세요."); 
				return;
			}
		}
	}

	var meg = "        " + ORGNM + " 허가번호 : "+ds_ioMFFireObjD.GetColumn(0,"PRMISN_NO") +"\n";
	meg += "     [한국소방안전원] 허가번호 : "+ds_ioDangerInfo.GetColumn(ds_ioDangerInfo.currow,"DPERMISSIONNO") +"\n";
	meg +="   연계해지 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}
	
	// 연계해지 사유 
	var cancelReason = Dialog("cust::frmcust5011.xml", "", 520, 188, "", -1, -1);	
	if (cancelReason == "" || cancelReason == null) {
		alert("연계 사유를 입력해 주세요");
		return;
	}
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchCancel", "", 0, "");     // 연계취소 
	tit_addSingleActionInfo("cust:insertCust0010AdditionInfo", "", 0, "");   // 부가정보
	
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));		
		parValue += " MMGNO=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"MMGNO"));
		parValue += " DBMGNO=" + quote(ds_ioDangerInfo.GetColumn(ds_ioDangerInfo.currow,"DBMGNO"));
		parValue += " DSEQ=" + quote(ds_ioDangerInfo.GetColumn(ds_ioDangerInfo.currow,"DSEQ"));
		parValue += " MDELREMARK=" + quote(cancelReason);
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		parValue += " MGUBUN='1'";   // 허가번호 처리 구분
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		
		if (ds_ioFireManagerInfo.GetCount() > 0 && ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMSTATUS") == "1") {
			parValue += " GUBUN='1'"; 
			parValue += " DMMGNO=" + quote(ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMMGNO"));
		}
		
		if (ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT")  > 1) {
			parValue += " FMMATCH='Y'";
		}		
		
		// 부가정보
		parValue += " SCMGNO=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));
		parValue += " ADCD=8";
		parValue += " ADCONTENT=" + quote("[연계해지사유]" + cancelReason);
		
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterCancelMatch"
		,false
		,false
		,true
	);
}

// 8  lfn_CancelMatch 처리 후 
function lfn_AfterCancelMatch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter("C");

	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
    lfn_MatchData();
    
    alert("연계해지가 완료되었습니다.");
    
}


/*============================================	연계후 처리   =================================*/

function lfn_MatchAfter(mode) {
	if (mode == "I") {
		var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
		var MANAGERMATCHCNT = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT");
		
		MFSTATUS++;
		MANAGERMATCHCNT++;
		
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT",MANAGERMATCHCNT);
			
		// 필터링
		if(tab.page1.radMFSelectGubun.Value == "1" || tab.page1.radMFSelectGubun.Value == "3") {
			setRow = ds_ioMFFireObj.currow;
			ds_ioMFFireObj.Filter("MSTATUS1!='1'");
			tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
			ds_ioMFFireObj.row = setRow;
		}
	} else if (mode == "U") {
		var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
		var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
		var MANAGERMATCHCNT = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT");
		
		MFSTATUS++;
		KFSTATUS++;
		
		// 선임자 연계 시에만 처리 
		if(managerMatchYN == "Y") {
			MANAGERMATCHCNT++;
		}
		managerMatchYN = "";
		
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
		ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT",MANAGERMATCHCNT);
		
	
		// 필터링
		if(tab.page1.radMFSelectGubun.Value == "1" || tab.page1.radMFSelectGubun.Value == "3") {
			setRow = ds_ioMFFireObj.currow;
			ds_ioMFFireObj.Filter("MSTATUS!='1'");
			tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
			ds_ioMFFireObj.row = setRow;
		}
		
		if(tab.page1.radKFSelectGubun.Value == "1" || tab.page1.radKFSelectGubun.Value == "3") {
			setRow = ds_ioKFFireObj.currow;
			ds_ioKFFireObj.Filter("RFLAGEE>='1'");
			tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();
			ds_ioKFFireObj.row = setRow;
		}

	} else if (mode == "C") {
		// 상태값 
		var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
		var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
		var MANAGERMATCHCNT = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT");
		
		// 감소		
		KFSTATUS--;		
		MFSTATUS--;
		if (MANAGERMATCHCNT > 0) {
			MANAGERMATCHCNT--;
		}
		
		// 적용 
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
		ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);		
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT",MANAGERMATCHCNT);
	
		// 필터링
		if(tab.page1.radMFSelectGubun.Value == "2" || tab.page1.radMFSelectGubun.Value == "3") {
			setRow = ds_ioMFFireObj.currow;
			ds_ioMFFireObj.Filter("MSTATUS=='1'");
			tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
			ds_ioMFFireObj.row = setRow;
		}
		
		if(tab.page1.radKFSelectGubun.Value == "2" || tab.page1.radKFSelectGubun.Value == "3") {
			setRow = ds_ioKFFireObj.currow;
			ds_ioKFFireObj.Filter("RFLAGEE=='0'");
			tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();
			ds_ioKFFireObj.row = setRow;
		}

	}
	
	// 매치후 처리 
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}


/*============================================	조건 처리   =================================*/

function lfn_MatchCancelAfter() {
	var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
	var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
	
	MFSTATUS--;
	KFSTATUS--;
	ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
	ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);
	
	// 필터링
	if(tab.page1.radMFSelectGubun.Value == "1") {
		setRow = ds_ioMFFireObj.currow;
		ds_ioMFFireObj.Filter("MNFCTRETC_SN!="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN")));
		ds_ioMFFireObj.row = setRow;
	}
	
	
	if(tab.page1.radKFSelectGubun.Value == "1") {
		setRow = ds_ioKFFireObj.currow;
		ds_ioKFFireObj.Filter("CMGNO!="+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));
		ds_ioKFFireObj.row = setRow;
	}
	
	// 매치후 처리 
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

// 청 조회조건변경(연계구분)
function tab_page1_radMFSelectGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance("12");
}

// 청 조회조건변경 (대상물)
function tab_page1_cbxMFObjGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance("14");
}
// 청 조회조건변경 (공공기관)
function tab_page1_cbxMFPBLINSTT_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance("14");
}


function lfn_SearchBalance(gubun){
	if (gubun == "11") {		
		var row = ds_oFireHead.FindRow("CD", tab.page1.cbxMFHead.Value);
		tab.page1.cbxKFJibu.Value = ds_oFireHead.GetColumn(row,"JIBUCD");
		lfn_JibuChange(tab.page1.cbxKFJibu.Value);
	} else if (gubun == "12") {
		tab.page1.radKFSelectGubun.Value = tab.page1.radMFSelectGubun.Value;
	} else if (gubun == "14") {
		if (tab.page1.cbxMFObjGubun.Value == "P02090100" && tab.page1.cbxMFPBLINSTT.Value == "Y") {
			tab.page1.cbxKFCourseD.Index = 3;
		} else if (tab.page1.cbxMFObjGubun.Value == "P02090100" && tab.page1.cbxMFPBLINSTT.Value == "N") {
			tab.page1.cbxKFCourseD.Index = 1;
		} else if (tab.page1.cbxMFObjGubun.Value == "P02090200" && tab.page1.cbxMFPBLINSTT.Value == "Y") {
			tab.page1.cbxKFCourseD.Index = 4;
		} else if (tab.page1.cbxMFObjGubun.Value == "P02090200" && tab.page1.cbxMFPBLINSTT.Value == "N") {
			tab.page1.cbxKFCourseD.Index = 2;
		} else {
			tab.page1.cbxKFCourseD.Index = 0;
		}
	}
}

/*============================================	연계 처리 버튼   =================================*/

function lfn_AllMatchBTN(nRow) {
	var MRow = "";
	var KRow = "";	
	if (ds_ioFireManagerInfo.GetCount() > 0) { MRow = ds_ioFireManagerInfo.currow;}
	if (ds_ioKFFireObj.GetCount() > 0) { KRow = ds_ioKFFireObj.currow; }
	
	// 기본
	tab.page1.btnDanger.Enable = false;
	tab.page1.btnMatchCancel.Enable = false;
	tab.page1.btnMatch.Enable = false;
	tab.page1.btnNewMatch.Enable = false;
	tab.page1.btnModMatch.Enable = false;
	
		
	// 허가버튼 활성화 
	if (
		ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == 0 
		&& ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") > 0
	   ) 
	{		
		tab.page1.btnDanger.Enable = true;
	} else {
		tab.page1.btnDanger.Enable = false;
	}
	
	// 연계해지 버튼 활성화 
	if (
		ds_ioMFFireObjD.GetColumn(0,"MSTATUS") > 0 
		//&& (ds_ioFireManagerInfo.GetColumn(MRow,"DMSTATUS") == 1 || ds_ioFireManagerInfo.GetCount() < 1)
		&& ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") > 0
	   )
	{
		tab.page1.btnMatchCancel.Enable = true;
	} else {
		tab.page1.btnMatchCancel.Enable = false;
	}
	
	// 수정없이 연계처리 활성화 , 수정연계 
	if (
		ds_ioMFFireObjD.GetColumn(0,"MSTATUS") >= 0 
		&& (ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMSTATUS") == 0 || ds_ioFireManagerInfo.GetCount() < 1)
		&& ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == 0
	   )
	{
		tab.page1.btnMatch.Enable = true;
		tab.page1.btnModMatch.Enable = true;
	} else {
		tab.page1.btnMatch.Enable = false;
		tab.page1.btnModMatch.Enable = false;
	}
	
	// 신규연계등록
	if (
		ds_ioMFFireObj.GetCount() > 0
		&& ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS") == 0
		&& (ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"DMSTATUS") == 0 || ds_ioFireManagerInfo.GetCount() = 0)
	   )
	{
		tab.page1.btnNewMatch.Enable = true;
	} else {
		tab.page1.btnNewMatch.Enable = false;
	}
}

/*============================================	매칭 컬러 처리    =================================*/

function lfn_MatchColor(nRow, mode) {
	if (mode == "ON") {
	
		// 대상물
		var SEARCHBNM = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"OBJ_NM");
		var BNM = ds_ioKFFireObj.GetColumn(nRow,"BNM");
		
		SEARCHBNM = trim(SEARCHBNM);
		BNM = trim(BNM);
		
		if (SEARCHBNM == BNM) {
			if (SEARCHBNM == null || SEARCHBNM = "") {
				tab.page1.edMFOBJ_NM.BKColor = "white";
				tab.page1.edKFBNM.BKColor = "white";
			} else {
				tab.page1.edMFOBJ_NM.BKColor = "lightskyblue";
				tab.page1.edKFBNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFOBJ_NM.BKColor = "white";
			tab.page1.edKFBNM.BKColor = "white";
		}
		
		
		// 동명(풀네임)
		var SEARCHDONGFNM = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"SEARCHDONGFNM");
		var BADDRDONGFNM = ds_ioKFFireObj.GetColumn(nRow,"BADDRDONGFNM");
		
		SEARCHDONGFNM = trim(SEARCHDONGFNM);
		BADDRDONGFNM = trim(BADDRDONGFNM);
		
		if (SEARCHDONGFNM == BADDRDONGFNM) {
			if (SEARCHDONGFNM == null || SEARCHDONGFNM = "") {
				tab.page1.edMFFDong.BKColor = "white";
				tab.page1.edKFFDong.BKColor = "white";
			} else {
				tab.page1.edMFFDong.BKColor = "lightskyblue";
				tab.page1.edKFFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFFDong.BKColor = "white";
			tab.page1.edKFFDong.BKColor = "white";
		}
		
		
		// 동명(숏네임)
		var SEARCHDONGNM = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"SEARCHDONGNM");
		var BADDRDONGNM = ds_ioKFFireObj.GetColumn(nRow,"BADDRDONGNM");
		
		SEARCHDONGNM = trim(SEARCHDONGNM);
		BADDRDONGNM = trim(BADDRDONGNM);
		
		if (SEARCHDONGNM == BADDRDONGNM) {
			if (SEARCHDONGNM == null || SEARCHDONGNM = "") {
				tab.page1.edMFDong.BKColor = "white";
				tab.page1.edKFDong.BKColor = "white";
			} else {
				tab.page1.edMFDong.BKColor = "lightskyblue";
				tab.page1.edKFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFDong.BKColor = "white";
			tab.page1.edKFDong.BKColor = "white";
		}
		
		
		// 주번지
		var SEARCHMAINADDR = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"SEARCHMAINADDR");
		var BADDRMAINNM = ds_ioKFFireObj.GetColumn(nRow,"BADDRMAINNM");
		
		SEARCHMAINADDR = trim(SEARCHMAINADDR);
		BADDRMAINNM = trim(BADDRMAINNM);
		
		if (SEARCHMAINADDR == BADDRMAINNM) {
			if (SEARCHMAINADDR == null || SEARCHMAINADDR = "") {
				tab.page1.edMFMainAddr.BKColor = "white";
				tab.page1.edKFMainAddr.BKColor = "white";
			} else {
				tab.page1.edMFMainAddr.BKColor = "lightskyblue";
				tab.page1.edKFMainAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFMainAddr.BKColor = "white";
			tab.page1.edKFMainAddr.BKColor = "white";
		}
		
		
		// 부번지
		var SEARCHSUBADDR = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"SEARCHSUBADDR");
		var BADDRSUBNM = ds_ioKFFireObj.GetColumn(nRow,"BADDRSUBNM");
		
		SEARCHSUBADDR = trim(SEARCHSUBADDR);
		BADDRSUBNM = trim(BADDRSUBNM);
		
		if (SEARCHSUBADDR == BADDRSUBNM) {
			if (SEARCHSUBADDR == null || SEARCHSUBADDR = "") {
				tab.page1.edMFSubAddr.BKColor = "white";
				tab.page1.edKFSubAddr.BKColor = "white";
			} else {
				tab.page1.edMFSubAddr.BKColor = "lightskyblue";
				tab.page1.edKFSubAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFSubAddr.BKColor = "white";
			tab.page1.edKFSubAddr.BKColor = "white";
		}
		
		// 도로명
		var SEARCHROADNM = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"ROAD_NM");
		var BROADNM = ds_ioKFFireObj.GetColumn(nRow,"RROADNM");
		
		SEARCHROADNM = trim(SEARCHROADNM);
		BROADNM = trim(BROADNM);

		if (SEARCHROADNM == BROADNM) {
			if (SEARCHROADNM == null || SEARCHROADNM = "") {
				tab.page1.edMFRoadNM.BKColor = "white";
				tab.page1.edKFRoadNM.BKColor = "white";
			} else {
				tab.page1.edMFRoadNM.BKColor = "lightskyblue";
				tab.page1.edKFRoadNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFRoadNM.BKColor = "white";
			tab.page1.edKFRoadNM.BKColor = "white";
		}		
		
	
		// 건물번호1
		var SEARCHMAINNO = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"MAIN_BDNBR");
		var BMAINNO = ds_ioKFFireObj.GetColumn(nRow,"RBUILDMAINNO");
		
		SEARCHMAINNO = trim(SEARCHMAINNO);
		BMAINNO = trim(BMAINNO);
		
		if (SEARCHMAINNO == BMAINNO) {
			if (SEARCHMAINNO == null || SEARCHMAINNO = "") {
				tab.page1.edMFMainNO.BKColor = "white";
				tab.page1.edKFMainNO.BKColor = "white";
			} else {
				tab.page1.edMFMainNO.BKColor = "lightskyblue";
				tab.page1.edKFMainNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFMainNO.BKColor = "white";
			tab.page1.edKFMainNO.BKColor = "white";
		}		
		
		// 건물번호2
		var SEARCHSUBNO = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"SEC_BDNBR");
		var BSUBNO = ds_ioKFFireObj.GetColumn(nRow,"RBUILDSUBNO");
		
		SEARCHSUBNO = trim(SEARCHSUBNO);
		BSUBNO = trim(BSUBNO);
		
		if (SEARCHSUBNO == BSUBNO) {
			if (SEARCHSUBNO == null || SEARCHSUBNO = "") {
				tab.page1.edMFSubNO.BKColor = "white";
				tab.page1.edKFSubNO.BKColor = "white";
			} else {
				tab.page1.edMFSubNO.BKColor = "lightskyblue";
				tab.page1.edKFSubNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFSubNO.BKColor = "white";
			tab.page1.edKFSubNO.BKColor = "white";
		}	
		
		// 선임자명
		var NM = ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"NM");
		var FMNM = ds_ioKFFireObj.GetColumn(nRow,"FMNM");
		
		NM = trim(NM);
		FMNM = trim(FMNM);
				
		if (NM  == FMNM) {
			if (NM == null || NM = "") {
				tab.page1.edKFFMNM.BKColor = "white";
			} else {
				tab.page1.edKFFMNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edKFFMNM.BKColor = "white";
		}
		
		
		// 선임자주민번호
		var IHIDNUM = ds_ioFireManagerInfo.GetColumn(ds_ioFireManagerInfo.currow,"IHIDNUM");
		var FMBIRTHDAY = ds_ioKFFireObj.GetColumn(nRow,"FMBIRTHDAY");
		var FMPERSONKEY = ds_ioKFFireObj.GetColumn(nRow,"FMPERSONKEY");
		
		if (length(IHIDNUM) > 8) {
			IHIDNUM = substr(trim(IHIDNUM),0,6);
		} else if (length(IHIDNUM) == 8) {
			IHIDNUM = substr(trim(IHIDNUM),2,6);
		} else {
			IHIDNUM = substr(trim(IHIDNUM),0,6);
		}
		FMBIRTHDAY = substr(trim(FMBIRTHDAY),0,6);
		
		if (IHIDNUM == FMBIRTHDAY) {
			if (IHIDNUM == null || IHIDNUM = "") {
				tab.page1.edKFFMBIRTHDAY.BKColor = "white";
			} else {
				tab.page1.edKFFMBIRTHDAY.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edKFFMBIRTHDAY.BKColor = "white";
		}
		
	} else {
		tab.page1.edMFOBJ_NM.BKColor = "white";
		tab.page1.edKFBNM.BKColor = "white";
		tab.page1.edMFFDong.BKColor = "white";
		tab.page1.edKFFDong.BKColor = "white";
		tab.page1.edMFDong.BKColor = "white";
		tab.page1.edKFDong.BKColor = "white";
		tab.page1.edMFMainAddr.BKColor = "white";
		tab.page1.edKFMainAddr.BKColor = "white";
		tab.page1.edMFSubAddr.BKColor = "white";
		tab.page1.edKFSubAddr.BKColor = "white";
		tab.page1.edMFRoadNM.BKColor = "white";
		tab.page1.edKFRoadNM.BKColor = "white";
		tab.page1.edMFMainNO.BKColor = "white";
		tab.page1.edKFMainNO.BKColor = "white";
		tab.page1.edMFSubNO.BKColor = "white";
		tab.page1.edKFSubNO.BKColor = "white";
		tab.page1.edKFFMNM.BKColor = "white";
		tab.page1.edKFFMBIRTHDAY.BKColor = "white";
		tab.page1.edKFFMPersonKey.BKColor = "white";
	}	
}

/*============================================	엔터키    =================================*/
					
function tab_page1_edMFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) { // Enter Key
		lfn_MFSearch();
	}
}

function tab_page1_edKFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) { // Enter Key
		tab_page1_btnKFSearch_OnClick();
	}
}


/*************************************************************************************************************
													안전원기준 
**************************************************************************************************************/

/*============================================	소방 안전 안전원=================================*/

// 지부변경 
function tab_page2_cbxKFJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance2("11");
	lfn_JibuChange(strCode);
}


// 안전원정보 그리드 원클릭!
function tab_page2_gdKFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 위험물 허가번호 조회 
	lfn_searchDanger2(nRow);	
	
	// 제외버튼처리 
	lfn_KFMatchExceptBTN2(nRow);
	
	// 청조회정보초기화 
	ds_ioFireManagerInfo2.ClearData();
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.edMFCount.Text = "";
	tab.page2.btnMFMatchExcept.Visible = false;
	tab.page2.btnMFMatchCancel.Visible = false;
	lfn_MatchColor2();
	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2();
	
	// 하단상세보기 연계 여부 값입력 
	if(ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page2.edKFMatch.Text = "제외";
	} else if (ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "0") {
		tab.page2.edKFMatch.Text = "X";
	} else if (ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") > 0){
		tab.page2.edKFMatch.Text = "○";
	} else {
		tab.page2.edKFMatch.Text = "X";
	}
	
	// 삭제된 정보 색 표기 	
	if (ds_ioKFFireObj2.GetColumn(nRow,"DELGUBUN") == "삭제"
		|| ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page2.Shape2.BkColor = "darkgray";
		tab.page2.Shape3.BkColor = "darkgray";
	} else {
		tab.page2.Shape2.BkColor = "white";
		tab.page2.Shape3.BkColor = "white";
	}
}

// 안전원정보 그리드 더블 클릭!
function tab_page2_gdKFOBJList_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 제외 여부 체크 
	if(ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == -1) {
		alert("제외 대상물입니다.");
		tab.page2.btnMatch.Enable = false;
		tab.page2.btnMatchCancel.Enable = false;
		tab.page2.btnModMatch.Enable = false;
		return;
	}
	
	// 대상물을 3글자 조회 
	var SEARCHBNM2 = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BSEARCHNM");	
		SEARCHBNM2 = substr(SEARCHBNM2,0,3);	

	var parValue = "CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
		parValue += " BONBUCD=" + quote(tab.page2.cbxMFHead.Value);				// 본부코드
		parValue += " STATION=" + quote(tab.page2.cbxMFStation.Value);			//  소방 서 
		parValue += " CENTER=" + quote(tab.page2.cbxMFCenter.Value); 			// 소방 센터 
		parValue += " MNFCTRETCCODE=" + quote(tab.page2.cbxMFMnfctretcGubun.Value);		// 제조소등 구분
		parValue += " MNFCTRETCCODED=" + quote(tab.page2.cbxMFMnfctretcGubunD.Value);	// 제조소등 상세구분
		parValue += " MODDATE1=" + quote(tab.page2.medMFModDate1.Value);		// 변경일자1
		parValue += " MODDATE2=" + quote(tab.page2.medMFModDate2.Value);		// 변경일자 2
		parValue += " MSTATUS=" + quote(tab.page2.radMFSelectGubun.Value);		// 검색
		parValue += " ROWNUM=" + quote(tab.page2.spMFRowNum.value);				// 조회수
		parValue += " GUBUN=1";																		// 검색구분 1: 안전원 그리드  조회 , 2:청 조회버튼
		parValue += " SEARCHBNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BSEARCHNM"));					// 대상물명
		parValue += " SEARCHBNM2="+quote(SEARCHBNM2);											// 대상물명2 (3자)	
		parValue += " SEARCHDONGFNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRDONGFNM"));			// 동풀네임
		parValue += " SEARCHDONGNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRDONGNM"));			// 동
		parValue += " SEARCHMAINADDR="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRMAINNM"));		// 주번지
		parValue += " SEARCHSUBADDR="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRSUBNM"));			// 부번지
		parValue += " SEARCHROADNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RROADNM"));					// 도로명
		parValue += " SEARCHMAINBDNBR="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RBUILDMAINNO"));			// 건물번호(주)
		parValue += " SEARCHSECBDNBR="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RBUILDSUBNO"));				// 건물번호(부)	
		parValue += " SERCHNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMNM"));				// 선임자명
		parValue += " SERCHBIRTHDAY="+quote(substr(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMBIRTHDAY"),0,6));	// 선임자 생년월일
		parValue += " SERCHPERSONKEY="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMPERSONKEY"));	// 선임자 개인식별번호		
		
	// 연계된 대상인 경우
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") > 0) {
		parValue += " MKFSAPK="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));
	}
	
	
	lfn_MFSearch2(parValue);
}


//  안전원조회
function lfn_KFSearch2()
{	
	ds_ioKFFireObj2.ClearData(); // 데이타셋 초기화
	ds_ioDangerInfo2.ClearData();
	tab.page2.edKFMatch.Text = "";
	
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page2.edKFKeyword.Text != "") {		
		if (tab.page2.chkKFPerson.Value == "1") {
			KEYWORD = "%"+tab.page2.edKFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page2.edKFKeyword.Text+"%";
		}
	}
	
	// 파라미터값 
	var parValue = "";
	parValue = "JIBU="+quote(tab.page2.cbxKFJibu.Value); 										// 지부
	parValue += " REGION1="+quote(tab.page2.cbxKFRegion1.Value); 								// 지역1
	parValue += " REGION2="+quote(tab.page2.cbxKFRegion2.Value); 								// 지역2
	//parValue += " COURSE="+quote(tab.page1.cbxKFCourse.Value); 									// 대표직능
	parValue += " COURSE='30'";								 									// 대표직능
	parValue += " COURSED="+quote(tab.page2.cbxKFCourseD.Value);								// 세부직능
	parValue += " MSTATUS="+quote(tab.page2.radKFSelectGubun.Value);							// 검색조건
	parValue += " ROWNUM="+quote(tab.page2.spKFRowNum.value);									// 조회수	
	parValue += " GUBUN=2";																		// 검색구분 1: 청그리드 조회 , 2:안전원조회버튼	
	parValue += " KEYFIELD="+quote(tab.page2.cbxKFKeyfield.Value);								// 키워드 구분
	parValue += " KEYWORD="+quote(KEYWORD);														// 키워드
	parValue += " DELUSER="+quote(tab.page2.chkKFDelUser.Value);								// 삭제자포함

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6100KFFireObj2", false);	

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioKFFireObj2=ds_oKFFireObj"	// outDs
		,parValue
		,"lfn_KFAfterSearch2"
		,false
		,false
		,true
	);	
}

// lfn_KFSearch2 조회후 처리 
function lfn_KFAfterSearch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 청조회정보초기화 
	ds_ioFireManagerInfo2.ClearData();
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.btnMFMatchExcept.Visible = false;
	tab.page2.btnMFMatchCancel.Visible = false;
	tab.page2.edMFCount.Text = "";
	
	// 위험물 허가번호 조회 
	lfn_searchDanger2(0);
	
	// 제외버튼처리 
	lfn_KFMatchExceptBTN2(0);
	
    tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();
    
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus2("0");
}

// 허가번호 조회 
function lfn_searchDanger2(nRow) {
	ds_ioDangerInfo2.ClearData(); 	// 위험물부가정보 초기화


    tit_clearActionInfo();
    tit_addCsvSearchActionInfo("cust:searchCust6100DangerInfoList", false);    

    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_ioDangerInfo2=ds_ioDangerInfo" // outDs
        , "DBMGNO=" + quote(ds_ioKFFireObj2.GetColumn(nRow, "BMGNO")) // 대상물관리번호
        , ""
        ,false
		,false
		,true
    );
}

//  연계  제외 처리 
function lfn_KFMatchExcept2(obj)
{	
	var MEKFSAPK = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO");
	if(!gfn_Confirm("'"+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BNM") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
	
	var parValue = "GUBUN='2' CMGNO="+quote(MEKFSAPK);	
	parValue += " EXCEPTCD="+quote(arrNo[0]);
	parValue += " EXCEPTTXT="+quote(arrNo[1]);
	parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    , parValue
		,"lfn_AfterKFMatchExcept2"
		,false
		,false
		,true
	);
}

// lfn_KFMatchExcept2 조회후
function lfn_AfterKFMatchExcept2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 청조회정보초기화 
	ds_ioFireManagerInfo2.ClearData();
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.btnMFMatchExcept.Visible = false;
	tab.page2.btnMFMatchCancel.Visible = false;
	tab.page2.edMFCount.Text = "";
	
    /* 연계제외처리후  상태값 변경*/     
	// 연계제외대상 상태 값 -1(연계제외)로 변경 
	ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radKFSelectGubun.Value == "1" || tab.page2.radKFSelectGubun.Value == "2") {
		setRow = ds_ioKFFireObj2.currow;	
		ds_ioKFFireObj2.Filter("RFLAGEE!='-1'"); // 연계제외대상 필터링 
		tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();  // 총 건수 변경
		ds_ioKFFireObj2.row = setRow;
	}
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioKFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN2(ds_ioKFFireObj2.currow);
		
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus2(ds_ioKFFireObj2.currow);
}

//  연계 제외 취소 
function lfn_KFMatchExceptCancel2(obj)
{
	
	if(!gfn_Confirm("'"+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BNM") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	var parValue = "GUBUN='2' CMGNO="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));
        parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
        
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterKFMatchCancel2"
		,false
		,false
		,true
	);
}

// lfn_KFMatchExceptCancel2 조회후
function lfn_AfterKFMatchCancel2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 청조회정보초기화 
	ds_ioFireManagerInfo2.ClearData();
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.edMFCount.Text = "";
	tab.page2.btnMFMatchExcept.Visible = false;
	tab.page2.btnMFMatchCancel.Visible = false;
    
    /* 연계제외처리취소후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radKFSelectGubun.Value == "3") {
		setRow = ds_ioKFFireObj2.currow;
		ds_ioKFFireObj2.Filter("RFLAGEE=='-1'");	// 연계제외대상 필터링 
		tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();  // 총 건수 변경
		ds_ioKFFireObj2.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioKFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN2(ds_ioKFFireObj2.currow);
	
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus2();	
}


// 안전원정보 상태값변경 
function lfn_KFViewStatus2(nRow){
	if (nRow == "" || nRow = null){
		nRow = ds_ioKFFireObj2.currow;
	}
	
	// 하단상세보기 연계 여부 값입력 
	if(ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page2.edKFMatch.Text = "제외";
	} else if (ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "0") {
		tab.page2.edKFMatch.Text = "X";
	} else if (ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") > 0){
		tab.page2.edKFMatch.Text = "○";
	} else {
		tab.page2.edKFMatch.Text = "X";
	}
	
	/* 안전원정보 조회 후 상세보기 배경색 변경 */
    // 삭제된 정보 색 표기 	
	if (ds_ioKFFireObj2.GetColumn(nRow,"DELGUBUN") == "삭제" || ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page2.Shape2.BkColor = "darkgray";
		tab.page2.Shape3.BkColor = "darkgray";
	} else {
		tab.page2.Shape2.BkColor = "white";
		tab.page2.Shape3.BkColor = "white";
	}
}

//  연계 제외 버튼 처리 
function lfn_KFMatchExceptBTN2(nRow)
{
	var RFLAGEE = "";
	if (nRow == "" || nRow == null) {
		RFLAGEE = ds_ioKFFireObj2.GetColumn(0,"RFLAGEE");
	} else {
		RFLAGEE = ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE");
	}
	
	if (RFLAGEE == "0") {
		tab.page2.btnKFMatchCancel.Visible = false;
		tab.page2.btnKFMatchExcept.Visible = true;
	} else if (RFLAGEE == "-1") {
		tab.page2.btnKFMatchCancel.Visible = true;
		tab.page2.btnKFMatchExcept.Visible = false;
	} else if (RFLAGEE > 0) {
		tab.page2.btnKFMatchCancel.Visible = false;
		tab.page2.btnKFMatchExcept.Visible = false;
	} else {
		tab.page2.btnKFMatchCancel.Visible = false;
		tab.page2.btnKFMatchExcept.Visible = false;
	}
}

// 회비교육비
function lfn_SunapEduInfo2(obj)
{
	// 안전원 
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO") == "" || ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO") == null) {
		alert("[한국소방안전원] 대상을 지정해주세요.");
		return;
	}
	var sArg  = "sCmgno=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));			// 고객관리번호
	Dialog("cust::frmcust6002MDataSunapEduInfo.xml", sArg, 600, 398, "", -1, -1);

}

// 엑셀
function tab_page2_btnKFExcel_OnClick(obj)
{
	if (ds_ioKFFireObj2.GetCount() > 0) {
		tab.page2.gdKFOBJList.ExportExcelEx("sheet1");
	}	
}

/*============================================	국민인전처  =================================*/

// 쳥그리드 원클릭
function tab_page2_gdMFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 매칭 컬러 
	lfn_MatchColor2("ON");
	
	// 연계 제외 여부 버튼 처리 
	lfn_MFMatchExceptBTN2(nRow);
	
	// 청정보 상세조회 
	lfn_MFObjInfoSearch2(nRow);
}

function tab_page2_btnMFSearch_OnClick(obj)
{
		// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page2.edMFKeyword.Text != "") {		
		if (tab.page2.chkMFPerson.Value == "1") {
			KEYWORD = "%"+tab.page2.edMFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page2.edMFKeyword.Text+"%";
		}
	}
	
	
	var parValue = "CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
		parValue += " BONBUCD=" + quote(tab.page2.cbxMFHead.Value);				// 본부코드
		parValue += " STATION=" + quote(tab.page2.cbxMFStation.Value);			//  소방 서 
		parValue += " CENTER=" + quote(tab.page2.cbxMFCenter.Value); 			// 소방 센터 
		parValue += " MNFCTRETCCODE=" + quote(tab.page2.cbxMFMnfctretcGubun.Value);		// 제조소등 구분
		parValue += " MNFCTRETCCODED=" + quote(tab.page2.cbxMFMnfctretcGubunD.Value);	// 제조소등 상세구분
		parValue += " MODDATE1=" + quote(tab.page2.medMFModDate1.Value);		// 변경일자1
		parValue += " MODDATE2=" + quote(tab.page2.medMFModDate2.Value);		// 변경일자 2
		parValue += " MSTATUS=" + quote(tab.page2.radMFSelectGubun.Value);		// 검색
		parValue += " ROWNUM=" + quote(tab.page2.spMFRowNum.value);				// 조회수		
		parValue += " KEYFIELD=" + quote(tab.page2.cbxMFKeyfield.Value);		// 검색 필드
		parValue += " KEYWORD=" + quote(KEYWORD);								// 검색어 
		parValue += " GUBUN=2";	 // 청 버튼 조회 
	
	lfn_MFSearch2(parValue);
}

// 청자료 조회 
function lfn_MFSearch2(parValue)
{
	// 안전원 정보 초기 화 	
	ds_ioMFFireObj2.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD2.ClearData(); // 데이타셋 초기화
	ds_ioFireManagerInfo2.ClearData(); // 데이타셋 초기화
	tab.page2.edMFMatch.Text = "";

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6100MFDangerAdmin2", false);	

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObj2=ds_oMFFireObj"	// outDs
		,parValue
		,"lfn_MFAfterSearch2"
		,false
		,false
		,true
	);
}


// lfn_MFSearch 조회후
function lfn_MFAfterSearch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
      
    tab.page2.edMFCount.Text = ds_ioMFFireObj2.GetCount();
    
    lfn_MFMatchExceptBTN2();
    
    // 조회로그 남기기 
    logWrite("3");
    
    // 청정보 상세조회 
    lfn_MFObjInfoSearch2("0");
}

// 청정보 상세조회 
function lfn_MFObjInfoSearch2(nRow)
{
	ds_ioFireManagerInfo2.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD2.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("cust:searchCust6100MFDangerAdminD2", false);
	tit_addSearchActionInfo("cust:searchCust6100MFDangerAdminManager", false);

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObjD2=ds_oMFFireObjD ds_ioFireManagerInfo2=ds_oFireManagerInfo"	// outDs
		,"MNFCTRETC_SN=" + quote(ds_ioMFFireObj2.GetColumn(nRow,"MNFCTRETC_SN")) 
		+ " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2))		// 지역코드
		,"lfn_MFFMAfterSearch2"
		,false
		,false
		,true
	);
}

//  lfn_MFFireManagerSearch2 조회후
function lfn_MFFMAfterSearch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    if (ds_ioMFFireObjD2.GetCount() > 0) {
		// 조회로그 남기기 
		detailLogWrite("K");
    }
    
    
    // 매칭 컬러 
	lfn_MatchColor2("ON");
    
    // 연계 처리 관련버튼 처리
	lfn_AllMatchBTN2();
    
    // 하단상세보기 연계 여부 값입력 
	if(ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "-1") {
		tab.page2.edMFMatch.Text = "제외";
	} else if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "0") {
		tab.page2.edMFMatch.Text = "X";
	} else if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") > 0){
		tab.page2.edMFMatch.Text = "○";
	} else {
		tab.page2.edMFMatch.Text = "X";
	}
	
	// 선임자 연계제외 버튼처리 
	if(ds_ioFireManagerInfo2.GetColumn(0,"DMSTATUS") == 0) {
		tab.page2.btnMFMatchExceptM.Visible = true;
		tab.page2.btnMFMatchExceptCancelM.Visible = false;
	} else if (ds_ioFireManagerInfo2.GetColumn(0,"DMSTATUS") == -1){
		tab.page2.btnMFMatchExceptM.Visible = false;
		tab.page2.btnMFMatchExceptCancelM.Visible = true;
	} else {
		tab.page2.btnMFMatchExceptM.Visible = false;
		tab.page2.btnMFMatchExceptM.Visible = false;
	}
	
	// 삭제된 정보 색 표기 	
	if (ds_ioMFFireObjD2.GetColumn(0,"DELETE_AT") == "Y" 
	    || ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "-1"
	    || ds_ioFireManagerInfo2.GetColumn(0,"DMSTATUS") == "-1") {
		tab.page2.Shape4.BkColor = "darkgray";
	} else {
		tab.page2.Shape4.BkColor = "white";
	}
}


// 연계 제외 처리 
function lfn_MFMatchExcept2(obj)
{
	if(!gfn_Confirm("'"+ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"OBJ_NM2") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}

	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
	
	var parValue = "GUBUN='1' MNFCTRETC_SN="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN"));
	parValue += " EXCEPTCD="+quote(arrNo[0]);
	parValue += " EXCEPTTXT="+quote(arrNo[1]);
	parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExcept2"
		,false
		,false
		,true
	);
}

// lfn_MFMatchExcept2조회후
function lfn_AfterMFMatchExcept2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 연계제외처리후  상태값 변경*/     
    // 연계제외대상 상태 값 -1(연계제외)로 변경 
    ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MSTATUS","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radMFSelectGubun.Value == "1" || tab.page2.radMFSelectGubun.Value == "2") {		
		setRow = ds_ioMFFireObj2.currow;
		ds_ioMFFireObj2.Filter("MSTATUS!='-1'"); // 연계제외대상 필터링 
		tab.page2.edMFCount.Text = ds_ioMFFireObj2.GetCount();  // 총 건수 변경
		ds_ioMFFireObj2.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioMFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN2(ds_ioMFFireObj2.currow);
	    
	// 대상물 선임자정보 상세조회
	lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);
}

//  연계 제외 취소 
function lfn_MFMatchExceptCancel2(obj)
{

	if(!gfn_Confirm("'"+ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"OBJ_NM2") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,"GUBUN='1' MNFCTRETC_SN="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN"))
         + " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2))		// 지역코드
		,"lfn_AfterMFMatchCancel2"
		,false
		,false
		,true
	);
}

// lfn_MFMatchExceptCancel2조회후
function lfn_AfterMFMatchCancel2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    /* 연계제외처리후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MSTATUS","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radMFSelectGubun.Value == "3") {
		setRow = ds_ioMFFireObj2.currow;
		ds_ioMFFireObj2.Filter("MSTATUS=='-1'"); // 연계제외대상 필터링 
		tab.page2.edMFCount.Text = ds_ioMFFireObj2.GetCount();  // 총 건수 변경
		ds_ioMFFireObj2.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioMFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN2(ds_ioMFFireObj2.currow);
	    
	// 대상물 선임자정보 상세조회
	lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);
}

// 연계 제외 버튼 처리 
function lfn_MFMatchExceptBTN2(nRow)
{
	var MSTATUS = "";
	if (nRow == "" || nRow == null) {
		MSTATUS = ds_ioMFFireObj2.GetColumn(0,"MSTATUS");
	} else {
		MSTATUS = ds_ioMFFireObj2.GetColumn(nRow,"MSTATUS");
	}	
	
	if (MSTATUS == 0) {
		tab.page2.btnMFMatchCancel.Visible = false;
		tab.page2.btnMFMatchExcept.Visible = true;
	} else if (MSTATUS == -1) {
		tab.page2.btnMFMatchCancel.Visible = true;
		tab.page2.btnMFMatchExcept.Visible = false;
	} else if (MSTATUS > 0 ) {
		tab.page2.btnMFMatchCancel.Visible = false;
		tab.page2.btnMFMatchExcept.Visible = false;
	} else {
		tab.page2.btnMFMatchCancel.Visible = false;
		tab.page2.btnMFMatchExcept.Visible = false;
	}	
}

// 청시스템 상세보기 
function tab_page2_btnFPISInfo_OnClick(obj)
{
	if (ds_ioMFFireObj2.GetCount() > 0 ) {
		var parValue = "sCourse=30";
		parValue += " sCivilAppeal=-1";
		parValue += " sBarCode=''";	
		parValue += " sMFPIS1_SN="+quote(ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " sCTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
		
		var arrNo = Dialog("cust::frmcust5010.xml", parValue, 800, 590, "", -1, -1);
	} else {
		alert("선택된 자료가 없습니다.");
		return;
	}
}

// 선임자 연계 제외 취소
function lfn_MFMatchExceptCancelM2(obj)
{	
	
	if(!gfn_Confirm("'"+ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"NM") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	var parValue = "DMMGNO=" + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMMGNO"));	
		parValue += " GUBUN='2'";   // 1 : 연계제외 , 2 : 연계제외 취소 
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptM", "", 0, "");

	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExceptCancelM2"
		,false
		,false
		,true
	);
}

//  lfn_MFMatchExceptCancelM2조회후
function lfn_AfterMFMatchExceptCancelM2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 상세정보  조회 
    lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);
}

// 선임자 연계 제외
function lfn_MFMatchExceptM2(obj)
{

	if(!gfn_Confirm("'"+ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"NM") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	var parValue = "DMMGNO=" + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMMGNO"));	
		parValue += " GUBUN='1'";   // 1 : 연계제외 , 2 : 연계제외 취소 
        parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
        
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchExceptM", "", 0, "");
		
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExceptM2"
		,false
		,false
		,true
	);	
}


//  lfn_MFMatchExceptM2조회후
function lfn_AfterMFMatchExceptM2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 상세정보  조회 
    lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);
}


// 청 선임자 그리드 정보 원클릭시 
function tab_page2_gdMFManager_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	lfn_MatchColor2("ON",nRow);
	lfn_AllMatchBTN2(nRow);
}

// 수정없이  연계 처리 
function lfn_NowMatch2(obj)
{  
	/* 변수 선언 */
	var FMMATCH = "N";   // 선임자만 매치할건지 판단 
	var mfNM = ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"NM");  // 소방청 선임자 이름
	var mfBIRTHDAY = "";
	if (length(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"IHIDNUM")) > 8) {
		mfBIRTHDAY = substr(replace(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"IHIDNUM"), "-", ""),0,6);
	} else if (length(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"IHIDNUM")) == 8) {
		mfBIRTHDAY = substr(replace(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"IHIDNUM"), "-", ""),2,6);
	} else {
		mfBIRTHDAY = substr(replace(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"IHIDNUM"), "-", ""),0,6);
	}
	var kfNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMNM"); // 안전원 선임자 이름 
	var kfBIRTHDAY = substr(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMBIRTHDAY"),0,6);// 안전원 선임자 생년월일
	
	/* 체크 사항 */
	// 안전원 
	if (ds_ioKFFireObj2.GetCount() < 1) {
		alert("[한국소방안전원] 연계할 대상을 지정해주세요.");
		return;
	}
	
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") > 0) {
		alert("[한국소방안전원] 이미 연계된 대상입니다.");
		return;
	}
	
	// 청
	if (ds_ioMFFireObjD2.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}

	
	if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "1") {
		if (ds_ioFireManagerInfo2.GetRowCount() > 1) {
			for(var i = 0; i < ds_ioFireManagerInfo2.GetRowCount(); i++) {
				if (ds_ioFireManagerInfo2.GetColumn(i,"DMSTATUS") == "0") {
					FMMATCH = "Y";
				}
			}
			if (FMMATCH == "N") {
				alert(ORGNM + " 연계된 대상입니다.");
				return;
			}
		} else {			
			alert(ORGNM + " 연계된 대상입니다.");
			return;
		}
	} 
	
	// 선임자 매치여부 판단 	
	if (mfNM == kfNM && mfBIRTHDAY == kfBIRTHDAY) {	  // 생년월일과 성명이 같은 경우 
		managerMatchYN = "Y";
	} else if (mfNM == kfNM && (mfBIRTHDAY == null || kfBIRTHDAY == null)) {   // 성명이 같고 생년월일이 청 안전원 둘중 하나라도 없는경우 
		managerMatchYN = "Y";
	} else {
		managerMatchYN = "N";
	}
	
	/* 선임자만 매치시 선임자체크가 FALSE일경우 */
	if (FMMATCH == "Y" && managerMatchYN = "N") {
		alert("연계하려는 대상이 잘못되었습니다.");
		return;
	}
	
	if(managerMatchYN = "N") {
		if (!Confirm("연계할 선임자가 일치하지 않습니다. 계속 진행하시겠습니까?")) {
			return;
		}
	}
	
	var meg = "     [한국소방안전원] 대상명 : "+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BNM") +"\n";
	meg += "        " + ORGNM + " 대상명 : "+ds_ioMFFireObjD2.GetColumn(0,"OBJ_NM") +"\n";	
	meg +="   연계 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}	

	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:insertCust6100Match", "", 0, "");     // 매치테이블
	tit_addSingleActionInfo("cust:insertCust0010AdditionInfo", "", 0, "");   // 부가정보
	
	// 매치 
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));		
		parValue += " FIRECD=" + quote(ds_ioMFFireObjD2.GetColumn(0,"CMPN119SCID"));
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		
		parValue += " SBMGNO=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BMGNO"));
		parValue += " DPERMISSIONNO=" + quote(ds_ioMFFireObjD2.GetColumn(0,"PRMISN_NO"));
		parValue += " DREMARK=" + quote("설치(변경)허가번호 : " + ds_ioMFFireObjD2.GetColumn(0,"ITL_NO"));
			
		if (ds_ioFireManagerInfo2.GetCount() > 0 && managerMatchYN == "Y") {
			parValue += " GUBUN='1'";  //  연계	
			parValue += " DMMGNO=" + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMMGNO"));
		}
		parValue += " FMMATCH=" + quote(FMMATCH);
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드		
		
		// 부가정보 
		parValue += " SCMGNO=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));
		parValue += " ADCD=8";
		if (substr(tab.page2.cbxMFHead.Value,0,2) == "11") {	// 서울본부
			parValue += " ADCONTENT=" + quote("서울소방본부 연계일치화(" + left(GetDate(), 4)+"-"+mid(GetDate(),4,2)+"-"+mid(GetDate(),6,2)+")");
		} else {	// 서울본부 외
			parValue += " ADCONTENT=" + quote("데이터연계 일치화처리(" + left(GetDate(), 4)+"-"+mid(GetDate(),4,2)+"-"+mid(GetDate(),6,2)+")");
		}
	
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterNowMatch2"
		,false
		,false
		,true
	);
}

// lfn_NowMatch2 처리 후 
function lfn_AfterNowMatch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter2("U");
	
    alert("연계가 완료되었습니다.");
}


// 연계해지  처리 
function lfn_CancelMatch2(obj)
{  
	
	/* 체크사항 */
	
	// 안전원 
	if (ds_ioKFFireObj2.GetCount() < 1) {
		alert("[한국소방안전원] 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") < 1 ) {
		alert("[한국소방안전원] 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 청
	if (ds_ioMFFireObjD2.GetCount() < 1) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") < 1) {
		alert(ORGNM + " 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 연계 대상 확인
	var chk = 0;
	for (var i = 0; i < ds_ioMFFireObjD2.GetCount(); i++) { 
		if (ds_ioDangerInfo2.GetColumn(ds_ioDangerInfo2.currow,"MFPIS1") == ds_ioMFFireObjD2.GetColumn(i,"MNFCTRETC_SN")
		    && ds_ioDangerInfo2.GetColumn(ds_ioDangerInfo2.currow,"DPERMISSIONNO") == ds_ioMFFireObjD2.GetColumn(i,"PRMISN_NO")
		) {
			chk++;
		}
	}	
	if (chk < 1) {
		alert("잘못된 연계대상입니다.");
		return;
	}
	
	// 선임자 연계대상이 존재 할때는 선임자를 선택하도록 
	if (ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MANAGERMATCHCNT")  > 0) {
		if (ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMSTATUS") < "1") {
			alert("연계된 선임자가 있습니다. 선임자를 선택해주세요"); 
			return;
		} else {
			if (ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"NM")
				!= ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMNM")) {
				alert("대상물의 연계된 선임자가 아닙니다. 연계된 선임자를 선택해주세요."); 
				return;
			}
		}
	}


	var meg = "        [한국소방안전원] 허가번호 : "+ds_ioMFFireObjD2.GetColumn(0,"PRMISN_NO") +"\n";
	meg += "     " + ORGNM + " 허가번호 : "+ds_ioDangerInfo2.GetColumn(ds_ioDangerInfo2.currow,"DPERMISSIONNO") +"\n";
	meg +="   연계해지 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}
	
	// 연계해지 사유 
	var cancelReason = Dialog("cust::frmcust5011.xml", "", 520, 188, "", -1, -1);	
	if (cancelReason == "" || cancelReason == null) {
		alert("연계 사유를 입력해 주세요");
		return;
	}
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6100MatchCancel", "", 0, "");     // 연계취소 
	tit_addSingleActionInfo("cust:insertCust0010AdditionInfo", "", 0, "");   // 부가정보
	
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD2.GetColumn(0,"MFPIS1"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));		
		parValue += " MMGNO=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"MMGNO"));
		parValue += " DBMGNO=" + quote(ds_ioDangerInfo2.GetColumn(ds_ioDangerInfo2.currow,"DBMGNO"));
		parValue += " DSEQ=" + quote(ds_ioDangerInfo2.GetColumn(ds_ioDangerInfo2.currow,"DSEQ"));
		parValue += " MDELREMARK=" + quote(cancelReason);
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		parValue += " MGUBUN='1'";   // 허가번호 처리 구분
		
		if (ds_ioFireManagerInfo2.GetCount() > 0 && ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMSTATUS") == "1" ) {
			parValue += " GUBUN='1'"; 
			parValue += " DMMGNO=" + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMMGNO"));
		}
		
		if (ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MANAGERMATCHCNT")  > 1) {
			parValue += " FMMATCH='Y'";
		}
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드	
		
		// 부가정보
		parValue += " SCMGNO=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));
		parValue += " ADCD=8";
		parValue += " ADCONTENT=" + quote("[연계해지사유]" + cancelReason);
		
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterCancelMatch2"
		,false
		,false
		,true
	);
}

// lfn_CancelMatch2 처리 후 
function lfn_AfterCancelMatch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter2("C");
	
    alert("연계해지가 완료되었습니다.");
    
}

// 엑셀 
function tab_page2_btnMFExcel_OnClick(obj)
{
	if (ds_ioMFFireObj2.GetCount() > 0) {
		tab.page2.gdMFOBJList.ExportExcelEx("sheet1");
	}
}
/*============================================	연계후 처리   =================================*/

function lfn_MatchAfter2(mode) {
	if (mode == "U") {
		var MSTATUS = ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MSTATUS");
		var MANAGERMATCHCNT = ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MANAGERMATCHCNT");
		var KFSTATUS = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE");
	
		MSTATUS++;
		if(managerMatchYN == "Y") {
			MANAGERMATCHCNT++;
		}
		KFSTATUS++;
		
		managerMatchYN ="";
		
		ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MSTATUS",MSTATUS);
		ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MANAGERMATCHCNT",MANAGERMATCHCNT);
		ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE",KFSTATUS);
		ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"MFPIS1",ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN"));
		
	
		// 필터링
		if(tab.page2.radMFSelectGubun.Value == "1") {
			setRow = ds_ioMFFireObj2.currow;
			ds_ioMFFireObj2.Filter("MNFCTRETC_SN!="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN")));
			ds_ioMFFireObj2.row = setRow;
		}
		
		if(tab.page2.radKFSelectGubun.Value == "1") {
			setRow = ds_ioKFFireObj2.currow;
			ds_ioKFFireObj2.Filter("CMGNO!="+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));
			ds_ioKFFireObj2.row = setRow;
		}

	} else if (mode == "C") {
		// 상태값 
		var MSTATUS = ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MSTATUS");
		var MANAGERMATCHCNT = ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MANAGERMATCHCNT");
		var KFSTATUS = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE");
	
		// 감소
		MSTATUS--;
		if (MANAGERMATCHCNT > 0) {
			MANAGERMATCHCNT--;
		}
		KFSTATUS--;
		
		// 적용 
		ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MSTATUS",MSTATUS);
		ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MANAGERMATCHCNT",MANAGERMATCHCNT);
		ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE",KFSTATUS);		
	
		// 필터링
		if(tab.page2.radMFSelectGubun.Value == "2") {
			setRow = ds_ioMFFireObj2.currow;
			ds_ioMFFireObj2.Filter("MNFCTRETC_SN!="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN")));
			ds_ioMFFireObj2.row = setRow;
		}
		
		if(tab.page2.radKFSelectGubun.Value == "2") {
			setRow = ds_ioKFFireObj2.currow;
			ds_ioKFFireObj2.Filter("CMGNO!="+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));
			ds_ioKFFireObj2.row = setRow;
		}

	}
	
	// 하단상세보기 연계 여부 값입력 
	if(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") == "-1") {
		tab.page2.edKFMatch.Text = "제외";
	} else if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") == "0") {
		tab.page2.edKFMatch.Text = "X";
	} else if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") > 0){
		tab.page2.edKFMatch.Text = "○";
	} else {
		tab.page2.edKFMatch.Text = "X";
	}
	
	// 청정보조회 
	lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);
	
	// 위험물 허가번호 조회 
	lfn_searchDanger2(ds_ioKFFireObj2.currow);
}


// 수정연계
function btnModMatch_OnClick2(obj) {
	// 안전원 
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO") == "" || ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO") == null) {
		alert("[한국소방안전원] 연계대상을 지정해주세요.");
		return;
	}
	
	// 청
	if (ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN") == "" || ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN") == null) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}

	var sStatus = "U";
	var sMNFCTRETC_SN = "";
	var sCMGNO = "";	

	// 연계모드 설정
	sCMGNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO");
	
	//  제조소등 관리번호 설정
	sMNFCTRETC_SN = ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN");
	
	        
	// 파라미터값 설정 
 	var parValue = "sStatus=" + quote(sStatus); // 연계모드(I : 신규 , U : 수정 )
	parValue += " sMNFCTRETC_SN=" + quote(sMNFCTRETC_SN); // 제조소등관리번호 
	parValue += " sCMGNO=" + quote(sCMGNO);  // 안전원고객관리번호
	parValue += " sAPNTRLSOFC_DE=" + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMINDATE"));  //선임일자
	parValue += " sMNGR_SN= " + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMINMNGR_SN")); // 안전관리자 선임 관리자 번호 
	parValue += " sAPNTRLSOFC_SE=" + quote(ds_ioFireManagerInfo2.GetColumn(ds_ioFireManagerInfo2.currow,"DMOUTDATE")); // 선임 해임 구분
	parValue += " sJIBU=" + quote(tab.page2.cbxKFJibu.Value);
	parValue += " sCTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드	

	var arrNo = Dialog("cust::frmcust6101PDataConnectionDangerManageSave.xml", parValue , 800, 700, "", -1, -1);
	
	// 변경, 수정이 된경우 
	if(arrNo == "U"){
		// 매치후 처리 
		lfn_MatchAfter2(arrNo);
	}
}

/*================================    조건 연계	======================================*/
// 청 조회조건변경(연계구분)
function tab_page2_radKFSelectGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance2("12");
}
function lfn_SearchBalance2(gubun){
	if (gubun == "11") {
		var JIBUCD = tab.page2.cbxKFJibu.Value;
		if (JIBUCD == "1141") {
			 JIBUCD = "1081";
		}
		var row = ds_oFireHead.FindRow("JIBUCD", JIBUCD );	
		tab.page2.cbxMFHead.Value = ds_oFireHead.GetColumn(row,"CD");
		cbxMFHead_OnChanged("tab.page2.cbxMFHead",tab.page2.cbxMFHead.Value);
		lfn_FilterFireStation(tab.page2.cbxMFHead.Value);
	} else if (gubun == "12") {
		 tab.page2.radMFSelectGubun.Value = tab.page2.radKFSelectGubun.Value;
	} 
}


/*============================================	매칭 컬러 처리    =================================*/

function lfn_MatchColor2(mode,nRow) {
	if (mode == "ON") {
	
		// 대상물
		var SEARCHBNM = ds_ioMFFireObjD2.GetColumn(0,"OBJ_NM");
		var BNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BNM");
		
		SEARCHBNM = trim(SEARCHBNM);
		BNM = trim(BNM);
		
		if (SEARCHBNM == BNM) {
			if (SEARCHBNM == null || SEARCHBNM = "") {
				tab.page2.edMFOBJ_NM.BKColor = "white";
				tab.page2.edKFBNM.BKColor = "white";
			} else {
				tab.page2.edMFOBJ_NM.BKColor = "lightskyblue";
				tab.page2.edKFBNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFOBJ_NM.BKColor = "white";
			tab.page2.edKFBNM.BKColor = "white";
		}
		
		
		// 동명(풀네임)
		var SEARCHDONGFNM = ds_ioMFFireObjD2.GetColumn(0,"SEARCHDONGFNM");
		var BADDRDONGFNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRDONGFNM");
		
		SEARCHDONGFNM = trim(SEARCHDONGFNM);
		BADDRDONGFNM = trim(BADDRDONGFNM);
		
		if (SEARCHDONGFNM == BADDRDONGFNM) {
			if (SEARCHDONGFNM == null || SEARCHDONGFNM = "") {
				tab.page2.edMFFDong.BKColor = "white";
				tab.page2.edKFFDong.BKColor = "white";
			} else {
				tab.page2.edMFFDong.BKColor = "lightskyblue";
				tab.page2.edKFFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFFDong.BKColor = "white";
			tab.page2.edKFFDong.BKColor = "white";
		}
		
		
		// 동명(숏네임)
		var SEARCHDONGNM = ds_ioMFFireObjD2.GetColumn(0,"SEARCHDONGNM");
		var BADDRDONGNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRDONGNM");
		
		SEARCHDONGNM = trim(SEARCHDONGNM);
		BADDRDONGNM = trim(BADDRDONGNM);
		
		if (SEARCHDONGNM == BADDRDONGNM) {
			if (SEARCHDONGNM == null || SEARCHDONGNM = "") {
				tab.page2.edMFDong.BKColor = "white";
				tab.page2.edKFDong.BKColor = "white";
			} else {
				tab.page2.edMFDong.BKColor = "lightskyblue";
				tab.page2.edKFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFDong.BKColor = "white";
			tab.page2.edKFDong.BKColor = "white";
		}
		
		
		// 주번지
		var SEARCHMAINADDR = ds_ioMFFireObjD2.GetColumn(0,"SEARCHMAINADDR");
		var BADDRMAINNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRMAINNM");
		
		SEARCHMAINADDR = trim(SEARCHMAINADDR);
		BADDRMAINNM = trim(BADDRMAINNM);
		
		if (SEARCHMAINADDR == BADDRMAINNM) {
			if (SEARCHMAINADDR == null || SEARCHMAINADDR = "") {
				tab.page2.edMFMainAddr.BKColor = "white";
				tab.page2.edKFMainAddr.BKColor = "white";
			} else {
				tab.page2.edMFMainAddr.BKColor = "lightskyblue";
				tab.page2.edKFMainAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFMainAddr.BKColor = "white";
			tab.page2.edKFMainAddr.BKColor = "white";
		}
		
		
		// 부번지
		var SEARCHSUBADDR = ds_ioMFFireObjD2.GetColumn(0,"SEARCHSUBADDR");
		var BADDRSUBNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BADDRSUBNM");
		
		SEARCHSUBADDR = trim(SEARCHSUBADDR);
		BADDRSUBNM = trim(BADDRSUBNM);
		
		if (SEARCHSUBADDR == BADDRSUBNM) {
			if (SEARCHSUBADDR == null || SEARCHSUBADDR = "") {
				tab.page2.edMFSubAddr.BKColor = "white";
				tab.page2.edKFSubAddr.BKColor = "white";
			} else {
				tab.page2.edMFSubAddr.BKColor = "lightskyblue";
				tab.page2.edKFSubAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFSubAddr.BKColor = "white";
			tab.page2.edKFSubAddr.BKColor = "white";
		}
		
		if(nRow == "" || nRow == null) {
			nRow = ds_ioFireManagerInfo2.currow;
		} 
		
		
		// 도로명
		var SEARCHROADNM = ds_ioMFFireObjD2.GetColumn(0,"ROAD_NM");
		var BROADNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RROADNM");
		
		SEARCHROADNM = trim(SEARCHROADNM);
		BROADNM = trim(BROADNM);

		if (SEARCHROADNM == BROADNM) {
			if (SEARCHROADNM == null || SEARCHROADNM = "") {
				tab.page2.edMFRoadNM.BKColor = "white";
				tab.page2.edKFRoadNM.BKColor = "white";
			} else {
				tab.page2.edMFRoadNM.BKColor = "lightskyblue";
				tab.page2.edKFRoadNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFRoadNM.BKColor = "white";
			tab.page2.edKFRoadNM.BKColor = "white";
		}		
		
	
		// 건물번호1
		var SEARCHMAINNO = ds_ioMFFireObjD2.GetColumn(0,"MAIN_BDNBR");
		var BMAINNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RBUILDMAINNO");
		
		SEARCHMAINNO = trim(SEARCHMAINNO);
		BMAINNO = trim(BMAINNO);
		
		if (SEARCHMAINNO == BMAINNO) {
			if (SEARCHMAINNO == null || SEARCHMAINNO = "") {
				tab.page2.edMFMainNO.BKColor = "white";
				tab.page2.edKFMainNO.BKColor = "white";
			} else {
				tab.page2.edMFMainNO.BKColor = "lightskyblue";
				tab.page2.edKFMainNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFMainNO.BKColor = "white";
			tab.page2.edKFMainNO.BKColor = "white";
		}		
		
		// 건물번호2
		var SEARCHSUBNO = ds_ioMFFireObjD2.GetColumn(0,"SEC_BDNBR");
		var BSUBNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RBUILDSUBNO");
		
		SEARCHSUBNO = trim(SEARCHSUBNO);
		BSUBNO = trim(BSUBNO);
		
		if (SEARCHSUBNO == BSUBNO) {
			if (SEARCHSUBNO == null || SEARCHSUBNO = "") {
				tab.page2.edMFSubNO.BKColor = "white";
				tab.page2.edKFSubNO.BKColor = "white";
			} else {
				tab.page2.edMFSubNO.BKColor = "lightskyblue";
				tab.page2.edKFSubNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFSubNO.BKColor = "white";
			tab.page2.edKFSubNO.BKColor = "white";
		}	
			
		if(nRow == "" || nRow == null) {
			nRow = ds_ioFireManagerInfo2.currow;
		} 
			
		
		// 선임자명
		var NM = ds_ioFireManagerInfo2.GetColumn(nRow,"NM");
		var FMNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMNM");
		
		NM = trim(NM);
		FMNM = trim(FMNM);
				
		if (NM  == FMNM) {
			if (NM == null || NM = "") {
				tab.page2.edKFFMNM.BKColor = "white";
			} else {
				tab.page2.edKFFMNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edKFFMNM.BKColor = "white";
		}
		
		
		// 선임자주민번호
		var IHIDNUM = ds_ioFireManagerInfo2.GetColumn(nRow,"IHIDNUM");
		var FMBIRTHDAY = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMBIRTHDAY");
		var FMPERSONKEY = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"FMPERSONKEY");
		
		if (length(IHIDNUM) > 8) {
			IHIDNUM = substr(trim(IHIDNUM),0,6);
		} else if (length(IHIDNUM) == 8) {
			IHIDNUM = substr(trim(IHIDNUM),2,6);
		} else {
			IHIDNUM = substr(trim(IHIDNUM),0,6);
		}
		FMBIRTHDAY = substr(trim(FMBIRTHDAY),0,6);
		
		if (IHIDNUM == FMBIRTHDAY) {
			if (IHIDNUM == null || IHIDNUM = "") {
				tab.page2.edKFFMBIRTHDAY.BKColor = "white";
			} else {
				tab.page2.edKFFMBIRTHDAY.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edKFFMBIRTHDAY.BKColor = "white";
		}
		
	} else {
		tab.page2.edMFOBJ_NM.BKColor = "white";
		tab.page2.edKFBNM.BKColor = "white";
		tab.page2.edMFFDong.BKColor = "white";
		tab.page2.edKFFDong.BKColor = "white";
		tab.page2.edMFDong.BKColor = "white";
		tab.page2.edKFDong.BKColor = "white";
		tab.page2.edMFMainAddr.BKColor = "white";
		tab.page2.edKFMainAddr.BKColor = "white";
		tab.page2.edMFSubAddr.BKColor = "white";
		tab.page2.edKFSubAddr.BKColor = "white";
		tab.page2.edMFRoadNM.BKColor = "white";
		tab.page2.edKFRoadNM.BKColor = "white";
		tab.page2.edMFMainNO.BKColor = "white";
		tab.page2.edKFMainNO.BKColor = "white";	
		tab.page2.edMFSubNO.BKColor = "white";
		tab.page2.edKFSubNO.BKColor = "white";
		tab.page2.edKFFMNM.BKColor = "white";
		tab.page2.edKFFMBIRTHDAY.BKColor = "white";
		tab.page2.edKFFMPersonKey.BKColor = "white";
	}	
}

/*============================================	연계 처리 버튼   =================================*/

function lfn_AllMatchBTN2(nRow) {
	var MRow = "";
	var KRow = "";	
	if (nRow == "" || nRow == null) {
		if (ds_ioFireManagerInfo2.GetCount() > 0) { MRow = ds_ioFireManagerInfo2.currow;}
	} else {
		MRow = nRow;
	}
	if (ds_ioKFFireObj2.GetCount() > 0) { KRow = ds_ioKFFireObj2.currow; }
	
	// 기본
	tab.page2.btnMatchCancel.Enable = false;
	tab.page2.btnMatch.Enable = false;
	tab.page2.btnModMatch.Enable = false;
	
		
	// 연계해지 버튼 활성화 
	if (
		ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") > 0 
		//&& (ds_ioFireManagerInfo2.GetColumn(MRow,"DMSTATUS") == 1 || ds_ioFireManagerInfo2.GetCount() < 1)
		&& ds_ioKFFireObj2.GetColumn(KRow,"RFLAGEE") > 0
	   )
	{
		tab.page2.btnMatchCancel.Enable = true;
	} else {
		tab.page2.btnMatchCancel.Enable = false;
	}
	
	// 수정없이 연계처리 활성화
	if (
		ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") >= 0 
		&& (ds_ioFireManagerInfo2.GetColumn(MRow,"DMSTATUS") == 0 || ds_ioFireManagerInfo2.GetCount() < 1)
		&& ds_ioKFFireObj2.GetColumn(KRow,"RFLAGEE") == 0
	   )
	{
		tab.page2.btnMatch.Enable = true;
	} else {
		tab.page2.btnMatch.Enable = false;
	}
	
	// 수정연계 
	if (
		ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") >= 0 		
		&& ds_ioKFFireObj2.GetColumn(KRow,"RFLAGEE") == 0
		&& (ds_ioFireManagerInfo2.GetColumn(MRow,"DMSTATUS") == 0 || ds_ioFireManagerInfo2.GetCount() < 1)
	   )
	{
		tab.page2.btnModMatch.Enable = true;
	} else {
		tab.page2.btnModMatch.Enable = false;
	}
}


/**************************************************************
공통함수 
**************************************************************/
function KfClear() {
	// 안전원 정보 초기 화 
	ds_ioKFFireObj.ClearData();
	ds_ioDangerInfo.ClearData();
	tab.page1.edKFCount = "";
	tab.page1.Shape2.BkColor = "";
	tab.page1.Shape3.BkColor = "";
	tab.page1.btnKFMatchCancel.Visible = false;
	tab.page1.btnKFMatchExcept.Visible = false;
}

/**************************************************************
로그 남기기 
**************************************************************/
function logWrite(gubun,row) {
	var ls_HistoryArg = "";
	var Action = "";
	if (gubun == "1") {
		// 조회이력을 저장한다.  
		ls_HistoryArg = " 소방본부=" + tab.page1.cbxMFHead.Value;
		ls_HistoryArg += ", 소방서=" + tab.page1.cbxMFStation.Value;
		ls_HistoryArg += ", 소방센터=" + tab.page1.cbxMFCenter.Value;
		ls_HistoryArg += ", 제조소구분=" + tab.page1.cbxMFMnfctretcGubun.Value;
		ls_HistoryArg += ", 제조소상세구분=" + tab.page1.cbxMFMnfctretcGubunD.Value;
		ls_HistoryArg += ", 변경일자1=" + tab.page1.medMFModDate1.Value;
		ls_HistoryArg += " ~ 변경일자2=" + tab.page1.medMFModDate2.Value;
		ls_HistoryArg += ", 검색조건=" + tab.page1.radMFSelectGubun.Value;
		ls_HistoryArg += ", 검색필드=" + tab.page1.cbxMFKeyfield.Value;
		ls_HistoryArg += ", 검색키워드=" + tab.page1.edMFKeyword.Text;
		ls_HistoryArg += ", 문자열 포함여부=" + tab.page1.chkMFPerson.Value;
		ls_HistoryArg += ", 조회수=" + tab.page1.spMFRowNum.value;
		
		Action = "청기준 : 청자료 전체조회";
	} else if (gubun == "3") {
		// 조회이력을 저장한다.  
		ls_HistoryArg = " 소방본부=" + tab.page2.cbxMFHead.Value;
		ls_HistoryArg += ", 소방서=" + tab.page2.cbxMFStation.Value;
		ls_HistoryArg += ", 소방센터=" + tab.page2.cbxMFCenter.Value;
		ls_HistoryArg += ", 제조소구분=" + tab.page2.cbxMFMnfctretcGubun.Value;
		ls_HistoryArg += ", 제조소상세구분=" + tab.page2.cbxMFMnfctretcGubunD.Value;
		ls_HistoryArg += ", 변경일자1=" + tab.page2.medMFModDate1.Value;
		ls_HistoryArg += " ~ 변경일자2=" + tab.page2.medMFModDate2.Value;
		ls_HistoryArg += ", 검색조건=" + tab.page2.radMFSelectGubun.Value;
		ls_HistoryArg += ", 검색필드=" + tab.page2.cbxMFKeyfield.Value;
		ls_HistoryArg += ", 검색키워드=" + tab.page2.edMFKeyword.Text;
		ls_HistoryArg += ", 문자열 포함여부=" + tab.page2.chkMFPerson.Value;
		ls_HistoryArg += ", 조회수=" + tab.page2.spMFRowNum.value;
		ls_HistoryArg += ", 고객번호=" + ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO");
		Action = "안전원기준 : 청자료 전체조회";
	} 
              
    gfn_InsertFPISSearchPrintHistory(
        "S"
        , this.ID
        , "위험물안전관리자 일치화 관리"
        , Action
        , ls_HistoryArg
    );
}

/**************************************************************
 상세조회 로그 남기기 
**************************************************************/
function detailLogWrite(code) {

	var searchNm = "";		// 조회대상명
	var sMFPIS1 = "";		
	
	if(code == "M") {
		if (ds_ioMFFireObjD.GetColumn(0,"OBJ_NM") == null) {
			if (ds_ioMFFireObjD.GetColumn(0,"INSTLR_CPR_NM") == null) {
				if (ds_ioMFFireObjD.GetColumn(0,"INSTLR_NM") != null) {
					searchNm = ds_ioMFFireObjD.GetColumn(0,"INSTLR_NM");
				}
			} else {
				searchNm = ds_ioMFFireObjD.GetColumn(0,"INSTLR_CPR_NM");
			}
		} else {
			searchNm = ds_ioMFFireObjD.GetColumn(0,"OBJ_NM");
		}
		sMFPIS1 = ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN");
    } else if (code == "K") {
		if (ds_ioMFFireObjD2.GetColumn(0,"OBJ_NM") == null) {
			if (ds_ioMFFireObjD2.GetColumn(0,"INSTLR_CPR_NM") == null) {
				if (ds_ioMFFireObjD2.GetColumn(0,"INSTLR_NM") != null) {
					searchNm = ds_ioMFFireObjD2.GetColumn(0,"INSTLR_NM");
				}
			} else {
				searchNm = ds_ioMFFireObjD2.GetColumn(0,"INSTLR_CPR_NM");
			}
		} else {
			searchNm = ds_ioMFFireObjD2.GetColumn(0,"OBJ_NM");
		}
		sMFPIS1 = ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN");
    }
	
	// 상세 조회이력을 저장한다.  	
    gfn_InsertFPISDetailSearchPrintHistory(
        "1"			// 대상구분
        , menuId		// 메뉴 아이디 
        , searchNm		// 조회 대상명 
        , sMFPIS1		// 메인 PK
    );
}


function tab_page2_edKFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {
		lfn_KFSearch2();
	}
}

function tab_page2_edMFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {
		tab_page2_btnMFSearch_OnClick();
	}
}

function tab_OnChanged(obj,nOldIndex,nNewindex)
{
	if (nNewindex == "0") {
		lfn_FilterFireStation(tab.page1.cbxMFHead.value);
		lfn_JibuChange(tab.page1.cbxKFJibu.Value);
	} else if (nNewindex == "1") {
		lfn_FilterFireStation(tab.page2.cbxMFHead.value);
		lfn_JibuChange(tab.page2.cbxKFJibu.Value);
	}
	
	if (tab.page2.cbxMFHead.value == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}	
}



/*
 * 기능 : 데이타연계 조회 출력 HISTORY 창 팝업
*/
function btnDataHistory_OnClick(obj)
{	
	var arrNo = Dialog("sys::frmsys0095MDataMatchDetailSearchHistoryList.xml", "menuId="+quote(menuId), 800, 590, "", -1, -1);	
}
function Form_OnActivate(obj)
{
	gs_SysID = "[stm_01,bsn_1003,dsc_0006]";	// 개인정보접속기록 시스템ID 
}
]]></Script>
</Window>
<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="200" Id="frmcust0010PSearchVAccountCno" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="은행가상계좌로&#32;관리번호&#32;검색" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="400" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioVAccountCno"></Dataset>
		</Datasets>
		<Shape Bottom="192" Height="151" Id="shpGubunBox4" Left="4" LineColor="user15" Right="396" TabOrder="3" Top="41" Type="Rectangle" Width="392"></Shape>
		<Static Border="Flat" BorderColor="user6" Font="굴림,9,Bold" Height="30" Id="lbNotice" Left="9" LineSpacing="5" TabOrder="6" Top="56" Width="382"></Static>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="304" LineColor="user14" Right="400" TabOrder="5" Top="1" Type="Rectangle" Width="96"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="308" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbBankNm" Left="13" Style="sty_Label" TabOrder="2" Text="가상계좌" Top="61" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbRepay" Left="20" Style="sty_LabelGruopBox" TabOrder="4" Text="가상계좌로&#32;관리번호&#32;검색" Top="33" VAlign="Middle" Width="228"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="226" OnClick="lfn_Search" Style="sty_Button" TabOrder="7" ToolTipText="조회" Top="60" Width="85"></Button>
		<Grid AutoFit="TRUE" BindDataset="ds_ioVAccountCno" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="168" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="77" Id="gdVAccount" InputPanel="FALSE" Left="8" LineColor="default" MinWidth="100" OnCellDBLClick="gdVAccount_OnCellDblClick" Right="392" Style="sty_Grid" TabOrder="8" TabStop="true" Top="91" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="384">
			<contents>
				<format id="Default">
					<columns>
						<col width="63"/>
						<col width="63"/>
						<col width="69"/>
						<col width="136"/>
						<col width="67"/>
					</columns>
					<head>
						<cell col="0" display="text" text="지부"/>
						<cell col="1" display="text" text="관리번호"/>
						<cell col="2" display="text" text="직능"/>
						<cell col="3" display="text" text="업체명"/>
						<cell col="4" display="text" text="선임자"/>
					</head>
					<body>
						<cell align="center" col="0" colid="GTDEPTNM" display="text"/>
						<cell align="center" col="1" colid="CNO" display="text"/>
						<cell align="center" col="2" colid="CGROUPNICKNM" display="normal"/>
						<cell align="left" col="3" colid="BNM" display="normal"/>
						<cell align="center" col="4" colid="FMNM" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="17" Id="Static9" Left="8" TabOrder="9" Text="※&#32;리스트에서&#32;더블클릭시&#32;고객정보관리에서&#32;상세&#32;조회됩니다." Top="174" Width="365"></Static>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medVAccount" Left="104" LeftMargin="2" Mask="######-##-######" MaxLength="6" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medVAccount_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="10" Top="61" Type="STRING" UserData="S" Width="120"></MaskEdit>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust0010PSearchVAccountCno.xml
 * 설명 : 은행가상계좌로 관리번호 검색
 * 작성일 : 2016.04.19
 * 작성자 : 정현호
 */

#include "LIB::COMMON.js"; // 공통 관련


/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

	ds_ioVAccountCno.ClearData();
	
	medVAccount.SetFocus();
    
}

/**
 * 조회
 */
function lfn_Search() {

	ds_ioVAccountCno.ClearData();	// 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("cust:searchCust0010VAccountCno", false);
    tit_callService(
        ""
        ,""
        ,""
        ,"ds_ioVAccountCno=ds_oVAccountCno" // outDs
        ,"VACCOUNT=" + quote(medVAccount.Value) // args 
        ,"lfn_AfterSearch"
        ,false
        ,false
        ,true
    );
    
}

function lfn_AfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    gfn_SearchMessage(gdVAccount); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

function Form_OnUnloadCompleted(obj) {
    Close();
}


function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{

    switch (nChar) {
		case 113 : // F2			lfn_Search();            break;
    
        case 27 : // 종료(Esc)
            lfn_End();
            break;
    }
   
}

/*
 * 기능 : 종료
 */
function lfn_End(obj) {
    Close();
}
/* 공통 필수 종료 */

/* 사용자 함수 */

/* 사용자 이벤트 함수 */


function gdVAccount_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var arrArg = Array(1);
    arrArg[0] = ds_ioVAccountCno.GetColumn(nRow, "CMGNO");		        //고객정보관리번호
	Close(arrArg);
}



function medVAccount_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if(nChar == 13) {	// Enter key
		if(!gfn_IsNull(medVAccount.Value)) {
			lfn_Search();
		}
	}
}
]]></Script>
</Window>
<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="700" Id="frmCOM9022MSurveyAdmin" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="lfn_Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="교육만족도&#32;설문조사&#32;관리" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="900" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioSession">
				<Contents>
					<colinfo id="SHARE_SESSION" size="256" summ="default" type="STRING"/>
					<colinfo id="SHARE_SABUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="806" LineColor="user14" Right="897" TabOrder="61" Top="1" Type="Rectangle" Width="91"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="2" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="300">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="809" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="4" Width="85"></Button>
		<MSIE Bottom="700" Height="668" Id="AxMsie" Right="900" Top="32" Width="900"></MSIE>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmCOM9022MSurveyAdmin
 * 설명 : 교육만족도 설문조사 관리
 * 작성일 : 2016.09.12
 
 * 작성자 : 정현호
 */

#include "LIB::COMMON.js"; // 공통업무 관련

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";
	
	ds_ioSession.ClearData();
	ds_ioSession.AddRow();
	
	ds_ioSession.SetColumn(0, "SHARE_SABUN", gds_oUserInfo.GetColumn(0, "PSABUN"));
	ds_ioSession.SetColumn(0, "SHARE_SESSION", JSESSIONID);

	tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addSearchActionInfo("com:searchSession", false);
    // 서버 호출
    tit_callService(
		""
		,""
		,"ds_ioSession=ds_ioSession"	// inDs
		,""	// outDs
		,""	// args 
		,"lfn_AfterSessionSearch"
		,true
	);

}

function lfn_AfterSessionSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        alert(nErrorCode, strErrorMsg);
        return;
    }
    
    var url = "http://172.19.1.17:8090/survey/admin/admin.jsp";
	
	var PostData =TextToBin("share_session="+JSESSIONID+"&share_sabun="+gds_oUserInfo.GetColumn(0, "PSABUN"),"utf-8");
	var Headers = "Content-Type: application/x-www-form-urlencoded";
	
	var rtn = AxMsie.Navigate2(url, ,"_self", PostData, Headers);
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    // to do    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

function Form_OnSize(obj,nCx,nCy,nState) {
    if (gs_IsResizingForm == "Y") {
    }
    }

function lfn_Form_OnUnloadCompleted(obj) {
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    gfn_DeleteOpenedMenu(ls_FormId[0]);
    gfn_Form_OnUnloadCompleted(obj);
}

/* 공통 필수 종료 */function lfn_End(obj)
{
	close();
}
]]></Script>
</Window>
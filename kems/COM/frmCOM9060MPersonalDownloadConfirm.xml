<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="748" Id="frmCOM9060MPersonalDownloadConfirm" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="개인정보&#32;다운로드&#32;자료&#32;점검" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="900" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioJibu">
				<Contents>
					<colinfo id="DEPTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPTNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMonth">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>01</CD>
						<DATA>1월</DATA>
					</record>
					<record>
						<CD>02</CD>
						<DATA>2월</DATA>
					</record>
					<record>
						<CD>03</CD>
						<DATA>3월</DATA>
					</record>
					<record>
						<CD>04</CD>
						<DATA>4월</DATA>
					</record>
					<record>
						<CD>05</CD>
						<DATA>5월</DATA>
					</record>
					<record>
						<CD>06</CD>
						<DATA>6월</DATA>
					</record>
					<record>
						<CD>07</CD>
						<DATA>7월</DATA>
					</record>
					<record>
						<CD>08</CD>
						<DATA>8월</DATA>
					</record>
					<record>
						<CD>09</CD>
						<DATA>9월</DATA>
					</record>
					<record>
						<CD>10</CD>
						<DATA>10월</DATA>
					</record>
					<record>
						<CD>11</CD>
						<DATA>11월</DATA>
					</record>
					<record>
						<CD>12</CD>
						<DATA>12월</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioYear">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioChoiceGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>정상</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>비정상</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDownloadList1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDownloadList2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDownloadList3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDownloadChk"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iDownloadChk">
				<Contents>
					<colinfo id="PDCGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PDCYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="PDCMONTH" size="256" summ="default" type="STRING"/>
					<colinfo id="PDCCHKGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PDCCHKREMARK" size="1000" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="632" LineColor="user14" Right="896" TabOrder="61" Top="1" Type="Rectangle" Width="264"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="3" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="350">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="722" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="1" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="809" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Shape Bottom="87" Height="40" Id="Shape0" Left="4" LineColor="user15" Right="892" TabOrder="5" Top="47" Type="Rectangle" Width="888"></Shape>
		<Static Align="Center" Height="20" Id="lbBiz" Left="20" Style="sty_LabelGruopBox" TabOrder="6" Text="조회" Top="36" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Height="20" Id="lbJibu" Left="10" Style="sty_Label" TabOrder="7" Text="지부" Top="61" UserData="S" VAlign="Middle" Width="75"></Static>
		<Combo Border="Flat" CodeColumn="DEPTCD" DataColumn="DEPTNM" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_ioJibu" Left="87" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="60" UserData="I" Width="100"></Combo>
		<Shape Bottom="280" Height="165" Id="Shape2" Left="4" LineColor="user15" Right="892" TabOrder="9" Top="115" Type="Rectangle" Width="888"></Shape>
		<Static Align="Center" BKColor="chocolate" Font="굴림,12,Bold" Height="27" Id="lbSearch1" Left="20" Style="sty_LabelGruopBox" TabOrder="10" Text="과다&#32;개인정보&#32;다운로드(정보주체&#32;100건&#32;이상)" Top="97" VAlign="Middle" Width="364"></Static>
		<Static Align="Center" Height="20" Id="lbNoJubsuCnt" Left="8" Style="sty_LabelStat" TabOrder="11" Text="조회건수" Top="129" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medTotalCnt1" Left="100" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="11" Top="129" UserData="S" Width="52"></MaskEdit>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oDownloadList1" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="273" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="122" Id="gdDownloadList1" InputPanel="FALSE" Left="8" LineColor="default" MinWidth="100" Right="888" RowHeight="20" Style="sty_Grid" TabOrder="12" TabStop="true" Top="151" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="880">
			<contents>
				<format id="Default">
					<columns>
						<col width="48"/>
						<col width="179"/>
						<col width="169"/>
						<col width="253"/>
						<col width="51"/>
						<col width="129"/>
						<col width="62"/>
					</columns>
					<head>
						<cell col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="메뉴"/>
						<cell align="center" col="2" display="text" text="제목"/>
						<cell align="center" col="3" display="text" text="사유"/>
						<cell align="center" col="4" display="text" text="건수"/>
						<cell col="5" display="text" text="일시"/>
						<cell align="center" col="6" display="text" text="사용자"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row&#32;+&#32;1"/>
						<cell align="left" col="1" colid="PCMENU" display="normal"/>
						<cell align="left" col="2" colid="PCTITLE" display="normal"/>
						<cell align="left" col="3" colid="PDHREASON" display="normal"/>
						<cell align="right" col="4" colid="PDHDWLDCNT" display="number"/>
						<cell align="center" col="5" colid="PDHREGDATE" display="normal"/>
						<cell align="center" col="6" colid="PNM" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbYear" Left="191" Style="sty_Label" TabOrder="14" Text="년월" Top="61" UserData="S" VAlign="Middle" Width="75"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxYear" INDEX="0" InnerDataset="ds_ioYear" Left="268" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="15" Top="60" UserData="S" Value="1" Width="66"></Combo>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMonth" INDEX="0" InnerDataset="ds_ioMonth" Left="336" OnFocus="gfn_ComponentOnFocus" OnKeyDown="cbxMonth_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="16" Top="60" UserData="S" Value="1" Width="50"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,11,Bold" Height="32" Id="btnSearch" ImageID="BTN_조회_b" Left="390" OnClick="lfn_Search" Style="sty_Button" TabOrder="17" Text="&#32;&#32;전체조회" ToolTipText="조회" Top="52" Width="112"></Button>
		<Shape Bottom="472" Height="165" Id="Shape1" Left="4" LineColor="user15" Right="892" TabOrder="18" Top="307" Type="Rectangle" Width="888"></Shape>
		<Static Align="Center" BKColor="chocolate" Font="굴림,12,Bold" Height="27" Id="lbSearch2" Left="20" Style="sty_LabelGruopBox" TabOrder="19" Text="1시간&#32;내&#32;과다&#32;다운로드&#32;횟수(20회&#32;이상)" Top="289" VAlign="Middle" Width="332"></Static>
		<Static Align="Center" Height="20" Id="Static1" Left="8" Style="sty_LabelStat" TabOrder="21" Text="조회건수" Top="321" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medTotalCnt2" Left="100" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="20" Top="321" UserData="S" Width="52"></MaskEdit>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oDownloadList2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="466" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="122" Id="gdDownloadList2" InputPanel="FALSE" Left="8" LineColor="default" MinWidth="100" OnCellClick="gdDownloadList2_OnCellClick" OnCellDBLClick="gdDownloadList2_OnCellDblClick" Right="888" RowHeight="20" Style="sty_Grid" TabOrder="22" TabStop="true" Top="344" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="880">
			<contents>
				<format id="Default">
					<columns>
						<col width="48"/>
						<col width="155"/>
						<col width="180"/>
						<col width="158"/>
						<col width="86"/>
					</columns>
					<head>
						<cell col="0" display="text" text="순번"/>
						<cell col="1" display="text" text="다운로드&#32;횟수"/>
						<cell align="center" col="2" display="text" text="다운로드&#32;일시"/>
						<cell align="center" col="3" display="text" text="사용자"/>
						<cell align="center" col="4" display="text" text="내역보기"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row&#32;+&#32;1"/>
						<cell align="center" col="1" colid="CNT" display="normal"/>
						<cell align="center" col="2" colid="REGHH" display="normal"/>
						<cell align="center" col="3" colid="PNM" display="normal"/>
						<cell align="center" col="4" cursor="hand" display="button" expr="&apos;내역보기&apos;"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape Bottom="664" Height="165" Id="Shape3" Left="4" LineColor="user15" Right="892" TabOrder="23" Top="499" Type="Rectangle" Width="888"></Shape>
		<Static Align="Center" BKColor="chocolate" Font="굴림,12,Bold" Height="27" Id="lbSearch3" Left="20" Style="sty_LabelGruopBox" TabOrder="24" Text="비&#32;업무시간&#32;내&#32;다운로드[근무일(21시~익일07시),&#32;휴일]" Top="481" VAlign="Middle" Width="452"></Static>
		<Static Align="Center" Height="20" Id="Static3" Left="8" Style="sty_LabelStat" TabOrder="26" Text="조회건수" Top="513" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medTotalCnt3" Left="100" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="25" Top="513" UserData="S" Width="52"></MaskEdit>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oDownloadList3" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="657" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="122" Id="gdDownloadList3" InputPanel="FALSE" Left="8" LineColor="default" MinWidth="100" Right="888" RowHeight="20" Style="sty_Grid" TabOrder="27" TabStop="true" Top="535" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="880">
			<contents>
				<format id="Default">
					<columns>
						<col width="48"/>
						<col width="177"/>
						<col width="162"/>
						<col width="193"/>
						<col width="73"/>
						<col width="54"/>
						<col width="134"/>
						<col width="61"/>
					</columns>
					<head>
						<cell col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="메뉴"/>
						<cell align="center" col="2" display="text" text="제목"/>
						<cell align="center" col="3" display="text" text="사유"/>
						<cell col="4" display="text" text="구분"/>
						<cell align="center" col="5" display="text" text="건수"/>
						<cell col="6" display="text" text="일시"/>
						<cell align="center" col="7" display="text" text="사용자"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row&#32;+&#32;1"/>
						<cell align="left" col="1" colid="PCMENU" display="normal"/>
						<cell align="left" col="2" colid="PCTITLE" display="normal"/>
						<cell align="left" col="3" colid="PDHREASON" display="normal"/>
						<cell align="center" col="4" colid="ETC" display="text"/>
						<cell align="right" col="5" colid="PDHDWLDCNT" display="number"/>
						<cell align="center" col="6" colid="PDHREGDATE" display="normal"/>
						<cell align="center" col="7" colid="PNM" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape Bottom="744" Height="71" Id="Shape4" Left="4" LineColor="user15" Right="892" TabOrder="28" Top="673" Type="Rectangle" Width="888"></Shape>
		<Static Align="Center" BKColor="user15" Font="굴림,16,Bold" Height="67" Id="Static4" Left="5" Style="sty_Label" TabOrder="29" Text="다운로드&#10;점검결과&#10;전송" Top="675" UserData="S" VAlign="Middle" Width="99"></Static>
		<Static Align="Center" Font="굴림,12,Bold" Height="62" Id="Static5" Left="344" Style="sty_Label" TabOrder="30" Text="조치사항" Top="677" UserData="S" VAlign="Middle" Width="75"></Static>
		<Button Font="굴림,14,Bold" Height="66" Id="btnSave" Left="812" OnClick="btnSave_OnClick" TabOrder="31" Text="등록" Top="676" Width="77"></Button>
		<Static Align="Center" Font="굴림,12,Bold" Height="62" Id="Static6" Left="106" Style="sty_Label" TabOrder="32" Text="확인여부" Top="677" UserData="S" VAlign="Middle" Width="75"></Static>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Font="굴림,12,Bold" Height="52" Id="radChoiceGubun" INDEX="-1" InnerDataset="ds_ioChoiceGubun" Left="184" LeftMargin="4" OnChanged="radChoiceGubun_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="33" Top="682" Width="152"></Radio>
		<Static Align="Center" BKColor="user35" Color="user0" Font="굴림,14,Bold" Height="27" Id="lbChk" Left="511" TabOrder="34" Top="54" VAlign="Middle" Width="249"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="635" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="35" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static7" Left="608" Style="sty_Label" TabOrder="36" Text="정보주체&#32;건수" Top="123" UserData="S" VAlign="Middle" Width="90"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Border="Flat" Column="BTEL" Height="20" Id="edDownloadCnt1" ImeMode="native" Left="701" LeftMargin="2" MaxLength="16" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="37" Top="123" UserData="S:건수" Width="56"></Edit>
		<Static Height="20" Id="Static8" Left="760" TabOrder="38" Text="건&#32;이상" Top="124" VAlign="Middle" Width="44"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,11,Bold" Height="28" Id="btnSearch1" Left="807" OnClick="lfn_Search1" Style="sty_Button" TabOrder="39" Text="조&#32;회" ToolTipText="조회" Top="119" Width="80"></Button>
		<Static Align="Center" Height="20" Id="Static9" Left="608" Style="sty_Label" TabOrder="40" Text="다운로드&#32;횟수" Top="317" UserData="S" VAlign="Middle" Width="90"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Border="Flat" Column="BTEL" Height="20" Id="edDownloadCnt2" ImeMode="native" Left="701" LeftMargin="2" MaxLength="16" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="41" Top="317" UserData="S:횟수" Width="56"></Edit>
		<Static Height="20" Id="Static10" Left="760" TabOrder="42" Text="회&#32;이상" Top="318" VAlign="Middle" Width="44"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,11,Bold" Height="28" Id="btnSearch2" Left="807" OnClick="lfn_Search2" Style="sty_Button" TabOrder="43" Text="조&#32;회" ToolTipText="조회" Top="312" Width="80"></Button>
		<Static Align="Center" Height="20" Id="Static11" Left="555" Style="sty_Label" TabOrder="44" Text="근무일&#32;비업무시간" Top="508" UserData="S" VAlign="Middle" Width="122"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,11,Bold" Height="28" Id="btnSearch3" Left="807" OnClick="lfn_Search3" Style="sty_Button" TabOrder="45" Text="조&#32;회" ToolTipText="조회" Top="503" Width="80"></Button>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medStartTime" Left="680" LeftMargin="2" Mask="##" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="46" Top="508" Type="STRING" UserData="S:시간" Width="22"></MaskEdit>
		<Static Align="Center" Height="20" Id="lbTimeWave" Left="704" Style="sty_Text" TabOrder="48" Text="시&#32;~&#32;익일" Top="509" VAlign="Middle" Width="58"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medEndTime" Left="763" LeftMargin="2" Mask="##" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="47" Top="508" Type="STRING" UserData="S:시간" Width="22"></MaskEdit>
		<TextArea Height="60" Id="TARemark" Left="421" TabOrder="49" Top="679" VScroll="TRUE" Width="388"></TextArea>
		<Static Height="20" Id="Static0" Left="786" Style="sty_Text" TabOrder="50" Text="시" Top="509" VAlign="Middle" Width="15"></Static>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmCOM9060MPersonalDownloadConfirm.xml
 * 설명 : 개인정보 다운로드 자료 점검
 * 작성일 : 2019.12.03
 * 작성자 : 정현호
 */

#include "LIB::training.js"; // 공통업무 관련
/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";
    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.
    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }

    //gfn_SearchAllJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회
    // 부서정보 조회 
    lfn_DeptSearch();
    
    cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");    
    
    
    var currYear = toNumber(left(getDate(), 4));
    ds_ioYear.ClearData();
    
    for (var i=-4; i<=1; i++) {
        ds_ioYear.InsertRow(0);
        ds_ioYear.SetColumn(0, "CD", currYear + i);
        ds_ioYear.SetColumn(0, "DATA", currYear + i);
    }

	if (substr(getDate(), 4, 2) == "01") { 
		cbxYear.Value = toNumber(currYear)-1;
		cbxMonth.Value = "12";
	} else {
		cbxYear.Value = currYear;
		cbxMonth.Value = lpad(toNumber(substr(getDate(), 4, 2))-1, "0", 2);
	}
    cbxJibu.SetFocus();
    
    
    edDownloadCnt1.Text = 100;	// 다운로드 정보주체 건수
    edDownloadCnt2.Text = 20;	// 1시간내 다운로드 횟수
    medStartTime.Value = "21";	// 근무일 비업무시간
    medEndTime.Value = "07";	// 근무일 비업무시간
    
    radChoiceGubun.Index = -1;
    lbChk.Visible = false;
    
}
/**
 * 버튼 실행 권한
 */
function lfn_SetFormAuth(bStatus) {
}
/*
 * 기능 :  조회
 */
 
 /*
 * 기능 : 부서정보 조회
 */
function lfn_DeptSearch(obj) {

    ds_ioJibu.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("sys:search0093DeptList", false);
	
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioJibu=ds_ioDeptList"	// outDs
		,""
		,"lfn_AfterDeptSearch"
		,false
	);
}

/*
 * 기능 : 부서정보 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterDeptSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
	// 부서정보 '전체'
	ds_ioJibu.InsertRow(0);
	ds_ioJibu.SetColumn(0,"DEPTNM","전체");
}
 
 function lfn_Search(obj)
{
	lfn_searchDownloadChk();
	lbSearch1.Text = "과다 개인정보 다운로드(정보주체 "+ edDownloadCnt1.Text +"건 이상)";
	lbSearch2.Text = "1시간 내 과다 다운로드 횟수("+ edDownloadCnt2.Text +"회 이상)";
	lbSearch3.Text = "비 업무시간 내 다운로드[근무일("+ medStartTime.Text + "시~익일"+ medEndTime.Text +"시), 휴일]";
	lfn_searchDownloadList1();
	lfn_searchDownloadList2();
	lfn_searchDownloadList3();
}

 function lfn_Search1(obj)
{
	lbSearch1.Text = "과다 개인정보 다운로드(정보주체 "+ edDownloadCnt1.Text +"건 이상)";
	lfn_searchDownloadList1();
}

 function lfn_Search2(obj)
{
	lbSearch2.Text = "1시간 내 과다 다운로드 횟수("+ edDownloadCnt2.Text +"회 이상)";
	lfn_searchDownloadList2();
}

 function lfn_Search3(obj)
{
	lbSearch3.Text = "비 업무시간 내 다운로드[근무일("+ medStartTime.Text + "시~익일"+ medEndTime.Text +"시), 휴일]";
	lfn_searchDownloadList3();
}


 function lfn_searchDownloadList1() {
	
	ds_oDownloadList1.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("com:searchPersonalDownloadList1", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oDownloadList1=ds_oDownloadList1" // outDs
		,"GTMGNO=" + quote(cbxJibu.Value)
		 + " YEAR=" + quote(cbxYear.Value)
		 + " MONTH=" + quote(cbxMonth.Value)
		 + " DCNT=" + edDownloadCnt1.Text // args
		,"lfn_AfterDownloadList"
		,false
		,""
		,true
	);
	
 }
 
 function lfn_searchDownloadList2() {
	
	ds_oDownloadList2.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("com:searchPersonalDownloadList2", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oDownloadList2=ds_oDownloadList2" // outDs
		,"GTMGNO=" + quote(cbxJibu.Value)
		 + " YEAR=" + quote(cbxYear.Value)
		 + " MONTH=" + quote(cbxMonth.Value)
	 	 + " DCNT=" + edDownloadCnt2.Text // args
		,"lfn_AfterDownloadList"
		,false
		,""
		,true
	);
	
 }
 
 function lfn_searchDownloadList3() {
	
	ds_oDownloadList3.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("com:searchPersonalDownloadList3", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oDownloadList3=ds_oDownloadList3" // outDs
		,"GTMGNO=" + quote(cbxJibu.Value)
		 + " YEAR=" + quote(cbxYear.Value)
		 + " MONTH=" + quote(cbxMonth.Value)
		 + " STIME=" + quote(medStartTime.Text)
		 + " ETIME=" + quote(medEndTime.Text) // args
		,"lfn_AfterDownloadList"
		,false
		,""
		,true
	);
	
 }
 
 function lfn_AfterDownloadList(nErrorCode, strErrorMsg) {
    
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oDownloadList1.GetCount() > 0) {
		// 총건수
		medTotalCnt1.Value = ds_oDownloadList1.GetCount();
    }
    
    if (ds_oDownloadList2.GetCount() > 0) {
		// 총건수
		medTotalCnt2.Value = ds_oDownloadList2.GetCount();
    }

    if (ds_oDownloadList3.GetCount() > 0) {
		// 총건수
		medTotalCnt3.Value = ds_oDownloadList3.GetCount();
    }
  
}




function gdDownloadList2_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

	if (nCell == 4) {
	
		if(ds_oDownloadList2.GetRowCount() == 0) {	
			gfn_Alert("자료가 없습니다.");	
			return false;	
		} else {
		
			gdDownloadList2_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex);
		}
    }
}


function gdDownloadList2_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
        var sArg = "sGTMGNO=" + quote(cbxJibu.Value)
            + " sREGDATE8=" + quote(ds_oDownloadList2.GetColumn(nRow, "PDHREGDATE8"))
            + " sHOUR=" + quote(ds_oDownloadList2.GetColumn(nRow, "PDHREGHH"))
            + " sSABUN=" + quote(ds_oDownloadList2.GetColumn(nRow, "PDHREGSABUN"))
            
            + " sPCCD=" + quote(ds_oDownloadList2.GetColumn(nRow, "PDHPCCD"));            var arrPos = Dialog("COM::frmCOM9060PPersonalDownloadList.xml", sArg, 750, 400, "", -1, -1);
}


function lfn_searchDownloadChk() {
	
	lbChk.Visible = true;
	
	ds_oDownloadChk.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("com:searchPersonalDownloadChk", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oDownloadChk=ds_oDownloadChk" // outDs
		,"PDCGTMGNO=" + quote(cbxJibu.Value)
		 + " PDCYEAR=" + quote(cbxYear.Value)
		 + " PDCMONTH=" + quote(cbxMonth.Value)	// args
		,"lfn_AfterDownloadChk"
		,false
		,""
		,true
	);
	
 }
 
 function lfn_AfterDownloadChk(nErrorCode, strErrorMsg) {
    
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    if (ds_oDownloadChk.GetRowCount() > 0) {
		
		radChoiceGubun.Value = ds_oDownloadChk.GetColumn(0, "PDCCHKGUBUN");
		if (radChoiceGubun.Value == 0) {
			lbChk.Text = "점검결과 전송완료(정상)";
		} else {
			lbChk.Text = "점검결과 전송완료(비정상)";
		}
		TARemark.Text = ds_oDownloadChk.GetColumn(0, "PDCCHKREMARK");
	} else {
		lbChk.Text = "점검결과 미전송";
		radChoiceGubun.Index = -1;
	}
}

function btnSave_OnClick(obj)
{

    if (gfn_IsNull(cbxJibu.Value)) {
        gfn_Alert("지부를 선택해 주십시오.");
        return false;
    }
    
    if (gfn_IsNull(cbxYear.Value)) {
        gfn_Alert("년도를 선택해 주십시오.");
        return false;
    }
    
    if (gfn_IsNull(cbxMonth.Value)) {
        gfn_Alert("월을 선택해 주십시오.");
        return false;
    }

    if (radChoiceGubun.Index < 0) {
        gfn_Alert("확인여부를 선택해 주십시오.");
        return false;
    }
    
	if (ds_oDownloadList1.GetRowCount() == 0 && ds_oDownloadList2.GetRowCount() == 0 && ds_oDownloadList3.GetRowCount() == 0) {
        if (!gfn_Confirm("자료가 조회되지 않았거나 다운로드한 이력이 없습니다.\n\n그래도 등록하시겠습니까?")) {
			return false;
        } 
    }
    	

//    lfn_searchDownloadChk();

    if (ds_oDownloadChk.GetRowCount() > 0 && ds_oDownloadChk.GetColumn(0, "PDCCLOSEGUBUN") == "0") { //정보지원과에서 확인처리한 경우
        gfn_Alert(cbxYear.Value + "년 " + cbxMonth.Value + "월 개인정보 다운로드 확인자료는 수정할 수 없습니다.");
        return false;
    }
    
    if (gfn_isNull(TARemark.Text)) {
		gfn_Alert("비정상인 경우 조치사항을 반드시 입력하세요!");
		return false;
    }
    if (ds_oDownloadChk.GetRowCount() == 0) {
		if (!gfn_Confirm(cbxYear.Value + "년 " + cbxMonth.Value + "월 점검결과를 등록하시겠습니까?")) {
			return false;
		} 
	} else {
		if (!gfn_Confirm(cbxYear.Value + "년 " + cbxMonth.Value + "월 점검결과를 수정하시겠습니까?")) {
			return false;
		} 
	}

    ds_iDownloadChk.ClearData();
    ds_iDownloadChk.InsertRow(0);
    ds_iDownloadChk.SetColumn(0, "PDCGTMGNO", cbxJibu.Value);
    ds_iDownloadChk.SetColumn(0, "PDCYEAR", cbxYear.Value);
    ds_iDownloadChk.SetColumn(0, "PDCMONTH", cbxMonth.Value);
    ds_iDownloadChk.SetColumn(0, "PDCCHKGUBUN", radChoiceGubun.Value);
    ds_iDownloadChk.SetColumn(0, "PDCCHKREMARK", TARemark.Text);

    tit_clearActionInfo();
    tit_addSingleActionInfo("com:insertPersonalDownloadChk", "", 0, "");
    tit_callService(
        ""
        ,""
        ,"ds_iDownloadChk=ds_iDownloadChk"	// inDs
        ,""	// outDs
        ,""	// args 
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );

}

function lfn_AfterSave(nErrorCode, strErrorMsg) {
    
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    gfn_Alert("정상적으로 저장되었습니다.");
	lfn_Search();
  
}



function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리	
}



function radChoiceGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (radChoiceGubun.Index == 0) {
		TARemark.Text = "특이사항 없음";
	} else {
		TARemark.Text = "";
	}
}

]]></Script>
</Window>
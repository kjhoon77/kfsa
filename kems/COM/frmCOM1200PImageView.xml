<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="400" Id="frmCOM1200PImageView" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="이미지보기팝업" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="600" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oEducationPlace">
				<Contents>
					<colinfo id="CREATE_DATE" size="7" summ="default" type="DATE"/>
					<colinfo id="CREATE_ID" size="20" summ="default" type="STRING"/>
					<colinfo id="JJIBUCD" size="2" summ="default" type="STRING"/>
					<colinfo id="MODIFY_DATE" size="7" summ="default" type="DATE"/>
					<colinfo id="MODIFY_ID" size="20" summ="default" type="STRING"/>
					<colinfo id="ZBUNJI" size="30" summ="default" type="STRING"/>
					<colinfo id="SIKUDONG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZHO" size="30" summ="default" type="STRING"/>
					<colinfo id="ZREGIONCD" size="2" summ="default" type="STRING"/>
					<colinfo id="ZSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="ZZIPCD" size="6" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="420" LineColor="user14" Right="598" TabOrder="61" Top="1" Type="Rectangle" Width="178"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="509" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Image Height="360" Id="imgImage" Left="4" OnClick="imgImage_OnClick" OnLoadCompleted="imgImage_OnLoadCompleted" Style="sty_Image" TabOrder="2" Top="32" Transparent="TRUE" Width="592"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnDownload" ImageID="BTN_TEXT_COM" Left="423" OnClick="btnDownload_OnClick" Style="sty_Button" TabOrder="3" Text="다운로드" ToolTipText="이미지저장" Top="4" Width="85"></Button>
		<HttpFile Height="24" Id="hfAttachFile" Left="396" Top="2" Width="24"></HttpFile>
		<FileDialog Bottom="26" Filter="Image(*.bmp;*.jpg;*.gif)|*.bmp;*.jpg;*.gif|BMP(*.bmp)|*.bmp|JPG(*.jpg)|*.jpg|GIF(*.gif)|*.gif|" Height="24" Id="fdAttachFile" Left="368" Right="392" TabOrder="4" Top="2" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[/*
 * 교육장약도명 : frmCOM1200PImageView.xml
 * 설명 : 이미지보기팝업
 * 작성일 : 2009.07.17
 * 작성자 : 김동현
 */

#include "LIB::COMMON.js"; // 공통 관련

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    if (IsExistVar("sRealFileName")) {
        if (gfn_IsNull(sRealFileName)) {
            imgImage.Text = "등록된 이미지가 없습니다.";
            btnDownload.Enable = false;
        } else {
            if (sMapGubun = "MAP"){
                imgImage.ImageID = "http://www.kfsi.or.kr" + sFilePath + sRealFileName;
            } else {
                imgImage.ImageID = GF_FILE_SERVER_URL + "kems" + sFilePath + "/" + sRealFileName;
            }
            if (sDownloadYN == "N") {	// 다운로드 여부
				btnDownload.Enable = false;
            }
        }
    }

}

function Form_OnUnloadCompleted(obj) {
    Close();
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    switch (nChar) {
        case 27 : // 종료(Esc)
            lfn_End();
            break;
    }
}

/*
 * 기능 : 종료
 */
function lfn_End(obj) {
    Close();
}
/* 공통 필수 종료 */

/* 사용자 이벤트 함수 */
function imgImage_OnLoadCompleted(obj) {
    var arrXy = imgImage.GetImageSize();
    window.Height = arrXy[1] + imgImage.Top + 4 + window.Height - this.Height;
    window.Width = arrXy[0] + 12;

    imgImage.Height = arrXy[1];
    imgImage.Width = arrXy[0];

    btnDownload.Left = arrXy[0] + 4 - btnDownload.Width - 2 - btnEnd.Width;
    btnEnd.Left = arrXy[0] + 4 - btnEnd.Width;
    shpBtnBox.Left = arrXy[0] + 4 - shpBtnBox.Width;
}

function btnDownload_OnClick(obj) {

    fdAttachFile.Type = "SAVE";
    fdAttachFile.FileName = iif(gfn_IsNull(sSaveFileName), "제목없음.bmp", sSaveFileName);

    if (fdAttachFile.open()) {
        var arrRtn = tit_fileRead(
            hfAttachFile
            , sFilePath
            , sRealFileName
            , fdAttachFile.FilePath
            , fdAttachFile.FileName
        );

        gfn_Alert(MSGI00060); //다운로드 완료 메시지
    }

}]]></Script>
</Window>
<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="400" Id="frmspcledu0601MExamSupervisorListPopup" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="시험감독관검색팝업" Top="8" Ver="1.0" Width="600" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_oExamSupervisor">				<Contents>					<colinfo id="SIMGNO" size="256" summ="default" type="STRING"/>					<colinfo id="SIPERSONNM" size="256" summ="default" type="STRING"/>					<colinfo id="SIBDAY" size="256" summ="default" type="STRING"/>					<colinfo id="SITEL" size="256" summ="default" type="STRING"/>					<colinfo id="SICOMPNM" size="256" summ="default" type="STRING"/>					<colinfo id="SIJIBUCD" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>		</Datasets>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="331" LineColor="user14" Right="598" TabOrder="61" Top="1" Type="Rectangle" Width="267"></Shape>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSelect" ImageID="BTN_TEXT_COM" Left="422" OnClick="btnSelect_OnClick" Style="sty_Button" TabOrder="2" Text="선택" ToolTipText="선택" Top="4" Transparent="TRUE" Width="85"></Button>		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oExamSupervisor" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="396" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="344" Id="gdExamSupervisor" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnCellDBLClick="gdExamSupervisor_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="596" RowHeight="20" Style="sty_Grid" TabOrder="6" TabStop="true" Top="52" UseDBuff="true" UsePopupMenu="true" UserData="시험감독관목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="592">			<contents>				<format id="Default">					<columns>						<col width="101"/>						<col width="136"/>						<col width="222"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="성명"/>						<cell align="center" col="1" display="text" text="생년월일"/>						<cell align="center" col="2" display="text" text="근무처"/>					</head>					<body>						<cell align="center" col="0" colid="SIPERSONNM" display="text"/>						<cell align="center" col="1" colid="SIBDAY" display="text" Mask="####년##월##일"/>						<cell align="center" col="2" colid="SICOMPNM" display="text"/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="BTN_MULTI_SORT" Left="520" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="5" Top="28" Transparent="TRUE" Width="74"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="335" OnClick="lfn_Search" Style="sty_Button" TabOrder="1" ToolTipText="조회" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="509" OnClick="lfn_End" Style="sty_Button" TabOrder="3" ToolTipText="닫기" Top="4" Width="85"></Button>		<Static Align="Center" Height="20" Id="lbExamSupervisor" Left="4" Style="sty_Label" TabOrder="7" Text="시험감독관" Top="28" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edExamSupervisor" ImeMode="native" Left="96" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExamSupervisor_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="4" Top="28" UserData="S" Width="232"></Edit>	</Form>	<Script><![CDATA[/* * 시험감독관명 : frmspcledu0601MExamSupervisorListPopup.xml * 설명 : 시험감독관검색팝업 * 작성일 : 2009.08.29 * 작성자 : 이규희 */#include "LIB::COMMON.js"; // 공통 관련var ls_sEJibuCD = "";/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    if (IsExistVar("sExamSupervisorNm")) {        ls_sEJibuCD = sExamSupervisorNm;    }    lfn_search(obj); // 시험감독관 조회}function Form_OnUnloadCompleted(obj) {    Close();}function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    switch (nChar) {        case 27 : // 종료(Esc)            lfn_End();            break;        case 113 : // 조회(F2)            lfn_Search();            break;    }}/* * 기능 : 조회 */function lfn_Search(obj) {    ds_oExamSupervisor.ClearData(); // 데이타셋 초기화        // 조회이력을 저장한다.      ls_HistoryArg = "지부=" + quote(ls_sEJibuCD)                + ",감독관명=" + quote(edExamSupervisor.Text);    gfn_InsertSearchPrintHistory(        "S"        , this.ID        , "감독관검색팝업"        , ls_HistoryArg    );    tit_clearActionInfo();	tit_addCsvSearchActionInfo("spcledu:searchExamSupervisorList", false);	// 서버 호출 	tit_callService(		""		,""		,""	// inDs		,"ds_oExamSupervisor=ds_oExamSupervisor"	// outDs		,"SIJIBUCD=" + quote(ls_sEJibuCD)            + " SIPERSONNM=" + quote(edExamSupervisor.Text) // args		,"lfn_AfterSearchExamSupervisor"		,false	);}/* * 기능 : 종료 */function lfn_End(obj) {    Close();}/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 공통코드 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchExamSupervisor(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    if (ds_oExamSupervisor.GetCount() == 1) {        var arrArg = Array(4);        arrArg[0] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SIMGNO"); // 감독관관리번호        arrArg[1] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SIPERSONNM"); // 성명        arrArg[2] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SIBDAY"); // 생년월일        arrArg[3] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SICOMPNM"); // 근무처        Close(arrArg);    }    gfn_SearchMessage(gdExamSupervisor); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* 사용자 이벤트 함수 */function lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {    var lobj_Dataset = object(obj.BindDataset);    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.    if (lobj_Dataset.GetRowCount() > 1) {        gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.    }}function btnMutilSort_OnClick(obj){	gfn_GridMultiSort(gdExamSupervisor, 0); // 멀티 정렬을 실행한다.}function btnSelect_OnClick(obj){    var arrArg = Array(4);    arrArg[0] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SIMGNO"); // 감독관관리번호    arrArg[1] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SIPERSONNM"); // 성명    arrArg[2] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SIBDAY"); // 생년월일    arrArg[3] = ds_oExamSupervisor.GetColumn(ds_oExamSupervisor.currow, "SICOMPNM"); // 근무처    Close(arrArg);}function gdExamSupervisor_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex){    btnSelect_OnClick(obj);}function edExamSupervisor_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){	if (nChar == 13) {        lfn_Search();	}}]]></Script></Window>
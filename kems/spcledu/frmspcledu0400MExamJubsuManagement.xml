<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="590" Id="frmspcledu0400MExamJubsuManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="시험접수관리" Top="8" Ver="1.0" Width="1000" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_oJibu">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oCourse">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oEmailDomain">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oImage">				<Contents>					<colinfo id="FILE_NAME" size="260" summ="default" type="STRING"/>					<colinfo id="SHORT_FILE_NAME" size="14" summ="default" type="STRING"/>					<colinfo id="FILE_SIZE" size="4" summ="default" type="INT"/>					<colinfo id="CREATE_DATE" size="4" summ="default" type="DATE"/>					<colinfo id="UPDATE_DATE" size="4" summ="default" type="DATE"/>					<colinfo id="ACCESS_DATE" size="4" summ="default" type="DATE"/>					<colinfo id="ATTR_ARCHIVE" size="4" summ="default" type="INT"/>					<colinfo id="ATTR_SYSTEM" size="4" summ="default" type="INT"/>					<colinfo id="ATTR_HIDDEN" size="4" summ="default" type="INT"/>					<colinfo id="ATTR_READONLY" size="4" summ="default" type="INT"/>					<colinfo id="ATTR_DIRECTORY" size="4" summ="default" type="INT"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oRemarkGubun">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oExamOrderMgno"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJubsuNo"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oSeatNo"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJubsuAllInfo" OnRowPosChanged="ds_oJubsuAllInfo_OnRowPosChanged">				<Contents>					<colinfo id="COURSECD" size="2" type="STRING"/>					<colinfo id="COURSEMUNJECD" size="4" type="STRING"/>					<colinfo id="JUBSUNO" size="6" type="STRING"/>					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>					<colinfo id="MGJIBUCD" size="4" type="STRING"/>					<colinfo id="PASSDATE" size="8" type="STRING"/>					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>					<colinfo id="TJPASSYN" size="1" type="STRING"/>					<colinfo id="EOMGNO" size="22" type="DECIMAL"/>					<colinfo id="EORDER" size="3" type="STRING"/>					<colinfo id="YEAR" size="4" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oOrderHist">				<Contents>					<colinfo id="ABSENTYN" size="7" type="STRING"/>					<colinfo id="AFTERJIBU" size="4" type="STRING"/>					<colinfo id="AFTERJUBSUNO" size="6" type="STRING"/>					<colinfo id="AFTERMGNO" size="22" type="DECIMAL"/>					<colinfo id="AFTERORDER" size="3" type="STRING"/>					<colinfo id="BEFORJIBU" size="4" type="STRING"/>					<colinfo id="BEFORJUBSUNO" size="6" type="STRING"/>					<colinfo id="BEFORMGNO" size="22" type="DECIMAL"/>					<colinfo id="BEFORORDER" size="3" type="STRING"/>					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>					<colinfo id="TJLASTSUNAPGUBUN" size="2" type="STRING"/>					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>					<colinfo id="EOHSEQ" size="22" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oSetlmentHist" OnRowPosChanged="ds_oSetlmentHist_OnRowPosChanged">				<Contents>					<colinfo id="ESSETLMTYN" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioMenuTree">				<Contents>					<colinfo id="MORDERSEQ" size="256" summ="default" type="STRING"/>					<colinfo id="MMENUID" size="256" summ="default" type="STRING"/>					<colinfo id="MENULEVEL" size="256" summ="default" type="STRING"/>					<colinfo id="MPARENTMENUID" size="256" summ="default" type="STRING"/>					<colinfo id="MMENUNM" size="256" summ="default" type="STRING"/>					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>					<colinfo id="MURL" size="256" summ="default" type="STRING"/>					<colinfo id="MREMARK" size="256" summ="default" type="STRING"/>					<colinfo id="MURLTYPE" size="256" summ="default" type="STRING"/>					<colinfo id="MSYSGUBUN" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oModifyColumn">				<Contents>					<colinfo id="COLUMNCD" size="256" summ="default" type="STRING"/>					<colinfo id="COLUMNNM" size="256" summ="default" type="STRING"/>					<record>						<COLUMNCD>PERSONNM</COLUMNCD>						<COLUMNNM>성명</COLUMNNM>					</record>					<record>						<COLUMNCD>RESIDENTNO</COLUMNCD>						<COLUMNNM>주민번호</COLUMNNM>					</record>					<record>						<COLUMNCD>ZIPCD</COLUMNCD>						<COLUMNNM>우편번호</COLUMNNM>					</record>					<record>						<COLUMNCD>ADDR1</COLUMNCD>						<COLUMNNM>주소1</COLUMNNM>					</record>					<record>						<COLUMNCD>ADDR2</COLUMNCD>						<COLUMNNM>주소2</COLUMNNM>					</record>					<record>						<COLUMNCD>TEL</COLUMNCD>						<COLUMNNM>전화번호</COLUMNNM>					</record>					<record>						<COLUMNCD>HPTEL</COLUMNCD>						<COLUMNNM>휴대폰</COLUMNNM>					</record>					<record>						<COLUMNCD>EMAILID</COLUMNCD>						<COLUMNNM>이메일ID</COLUMNNM>					</record>					<record>						<COLUMNCD>EMAILDOMAIN</COLUMNCD>						<COLUMNNM>이메일주소</COLUMNNM>					</record>					<record>						<COLUMNCD>COMPNM</COLUMNCD>						<COLUMNNM>근무처</COLUMNNM>					</record>					<record>						<COLUMNCD>REMARKCD</COLUMNCD>						<COLUMNNM>적요구분</COLUMNNM>					</record>					<record>						<COLUMNCD>REMARK</COLUMNCD>						<COLUMNNM>적요내용</COLUMNNM>					</record>					<record>						<COLUMNCD>PICTURE</COLUMNCD>						<COLUMNNM>사진</COLUMNNM>					</record>					<record>						<COLUMNCD>JUBSUNO</COLUMNCD>						<COLUMNNM>접수번호</COLUMNNM>					</record>					<record>						<COLUMNCD>DECISIONSEATNO</COLUMNCD>						<COLUMNNM>좌석번호</COLUMNNM>					</record>					<record>						<COLUMNCD>BARCODE</COLUMNCD>						<COLUMNNM>바코드</COLUMNNM>					</record>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oExamJubsuResult"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oExamJubsuPrint"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oExamOrder"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioExamJubsu">				<Contents>					<colinfo id="ABSENTDAY" size="1" summ="default" type="STRING"/>					<colinfo id="ABSENTYN" size="7" summ="default" type="STRING"/>					<colinfo id="ADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="ADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="AUTHYN" size="1" summ="default" type="STRING"/>					<colinfo id="BARCODE" size="12" summ="default" type="STRING"/>					<colinfo id="COMPNM" size="30" summ="default" type="STRING"/>					<colinfo id="COURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="COURSEMUNJECD" size="3" summ="default" type="STRING"/>					<colinfo id="COURSENM" size="30" summ="default" type="STRING"/>					<colinfo id="DECISIONSEATNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EMAILDOMAIN" size="40" summ="default" type="STRING"/>					<colinfo id="EMAILID" size="40" summ="default" type="STRING"/>					<colinfo id="HPTEL" size="16" summ="default" type="STRING"/>					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>					<colinfo id="IIIMGSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>					<colinfo id="JUBSUNO" size="6" summ="default" type="STRING"/>					<colinfo id="LASTIMGSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LASTSUNAPGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="LASTEJHSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LASTEOHSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LASTESSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="MGJIBUCD" size="4" summ="default" type="STRING"/>					<colinfo id="MGJIBUNICK" size="20" summ="default" type="STRING"/>					<colinfo id="MGJIBUNM" size="70" summ="default" type="STRING"/>					<colinfo id="MUNJEGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="PASSYN" size="1" summ="default" type="STRING"/>					<colinfo id="PERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="REMARK" size="100" summ="default" type="STRING"/>					<colinfo id="REMARKCD" size="2" summ="default" type="STRING"/>					<colinfo id="RESIDENTNO" size="13" summ="default" type="STRING"/>					<colinfo id="TEL" size="16" summ="default" type="STRING"/>					<colinfo id="EJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TPMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EOMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EORDER" size="3" summ="default" type="STRING"/>					<colinfo id="YEAR" size="4" summ="default" type="STRING"/>					<colinfo id="ZIPCD" size="6" summ="default" type="STRING"/>					<colinfo id="EJEXPYN" size="1" summ="default" type="STRING"/>					<colinfo encrypt="base64" id="IIIMGBINARY" size="400" summ="default" type="BLOB"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oPosResult"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJibuGubun">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD>S</CD>						<DATA>소속지부접수</DATA>					</record>					<record>						<CD>T</CD>						<DATA>타지부접수</DATA>					</record>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oExamAdd"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oChangeTpmgno">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD>S</CD>						<DATA>조회</DATA>					</record>					<record>						<CD>C</CD>						<DATA>성명/주민번호&#32;변경</DATA>					</record>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oTrainingPerson"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioYearbizlink"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioT_E_L_JubsuCheck"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioExam_ReturnTpmgnoJubsuCheck"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioExam_JubsuCheck"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioExamPerson"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioTrainingJubsuMatching"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioSettelYN">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD>Y</CD>						<DATA>입금</DATA>					</record>					<record>						<CD>N</CD>						<DATA>미입금</DATA>					</record>				</Contents>			</Dataset>		</Datasets>		<Shape Bottom="272" Height="232" Id="shpGubunBox3" Left="328" LineColor="user15" Right="992" TabOrder="79" Top="40" Type="Rectangle" Width="664"></Shape>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnApplyPicture" ImageID="BTN_TEXT_06" Left="680" OnClick="btnApplyPicture_OnClick" Style="sty_Button" TabOrder="33" Text="최근사진반영" Top="104" Transparent="TRUE" Width="93"></Button>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="280" LineColor="user14" Right="1000" TabOrder="65" Top="1" Type="Rectangle" Width="720"></Shape>		<Shape Bottom="360" Height="320" Id="shpGubunBox1" Left="4" LineColor="user15" Right="324" TabOrder="79" Top="40" Type="Rectangle" Width="320"></Shape>		<Shape Bottom="436" Height="140" Id="shpGubunBox4" Left="332" LineColor="user15" Right="996" TabOrder="79" Top="296" Type="Rectangle" Width="664"></Shape>		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="60" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="192">			<Contents></Contents>		</Div>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oSetlmentHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="431" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="97" Id="gdSetlmentHist" InputPanel="FALSE" Left="435" LineColor="default" Right="992" RowHeight="20" Style="sty_Grid" TabOrder="47" TabStop="true" Top="334" UseDBuff="true" UsePopupMenu="true" UserData="결제내역" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="557">			<contents>				<format id="Default">					<columns>						<col width="35"/>						<col width="77"/>						<col width="47"/>						<col width="47"/>						<col width="98"/>						<col width="106"/>						<col width="70"/>						<col width="65"/>						<col width="73"/>						<col width="73"/>						<col width="94"/>						<col width="0"/>						<col width="94"/>						<col width="94"/>						<col width="1"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="순번"/>						<cell align="center" col="1" display="text" text="처리일자"/>						<cell col="2" display="text" text="결제"/>						<cell col="3" display="text" text="선수납"/>						<cell align="center" col="4" display="text" text="결제구분"/>						<cell align="center" col="5" display="text" text="결제방법"/>						<cell align="center" col="6" display="text" text="금액(원)"/>						<cell align="center" col="7" display="text" text="환불No."/>						<cell col="8" display="text" text="처리지부"/>						<cell align="center" col="9" display="text" text="처리자"/>						<cell align="center" col="10" display="text" text="주문번호"/>						<cell align="center" col="11" display="text" text="세금계산서발행여부"/>						<cell col="12" display="text" text="POS지부"/>						<cell col="13" display="text" text="관리지부"/>						<cell col="14" display="text" text="선수납여부"/>					</head>					<body>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="0" display="number" expr="ln_TotalGridSetlementCount&#32;-&#32;CURROW"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="1" colid="ESPROCDATE" display="text" Mask="####-##-##"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="2" colid="ESSETLMTYN" color='expr:iif(ESSETLMTYN==&quot;N&quot;,&quot;red&quot;,&quot;default&quot;)' combocol="CD" combodataset="ds_ioSettelYN" combotext="DATA" display="combo" font="굴림,10"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="3" colid="EARLYGUBUNNAME" color='expr:iif(EARLYGUBUN==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="4" colid="ESGUBUNCDNM" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="5" colid="ESGUBUNNM" display="text"/>						<cell align="right" bkcolor="expr:fn_bkcolor(currow)" col="6" colid="ESPROCAMOUNT" display="number" Mask="#,###"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="7" colid="ESREPAYREF" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="8" colid="ESPROCGTMGNM" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="9" colid="PROCSABUN" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="10" colid="ESJUMUNNO" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="11" colid="TAXRCPTYN" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="12" colid="ESPOSGTMGNM" display="text"/>						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="13" colid="ESMGGTMGNM" display="text"/>						<cell col="14" colid="EARLYGUBUN" display="text"/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="283" OnClick="lfn_Search" Style="sty_Button" TabOrder="50" ToolTipText="조회" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="457" OnClick="lfn_Delete" Style="sty_Button" TabOrder="3" ToolTipText="삭제&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="370" OnClick="lfn_Save" Style="sty_Button" TabOrder="2" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="651" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="4" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="738" OnClick="lfn_Excel" Style="sty_Button" TabOrder="5" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="825" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="6" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="912" OnClick="lfn_End" Style="sty_Button" TabOrder="7" ToolTipText="닫기" Top="4" Width="85"></Button>		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="61" Text="지부" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnChanged="lfn_SearchExamLatestOrder" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="55" UserData="I:지부" Width="88"></Combo>		<Static Align="Center" Height="82" Id="lbCourse" Left="8" Style="sty_Label" TabOrder="62" Text="직능" Top="80" UserData="S" VAlign="Middle" Width="20" WordWrap="TRUE"></Static>		<Static Align="Center" Height="20" Id="lbExamYear" Left="192" Style="sty_Label" TabOrder="63" Text="년도" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Height="20" Id="edExamYear" ImeMode="native" Left="284" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExamYear_OnKeyDown" OnKillFocus="lfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="56" UserData="I:년도" Width="36"></Edit>		<Static Align="Center" Height="20" Id="lbExamOrder" Left="8" Style="sty_Label" TabOrder="64" Text="회차" Top="166" UserData="S" VAlign="Middle" Width="88"></Static>		<Static Align="Center" Height="20" Id="lbPersonNm" Left="336" Style="sty_Label" TabOrder="65" Text="성명" Top="56" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edExamOrder" ImeMode="native" Left="100" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExamOrder_OnKeyDown" OnKillFocus="edExamOrder_OnKillFocus" Style="sty_Edit" TabOrder="11" Top="166" UserData="S:회차" Width="28"></Edit>		<Static Align="Center" Height="20" Id="lbResidentNo" Left="336" Style="sty_Label" TabOrder="66" Text="주민번호" Top="80" VAlign="Middle" Width="88"></Static>		<Static Align="Center" Height="20" Id="lbAt" Left="522" Style="sty_Text" TabOrder="67" Text="@" Top="200" VAlign="Middle" Width="16"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfo" ImageID="BTN_TEXT_06" Left="538" OnClick="btnSearchPersonInfo_OnClick" Style="sty_Button" TabOrder="26" Text="기본정보" Top="55" Transparent="TRUE" Width="93"></Button>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="PERSONNM" Height="20" Id="edPersonNm" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="13" Top="56" UserData="S:성명" Width="106"></Edit>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuNo" ImeMode="native" Left="100" LeftMargin="2" MaxLength="6" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edJubsuNo_OnKeyDown" OnKillFocus="edJubsuNo_OnKillFocus" Style="sty_Edit" TabOrder="12" Top="190" UserData="S:접수번호" Width="50"></Edit>		<Static Align="Center" Height="20" Id="lbSeq" Left="8" Style="sty_Label" TabOrder="68" Text="접수번호" Top="190" UserData="S" VAlign="Middle" Width="88"></Static>		<Static Align="Center" Height="20" Id="lbAddr" Left="336" Style="sty_Label" TabOrder="71" Text="주소" Top="104" VAlign="Middle" Width="88"></Static>		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioExamJubsu" BKColor="user4" Border="Flat" Column="ZIPCD" Height="20" Id="medZipCode" Left="428" LeftMargin="2" Mask="###-###" OnFocus="edZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="59" Top="104" Type="STRING" UserData="S" Width="58"></MaskEdit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchZipCode" ImageID="BTN_SEARCH" Left="488" OnClick="btnSearchZipCode_OnClick" Style="sty_Button" TabOrder="28" Top="104" Transparent="TRUE" Width="22"></Button>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="ADDR1" Height="20" Id="edAddr1" ImeMode="native" Left="336" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="15" Top="128" UserData="S" Width="436"></Edit>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="ADDR2" Height="20" Id="edAddr2" ImeMode="native" Left="336" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="16" Top="152" UserData="S" Width="436"></Edit>		<Static Align="Center" Height="20" Id="lbTel" Left="336" Style="sty_Label" TabOrder="69" Text="전화번호" Top="176" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="TEL" Height="20" Id="edTel" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="17" Top="176" UserData="S" Width="104"></Edit>		<Static Align="Center" Height="20" Id="lbHpTel" Left="536" Style="sty_Label" TabOrder="70" Text="휴대폰" Top="176" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="HPTEL" Height="20" Id="edHpTel" ImeMode="native" Left="628" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="18" Top="176" UserData="S" Width="104"></Edit>		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="RESIDENTNO" Height="20" Id="medResidentNo" Left="428" LeftMargin="2" Mask="######-#######" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="14" Top="80" Type="STRING" UserData="S:주민번호" Width="106"></MaskEdit>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxEmailDomain" INDEX="0" InnerDataset="ds_oEmailDomain" Left="642" OnChanged="cbxEmailDomain_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="36" Top="199" Width="92"></Combo>		<Static Align="Center" Height="20" Id="lbEmail" Left="336" Style="sty_Label" TabOrder="71" Text="E-Mail" Top="200" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="EMAILID" Height="20" Id="edEmail" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="19" Top="200" UserData="S" Width="95"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAuthResidentNo" ImageID="BTN_TEXT_06" Left="538" OnClick="btnAuthResidentNo_OnClick" Style="sty_Button" TabOrder="27" Text="실명인증" Top="79" Transparent="TRUE" Width="93"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExamJubsuModify" ImageID="BTN_TEXT_COM" Left="100" OnClick="btnExamJubsuModify_OnClick" Style="sty_Button" TabOrder="25" Text="회차변경" Top="288" Transparent="TRUE" Width="85"></Button>		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oJubsuAllInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="584" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdJubsuInfo" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnCellClick="gdJubsuInfo_OnCellClick" Right="496" RowHeight="20" Style="sty_Grid" TabOrder="48" TabStop="true" Top="476" UseDBuff="true" UsePopupMenu="true" UserData="개인접수정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="492">			<contents>				<format id="Default">					<columns>						<col width="35"/>						<col width="68"/>						<col width="36"/>						<col width="134"/>						<col width="31"/>						<col width="58"/>						<col width="83"/>						<col width="47"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="순번"/>						<cell align="center" col="1" display="text" text="지부"/>						<cell align="center" col="2" display="text" text="년도"/>						<cell align="center" col="3" display="text" text="직능"/>						<cell align="center" col="4" display="text" text="회차"/>						<cell align="center" col="5" display="text" text="접수번호"/>						<cell align="center" col="6" display="text" text="합격일자"/>						<cell align="center" col="7" display="text" text="환불"/>					</head>					<body>						<cell align="right" col="0" display="number" expr="ln_TotalGridInfoCount&#32;-&#32;CURROW"/>						<cell align="center" col="1" colid="MGJIBUCD" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>						<cell align="center" col="2" colid="YEAR" display="text"/>						<cell align="center" col="3" colid="COURSEMUNJECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>						<cell align="center" col="4" colid="EORDER" display="text"/>						<cell align="center" col="5" colid="JUBSUNO" display="text"/>						<cell align="center" col="6" colid="PASSDATE" display="text" Mask="####-##-##" text="####-##-##"/>						<cell align="center" col="7" colid="LASTSUNAPGUBUN" display="text"/>					</body>				</format>			</contents>		</Grid>		<Static Align="Center" Height="20" Id="lbJubsuInfo" Left="4" Style="sty_LabelGruopBox" TabOrder="72" Text="개인접수정보" Top="452" VAlign="Middle" Width="120"></Static>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oOrderHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="584" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdOrderHist" InputPanel="FALSE" Left="500" LineColor="default" OnCellClick="gdOrderHist_OnCellClick" Right="996" RowHeight="20" Style="sty_Grid" TabOrder="49" TabStop="true" Top="476" UseDBuff="true" UsePopupMenu="true" UserData="회차변경정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="496">			<contents>				<format id="Default">					<columns>						<col width="35"/>						<col width="70"/>						<col width="50"/>						<col width="60"/>						<col width="70"/>						<col width="50"/>						<col width="60"/>						<col width="79"/>						<col width="60"/>						<col width="200"/>					</columns>					<head>						<cell col="0" display="text" rowspan="2" SuppressAlign="Middle" text="순번">							<cell col="0" display="text" rowspan="2" text="순번"/>						</cell>						<cell col="1" display="text" rowspan="2" SuppressAlign="Middle" text="지부">							<cell col="0" display="text" rowspan="2" text="지부"/>						</cell>						<cell col="2" display="text" rowspan="2" SuppressAlign="Middle" text="회차">							<cell col="0" display="text" rowspan="2" text="회차"/>						</cell>						<cell col="3" display="text" rowspan="2" SuppressAlign="Middle" text="접수번호">							<cell col="0" display="text" rowspan="2" text="접수번호"/>						</cell>						<cell col="4" colspan="3" display="text" text="변경&#32;후">							<cell col="0" colspan="3" display="text" text="변경&#32;후"/>						</cell>						<cell align="center" col="7" display="text" rowspan="2" SuppressAlign="Middle" text="처리일자" Valign="Center" wordwrap="word"/>						<cell col="8" display="text" rowspan="2" SuppressAlign="Middle" text="환불여부">							<cell col="0" display="text" rowspan="2" text="환불여부"/>						</cell>						<cell col="9" display="text" rowspan="2" text="변경사유"/>						<cell align="center" col="4" display="text" row="1" text="지부"/>						<cell align="center" col="5" display="text" row="1" text="회차"/>						<cell align="center" col="6" display="text" row="1" text="접수번호"/>					</head>					<body>						<cell align="right" col="0" display="number" expr="ln_TotalGridOrderCount&#32;-&#32;CURROW"/>						<cell align="center" col="1" colid="BEFORJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>						<cell align="center" col="2" colid="BEFORORDER" display="text"/>						<cell align="center" col="3" colid="BEFORJUBSUNO" display="text"/>						<cell align="center" col="4" colid="AFTERJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>						<cell align="center" col="5" colid="AFTERORDER" display="text"/>						<cell align="center" col="6" colid="AFTERJUBSUNO" display="text"/>						<cell col="7" colid="EOHPROCDATE" display="text" Mask="####-##-##" text="####-##-##"/>						<cell align="center" col="8" colid="LASTSUNAPGUBUN" display="text"/>						<cell col="9" colid="EJHPROCREASON" display="text"/>					</body>				</format>			</contents>		</Grid>		<Static Align="Center" Height="20" Id="lbJubsuHist" Left="500" Style="sty_LabelGruopBox" TabOrder="73" Text="개인접수회차이력" Top="452" VAlign="Middle" Width="120"></Static>		<Static Align="Center" Height="20" Id="lbSetlmt" Left="348" Style="sty_LabelGruopBox" TabOrder="74" Text="결제내역" Top="288" VAlign="Middle" Width="120"></Static>		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="EMAILDOMAIN" Height="20" Id="edEmailDomain" ImeMode="native" Left="536" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="20" Top="200" UserData="S" Width="104"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeqList" ImageID="BTN_TEXT_06" Left="154" OnClick="btnSeqList_OnClick" Style="sty_Button" TabOrder="23" Text="접수목록" ToolTipText="현접수번호를&#32;제외한&#32;이후&#32;목록" Top="189" Transparent="TRUE" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchExamOrder" ImageID="BTN_TEXT_06" Left="132" OnClick="btnSearchExamOrder_OnClick" OnKeyDown="btnSearchExamOrder_OnClick" Style="sty_Button" TabOrder="22" Text="접수가능회차" Top="165" Transparent="TRUE" Width="92"></Button>		<FileDialog Bottom="28" Filter="All(*.*)|*.*|JPG&#32;File(*.jpg)|*.jpg|" Height="24" Id="fdImage" Left="226" Right="250" TabOrder="93" Top="4" Width="24"></FileDialog>		<HttpFile Height="24" Id="hfImage" Left="252" Top="4" Width="24"></HttpFile>		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="82" Id="radCourse" INDEX="0" InnerDataset="ds_oCourse" Left="32" OnChanged="lfn_SearchExamLatestOrder" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="10" Top="80" UserData="I:직능" Width="288"></Radio>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTraingJubsuHist" ImageID="BTN_TEXT_06" Left="538" OnClick="btnTraingJubsuHist_OnClick" Style="sty_Button" TabOrder="29" Text="접수정보(F6)" Top="104" Transparent="TRUE" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnChangeProcDate" ImageID="BTN_TEXT_06" Left="674" OnClick="btnChangeProcDate_OnClick" Style="sty_Button" TabOrder="44" Text="처리일자변경" Top="309" Transparent="TRUE" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnProcRct" ImageID="BTN_TEXT_09" Left="768" OnClick="btnProcRct_OnClick" Style="sty_Button" TabOrder="45" Text="현금영수증처리/취소" Top="309" Transparent="TRUE" Width="131"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRct" ImageID="BTN_TEXT_06" Left="901" OnClick="btnPrintReRct_OnClick" Style="sty_Button" TabOrder="46" Text="영수증재발행" Top="309" Transparent="TRUE" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendSms" ImageID="BTN_TEXT_04" Left="736" OnClick="btnSendSms_OnClick" Style="sty_Button" TabOrder="34" Text="SMS발송" Top="176" Transparent="TRUE" Width="66"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendEmail" ImageID="BTN_TEXT_04" Left="736" OnClick="btnSendEmail_OnClick" Style="sty_Button" TabOrder="37" Text="메일발송" Top="200" Transparent="TRUE" Width="66"></Button>		<Button BKColor="user17" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Font="굴림,10,Bold" Height="97" Id="btnSetlmt" Left="336" OnClick="btnSetlmt_OnClick" Style="sty_Button" TabOrder="42" Text="결제(POS)" Top="334" Width="96"></Button>		<Static Align="Center" Height="20" Id="lbOrderChange" Left="8" Style="sty_Label" TabOrder="76" Text="회차변경" Top="289" VAlign="Middle" Width="88"></Static>		<Shape BKColor="#cc0000" Bottom="284" Height="4" Id="shpBox1" Left="328" LineColor="#cc0000" Right="1000" TabOrder="76" Top="280" Type="Rectangle" Width="672"></Shape>		<Shape BKColor="#cc0000" Bottom="446" Height="4" Id="shpBox2" Left="0" LineColor="#cc0000" Right="1000" TabOrder="76" Top="442" Type="Rectangle" Width="1000"></Shape>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSmsStat" ImageID="BTN_TEXT_04" Left="804" OnClick="btnSmsStat_OnClick" Style="sty_Button" TabOrder="35" Text="SMS현황" Top="176" Transparent="TRUE" Width="66"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEmailStat" ImageID="BTN_TEXT_04" Left="804" OnClick="btnEmailStat_OnClick" Style="sty_Button" TabOrder="38" Text="메일현황" Top="200" Transparent="TRUE" Width="66"></Button>		<Static Align="Center" Height="46" Id="lbExamInfo" Left="8" Style="sty_Label" TabOrder="76" Text="회차정보" Top="238" VAlign="Middle" Width="36" WordWrap="TRUE"></Static>		<Image Border="Flat" FillType="STRETCH" Height="144" Id="imgPicture" Left="876" Style="sty_Image" TabOrder="77" Text="사진" Top="47" Transparent="TRUE" Width="112"></Image>		<Image Border="Flat" FillType="STRETCH" Height="120" Id="imgLastestPicture" Left="777" Style="sty_Image" TabOrder="78" Text="최근사진" Top="47" Transparent="TRUE" Width="94"></Image>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchRegPicture" ImageID="BTN_TEXT_06" Left="680" OnClick="btnSearchRegPicture_OnClick" Style="sty_Button" TabOrder="31" Text="등록사진조회" Top="56" Transparent="TRUE" Width="93"></Button>		<Static Align="Center" Height="20" Id="lbExamPersonInfo" Left="348" Style="sty_LabelGruopBox" TabOrder="79" Text="접수자&#32;기본&#32;정보" Top="32" VAlign="Middle" Width="120"></Static>		<Static Align="Center" Height="20" Id="lbJubsu" Left="19" Style="sty_LabelGruopBox" TabOrder="79" Text="접수" Top="32" VAlign="Middle" Width="60"></Static>		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbExamInfo1" Left="48" Style="sty_Label" TabOrder="54" Top="239" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbExamInfo2" Left="48" Style="sty_Label" TabOrder="55" Top="261" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnUnUseJubsuNo" ImageID="BTN_TEXT_04" Left="250" OnClick="lfn_SearchUnUseJubsuNo" Style="sty_Button" TabOrder="24" Text="빈번호" ToolTipText="빈접수번호조회" Top="189" Transparent="TRUE" Width="66"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnLoadPicture_OnClick" Style="sty_Button" TabOrder="41" Text="사진찾기" Top="247" Transparent="TRUE" Width="119"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadScanPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnLoadScanPicture_OnClick" Style="sty_Button" TabOrder="40" Text="스캔사진불러오기" Top="223" Transparent="TRUE" Width="119"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnScanPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnScanPicture_OnClick" Style="sty_Button" TabOrder="39" Text="사진스캔실행" Top="199" Transparent="TRUE" Width="119"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPictureManagement" ImageID="BTN_TEXT_06" Left="680" OnClick="btnPictureManagement_OnClick" Style="sty_Button" TabOrder="32" Text="사진관리" Top="80" Transparent="TRUE" Width="93"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnShowVirtualAccount" ImageID="BTN_TEXT_06" Left="580" OnClick="btnShowVirtualAccount_OnClick" Style="sty_Button" TabOrder="43" Text="가상계좌보기" Top="309" Transparent="TRUE" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnModifyHistory" ImageID="BTN_TEXT_04" Left="250" OnClick="btnModifyHistory_OnClick" Style="sty_Button" TabOrder="30" Text="변경이력" ToolTipText="접수정보변경이력" Top="310" Transparent="TRUE" Width="66"></Button>		<File Bottom="28" Height="24" Id="fiImageFile" Left="200" Right="224" TabOrder="99" Top="4" Width="24"></File>		<Static Align="Center" Height="20" Id="lbExpYn" Left="336" Style="sty_Label" TabOrder="81" Text="경력자여부" Top="224" VAlign="Middle" Width="88"></Static>		<Checkbox BindDataset="ds_ioExamJubsu" Column="EJEXPYN" FalseValue="N" Height="20" Id="chkExpYn" Left="428" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="80" Text="경력자여부" Top="224" TrueValue="Y" Value="FALSE" Width="88"></Checkbox>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_TEXT_07" Left="544" OnClick="lfn_Print" Style="sty_Button" TabOrder="82" Text="응시원서출력(F9)" ToolTipText="응시원서출력" Top="4" Width="105"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExamCheatingManageLink" ImageID="BTN_TEXT_06" Left="156" OnClick="btnExamCheatingManageLink_OnClick" Style="sty_Button" TabOrder="83" Text="부정행위관리" Top="336" Transparent="TRUE" Width="92"></Button>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPoint" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="84" Top="337" UserData="S" Width="52"></Edit>		<Static Align="Center" Height="20" Id="lbPoint" Left="8" Style="sty_Label" TabOrder="85" Text="점수" Top="337" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPassYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="86" Top="313" UserData="S" Width="36"></Edit>		<Static Align="Center" Height="20" Id="lbPassYn" Left="8" Style="sty_Label" TabOrder="87" Text="합격여부" Top="313" VAlign="Middle" Width="88"></Static>		<Static Align="Center" Height="20" Id="lbSeatNo" Left="8" Style="sty_Label" TabOrder="89" Text="좌석번호" Top="214" VAlign="Middle" Width="88"></Static>		<Edit Align="RIGHT" AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edSeatNo" ImeMode="native" Left="100" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="88" Top="214" UserData="S" Width="50"></Edit>		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radJibuGubun" INDEX="0" InnerDataset="ds_oJibuGubun" Left="103" LeftMargin="2" OnChanged="radJibuGubun_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="90" Top="32" Value="S" Width="200"></Radio>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsuHistory" ImageID="BTN_TEXT_04" Left="250" OnClick="btnJubsuHistory_OnClick" Style="sty_Button" TabOrder="91" Text="접수이력" Top="336" Transparent="TRUE" Width="66"></Button>		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radChangeTpmgno" INDEX="0" InnerDataset="ds_oChangeTpmgno" Left="640" LeftMargin="2" OnChanged="radChangeTpmgno_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="92" Top="32" Value="S" Visible="FALSE" Width="200"></Radio>		<Edit BindDataset="ds_ioExamJubsu" Column="MUNJEGUBUN" Height="16" Id="Edit0" Left="800" OnChanged="Edit0_OnChanged" TabOrder="93" Text="Edit0" Top="248" Visible="FALSE" Width="24"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="Button0" ImageID="BTN_TEXT_06" Left="538" OnClick="btnSearchPersonInfoChange_OnClick" Style="sty_Button" TabOrder="94" Text="접수자정보변경" Top="31" Transparent="TRUE" Width="93"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPosReport" ImageID="BTN_TEXT_07" Left="473" OnClick="btnPosReport_OnClick" Style="sty_Button" TabOrder="95" Text="통합영수증조회" Top="309" Transparent="TRUE" Width="105"></Button>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu0400MExamJubsuManagement.xml * 설명 : 시험접수관리 * 작성일 : 2009.07.17 * 작성자 : 장성호 */#include "LIB::training.js"; // 공통업무 관련var ls_OldSeatNo = "";               // 좌석번호var ls_OldPictureNo = "";           // 기존 사진번호var lb_IsNiceCheckOk = false;       // 실명인증var lb_FileUpload = false;          // 사진등록여부var ls_ServiceName = "";            // Transaction시 호출 Service 이름var ls_CallBackServiceName = "";    // Transaction시 CallBack 함수 이름var ls_IsChangedJubsuInfoYn = "N";  // 접수자기본정보 변경여부var ls_IsChangedSeatNoYn    = "N";  // 좌석번호 변경여부var ls_IsChangedPictureYn   = "N";  // 사진 변경여부var ls_UploadRealName = "";         // 사진이미지 실제파일명var ls_FileUploadPath = "/IMGDATA/" + left(GetDate(), 4) + "/" + substr(GetDate(), 4, 2); // 사진이미지경로;var ls_OldPersonName = "";var ls_OldRID        = "";var ls_SearchFlag = false;          // 조회시 Mogno Information을 셋팅하기 위해 사용var serch_falg = "";   // 조회 버튼으로 한 것인지 선택해서 조회 인지 여부 "0", "1" 20091015var ls_PassSavePrintYN = ""; // 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    // 폼 환경설정    ls_SystemGubun = gs_SystemGubun;    ls_SystemMenuId = gs_SystemMenuId;    var ls_FormId = split(sFormUrl, "::");    ls_FormId = split(ls_FormId[1], ".");    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.        lfn_initJibu();        ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정        lfn_SetFormAuth(true); // 저장 권한    } else if (ms_FormAuth == "R") {        lfn_SetFormAuth(false); // 읽기 권한    } else {        gfn_Alert(MSGI00080);        close();    }    // 공통 코드 조회    gfn_SearchTrainingCourse("E", ds_oCourse, "Y"); // 직능 코드 조회    radCourse.Value = "60";    gfn_SearchAllJibu(cbxJibu, "Y", "선택"); // 지부 코드 조회    gfn_SearchCommonCode(ds_oEmailDomain, "EMAILDOMAIN", "Y", "직접입력"); // 이메일도메인 조회    gfn_SearchCommonCode(ds_oRemarkGubun, "REMARKGUBUN", "Y", "선택"); // 적요    lfn_InitJubsuBaseInfo(); // 접수기본 정보 초기화            edExamYear.Text = left(GetDate(), 4);    lfn_SearchExamLatestOrder(); // 최근 접수가능회차 조회        edExamOrder.SetFocus();        serch_falg = "0" ;    // 화면 실행시 조회 플래그는 0 으로 설정    edEmail.ImeMode = "english";    edEmailDomain.ImeMode = "english";    }function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    // to do    if (nChar == 117) {        btnTraingJubsuHist_OnClick();        return;    }    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리}function Form_OnSize(obj,nCx,nCy,nState) {    if (gs_IsResizingForm == "Y") {        gdSetlmentHist.Width = nCx - gdSetlmentHist.Left - 4 - 4;        shpGubunBox4.Width = nCx - shpGubunBox4.Left - 4;        gdJubsuInfo.Height = nCy - gdJubsuInfo.Top - 4;        gdOrderHist.Height = nCy - gdOrderHist.Top - 4;        gdOrderHist.Width = nCx - gdOrderHist.Left - 4;        shpBox1.Width = nCx - shpBox1.Left;        shpBox2.Width = nCx;    }}/* * 기능 : 취소 */function lfn_Cancel(obj) {     gfn_FormInit(this);    ms_ExamMgno = ""; // 시험관리번호    // 시험정보    lbExamInfo1.Text = "";    lbExamInfo2.Text = "";    // 접수 디폴트값 설정    edExamYear.Text = left(GetDate(), 4);    //radCourse.Value = "60";    lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화        // 그리드 초기화    ds_oJubsuAllInfo.ClearData();    gdJubsuInfo.NoDataText = "";    ds_oOrderHist.ClearData();    gdOrderHist.NoDataText = "";    ds_oSetlmentHist.ClearData();    gdSetlmentHist.NoDataText = "";    btnSetlmt.Enable = false; // 결제(POS) 버튼    btnProcRct.Enable = false;    btnShowVirtualAccount.Enable = false;		btnChangeProcDate.Enable = false;	btnPrintReRct.Enable = false;		edPersonNm.Readonly = false;	medResidentNo.Readonly = false;		Button0.Enable = false;	btnSearchPersonInfo.Enable = true;		lfn_SetChangedJubsuInfo(true);    edExamOrder.SetFocus();}/* * 기능 : 날짜 변경한하고 초기화 */function lfn_NoDateCancel(obj) {     gfn_FormInit(this);    ms_ExamMgno = ""; // 시험관리번호    // 시험정보    lbExamInfo1.Text = "";    lbExamInfo2.Text = "";    // 접수 디폴트값 설정    //edExamYear.Text = left(GetDate(), 4);    //radCourse.Value = "60";    lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화        // 그리드 초기화    ds_oJubsuAllInfo.ClearData();    gdJubsuInfo.NoDataText = "";    ds_oOrderHist.ClearData();    gdOrderHist.NoDataText = "";    ds_oSetlmentHist.ClearData();    gdSetlmentHist.NoDataText = "";    btnSetlmt.Enable = false; // 결제(POS) 버튼    btnProcRct.Enable = false;    btnShowVirtualAccount.Enable = false;		btnChangeProcDate.Enable = false;	btnPrintReRct.Enable = false;		edPersonNm.Readonly = false;	medResidentNo.Readonly = false;		Button0.Enable = false;	btnSearchPersonInfo.Enable = true;		lfn_SetChangedJubsuInfo(true);    edExamOrder.SetFocus();}/* * 기능 : 조회 */function lfn_Search(obj) {        if (gfn_IsNull(ms_ExamMgno)) {        gfn_Alert(MSGI00200); // "시험을 먼저 선택해 주십시오.";        edExamOrder.SetFocus();        return false;    }    if (gfn_IsNull(edJubsuNo.Text)) {        gfn_Alert("접수번호를 입력해 주십시오.");        edJubsuNo.SetFocus();        return false;    }    lfn_SearchExamJubsuList(obj);    }/* * 기능 : 삭제 */function lfn_Delete(obj) {		if ((ds_ioExamJubsu.currow < 0) || gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.        return false;    }    if (!gfn_Confirm(MSGW00030)) { // 정말로 삭제 하시겠습니까?        return false;    }	    // 결제를 하지 않았을 경우에는 삭제 가능    if (ds_oSetlmentHist.GetCount() > 0){		// 아직 구현이 안된것 같음 ?????????????????????????????????????????????????        gfn_Alert("결제가 진행되어 삭제할 수 없습니다.");        return false;    } else {        lfn_SaveModifyHistory("D"); // 변경이력을 저장한다.        tit_clearActionInfo();        tit_addSingleActionInfo("spcledu:deleteExamJubsu", "", 0, "");        //서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,""	// outDs            ,"EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args                 + " EOMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EOMGNO"))            ,"lfn_AfterDeleteExamJubsu"            ,false            ,false            ,true        );                    }        lfn_SearchExamLatestOrder();        }function lfn_searchTraingPerson() {/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면/////////////////// 값을 미리 넣어주기 위해 강습자관리버호를 검색함    ds_ioT_E_L_JubsuCheck.ClearData();    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.    tit_addCsvSearchActionInfo("com:searchTrainingPerson", false);    // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_ioExamPerson=ds_oTrainingPerson"	// outDs        , "TPNM=" + quote(edPersonNm.Text) // 성명         + " TPRESIDENTNO=" + quote(medResidentNo.value) // 주민번호                        // args        ,""        ,false        ,""        ,true    );  }/*function lfn_searchExamJubsuCheck() {/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기    ds_ioT_E_L_JubsuCheck.ClearData();    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.    tit_addCsvSearchActionInfo("com:searchExam_JubsuCheck", false);    // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_ioExam_JubsuCheck=ds_oExam_JubsuCheck"	// outDs        , "EOMGGTMGNO_A=" + quote(cbxJibu.Value)  // 지부        + " EOYEAR_A=" + quote(edExamYear.Text) // 년도        + " EOTCCOURSECD_A=" + quote(radCourse.Value) // 직능        + " EOTRAININGORDER_A=" + quote(edExamOrder.Text) // 회차         + " EPNM_A=" + quote(edPersonNm.Text) // 성명         + " EPRESIDENTNO_A=" + quote(medResidentNo.value) // 주민번호                        // args        ,""        ,false        ,""        ,true    );  }*/////////////////////* 강습수료여부 찾기*/function lfn_TrainingJubsuMatchingSearch(){                       ///////////////////////// 강습접수에 수료한거 중에 해당 직능이 있는지 조회하여 메시지 보여줌        ds_ioTrainingJubsuMatching.ClearData(); // 데이타셋 초기화        tit_clearActionInfo();        tit_addSearchActionInfo("spcledu:searchTrainingJubsuMatching", false);        // 서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,"ds_ioTrainingJubsuMatching=ds_oTrainingJubsuMatching"	// outDs            ,"TPNM=" + quote(edPersonNm.Text)		// 성명            + " TOTCCOURSECD=" + quote(radCourse.Value)  // 직능            + " TPRESIDENTNO=" + quote(replace(medResidentNo.Text,"-",""))// args            ,"lfn_AfterSearchTrainingPerson"            ,false            ,""            ,true                    );        ////////////////////////     }// 강습접수에 수료 내역이 있는지 조회 체크함function lfn_AfterSearchTrainingPerson(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }/////////start//  시험 접수시 1급, 2급 방화관리자일 경우 강습접수가 없으면 공공기관방화관리자로 검색        if(ds_ioTrainingJubsuMatching.count == "0") {                if(radCourse.Value == "21") {  // 1급 방화관리자일 경우 공공기관방화관리자 검색        ///////////////////////////////////////////////////////////            ds_ioTrainingJubsuMatching.ClearData(); // 데이타셋 초기화                    tit_clearActionInfo();            tit_addSearchActionInfo("spcledu:searchTrainingJubsuMatching", false);            // 서버 호출             tit_callService(                ""                ,""                ,""	// inDs                ,"ds_ioTrainingJubsuMatching=ds_oTrainingJubsuMatching"	// outDs                ,"TPNM=" + quote(edPersonNm.Text)		                + " TOTCCOURSECD=" + quote(20)                + " TPRESIDENTNO=" + quote(replace(medResidentNo.Text,"-",""))// args                ,"lfn_AfterSearchTrainingPersonA"                ,false                ,""                ,true            );                    ///////////////////////////////////////////////////////////           }            else if (radCourse.Value == "22") { // 2급 방화관리자일 경우 공공기관방화관리자 검색        ///////////////////////////////////////////////////////////                        ds_ioTrainingJubsuMatching.ClearData(); // 데이타셋 초기화                    tit_clearActionInfo();            tit_addSearchActionInfo("spcledu:searchTrainingJubsuMatching", false);            // 서버 호출             tit_callService(                ""                ,""                ,""	// inDs                ,"ds_ioTrainingJubsuMatching=ds_oTrainingJubsuMatching"	// outDs                ,"TPNM=" + quote(edPersonNm.Text)		                + " TOTCCOURSECD=" + quote(20)                + " TPRESIDENTNO=" + quote(replace(medResidentNo.Text,"-",""))// args                ,"lfn_AfterSearchTrainingPersonA"                ,false                ,""                ,true            );                        ///////////////////////////////////////////////////////////                      }                 } else {        if(ls_PassSavePrintYN == "1") { // 저장을 통해 수료 가능 여부 조회시 메세지 알려줌            alert("           강습교육 수료 후 2년이내 시험접수가능\n\n"                + "             교육수료일자 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE") + "\n"                + "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"                + "                  접수   가능 합니다. ");        }       }       // gfn_SearchMessage(gdTrainingPerson); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.    }/**  21, 22  로 조회하여 수료자 유무를 파악(메세지 표시함)*/function lfn_AfterSearchTrainingPersonA(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }        if (ds_ioTrainingJubsuMatching.count > 0 ) {        if(ls_PassSavePrintYN == "1") { // 저장을 통해 수료 가능 여부 조회시 메세지 알려줌            alert("           강습교육 수료 후 2년이내 시험접수가능\n\n"                + "             교육수료일자 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE") + "\n"                + "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"                + "                  접수   가능 합니다. ");        }        } else {        if(ls_PassSavePrintYN == "1") { // 저장을 통해 수료 가능 여부 조회시 메세지 알려줌            alert("           2년이내 강습교육 수료한 건이 없습니다.\n\n"                + "                  접수 불가 합니다. ");            return false;        }        }    }function lfn_Save(obj) {    /*        if (!gfn_IsNull(imgLastestPicture.ImageID)) {        if(gfn_IsNull(imgPicture.ImageID)) {            alert("최근 사진이 있습니다. 최근사진을 반영하시기 바랍니다.");                      return false;         }           } else {             }    */    if (gfn_IsNull(ms_ExamMgno)) {        gfn_Alert(MSGI00200); // "시험을 먼저 선택해 주십시오.";        edExamOrder.SetFocus();        return false;    }        if (ds_oExamOrderMgno.GetColumn(0, "EOSEATCNT") <= ds_oExamOrderMgno.GetColumn(0, "JUBSUCNT")) {        gfn_Alert("접수인원수를 초과하였습니다.");        return false;    }     if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // 신규이면서                && (left(GetDAte(), 8) > ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"))            ) {        gfn_Alert("시험시작일이 지나서 접수하실 수 없습니다.");        return false;    }            if (ds_ioExamJubsu.GetColumn(0, "LASTYN") == "N") {        gfn_Alert("회차변경된 접수번호는 수정하실 수 없습니다.");        return false;    }             if (!gfn_FormValidate(this)) { // 입력 Validation Check        return false;    }             var lb_ValidRedidentNoYn = gfn_CheckResidentNo(medResidentNo.Value); // 주민번호체계 검사    var lb_ValidForeignNoYn = gfn_CheckForeignNo(medResidentNo.Value); // 재외국인 등록번호 검사    if (!lb_ValidRedidentNoYn && !lb_ValidForeignNoYn) { // 둘다 실패면        if (!gfn_Confirm("주민등록번호가 형식에 맞지않습니다.\n강제로 저장 하시겠습니까?")) {            medResidentNo.SetFocus();            return false;        }    }           if (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // 신규가 아니면서                && (ds_ioExamJubsu.GetOrgBuffColumn(0, "PERSONNM") <> ds_ioExamJubsu.GetColumn(0, "PERSONNM"))                && (ds_ioExamJubsu.GetOrgBuffColumn(0, "RESIDENTNO") <> ds_ioExamJubsu.GetColumn(0, "RESIDENTNO"))            ) {        gfn_Alert("수강자(성명과 주민등록)를 변경하실 수 없습니다.");        return false;    }	//#김경철    //if (ds_ioExamJubsu.GetColumn(0, "AUTHYN") <> "Y") {    //    gfn_Alert("실명인증을 먼저 실행해주십시오.");    //    return false;    //}    	    //if (gfn_IsNull(imgPicture.ImageID)) {    //    gfn_Alert("사진을 먼저 등록해주십시오.");    //    return false;    //}        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IIIMGBINARY"))) {  // 사진을 선택하지 않아 없을 경우 바이너리 값을 null로 하여 패키지 호출함(패키지 에러방지)          ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", "");        }                 var sArg = "";    ls_PassSavePrintYN = "1"; // 저장을 통해 시험응시가능기간 조회함 (1)     if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) { // 신규        ///////////////////  해당 동일(시험접수) 직능 회차에 이미 접수 내역이 있으면 접수 안되게 함               /*                lfn_searchExamJubsuCheck();                     if (ds_ioExam_JubsuCheck.count > 0) {                    alert("해당 회차에 접수한 내역이 있습니다. 직능에 대해 동일한 회차에는 한번만 접수가 가능합니다.\n\n"                        + "         접수번호는 :   " + ds_ioExam_JubsuCheck.Getcolumn(0, "EOHJUBSUNO") + " 입니다. \n" );                    return false;                }          */ ////////////////////          ////////////////////// 수료 여부 있는지 미리 확인하고 메시지 출력        lfn_TrainingJubsuMatchingSearch(); // 수료여부 확인        /*               if (ds_ioTrainingJubsuMatching.count == 0 ) {                return false;            }        */   //////////////////////        if (!gfn_Confirm("정말로 저장 하시겠습니까?")) {            return false;        }                if(cbxjibu.Value != gds_oUserInfo.GetColumn(0, "PDEPTCD"))        {            if (!gfn_Confirm("타지부 접수입니다. 접수 저장하시겠습니까?")) {                return false;                    }        }             ////////////////////            ////////////////////         // trace(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));         // 기본정보, 실명 인증 하지 않고 저장시 개인정보 유무 체크 안하고 저장시 무결성 오류 발생 해결위함         //  강습자관리번호 없을 경우 한번 체크하여 동일자가 있을 경우 값을 넣어줌          if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {                    lfn_searchTraingPerson();                    ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));        }                  ////////////////////                ///////////////////        ls_ServiceName = "spcledu:insertExamJubsu";        ls_CallBackServiceName = "lfn_AfterInsertExamJubsu";        sArg = "IsNewPictureYn=" + quote(iif(lb_FileUpload, "Y", "N"));    } else { // 수정        if (!gfn_Confirm("수정 하시겠습니까?")) {            return false;        }                ls_ServiceName = "spcledu:updateExamJubsu";        ls_CallBackServiceName = "lfn_AfterUpdateExamJubsu";        lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.        sArg = "IsChangedJubsuInfoYn=" + quote(ls_IsChangedJubsuInfoYn);        sArg += " IsChangedSeatNoYn=" + quote(ls_IsChangedSeatNoYn);        sArg += " IsChangedPictureYn=" + quote(ls_IsChangedPictureYn);    }    ds_ioExamJubsu.SetColumn(0, "EOMGNO", ms_ExamMgno);    ds_ioExamJubsu.SetColumn(0, "JUBSUNO", edJubsuNo.Text);    ds_ioExamJubsu.SetColumn(0, "DECISIONSEATNO", edSeatNo.Text);        ds_oExamJubsuResult.ClearData(); // 결과 데이타셋 초기화        if (lb_FileUpload) { // 사진등록인 경우(파일 업로드일 경우)        tit_FileWrite(            hfImage            , ls_FileUploadPath            , fdImage.FilePath            , fdImage.FileName            , ls_UploadRealName            , "U"            , true        );        hfImage.CloseFile();    }    tit_clearActionInfo();    tit_addSingleActionInfo(ls_ServiceName, "", 0, "");    // 서버 호출    tit_callService(        ""        ,""        ,"ds_iExamJubsu=ds_ioExamJubsu"    // inDs        ,"ds_oExamJubsuResult=ds_oExamJubsu"    // outDs        ,sArg    // args        ,ls_CallBackServiceName        ,false        ,false        ,true    );              }/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterInsertExamJubsu(nErrorCode, strErrorMsg) {	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }        switch (ds_oExamJubsuResult.GetColumn(0, "RESULTCODE")) {        case "JUBSUNO" : // 접수번호중복            var ls_NewJubsuNo = lpad((toNumber(edJubsuNo.Text) + 1), "0", 6); // 접수번호            if (!gfn_Confirm("접수번호가 중복되었습니다.\n다음 접수번호[" + ls_NewJubsuNo + "]로 접수하시겠습니까?")) {                return false;            }            edJubsuNo.Text = ls_NewJubsuNo;            tit_addSingleActionInfo(ls_ServiceName, "", 0, "");            // 서버 호출            tit_callService(                ""                ,""                ,"ds_iExamJubsu=ds_ioExamJubsu:U"    // inDs                ,"ds_oExamJubsuResult=ds_oExamJubsu"    // outDs                ,""    // args                ,ls_CallBackServiceName                ,false                ,false                ,true            );                        break;        case "SEATNO" : // 좌석번호중복            gfn_Alert("좌석번호가 중복되었습니다.\n확인하신 후 다시 저장해 주십시오");            break;        case "OK" : // 정상처리            lfn_SaveModifyHistory("I"); // 변경이력을 저장한다.            gfn_SaveMessage(); // 저장 메세지를 처리한다.            lb_FileUpload = false;            lfn_Search();            break;        case "EXIST" :            gfn_Alert( "주민번호 : " + medResidentNo.Text + "님은 해당 직능(회차)에 이미 접수되었습니다.\n\n"                    + "              확인을 바랍니다.");            break;    }    }/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterDeleteExamJubsu(nErrorCode, strErrorMsg) {	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }	alert("정상적으로 삭제 되었습니다.");    lb_FileUpload = false;}/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterUpdateExamJubsu(nErrorCode, strErrorMsg) {      if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SaveMessage(); // 저장 메세지를 처리한다.    lb_FileUpload = false;    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부    ls_IsChangedPictureYn = "N"; // 사진 변경여부    lfn_SearchExamJubsuList(); // 접수번호로 다시 조회한다.}/* * 기능 : 출력 */function lfn_Print(obj) {    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");        edJubsuNo.SetFocus();        return false;    }    ls_PassSavePrintYN = "2"; // 수료 여부 조회 전에 응시원서 출력을 위한 값을 줌  flag        lfn_TrainingJubsuMatchingSearch();  // 수료 여부를 검색함 (시험 응시 가능 기간을 표기 하기 위함)        trace(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE") );        var sMessage = "";        if (ds_ioTrainingJubsuMatching.count() > 0) {        sMessage = "(*시험응시기한은 " + mid(ds_ioTrainingJubsuMatching.GetColumn(0, "EXAMMAXDATE"), 0, 4) + "년"                                   + mid(ds_ioTrainingJubsuMatching.GetColumn(0, "EXAMMAXDATE"), 4, 2) + "월"                                   + mid(ds_ioTrainingJubsuMatching.GetColumn(0, "EXAMMAXDATE"), 6, 2) + "일"                                   + "입니다."                                    + "시험응시가능 기간은 수료일로 부터 2년 이내 입니다.)";  //     }    // 출력이력을 저장한다.     gfn_InsertSearchPrintHistory(            "P"            , this.ID            , global.mnuLeft.cbxOpenForm.Text + "(응시원서)"            , "접수관리번호=" + ds_ioExamJubsu.GetColumn(0, "EJMGNO")        );    ds_oExamJubsuPrint.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamJubsuPrint", false);    // 서버 호출    tit_callService(        ""        ,""        ,""    // inDs        ,"ds_oExamJubsuPrint=ds_oExamJubsuPrint"    // outDs        ,"EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args        ,""        ,true        ,true        ,true    );    var lb_IsPrintedOk = gfn_PrintReport("frmspcledu0400R01ExamJubsu.rex",                                         "ds_oExamJubsuPrint",                                          "rpDirpath=" + GF_FILE_SERVER_URL + "kems"                                        + "^TPPASSDATE=" + sMessage,                                           true, "응시원서");    //var lb_IsPrintedOk = gfn_CallReportPopup("frmspcledu0400R01ExamJubsu.rex", "ds_oExamJubsuPrint", "rpDirpath=" + GF_FILE_SERVER_URL + "kems", true, "수강증");        if (lb_IsPrintedOk) {        //gfn_Alert("정상적으로 출력되었습니다.");    }}/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 최근 접수가능회차를 조회한다. * parameter : 없음 * return value : 없음 */function lfn_SearchExamLatestOrder(obj) {      ds_oExamOrder.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();	tit_addSearchActionInfo("spcledu:searchExamOrderList", false);	// 서버 호출 	tit_callService(		""		,""		,""	// inDs		,"ds_oExamOrder=ds_oExamOrder"	// outDs		,"EOTCCOURSECD=" + quote(radCourse.Value)            + " EOMGGTMGNO=" + quote(cbxJibu.Value)            + " EOYEAR=" + quote(edExamYear.Text)            + " sPosiYn=" + quote("Y") // 접수가능여부            + " sRowCount=" + quote("1") // 건수		,"lfn_AfterSearchExamLatestOrder"		,false	);		// 1급 방화관리자면 경력자 여부 체크 비활성화	// 20100129 정현호 대리님 요청으로 비활성화 활성화로 품	/*	if(radCourse.Value == 21)	{		chkExpYn.Enable = false;		chkExpYn.Value = "N";	}	*/}/* * 기능 : 최근 접수가능회차 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchExamLatestOrder(nErrorCode, strErrorMsg) {        if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    if (ds_oExamOrder.GetCount() > 0) {        ms_ExamMgno = ds_oExamOrder.GetColumn(0, "EOMGNO"); // 관리번호        cbxJibu.Value = ds_oExamOrder.GetColumn(0, "EOMGGTMGNO"); // 지부코드        edExamYear.Text = ds_oExamOrder.GetColumn(0, "EOYEAR"); // 년도        radCourse.Value = ds_oExamOrder.GetColumn(0, "EOTCCOURSECD"); // 직능코드        edExamOrder.Text = ds_oExamOrder.GetColumn(0, "EOEXAMORDER"); // 회차        lfn_SearchExamOrderMgno(); // 시험회차관리번호를 조회한다.    }else{              lfn_NoDateCancel();		//lfn_cancel();    }}/* * 기능 : 시험회차관리번호를 조회한다. * parameter : 없음 * return : 없음 */function lfn_SearchExamOrderMgno() {   if (gfn_IsNull(cbxJibu.Value)            || gfn_IsNull(radCourse.Value)            || gfn_IsNull(edExamYear.Text)            || gfn_IsNull(edExamOrder.Text)) {        ls_SearchFlag = false;        return false;    }    ds_oExamOrderMgno.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamOrderMgno", false);    // 서버 호출    tit_callService(        ""        ,""        ,""    // inDs        ,"ds_oExamOrderMgno=ds_oExamOrderMgno"    // outDs        ,"EOMGTMGNO=" + quote(cbxJibu.Value)            + " EOTCCOURSECD=" + quote(radCourse.Value)            + " EOYEAR=" + quote(edExamYear.Text)            + " EOEXAMORDER=" + quote(lpad(edExamOrder.Text, "0", 3))        ,"lfn_AfterSearchExamOrderMgno"        ,false        ,""        ,true    );}/* * 기능 :  시험회차관리번호 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchExamOrderMgno(nErrorCode, strErrorMsg) {      	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    if (ds_oExamOrderMgno.GetCount() > 0) {				ms_ExamMgno = ds_oExamOrderMgno.GetColumn(0, "EOMGNO"); // 회차관리번호		// 회차정보1		lbExamInfo1 = " 좌석수:" + ds_oExamOrderMgno.GetColumn(0, "EOSEATCNT"); // 좌석수		lbExamInfo1 = lbExamInfo1 + ",    현재접수인원수:" + ds_oExamOrderMgno.GetColumn(0, "EOJUBSUCNT"); // 현재접수인원수		// 회차정보2		var ls_date = ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"); // 시험일시		lbExamInfo2 = "시험일시 : " + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + substr(ls_date, 6, 2); // 교육시작일		ls_date = ds_oExamOrderMgno.GetColumn(0, "EOSTARTTIME");		lbExamInfo2 = lbExamInfo2 + "  " + left(ls_date, 2) + ":" + right(ls_date, 2);				if(ls_SearchFlag)		{						ls_SearchFlag = false;			return;		}						edJubsuNo.Text = ds_oExamOrderMgno.GetColumn(0, "NEWJUBSUNO"); // 접수번호		lfn_SearchUnUseSeatNo();        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화                           if(serch_falg == "0") {            // 그리드 초기화            ds_oJubsuAllInfo.ClearData();            gdJubsuInfo.NoDataText = "";            ds_oOrderHist.ClearData();            gdOrderHist.NoDataText = "";            ds_oSetlmentHist.ClearData();            gdSetlmentHist.NoDataText = "";            btnSetlmt.Enable = false; // 결제(POS) 버튼        } else if(serch_falg == "1") {                       ds_oSetlmentHist.ClearData();            gdSetlmentHist.NoDataText = "";            btnSetlmt.Enable = false; // 결제(POS) 버튼        }                            }else{    		//lfn_Cancel();		 lfn_NoDateCancel();    }        edJubsuNo.SetFocus();}/* * 기능 : 빈좌석번호를 조회한다. * parameter : 없음 * return : 없음 */function lfn_SearchUnUseSeatNo(obj){    if (gfn_IsNull(ms_ExamMgno)) {        gfn_Alert(MSGI00200); // "시험을 먼저 선택해 주십시오.";        edExamOrder.SetFocus();        return false;    }    ds_oSeatNo.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchUnUseExamSeatNo", false);    // 서버 호출    tit_callService(        ""        ,""        ,""    // inDs        ,"ds_oSeatNo=ds_oSeatNo"    // outDs        ,"EOMGNO =" + quote(ms_ExamMgno)        ,"lfn_AfterSearchUnUseExamSeatNo"        ,false        ,false        ,true    );}/* * 기능 : 빈좌석번호 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchUnUseExamSeatNo(nErrorCode, strErrorMsg) {        // 트랜잭션 에러를 처리한다.    if (nErrorCode != 0) {         gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    var ln_TotalCnt = ds_oSeatNo.GetCount();        if (ln_TotalCnt > 0) {                edSeatNo.Text = ds_oSeatNo.GetColumn(0, "EOHEXAMSEATNO"); // 접수좌석번호    } else {        edSeatNo.Text = 1; // 접수좌석번호    }       /////////////////// 빈번호 조회후 이름 주민번호 입력할 수 있게 해야 함    edPersonNm.Readonly = false;    medResidentNo.Readonly = false;    btnSearchPersonInfo.Enable =true;    Button0.Enable = false;    ///////////////////        }/* * 기능 : 접수자목록을 조회한다. * parameter : sOrderMgno - 회차관리번호 *             sJubsuNo - 접수번호 *             sLikeYn - LIKE 검색 여부 * return value : 시험접수자목록 정보를 가진 배열 오브젝트 */function lfn_SearchExamJubsuList(obj) {            var ls_HistoryArg = "";    var ls_SearchArg = "";        if (gfn_IsNull(ms_ExamMgno)            || gfn_IsNull(edJubsuNo.Text)) {        return false;    }    ls_HistoryArg = "회차관리번호=" + ms_ExamMgno        + ", 접수번호=" + lpad(edJubsuNo.Text, "0", 6);    ls_SearchArg = "EOMGNO=" + quote(ms_ExamMgno)        + " EOHJUBSUNO=" + quote(lpad(edJubsuNo.Text, "0", 6))        + " sLikeYn=" + quote("N");                        //trace("11::"+ms_ExamMgno);        //trace("22:"+edJubsuNo.Text);    // 조회이력을 저장한다.    gfn_InsertSearchPrintHistory(            "S"            , this.ID            , global.mnuLeft.cbxOpenForm.Text            , ls_HistoryArg        );    ds_ioExamJubsu.ClearData(); // 데이타셋 초기화    lfn_SetChangedJubsuInfo(true);    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamJubsuList2", false);    // 서버 호출    tit_callService(        ""        ,""        ,""    // inDs        ,"ds_ioExamJubsu=ds_oExamJubsuList"    // outDs        ,ls_SearchArg        ,"lfn_AfterSearchExamJubsuList"        ,false        ,false        ,true    );        }/* * 기능 : 접수자목록 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchExamJubsuList(nErrorCode, strErrorMsg) {	        if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }             if (ds_ioExamJubsu.GetCount() > 0) {        cbxJibu.Value = ds_ioExamJubsu.GetColumn(0, "MGJIBUCD"); // 지부        edExamYear.Text = ds_ioExamJubsu.GetColumn(0, "YEAR"); // 년도        radCourse.Value = ds_ioExamJubsu.GetColumn(0, "COURSECD"); // 직능        edExamOrder.Text = ds_ioExamJubsu.GetColumn(0, "EORDER"); // 회차        edJubsuNo.Text = ds_ioExamJubsu.GetColumn(0, "JUBSUNO"); // 접수번호        edSeatNo.Text = ds_ioExamJubsu.GetColumn(0, "DECISIONSEATNO"); // 확정좌석번호        ls_OldSeatNo = edSeatNo.Text; // 기존 좌석번호                ls_OldPersonName = ds_ioExamJubsu.GetColumn(0, "PERSONNM");        ls_OldRID   = ds_ioExamJubsu.GetColumn(0, "RESIDENTNO");                //점수        edPassYn.Text = ds_ioExamJubsu.GetColumn(0, "ERPASSYN");        //패스여부        edPoint.Text = ds_ioExamJubsu.GetColumn(0, "ERSCORE");        // 실명인증 버튼 활성/비활성        btnAuthResidentNo.Enable = true;                // 최근사진        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IILASTREALNM"))) {            imgLastestPicture.Text = "최근사진";            imgLastestPicture.ImageID = "";        } else {            imgLastestPicture.Text = "";            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamJubsu.GetColumn(0, "IILASTDIRPATH") + "/" + ds_ioExamJubsu.GetColumn(0, "IILASTREALNM");        }        // 사진        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IIREALNM"))) {            imgPicture.Text = "사진";            imgPicture.ImageID = "";        } else {            imgPicture.Text = "";            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamJubsu.GetColumn(0, "IIDIRPATH") + "/" + ds_ioExamJubsu.GetColumn(0, "IIREALNM");            ls_OldPictureNo = ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"); // 기존 사진번호        }                // dataset의 orginal row와 currunt row를 일치시키기 위해        Edit0_OnChanged(Edit0, "");                //trace("imgLastestPicture.Text:"+imgLastestPicture.Text);        //trace("imgLastestPicture.ImageID:"+imgLastestPicture.ImageID);        //trace("imgPicture.Text:"+imgPicture.Text);        //trace("imgPicture.ImageID:"+imgPicture.ImageID);                // 결제(POS) 버튼        if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정            btnSetlmt.Enable = true; // 결제(POS) 버튼        }		        lfn_SearchExamSetlmentHistList(); // 결제내역 조회    } else {        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화                // 그리드 초기화        ds_oJubsuAllInfo.ClearData();        gdJubsuInfo.NoDataText = "";        ds_oOrderHist.ClearData();        gdOrderHist.NoDataText = "";        ds_oSetlmentHist.ClearData();        gdSetlmentHist.NoDataText = "";        btnSetlmt.Enable = false; // 결제(POS) 버튼        btnProcRct.Enable = false;        btnShowVirtualAccount.Enable = false;                btnChangeProcDate.Enable = false;        btnPrintReRct.Enable = false;                lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.            }//////////////////////////////////////////////////////////////////////////    if(serch_falg == "0") { // 플래그로 개인접수정보 조회할지 판별         lfn_SearchExamJubsuAllInfoList(); // 개인접수정보 조회        } else if (serch_falg == "1") {        }    serch_falg = "0";   // 플래그 값 초기화 하기//////////////////////////////////////////////////////////////////////////    if (ds_ioExamJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부        lfn_SetChangedJubsuInfo(false);    }        if(ls_SearchFlag)    {		lfn_SearchExamOrderMgno();	}		radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부    edPersonNm.SetFocus();    ////////////////////////////////////////    if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medResidentNo))) {    ////////////////////////////////        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함         medResidentNo.Readonly = true;        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함         Button0.Enable = true;  // 접수자정보변경은 활성화 함    ////////////////////////////////	    } else {    ////////////////////////////////        edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함         medResidentNo.Readonly = false;        btnSearchPersonInfo.Enable = true;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함         Button0.Enable = false;  // 접수자정보변경은 활성화 함    ////////////////////////////////        }    if(ds_ioExamJubsu.GetColumn(0, "AUTHYN") == "Y"){  // 이미 실명인증 되었으면 비활성화                btnAuthResidentNo.Enable = false;        btnAuthResidentNo.Text = "실명인증완료";            }else {                btnAuthResidentNo.Enable = true;        btnAuthResidentNo.Text = "실명인증";    }       ////////////////////////////////////////}/* * 기능 : 시험접수자목록 팝업을 호출한다. * parameter : sOrderMgno - 회차관리번호 *             sJubsuNo - 접수번호 *             sLikeYn - LIKE 검색 여부 * return value : 시험접수자목록 정보를 가진 배열 오브젝트 */function lfn_ExamJubsuListPopup(eomgno, eohjubsuno, slikeyn) {		var sArg = "sGtMgno=" + quote(cbxJibu.Value)        + " sYear=" + quote(edExamYear.Text)        + " sCourse=" + quote(radCourse.Value)        + " sOrder=" + quote(edExamOrder.Text)               + " eomgno=" + quote(eomgno)        + " eohjubsuno=" + quote(eohjubsuno)        + " slikeyn=" + quote(slikeyn);           var sRet = Dialog("spcledu::frmspcledu0401PExamJubsuList.xml", sArg, 600, 400, "", -1, -1);        if (sRet == "OK") {		        edJubsuNo.Text = ds_ioExamJubsu.GetColumn(0, "JUBSUNO"); // 접수번호        edSeatNo.Text = ds_ioExamJubsu.GetColumn(0, "DECISIONSEATNO"); // 확정좌석번호    }}/* * 기능 : 빈번호를 조회한다. * parameter : 없음 * return : 없음 */function lfn_SearchUnUseJubsuNo(obj) {      if (gfn_IsNull(ms_ExamMgno)) {        gfn_Alert(MSGI00100); // "시험을 먼저 선택해 주십시오.";        edExamOrder.SetFocus();        return false;    }    ds_oJubsuNo.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchUnUseExamJubsuNo", false);    // 서버 호출    tit_callService(        ""        ,""        ,""    // inDs        ,"ds_oJubsuNo=ds_oJubsuNo"    // outDs        ,"EOMGNO=" + quote(ms_ExamMgno)        ,"lfn_AfterSearchUnUseExamJubsuNo"        ,false        ,false        ,true    );        lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.   }/* * 기능 : 빈번호 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchUnUseExamJubsuNo(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화    // 그리드 초기화    ds_oJubsuAllInfo.ClearData();    gdJubsuInfo.NoDataText = "";    ds_oOrderHist.ClearData();    gdOrderHist.NoDataText = "";    ds_oSetlmentHist.ClearData();    gdSetlmentHist.NoDataText = "";    btnSetlmt.Enable = false; // 결제(POS) 버튼        btnProcRct.Enable = false;    btnShowVirtualAccount.Enable = false;		btnChangeProcDate.Enable = false;	btnPrintReRct.Enable = false;		 	var bcount = 0;    var ln_TotalCnt = ds_oJubsuNo.GetCount();        if (ln_TotalCnt > 0) {                edJubsuNo.Text = ds_oJubsuNo.GetColumn(0, "EOHJUBSUNO");        } else {        edJubsuNo.Text = "000001"; // 접수번호    }}/** * 실명인증 */function lfn_ResidentCheck() {	if (ls_IsNiceCheckOk == "Y") {        btnAuthResidentNo.Text = "실명인증완료";        btnAuthResidentNo.Enable = false;        edAddr1.SetFocus();    } else {        btnAuthResidentNo.Text = "실명인증";        btnAuthResidentNo.Enable = true;    }}/* * 기능 : 개인접수정보를 조회한다. * parameter : 없음 * return value : 없음 */function lfn_SearchExamJubsuAllInfoList(obj) {           ds_oJubsuAllInfo.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamJubsuAllInfoList", false);    // 서버 호출    tit_callService(        ""        , ""        , "" // inDs        , "ds_oJubsuAllInfo=ds_oJubsuAllInfo" // outDs        , "TPMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO")) // args        , "lfn_AfterSearchExamJubsuAllInfoList"        , false    );}/* * 기능 : 개인접수정보 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */var ln_TotalGridInfoCount = 0;function lfn_AfterSearchExamJubsuAllInfoList(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }        ln_TotalGridInfoCount = ds_oJubsuAllInfo.GetCount();    gfn_SearchMessage(gdJubsuInfo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.    lfn_SearchExamOrderHistList(); // 회차변경이력 조회}/* * 기능 : 회차변경이력를 조회한다. * parameter : 없음 * return value : 없음 */function lfn_SearchExamOrderHistList(obj) {        ds_oOrderHist.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamOrderHistList", false);    // 서버 호출    tit_callService(          ""        , ""        , "" // inDs        , "ds_oOrderHist=ds_oOrderHist" // outDs        , "EJMGNO=" + quote(ds_oJubsuAllInfo.GetColumn(ds_oJubsuAllInfo.currow, "EJMGNO")) // args        , "lfn_AfterSearchExamOrderHistList"        , false    );}/* * 기능 : 회차변경이력 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */var ln_TotalGridOrderCount = 0;function lfn_AfterSearchExamOrderHistList(nErrorCode, strErrorMsg) {        if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }            if(serch_falg == "1") {        gdOrderHist_OnCellClick(0,0,0,0,0);    }        ln_TotalGridOrderCount = ds_oOrderHist.GetCount();    gfn_SearchMessage(gdOrderHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* * 기능 : 결제내역를 조회한다. * parameter : 없음 * return value : 없음 */function lfn_SearchExamSetlmentHistList(obj) {       ds_oSetlmentHist.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamSetlmentHistList", false);    // 서버 호출    tit_callService(        ""        , ""        , "" // inDs        , "ds_oSetlmentHist=ds_oSetlmentHist" // outDs        , "EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args        , "lfn_AfterSearchExamSetlmentHistList"        , false    );}/* * 기능 : 결제내역 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */var ln_TotalGridSetlementCount = 0;function lfn_AfterSearchExamSetlmentHistList(nErrorCode, strErrorMsg) {      if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    ln_TotalGridSetlementCount = ds_oSetlmentHist.GetCount();    gfn_SearchMessage(gdSetlmentHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* * 기능 : 버튼 활성/비활성시킨다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetFormAuth(bStatus) {    btnDelete.Enable = bStatus; // 삭제 버튼    btnSave.Enable = bStatus; // 수정&저장 버튼}/* * 기능 : 접수기본 정보를 초기화한다. * parameter : 없음 * return : 없음 */function lfn_InitJubsuBaseInfo() {        ds_oExamJubsuResult.ClearData();    ds_ioExamJubsu.ClearData();    ds_ioExamJubsu.InsertRow(0);    cbxEmailDomain.Value = "";               // 실명인증버튼    lb_IsNiceCheckOk = false;    btnAuthResidentNo.Text = "실명인증";    btnAuthResidentNo.Enable = true;        // 사진    imgLastestPicture.ImageID = "";    imgLastestPicture.Text = "최근사진";    imgPicture.ImageID = "";    imgPicture.Text = "사진";        ds_ioExamJubsu.ApplyChange();    ls_UploadRealName = ""; // 사진이미지 실제파일명    lb_FileUpload = false; // 사진등록여부    ls_OldSeatNo = ""; // 기존 좌석번호    ls_OldPictureNo = ""; // 기존 사진번호    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부    ls_IsChangedPictureYn = "N"; // 사진 변경여부    ls_OldPersonName = "";    ls_OldRID   = "";        radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부    ls_SearchFlag = false;    }/* * 기능 : 업무 변경이력을 저장한다. * parameter : sGubun - 변경구분. 예) I, U, D * return : 없음 */function lfn_SaveModifyHistory(sGubun) {      if (sGubun = "I") { // 신규        gds_iModifyHistory.InsertRow(0);        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oExamJubsuResult.GetColumn(0, "RESULTEJMGNO")); // KEY값        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값    } else if (sGubun = "D") { // 삭제        gds_iModifyHistory.InsertRow(0);        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값    } if (sGubun = "U") { // 수정        var ln_TotalCount = ds_oModifyColumn.GetCount();        var ls_ColumnCd = "";        var ls_ColumnNm = "";        for (var i = 0; i < ln_TotalCount; i++) {            ls_ColumnCd = ds_oModifyColumn.GetColumn(i, "COLUMNCD");            ls_ColumnNm = ds_oModifyColumn.GetColumn(i, "COLUMNNM");            if (ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd) <> ds_ioExamJubsu.GetColumn(0, ls_ColumnCd)) {                gds_iModifyHistory.InsertRow(0);                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_ColumnNm); // 변경 컬럼명                gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd)); // 변경 전 값                gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ds_ioExamJubsu.GetColumn(0, ls_ColumnCd)); // 변경 후 값                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부            }        }        // 좌석번호 변경        if (ls_OldSeatNo <> edSeatNo.Text) {            gds_iModifyHistory.InsertRow(0);            gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분            gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분            gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값            gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "좌석번호"); // 변경 컬럼명            gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldSeatNo); // 변경 전 값            gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", edSeatNo.Text); // 변경 후 값            ls_IsChangedSeatNoYn = "Y"; // 좌석번호 변경여부        }        // 사진 변경        if (lb_FileUpload || ls_OldPictureNo <> ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ")) {            gds_iModifyHistory.InsertRow(0);            gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분            gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분            gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값            gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "사진"); // 변경 컬럼명            gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldPictureNo); // 변경 전 값            gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", iif(lb_FileUpload, ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1, ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"))); // 변경 후 값            if (lb_FileUpload) {                ls_IsChangedPictureYn = "Y"; // 사진 변경여부                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부            } else {                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부            }        }    }    gfn_InsertModifyHistory(); // 업무 변경이력을 저장한다.}/* 사용자 이벤트 함수 */function lfn_SortGrid2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {    var lobj_Dataset = object(obj.BindDataset);    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.    if (lobj_Dataset.GetRowCount() > 1) { 	    if (nCell > 0) {            gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.        }    }}// 회차function edExamOrder_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){	if (nChar == 13) { // Enter key        btnSearchExamOrder.SetFocus();        lfn_SearchExamOrderMgno(obj);	}}function edExamOrder_OnKillFocus(obj) {    gfn_ComponentOnKillFocus(obj);    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));        lfn_SearchExamOrderMgno(obj); // 회차관리번호 조회함    }// 접수가능회차function btnSearchExamOrder_OnClick(obj) {      var arrExamOrder = gfn_ExamOrderListPopup("Y", cbxJibu.Value, edExamYear.Text, radCourse.Value); // 교육일정관리목록 조회 팝업        if (length(arrExamOrder) > 0) {        radCourse.Value = arrExamOrder[0];        edExamYear.Text = arrExamOrder[1];        edExamOrder.Text = arrExamOrder[2];        ms_ExamMgno = arrExamOrder[3];        cbxJibu.Value = arrExamOrder[4];        lfn_SearchExamOrderMgno();    }else{		//lfn_cancel();  		lfn_NoDateCancel(); // 날짜는 초기화 안함    }}// 접수번호function edJubsuNo_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {	if (nChar == 13) { // Enter key        btnSeqList.SetFocus();        lfn_SearchExamJubsuList(obj);	}}function edJubsuNo_OnKillFocus(obj){    gfn_ComponentOnKillFocus(obj);    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 6));       // lfn_SearchExamJubsuList(obj);  //접수목록 조회함    }// 접수목록function btnSeqList_OnClick(obj) {        if (gfn_IsNull(ms_ExamMgno)) {        gfn_Alert("시험을 먼저 선택해 주십시오.");        edExamOrder.SetFocus();        return false;    }    lfn_ExamJubsuListPopup(ms_ExamMgno, edJubsuNo.Text, iif(gfn_IsNull(edJubsuNo.Text), "", "Y")); // 교육접수자목록 조회 팝업    lfn_SearchExamJubsuList(obj);}// 결강자관리function btnAbsentManageLink_OnClick(obj) {   }// 회차변경function btnExamJubsuModify_OnClick(obj) {        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다.");        edJubsuNo.SetFocus();        return false;    }    if (left(GetDAte(), 8) > ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE")) {        gfn_Alert("시험일이 지나서 회차변경하실 수 없습니다.");        return false;    }    if (ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "Y") { // 환불이면        gfn_Alert("환불 상태이므로 회차변경할 수 없습니다.");        return false;    }    var sArg = "sJibu=" + quote(cbxJibu.Text);    sArg += " sJibuCd=" + quote(cbxJibu.Value);    sArg += " sCourse=" + quote(ds_oCourse.GetColumn(ds_oCourse.FindRow("CD", radCourse.Value), "DATA"));    sArg += " sCourseCd=" + quote(radCourse.Value);    sArg += " sYear=" + quote(edExamYear.Text);    sArg += " sOrder=" + quote(edExamOrder.Text);    sArg += " sEjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));	    return Dialog("spcledu::frmspcledu0402PExamOrderChange.xml", sArg, 800, 400, "", -1, -1);}// 기본정보function btnSearchPersonInfo_OnClick(obj) {	lfn_SearchPersonNm();}function lfn_SearchPersonNm(){	var arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medResidentNo.Value,"22"); // 고객 조회 팝업    if (length(arrTrainingPerson) > 0) {        edPersonNm.text = arrTrainingPerson[0];        medResidentNo.Value = arrTrainingPerson[1];        ms_TrainingPersonMgno = arrTrainingPerson[2];        ds_ioExamJubsu.SetColumn(0, "TPMGNO", arrTrainingPerson[2]);        edTel.Text = arrTrainingPerson[3];        edHpTel.Text = arrTrainingPerson[4];        edEmail.text = arrTrainingPerson[5];        edEmailDomain.Value = arrTrainingPerson[6];        ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);        medZipCode.Value = arrTrainingPerson[12];        edAddr1.text = arrTrainingPerson[13];        edAddr2.text = arrTrainingPerson[14];        //실명인증 버튼        var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부        if (ls_AuthYn == "Y") {            ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");            btnAuthResidentNo.Enable = false;            btnAuthResidentNo.Text = "실명인증완료";            edAddr1.SetFocus();        } else {            btnAuthResidentNo.Enable = true;            btnAuthResidentNo.Text = "실명인증";            btnAuthResidentNo_OnClick();        }        // 최근사진        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ")) || ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") == '0') {            imgLastestPicture.Text = "최근사진";            imgLastestPicture.ImageID = "";        } else {            imgLastestPicture.Text = "";            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];        }            } else {        medResidentNo.SetFocus();    }           //lfn_searchAddr(medResidentNo.Value);  //  주소를 따로 구하도록하였지만 필요 없는거 같음}function lfn_searchAddr(residentNo)   //  주소를 따로 구하도록하였지만 필요 없는거 같음{	if(residentNo == "" || residentNo = NULL)	{		return false;	}		tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchExamJubsuAddr", false);    // 서버 호출    tit_callService(        ""        ,""        ,""    // inDs        ,"ds_oExamAdd=ds_oExamAdd"    // outDs        ,"EJRESIDENTNO=" + quote(residentNo)                ,"lfn_AfterSearchAddr"        ,false    );}function lfn_AfterSearchAddr(nErrorCode, strErrorMsg){	ds_ioExamJubsu.SetColumn(0, "ZIPCD", ds_oExamAdd.GetColumn(0, "EJZZIPCD"));	ds_ioExamJubsu.SetColumn(0, "ADDR1", ds_oExamAdd.GetColumn(0, "EJADDR1"));	ds_ioExamJubsu.SetColumn(0, "ADDR2", ds_oExamAdd.GetColumn(0, "EJADDR2"));}// 주민등록번호function medResidentNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {    if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13)){ // (Ctrl + C)가 아니면        if (nChar == 13) {            btnAuthResidentNo.SetFocus();            btnAuthResidentNo_OnClick(); // 실명인증        } else {            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {                lfn_ResetPerson();            }        }    }}// 실명인증function btnAuthResidentNo_OnClick(obj) {	lb_IsNiceCheckOk = gfn_CheckNice(edPersonNm.Text, medResidentNo.Value); // 실명인증    if (lb_IsNiceCheckOk) {        btnAuthResidentNo.Text = "실명인증완료";        btnAuthResidentNo.Enable = false;        ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");        edAddr1.SetFocus();       ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함        lfn_searchTraingPerson(); // 개인정보 조회                //////////////////        ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));        ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", ds_ioExamPerson.GetColumn(0, "TPLASTIMGSEQ"));        ds_ioExamJubsu.SetColumn(0, "ZIPCD", ds_ioExamPerson.GetColumn(0, "TPZIPCD"));               // medZipCode.Text = ds_ioTrainingPerson.GetColumn(0, "TPZIPCD");        edAddr1.Text = ds_ioExamPerson.GetColumn(0, "TPADDR1");        edAddr2.Text = ds_ioExamPerson.GetColumn(0, "TPADDR2");        edTel.Text = ds_ioExamPerson.GetColumn(0, "TPTEL");        edHpTel.Text = ds_ioExamPerson.GetColumn(0, "TPHPTEL");        edEmail.Text = ds_ioExamPerson.GetColumn(0, "TPEMAILID");        edEmailDomain.Text = ds_ioExamPerson.GetColumn(0, "TPEMAILDOMAIN");                // 최근사진        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ"))) {            imgLastestPicture.Text = "최근사진";            imgLastestPicture.ImageID = "";        } else {            imgLastestPicture.Text = "";            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamPerson.GetColumn(0, "IIDIRPATH") + "/" + ds_ioExamPerson.GetColumn(0, "IIREALNM");        }        ////////////////////////////////                     } else {        btnAuthResidentNo.Text = "실명인증";        btnAuthResidentNo.Enable = true;        medResidentNo.SetFocus();    }           	///////////////////////////  강습자관리번호 유무 파악	///////////////////////////  없을 경우 다시 조회함  (원래 있었으나 저장시 체크하기로 하여 일단 막음)	/*	if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {	            ds_oTrainingPerson.ClearData(); // 데이타셋 초기화        tit_clearActionInfo();         tit_addSearchActionInfo("spcledu:searchExamPersonCheck", false);        // 서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,"ds_oTrainingPerson=ds_oExamPersonCheck"	// outDs            ,"TPNM=" + quote(edPersonNm.Text)                + " TPRESIDENTNO=" + quote(replace(medResidentNo.Text,"-",""))// args            ,"lfn_AftersearchExamCheck"            ,false            ,""            ,true        );      }  */              }/* 사용자 함수 *//* * 기능 : 시험자 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */ /* function lfn_AftersearchExamCheck(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }   	      ////////  조회 후 값 담음       //  ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_oTrainingPerson.GetColumn(0, "TPMGNO"));      //  ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", ds_oTrainingPerson.GetColumn(0, "TPLASTIMGSEQ"));        //////// 기존 정보 사용 여부를 재확인     // alert(ds_oTrainingPerson.Count());                if(ds_oTrainingPerson.Count() > 0) {            if(!Confirm("기존 사용자 정보가 있습니다. 사용하시겠습니까?")){  //선택한것이 있는지 체크 메세지 보임                ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_oTrainingPerson.GetColumn(0, "TPMGNO"));                return false;            }                        edPersonNm.text = ds_oTrainingPerson.GetColumn(0, "TPNM");            medResidentNo.Value = ds_oTrainingPerson.GetColumn(0, "TPRESIDENTNO");            ms_TrainingPersonMgno = ds_oTrainingPerson.GetColumn(0, "TPMGNO");            ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_oTrainingPerson.GetColumn(0, "TPMGNO"));            edTel.Text = ds_oTrainingPerson.GetColumn(0, "TPTEL");            edHpTel.Text = ds_oTrainingPerson.GetColumn(0, "TPHPTEL");            edEmail.text = ds_oTrainingPerson.GetColumn(0, "TPEMAILID");            edEmailDomain.Value = ds_oTrainingPerson.GetColumn(0, "TPEMAILDOMAIN");            ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", ds_oTrainingPerson.GetColumn(0, "TPLASTIMGSEQ"));            medZipCode.Value = arrTrainingPerson[12];            edAddr1.text = arrTrainingPerson[13];            edAddr2.text = arrTrainingPerson[14];                // 최근사진            if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ")) || ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") == '0') {                imgLastestPicture.Text = "최근사진";                imgLastestPicture.ImageID = "";            } else {                imgLastestPicture.Text = "";                imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_oTrainingPerson.GetColumn(0, "IIDIRPATH"); + "/" + ds_oTrainingPerson.GetColumn(0, "IIREALNM");;            }                    }}*/// 접수이력function btnTraingJubsuHist_OnClick(obj) {       if (gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medResidentNo.Value)) {        gfn_Alert("성명이나 주민등록번호를 입력해 주십시오.");        edPersonNm.SetFocus();        return false;    }    var sArg = "sPersonNm=" + quote(edPersonNm.Text);    sArg += " sResidentNo=" + quote(medResidentNo.Value);    var arrEjmgno = Dialog("spcledu::frmspcledu0403PExamJubsuHistList.xml", sArg, 600, 400, "", -1, -1);        if (length(arrEjmgno) > 0) {    		ms_ExamMgno = arrEjmgno[0]; // 회차관리번호		edJubsuNo.Text = arrEjmgno[1]; // 접수번호				if(arrEjmgno[2] != gds_oUserInfo.GetColumn(0, "PDEPTCD"))		{			changeJibuRadio("T", false);				radJibuGubun.Value = "T";		}else{						changeJibuRadio("S", false);			radJibuGubun.Value = "S";		}				ls_SearchFlag = true;		lfn_SearchExamJubsuList();    }        //if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {    //    gfn_Alert("접수 정보가 없습니다.");    //    return false;    //}    //var sArg = "sTjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));    //return Dialog("spcledu::frmspcledu0403PExamJubsuHistList.xml", sArg, 600, 400, "", -1, -1);    }// 변경이력function btnModifyHistory_OnClick(obj) {       if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다.");        return false;    }	gfn_ModifyHistoryListPopup("시험접수", ds_ioExamJubsu.GetColumn(0, "EJMGNO"));}// 우편번호function edZipCode_OnFocus(obj) {    btnSearchZipCode.SetFocus();}// 우편번호function btnSearchZipCode_OnClick(obj) {    var arrZipCode = gfn_ZipCodeListPopup(); // 우편번호 조회 팝업    if (length(arrZipCode) > 0) {        medZipCode.Value = arrZipCode[0];        edAddr1.Text = arrZipCode[1];        edAddr2.SetFocus();    }}// 주소1function edAddr1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {    if (nChar == 13) {        btnSearchZipCode.SetFocus();        var arrZipCode = gfn_ZipCodeListPopup(edAddr1.Text); // 우편번호 조회 팝업        if (length(arrZipCode) > 0) {            medZipCode.Value = arrZipCode[0];            edAddr1.Text = arrZipCode[1];            edAddr2.SetFocus();        } else {            edAddr1.SetFocus();        }    }}// E-Mailfunction cbxEmailDomain_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {	if (strText == "직접입력") {        edEmailDomain.Enable = true;        edEmailDomain.Value = "";        edEmailDomain.SetFocus();    } else {        edEmailDomain.Value = cbxEmailDomain.Value;        edEmailDomain.SetFocus();    }}// SMS발송function btnSendSms_OnClick(obj) {  	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");        return false;    }    if (gfn_IsNull(edHpTel.Text)) {        gfn_Alert("발송할 휴대폰번호가 존재하지 않습니다.");        return false;    }    var arrSms = gfn_SendOneSmsPopup("22" // 시험접수                    , edHpTel.Text, edPersonNm.Text                    , ds_ioExamJubsu.GetColumn(0, "EOMGNO")                    , ds_ioExamJubsu.GetColumn(0, "EJMGNO")                    , ds_ioExamJubsu.GetColumn(0, "JUBSUNO")                ); // 단일문자메시지발송 팝업}// 결제(POS)function btnSetlmt_OnClick(obj) {       /* POPUP 호출시 넘어오는 Parameter    * parameter : sProgramId - POS단위업무프로그램	*             sSunapGubun - 수납환불구분	*             sProcAmount - 수납환불처리금액	*             sPosYear - 환불용 POS년도	*             sPosMgno - 환불용 POS관리번호	*             sKey1 - KEY값1	*             sKey2 - KEY값2	*             sHpTel - 휴대폰번호	*             sRepayPayment - 환불용 수납 결제방법	*             sRepayAmount - 환불금액	*             sRepayAbsenGubun - 강습결강일차	*/    /////////////////// 선수납 여부 체크함     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 환불이 불가능합니다.\n\n"              + "     선수납 한 인원은 강습 결제화면에서 환불이 가능합니다.");        return false;      }    ///////////////////    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");        return false;    }        if ((ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "13"            || ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "23"            || ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "15"            || ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "25") // 가상계좌이면서            && (ds_oSetlmentHist.GetColumn(0, "ESSETLMTYN") == "N")) { // 결제여부가 'N'인 경우        gfn_Alert("가상계좌 결제처리 중 입니다.");        return false;    }	    var ls_SunapGubun = "";      // 수납환불구분    var ls_ProcAmount = "";      // 처리금액    var ls_PosYear = "";         // 환불영수증년도    var ls_PosMgno = "";         // 환불영수증관리번호    var ls_RepayAmount = "";     // 환불일경우 환불할 금액    var ls_RepayAbsenGubun = ""; // 환불일경우 결강일차    var ls_RepayPayment = "";        var ls_LastSunapGubun = ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN"); // 최종결제내역        trace("최종결제내역"+ls_LastSunapGubun);            if (gfn_IsNull(ls_LastSunapGubun)) { // 결제내역이 없으면                ls_SunapGubun = "0"; // 수납                ls_ProcAmount = "10000";//gfn_SearchTrainingFee(radCourse.Value, 'N', "T"); // 수납금액            } else if (ls_LastSunapGubun == "N") { // 수납이면                  ls_SunapGubun = "1"; // 환불        ls_ProcAmount = 10000;//gfn_SearchTrainingRepayFee(ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"), ds_ioTrainingJubsu.GetColumn(0, "ABSENTDAY")); // 환불수납금액        ls_PosYear = ds_oSetlmentHist.GetColumn(0, "ESPMYEAR"); // 영수증년도        ls_PosMgno = ds_oSetlmentHist.GetColumn(0, "ESPMMGNO"); // 영수증관리번호        ls_RepayAmount = ds_oSetlmentHist.GetColumn(0, "ESPROCAMOUNT"); // 환불금액        ls_RepayPayment = ds_oSetlmentHist.GetColumn(0, "PMPAYMENTFLAG");        //ls_RepayAbsenGubun = ds_ioTrainingJubsu.GetColumn(0, "ABSENTDAY"); //환불결강일차            } else if (ls_LastSunapGubun == "Y") { // 환불이면            ls_SunapGubun = "0"; // 수납        ls_ProcAmount = "10000";//gfn_SearchTrainingFee(left(radCourse.Value, 2), right(radCourse.Value, 1), "T"); // 수납금액            }        var ls_Key1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO"); // KEY값1    var ls_Key2 = ""; // KEY값2    var ls_HpTel = edHpTel.Text; // 휴대폰번호    // 통합영수증발급(POS)시스템 팝업을 호출한다.        var arrPos = gfn_POSPopup("22", ls_SunapGubun, ls_ProcAmount, ls_PosYear, ls_PosMgno, ls_Key1, ls_Key2, ls_HpTel, ls_RepayPayment, ls_RepayAmount, ls_RepayAbsenGubun);    TRACE("POS CLOSE 상태 : "+arrPos);        //if (arrPos == "OK") {        lfn_SearchExamJubsuList(); // 접수번호로 다시 조회한다.    //}    }// 개인접수정보function ds_oJubsuAllInfo_OnRowPosChanged(obj,nOldRow,nRow) {  if (nRow <> -1) {        lfn_SearchExamOrderHistList(); // 회차변경이력 조회  }}/* * 사진관리 링크 */function btnPictureManagement_OnClick(obj) {	gs_SystemGubun = "training";    gs_SystemMenuId = "0000000003";    global.mnuLeft.tabMenu.tabpgMenu.Text = "강습관리";    var ls_MenuId = "0000000120";    var ls_MenuTitle = "사진관리";    var ls_MenuUrl = "spcledu::frmspcledu9100MPictureManagement.xml";    var sArg = "sPersonNm=" + quote(edPersonNm.Text)        + " sResidentNo=" + quote(medResidentNo.Value);    global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);    gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sArg);}/* * 최근사진반영 */function btnApplyPicture_OnClick(obj) {	if (gfn_IsNull(imgLastestPicture.ImageID)) {        gfn_Alert("최근사진 등록을 먼저 해주십시오.");        return false;	}		imgPicture.ImageID = imgLastestPicture.ImageID;	imgPicture.Text = "";	lb_FileUpload = false;	ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ"));	ls_IsChangedJubsuInfoYn = "Y";  // 접수자기본정보 변경여부	}/* * 사진찾기 */function btnLoadPicture_OnClick(obj) {    fdImage.Type = "OPEN";    if (fdImage.open()) {        fiImageFile = fdImage.FilePath + "\\" + fdImage.FileName;        fiImageFile.Open("rb");                var ln_ImageSize = fiImageFile.GetLength();        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경        if (ln_ImageSize > 300) {            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");            return false;        }                ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());                        imgPicture.ImageID = fdImage.FilePath + "\\" + fdImage.FileName;        imgPicture.Text = "";        lb_FileUpload = true;        //alert(ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"));        ls_UploadRealName = left(medResidentNo.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);        ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1);        ds_ioExamJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);        ds_ioExamJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);        ds_ioExamJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);    }}// 등록사진조회function btnSearchRegPicture_OnClick(obj) {    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {        gfn_Alert("이미지 정보가 없습니다.");        return;    }    var sArg = "sTpMgno=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO"));    sArg += " sPersonNm=" + quote(edPersonNm.Text);    sArg += " sResidentNo=" + quote(medResidentNo.Value);           var arrImage = Dialog("spcledu::frmspcledu0255PTrainingPersonPicture.xml", sArg, 536, 440, "", -1, -1); // 고객 사진 조회        if (length(arrImage) > 0) {        if (ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ") <> arrImage[0]) {            ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", arrImage[0]);            imgLastestPicture.Text = "";            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"                + arrImage[1]                + "/" + arrImage[2];        }    }}/* * 스캔실행 */function btnScanPicture_OnClick(obj) {	ExecProc(gs_ScanProgramName);}/* * 스캔사진불러오기 */function btnLoadScanPicture_OnClick(obj) {    imgPicture.ImageID = "";	imgPicture.Text = "사진";    var ls_File = split(gs_ScanFileName,"\\");    fdImage.FilePath = left(gs_ScanFileName, length(gs_ScanFileName) - length(ls_File[length(ls_file) - 1]));    fdImage.FileName = ls_File[length(ls_file) - 1];    fiImageFile.FileName = gs_ScanFileName;    if (fiImageFile.Open()) {                fiImageFile.Open("rb");        var ln_ImageSize = fiImageFile.GetLength();        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경        if (ln_ImageSize > 300) {            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");            return false;        }        ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());        fiImageFile.Close();    } else {        gfn_Alert("스캔 이미지가 없습니다.");        return;    }    imgPicture.ImageID = gs_ScanFileName;    imgPicture.Text = "";    lb_FileUpload = true;    ls_UploadRealName = left(medResidentNo.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);    ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1);        ds_ioExamJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);    ds_ioExamJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);    ds_ioExamJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);}function btnExamCheatingManageLink_OnClick(obj) {    gs_SystemGubun = "training";    gs_SystemMenuId = "0000000003";    global.mnuLeft.tabMenu.tabpgMenu.Text = "강습관리";    var ls_MenuId = "0000000105";    var ls_MenuTitle = "부정행위자관리";    var ls_MenuUrl = "spcledu::frmspcledu0420MExamCheatingManagement.xml";    var sAddArg = "";    global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);	gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sAddArg);}function edExamYear_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {	//gfn_EnterNextFocus(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam);    //lfn_SearchExamLatestOrder();    if (nChar == 13) { // Enter key       // gfn_EnterNextFocus();        lfn_NoDateCancel(); // 날짜는 초기화안함           	} else {                gfn_FormInit(this);        ms_ExamMgno = ""; // 시험관리번호            // 시험정보        lbExamInfo1.Text = "";        lbExamInfo2.Text = "";                lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화                // 그리드 초기화        ds_oJubsuAllInfo.ClearData();        gdJubsuInfo.NoDataText = "";        ds_oOrderHist.ClearData();        gdOrderHist.NoDataText = "";        ds_oSetlmentHist.ClearData();        gdSetlmentHist.NoDataText = "";        btnSetlmt.Enable = false; // 결제(POS) 버튼        btnProcRct.Enable = false;        btnShowVirtualAccount.Enable = false;	        btnChangeProcDate.Enable = false;        btnPrintReRct.Enable = false;                edPersonNm.Readonly = false;        medResidentNo.Readonly = false;                Button0.Enable = false;        btnSearchPersonInfo.Enable = true;                //btnPosReport.Enable = false;    //통합영수증조회 버튼                lfn_SetChangedJubsuInfo(true);             }	    }function lfn_PrintScreen(obj){	}function lfn_End(obj){	}/* * 기능 : 회차변경된 정보 상태변경한다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetChangedJubsuInfo(bStatus) {    if (bStatus) {        shpGubunBox3.BkColor = "";    } else {        shpGubunBox3.BkColor = "user18";    }    if (bStatus && ms_FormAuth == "W") { // 권한에 따른 버튼 설정        btnSave.Enable = true;        btnDelete.Enable = true;    } else {        btnSave.Enable = false;        btnDelete.Enable = false;    }    btnApplyPicture.Enable = bStatus; // 사진반영    // btnCancel.Enable = bStatus; // 초기화    // btnEnd.Enable = bStatus; // 종료    // btnSearchPersonInfo.Enable = bStatus; // 기본정보    btnSearchZipCode.Enable = bStatus; // 우편번호    btnAuthResidentNo.Enable = bStatus; // 실명인증    // btnAbsentManageLink.Enable = bStatus; // 결강관리    btnExamJubsuModify.Enable = bStatus; // 회차변경    // btnSeqList.Enable = bStatus; // 접수목록    // btnSearchTrainingOrder.Enable = bStatus; // 접수가능회차    // btnTraingJubsuHist.Enable = bStatus; // 접수이력    // btnSeatList.Enable = bStatus; // 좌석목록    // btnSmsStat.Enable = bStatus; // SMS현황    // btnEmailStat.Enable = bStatus; // 이메일현황    btnSearchRegPicture.Enable = bStatus; // 등록사진조회    // btnBarCodeSearch.Enable = bStatus; // 바코드조회    // btnUnUseJubsuNo.Enable = bStatus; // 빈좌석    btnLoadPicture.Enable = bStatus; // 사진찾기    btnLoadScanPicture.Enable = bStatus; // 스캔사진불러오기    btnScanPicture.Enable = bStatus; // 사진스캔    // btnPictureManagement.Enable = bStatus; // 사진관리    //btnShowVirtualAccount.Enable = bStatus; // 가상계좌보기    // btnModifyHistory.Enable = bStatus; // 변경이력    //btnChangeProcDate.Enable = bStatus; // 처리일자변경    //btnProcRct.Enable = bStatus; // 현금영수증처리    //btnPrintReRct.Enable = bStatus; // 영수증재발행    // btnSendSms.Enable = bStatus; // SMS 전송    // btnSendEmail.Enable = bStatus; // 이메일 전송    //btnPosResultList.Enable = bStatus; // POS처리결과조회    btnSetlmt.Enable = bStatus; // 결제(POS) 버튼    //btnPrintJubsu.Enable = bStatus; // 수강증출력 버튼    btnPrint.Enable = bStatus; // 강습원서출력 버튼    //btnPrintJubsuResult.Enable = bStatus; // 강습접수결과출력 버튼    // cbxJibu.Enable = bStatus;    // edTrainingYear.Enable = bStatus;    // radCourse.Enable = bStatus;    // edTrainingOrder.Enable = bStatus;    // edJubsuNo.Enable = bStatus;    // edSeatNo.Enable = bStatus;    // edPersonNm.Enable = bStatus;    // medResidentNo.Enable = bStatus;    // medBarCode.Enable = bStatus;    //edCompNm.Enable = bStatus;    edAddr1.Enable = bStatus;    edAddr2.Enable = bStatus;    edTel.Enable = bStatus;    edHpTel.Enable = bStatus;    edEmail.Enable = bStatus;    edEmailDomain.Enable = bStatus;    cbxEmailDomain.Enable = bStatus;    //edRemark.Enable = false;    //cbxRemarkGubun.Enable = bStatus;   // btnPosReport.Enable = bStatus;//통합영수증조회 버튼}function btnSmsStat_OnClick(obj){	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다.");        return false;    }        var sArg = "sEjmgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESEJMGNO"));	Dialog("spcledu::frmspcledu0426PExamSmsSendList.xml", sArg, 600, 400, "", -1, -1);}function btnSendEmail_OnClick(obj){	if (ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN") != "N") {        gfn_Alert("수납 완료된 접수자에게만 메일을 발송할 수 있습니다.");        return false;    }	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");        return false;    }    if (gfn_IsNull(edEmail.Text)) {        gfn_Alert("발송할 이메일이 존재하지 않습니다.");        return false;    }        var sArg = "sMgNo=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));    sArg += " sGubun=" + quote("E");    Dialog("COM::frmCOM1300MOneMAILSend.xml", sArg, 504, 130, "", -1, -1);	// 단일문자메시지발송 팝업}function btnEmailStat_OnClick(obj){	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");        return false;    }        var sArg = "sMgNo=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));    sArg += " sGubun=" + quote("E");	    Dialog("COM::frmCOM1400POneMAILSendList.xml", sArg, 600, 400, "", -1, -1);	// MAIL발송현황팝업}function btnChangeProcDate_OnClick(obj){    //////////////     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 처리일자변경이 불가합니다.\n\n"              + "     선수납 한 인원은 강습 결제화면에서 처리일자변경이 가능합니다.");        return false;      }    //////////////	if (ds_oSetlmentHist.currow < 0) {        gfn_Alert("결제 내역을 선택해 주십시오.");        return false;    }	//////////////////////////////////	//// 처리일자 변경시 결제 시스템에 내용이 있는지 먼저 확인함 		ds_ioYearbizlink.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("com:searchYearbizlink", false);    // 서버 호출    tit_callService(        ""        , ""        , "" // inDs        , "ds_ioYearbizlink=ds_oYearbizlink" // outDs        , "ESEJMGNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESEJMGNO")) // args            + " ESSEQ=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESSEQ")) // args        , ""        ,false        ,""        ,true    );			if (ds_ioYearbizlink.count > 0) {        alert("      < 수수료관리번호 및 수납일자 변경 불가 >\n\n"                               + "해당 자료는 회계시스템에서 시스템연동을 통해 결의서를 \n"             + "생성하였습니다. 생성정보는 아래와 같습니다.\n\n\n"                          + "                - 결의서 번호 : " + ds_ioYearbizlink.GetColumn(0, "KEYNO") + "\n\n"             + "                - 성          명 : " + ds_ioYearbizlink.GetColumn(0, "YBLNM") + "\n\n"              + "                - 금          액 : " +  ds_ioYearbizlink.GetColumn(0, "YBLAMT") + "원" + "\n\n"             + "                - 처 리  일 자 : " + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 0, 4) + "-" + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 4, 2) + "-" + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 6, 2));         return false;   	}	///////////////////////////////////		    var sArg = "sEjmgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESEJMGNO"));    sArg += " sSetlmtSeq=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESSEQ"));    sArg += " sProcDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPROCDATE"));    sArg += " sPonyDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPONYDATE"));    sArg += " sPonyDateCheck=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPONYGUBUN"));    sArg += " sPmYear=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR"));    sArg += " sPmMgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO"));    sArg += " sEsgubun=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESGUBUN"));	var ls_RetProc = Dialog("spcledu::frmspcledu0406PExamJubsuProcessDateChange.xml", sArg, 572, 184, "", -1, -1);	if (ls_RetProc == "OK") {        lfn_SearchExamSetlmentHistList(); // 결제내역 조회	}}function btnPrintReRct_OnClick(obj){	if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 영수증재발행이 불가능합니다.\n\n"              + "     선수납 한 인원은 강습 결제화면에서 영수증재발행 가능합니다.");        return false;      }		if (!gfn_Confirm("정말로 영수증을 재발행 하시겠습니까?")) {        return false;	}    gfn_PrintReceipt(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR")        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO")); // 영수증을 출력한다.}function btnShowVirtualAccount_OnClick(obj){     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 가상계좌 조회가 불가능합니다.\n\n"              + "     선수납 한 인원은 강습 결제화면에서 가상계좌 조회가 가능합니다.");        return false;      }			if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG") <> "3") { // 납입방법        gfn_Alert("선택하신 결제는 가상계좌결제가 아닙니다.");        return false;    }    // POS 결과 정보를 조회한다.	gfn_SearchPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR")        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO")        , ds_oPosResult);    var sArg = ""; // 팝업파라메터    sArg = "sVirtCloseDate=" + quote(ds_oPosResult.GetColumn(0, "VIRTCLOSEDATE")); // 가상계좌유효기간    sArg += " sVirtStat=" + quote(ds_oPosResult.GetColumn(0, "VIRTRESULT")); // 입금여부(R-계좌 할당,I-입금,C-취소)    sArg += " sVirtAccountNo=" + quote(ds_oPosResult.GetColumn(0, "VIRTACCOUNT")); // 계좌번호    sArg += " sVirtBankCd=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKCD")); // 은행코드    sArg += " sVirtBankNm=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKNM")); // 은행명칭    sArg += " sVirtInputAmount=" + quote(ds_oPosResult.GetColumn(0, "VIRTINPUTAMT")); // 입금액    sArg += " sVirtBankDate=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKDATE")); // 입금/취소일자    sArg += " sGubun=" + quote("22"); // 업무구분 : 21 강습 22 시험	var arrVirtGubun = Dialog("COM::frmCOM3401PVirtualAccountPOSResult.xml", sArg, 400, 224, "", -1, -1);		if (arrVirtGubun[0] == "1") {  //가상계좌를 삭제 했다면        lfn_Search(); // 다시 조회 함    }    }function ds_oSetlmentHist_OnRowPosChanged(obj,nOldRow,nRow){	if (ds_ioExamJubsu.GetColumn(0, "LASTYN") == "Y") { // 회차변경여부        var ls_PaymentGubun = obj.GetColumn(nRow, "PMPAYMENTFLAG"); // 납입방법        var ls_SunapGubun = obj.GetColumn(nRow, "ESGUBUNCD"); // 수납구분        var ln_RepayRefNo = obj.GetColumn(nRow, "ESREPAYREF"); // 수납구분                if (ls_PaymentGubun == "0") { // 현금            btnProcRct.Text = "현금영수증처리";                        if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우                btnProcRct.Enable = true;            } else {                btnProcRct.Enable = false;            }                                    btnShowVirtualAccount.Enable = false;        } else if (ls_PaymentGubun == "1") { // 카드            btnProcRct.Enable = false;            btnShowVirtualAccount.Enable = false;        } else if (ls_PaymentGubun == "2") { // 현금영수증            btnProcRct.Text = "현금영수증취소";                        if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우                btnProcRct.Enable = true;            } else {                btnProcRct.Enable = false;            }                                   btnShowVirtualAccount.Enable = false;                    } else if (ls_PaymentGubun == "3" || obj.GetColumn(nRow, "TSGUBUN") == "15" || obj.GetColumn(nRow, "TSGUBUN") == "25") { // 가상계좌                        if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우                btnProcRct.Enable = true;            } else {                btnProcRct.Enable = false;            }                        btnShowVirtualAccount.Enable = true;        } else {            btnProcRct.Enable = false;            btnShowVirtualAccount.Enable = false;        }                btnChangeProcDate.Enable = true;        btnPrintReRct.Enable = true;    }else{    		btnChangeProcDate.Enable = false;        btnPrintReRct.Enable = false;        btnShowVirtualAccount.Enable = false;        btnProcRct.Enable = false;    }    }function radJibuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex){	if (strCode == "S") { // 소속지부			if (ds_oJibu.FindRow("CD", gds_oUserInfo.GetColumn(0, "PDEPTCD")) <> -1) {            cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");        }        	}		changeJibuRadio(strCode, true);}function changeJibuRadio(strCode, isSearch){	if(strCode == "S")	{		cbxJibu.Enable = false;        radJibuGubun.BkColor = "";				if(isSearch)		{			lfn_SearchExamLatestOrder();		}			}else{				cbxJibu.Enable = true;        radJibuGubun.BkColor = "red";		}}function lfn_initJibu(){	cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");	cbxJibu.Enable = false;}function btnProcRct_OnClick(obj){     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 현금영수증처리/취소가 불가능합니다.\n\n"              + "     선수납 한 인원은 강습 결제화면에서 현금영수증처리/취소가 가능합니다.");        return false;      }		if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");        return false;    }    // if (!gfn_Confirm(btnProcRct.Text + "하시겠습니까?")) {        // return false;	// }    if (left(GetDate(), 8) >= left(AddDate(ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"), 365), 8)) {        gfn_Alert("교육시작일로부터 1년이 지났습니다.");        return false;    }    if (ds_ioExamJubsu.GetColumn(0, "EJHSTATUSCD") == '5' // 5:환불신청(미입금)            || ds_ioExamJubsu.GetColumn(0, "EJHSTATUSCD") == '6') { // 6:환불접수(신청확인)        gfn_Alert("인터넷 환불 처리 중입니다.");        return false;    }    var ls_Key1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO"); // KEY값1-접수관리번호    var ls_Key2 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESSEQ"); // KEY값2-결제순차번호    var ls_RepayPosYear = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR"); // POS년도    var ls_RepayPosMgno = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO"); // POS관리번호    var ls_RepayPayment = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG"); // 결과출력용 납입방법(0,1,2,3)        // 통합영수증발급(POS)시스템 현금영수증처리 팝업을 호출한다.    var arrPos = gfn_TrainingCashChangePOSPopup("22", ls_Key1, ls_Key2, ls_RepayPosYear, ls_RepayPosMgno, ls_RepayPayment);    if (arrPos[0] <> "END") {        lfn_SearchExamJubsuList(); // 접수번호로 다시 조회한다.    }}function btnJubsuHistory_OnClick(obj){	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {        gfn_Alert("접수 정보가 없습니다.");        return false;    }    var sArg = "sEjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));    Dialog("spcledu::frmspcledu0428PExamJubsuHistory.xml", sArg, 600, 400, "", -1, -1);}function radChangeTpmgno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex){	if (strCode == "C") {        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {            gfn_Alert("접수 정보가 없습니다.");            radChangeTpmgno.Value = "S";            return false;        } else {            gfn_Alert("이 기능은 동일 인물에 대한 오타에 의한 성명/주민번호 변경용입니다.\n따라서, 해당 강습자와 관련된 모든 정보가 일괄 변경되므로, 신중히 변경하시기 바랍니다.");        }	}}function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){	if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면        if (nChar == 13) {            btnAuthResidentNo.SetFocus();            lfn_SearchPersonNm();        } else {            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {                lfn_ResetPerson();                medResidentNo.Value = "";            }        }    }}function lfn_ResetPerson() {    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부    lfn_SetChangedJubsuInfo(true);    ds_ioExamJubsu.SetColumn(0, "EJMGNO", ""); // 접수관리번호    ms_TrainingPersonMgno = "";    ds_ioExamJubsu.SetColumn(0, "TPMGNO", "");    medZipCode.Value = "";    edAddr1.Text = "";    edAddr2.Text = "";    edTel.Text = "";    edHpTel.Text = "";    edEmail.text = "";    edEmailDomain.Value = "";    ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", "");    //실명인증 버튼    btnAuthResidentNo.Text = "실명인증";    btnAuthResidentNo.Enable = true;    ds_ioExamJubsu.SetColumn(0, "AUTHYN", "");    // 최근사진    imgLastestPicture.Text = "최근사진";    imgLastestPicture.ImageID = "";    // 그리드 초기화    ds_oJubsuAllInfo.ClearData();    gdJubsuInfo.NoDataText = "";    ds_oOrderHist.ClearData();    gdOrderHist.NoDataText = "";    ds_oSetlmentHist.ClearData();    gdSetlmentHist.NoDataText = "";    btnSetlmt.Enable = false; // 결제(POS) 버튼    btnProcRct.Enable = false;    btnShowVirtualAccount.Enable = false;        btnChangeProcDate.Enable = false;    btnPrintReRct.Enable = false;}/*// 최차변경이력을 선택했을시 상단에 상세 내용을 보여줌 20091015*/function gdOrderHist_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex){   //alert("회차변경이력" + ds_oOrderHist.currow + nRow);		if(ds_oOrderHist.rowcount > 0)	{		var cnt = nRow; // 선택 row 값					var edJubsuNo_Num; // 접수번호 담는 변수				serch_falg = "1";		   			cbxJibu.value = ds_oOrderHist.GetColumn(cnt, "BEFORJIBU");    // 지부			edExamYear.Text = ds_oOrderHist.GetColumn(cnt, "BEFOREOYEAR");  // 년도			radCourse.Value = ds_oOrderHist.GetColumn(cnt, "BEFOREOTCCOURSECD");  // 직능			edExamOrder.Text = ds_oOrderHist.GetColumn(cnt, "BEFORORDER"); // 회차 정보			edJubsuNo.text  = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호			edJubsuNo_Num = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호 담음			edSeatNo.Text = ds_oOrderHist.GetColumn(cnt, "EOHEXAMSEATNO"); // 좌석번호				if(ds_oOrderHist.GetColumn(cnt, "BEFORJIBU") != gds_oUserInfo.GetColumn(0, "PDEPTCD"))			{				changeJibuRadio("T", false);					radJibuGubun.Value = "T";			}else{								changeJibuRadio("S", false);				radJibuGubun.Value = "S";			}				//alert("회차관리번호 조회함");				lfn_SearchExamOrderMgno();  // 시험 회차관리번호를 조회한다.			edJubsuNo.text  = edJubsuNo_Num; // 접수번호			lfn_SearchExamJubsuList();  // 시험접수 내용을 조회한다.			}else{		serch_falg = "0";	}}function gdJubsuInfo_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex){    serch_falg = "1";  // 조회 플래그만 변경        /*    if(ds_oJubsuAllInfo.count == "1") {        gdOrderHist_OnCellClick(0,0,0,0,0);    }    */        if(ds_oJubsuAllInfo.currow == nRow) {              ds_oJubsuAllInfo_OnRowPosChanged(); // ds 변경 함수를 호출함 (같은 row선택시)    }    }function Edit0_OnChanged(obj,strText){	Edit0.Text = "";}function btnSearchPersonInfoChange_OnClick(obj){    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medResidentNo.Value)) {        gfn_Alert("성명 및 주민번호가 비어있습니다.\n'기본정보조회' 후에 사용하여 주시기 바랍니다.");        return;    }//////////////////////    ds_ioT_E_L_JubsuCheck.ClearData();    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.    tit_addCsvSearchActionInfo("com:searchT_E_L_JubsuCheck", false);    // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_ioT_E_L_JubsuCheck=ds_oT_E_L_JubsuCheck"	// outDs        ,"TPMGNO_A=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO")) // args        ,"lfn_AfterAllJubsuSearch"        ,false        ,""        ,true    );        if (ds_ioT_E_L_JubsuCheck.GetRowCount() == 1) {      /*  alert("   현재 접수내역의 접수자는 신규 접수자 입니다. \n\n"             + "반드시 '1번의 이름/주민번호 변경'을 통해 변경 바랍니다. \n");*/            } else {      /*  alert("   현재 접수내역의 접수자는 기존 접수한 내역이 있습니다. \n\n"             + "반드시 '2번의 접수 대상자 변경'을 통해 변경 바랍니다. \n");*/    }////////////////////    var retArr = gfn_TrainingPersonModifyPopup(ds_ioExamJubsu.GetColumn(0, "TPMGNO"), ds_ioT_E_L_JubsuCheck.GetRowCount());  //팝업 호출    if(gfn_isNull(retArr[0]) and gfn_isNull(retArr[1]) and gfn_isNull(retArr[2])){        } else {        if (edPersonNm.Text != retArr[0]            || medResidentNo.Value != retArr[1]            || ds_ioExamJubsu.GetColumn(0, "TPMGNO") != retArr[2] ) {  // 기존값과 조회 변경한 값이 다를 경우 update 수행            //////////////////////// return 되는 강습자관리번호로 해당 직능 및 회차에 동일인 접수 내역있는지 확인        lfn_searchJubsuListReturnTpmgno(retArr[2], retArr[1], retArr[0]);     // return 강습자관리번호로 접수내역 확인                  if (ds_ioExam_ReturnTpmgnoJubsuCheck.count > 0) {            alert("변경예정대상자는 이미 해당 직능 회차에 접수가 되어 있습니다. 확인 바랍니다. \n\n"                + "         직          능 :   " + radCourse.Text + "\n"                 + "         회          차 :   " + edExamOrder.Text + "\n"                 + "         이          름 :   " + retArr[0] + "\n"                 + "         접수 번호는 :   " + ds_ioExam_ReturnTpmgnoJubsuCheck.Getcolumn(0, "EOHJUBSUNO") + " 입니다. \n" );            return false;        }     ////////////////////      /////////////////////////// 개인정보 변경 후 수료 여부 확인     ///////////////////////// 강습접수에 수료한거 중에 해당 직능이 있는지 조회하여 메시지 보여줌        ds_ioTrainingJubsuMatching.ClearData(); // 데이타셋 초기화        tit_clearActionInfo();        tit_addSearchActionInfo("spcledu:searchTrainingJubsuMatching", false);        // 서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,"ds_ioTrainingJubsuMatching=ds_oTrainingJubsuMatching"	// outDs            ,"TPNM=" + quote(edPersonNm.Text)		// 성명            + " TOTCCOURSECD=" + quote(radCourse.Value)  // 직능            + " TPRESIDENTNO=" + quote(replace(medResidentNo.Text,"-",""))// args            ,"lfn_AfterSearchTrainingPerson"            ,false            ,""            ,true                    );        ////////////////////////     접수자 변경시 수료여부 체크하여 접수를 변경할지 판단           if (ds_ioTrainingJubsuMatching.count == 0 ) {            if (!gfn_Confirm("정말 저장하시겠습니까?")) {                return false;            }                       //   return false;     }                      ///////////////////////////               ds_ioExamJubsu.SetColumn(0, "TPMGNO", retArr[2]);  // 강습자관리번호를 update함                    tit_addSingleActionInfo("com:updateExamJubsuChange", "", 0, "");            tit_callService(                ""                ,""                ,"ds_iTrainingJubsuChange=ds_ioExamJubsu:U"	// inDs                ,""	// outDs                ,"TPMGNO_A=" + quote(retArr[2])                                   + " TPRESIDENTNO_A=" + quote(retArr[1])                    + " PNM_A=" + quote(retArr[0])                    + " TPZIPCD_A=" + quote(medZipCode.Value)                    + " TPADDR1_A=" + quote(edAddr1.Text)                    + " TPADDR2_A=" + quote(edAddr2.Text)                                        + " TPTEL_A=" + quote(edTel.Text) //전화번호                    + " TPHPTEL_A=" + quote(edHpTel.Text)  //휴대폰                    + " TPEMAILID_A=" + quote(edEmail.Text + cbxEmailDomain) //E- MAIL                                                         + " TJMGNO_A=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args                ,"lfn_AfterSearchChane"                ,false                ,""                ,true            );        }    }         }function lfn_searchJubsuListReturnTpmgno(sTpmgNo, sTPRESIDENTNO, sTNM) {/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기 return 강습자관리번호로 check    var TPMGNO_A = sTpmgNo;    var TPRESIDENTNO_A = sTPRESIDENTNO;    var TNM_A = sTNM;    ds_ioExam_ReturnTpmgnoJubsuCheck.ClearData();    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.    tit_addCsvSearchActionInfo("com:searchExam_ReturnTpmgnoJubsuCheck", false);    // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_ioExam_ReturnTpmgnoJubsuCheck=ds_oExam_ReturnTpmgnoJubsuCheck"	// outDs        , "TOMGGTMGNO_A=" + quote(cbxJibu.Value)  // 지부        + " TOYEAR_A=" + quote(edExamYear.Text) // 년도        + " TOTCCOURSECD_A=" + quote(radCourse.Value) // 직능        + " TOTRAININGORDER_A=" + quote(edExamOrder.Text) // 회차         + " TPRESIDENTNO_A=" + quote(TPRESIDENTNO_A)        + " TPNM_A=" + quote(TNM_A)         // + " TPMGNO_A=" + quote(TPMGNO_A) // 강습자관리관번호                      // args        ,""        ,false        ,""        ,true    );  }  /* 사용자 함수 *//* * 기능 : 접수내역 update 후 처리 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchChane(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }       lfn_Search();     gfn_SaveMessage(); // 저장 메세지를 처리한다.	}function lfn_AfterAllJubsuSearch(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    	}/** 결재 그리드 배경색을 기본으로 하고 선택한 ROW에 배경색을 지정(셀의 색상속성을 지정위함)*/function fn_bkcolor(currow){    if(ds_oSetlmentHist.row == currow)     {        return "#DFCF91";      }else      {        return "default";      }}function lfn_ComponentOnKillFocus(obj){    lfn_NoDateCancel(); //날짜는 초기화 안함                      if (edExamYear.Text == left(GetDate(), 4)) {            lfn_SearchExamLatestOrder(); // 최근 접수가능회차 조회             }             //   edExamOrder.SetFocus(); }// 통합영수증조회 팝업function btnPosReport_OnClick(obj){    var sArg = "sProgramId=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD"));    var retDlg = Dialog("posetc::frmposetc0020PPosReport.xml", sArg, 480, 320, "", -1, -1);	}]]></Script></Window>
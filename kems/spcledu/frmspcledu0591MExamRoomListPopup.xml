<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="400" Id="frmspcledu0591MExamRoomListPopup" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="시험장검색팝업" Top="8" Ver="1.0" Width="600" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_oExamRoom">				<Contents>					<colinfo id="EOEXAMORDER" size="3" summ="default" type="STRING"/>					<colinfo id="EOEXAMORDERGUBUN" size="30" summ="default" type="STRING"/>					<colinfo id="EOMGJIBUCD" size="2" summ="default" type="STRING"/>					<colinfo id="EOMGNO" size="30" summ="default" type="STRING"/>					<colinfo id="EOYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="EPMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EREXAMROOM" size="200" summ="default" type="STRING"/>					<colinfo id="ERNUMTYPE" size="2" summ="default" type="STRING"/>					<colinfo id="EXAMNM" size="52" summ="default" type="STRING"/>					<colinfo id="JJIBUNM" size="20" summ="default" type="STRING"/>					<colinfo id="TCCOURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="TCCOURSENM" size="30" summ="default" type="STRING"/>					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJibu">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oCourse">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>		</Datasets>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="331" LineColor="user14" Right="598" TabOrder="61" Top="1" Type="Rectangle" Width="267"></Shape>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSelect" ImageID="BTN_TEXT_COM" Left="422" OnClick="btnSelect_OnClick" Style="sty_Button" TabOrder="2" Text="선택" ToolTipText="선택" Top="4" Transparent="TRUE" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="BTN_MULTI_SORT" Left="520" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="5" Top="32" Transparent="TRUE" Width="74"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="335" OnClick="lfn_Search" Style="sty_Button" TabOrder="1" ToolTipText="조회" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="509" OnClick="lfn_End" Style="sty_Button" TabOrder="3" ToolTipText="닫기" Top="4" Width="85"></Button>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oExamRoom" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="392" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="336" Id="gdExamRoom" InputPanel="FALSE" Left="4" LineColor="default" OnCellDBLClick="gdExamRoom_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="596" RowHeight="20" Style="sty_Grid" TabOrder="6" TabStop="true" Top="56" UseDBuff="true" UsePopupMenu="true" UserData="시험장목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="592">			<contents>				<format id="Default">					<columns>						<col width="323"/>						<col width="297"/>						<col width="120"/>						<col width="47"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="시험명"/>						<cell align="center" col="1" display="text" text="시험장"/>						<cell align="center" col="2" display="text" text="직능"/>						<cell align="center" col="3" display="text" text="종별"/>					</head>					<body>						<cell align="left" col="0" colid="EXAMNM" display="text"/>						<cell align="left" col="1" colid="EREXAMROOM" display="text"/>						<cell align="center" col="2" colid="EPCOURSECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>						<cell align="center" col="3" colid="EPNUMTYPE" display="text"/>					</body>				</format>			</contents>		</Grid>		<Static Align="Center" Height="20" Id="lbExamRoom" Left="4" Style="sty_Label" TabOrder="7" Text="시험장" Top="32" UserData="SK" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edExamRoom" ImeMode="native" Left="96" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExamRoom_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="4" Top="32" UserData="S:시험장:K" Width="420"></Edit>	</Form>	<Script><![CDATA[/* * 시험장정보명 : frmspcledu0591MExamRoomListPopup.xml * 설명 : 시험장검색팝업 * 작성일 : 2009.08.29 * 작성자 : 이규희 */#include "LIB::COMMON.js"; // 공통 관련/* 공통 필수 시작 */var ls_sExamOrder = "";function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    ls_sExamOrder = ms_ExamMgno;    lfn_Search();}function Form_OnUnloadCompleted(obj) {    Close();}function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    switch (nChar) {        case 27 : // 종료(Esc)            lfn_End();            break;        case 113 : // 조회(F2)            lfn_Search();            break;    }}/* * 기능 : 조회 */function lfn_Search(obj) {    if (length(toString(ls_sExamOrder)) == 0) {        gfn_Alert("시험을 선택해 주십시오.");        btnSearchExamOrder.SetFocus();        return false;    }    ds_oExamRoom.ClearData(); // 데이타셋 초기화        // 조회이력을 저장한다.      ls_HistoryArg = "회차관리번호=" + quote(ls_sExamOrder)                + ",시험장=" + quote(edExamRoom.Text);    gfn_InsertSearchPrintHistory(        "S"        , this.ID        , global.mnuLeft.cbxOpenForm.Text        , ls_HistoryArg    );    tit_clearActionInfo();	tit_addCsvSearchActionInfo("spcledu:searchExamRoom", false);	// 서버 호출 	tit_callService(		""		,""		,""	// inDs		,"ds_oExamRoom=ds_oExamRoom"	// outDs		,"EOMGNO=" + quote(ls_sExamOrder)            + " EREXAMROOM=" + quote(edExamRoom.Text)	// args 		,"lfn_AfterSearchExamRoom"		,false	);}/* * 기능 : 종료 */function lfn_End(obj) {    Close();}/* 공통 필수 종료 *//* 시험장 함수 *//* * 기능 : 공통코드 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchExamRoom(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    if (ds_oExamRoom.GetCount() == 1) {        var arrArg = Array(2);        arrArg[0] = ds_oExamRoom.GetColumn(ds_oExamRoom.currow, "EOMGNO"); // 시험장관리번호        arrArg[1] = ds_oExamRoom.GetColumn(ds_oExamRoom.currow, "EREXAMROOM"); // 시험장명        Close(arrArg);    }    gfn_SearchMessage(gdExamRoom); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* 시험장 이벤트 함수 */function lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {    var lobj_Dataset = object(obj.BindDataset);    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.    if (lobj_Dataset.GetRowCount() > 1) {        gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.    }}function btnMutilSort_OnClick(obj){	gfn_GridMultiSort(gdExamRoom, 0); // 멀티 정렬을 실행한다.}function btnSelect_OnClick(obj){    var arrArg = Array(2);    arrArg[0] = ds_oExamRoom.GetColumn(ds_oExamRoom.currow, "EOMGNO"); // 시험장관리번호    arrArg[1] = ds_oExamRoom.GetColumn(ds_oExamRoom.currow, "EREXAMROOM"); // 시험장명    Close(arrArg);}function gdExamRoom_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex){    btnSelect_OnClick(obj);}function edExamRoom_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){    if (nChar == 13) { // Enter Key        lfn_Search();    }}function btnSearchExamOrder_OnClick(obj) {    var arrExamOrder = gfn_ExamOrderListPopup(); // 시험회차목록 조회 팝업    if (length(arrExamOrder) > 0) {        //edExamNm.Text = arrExamOrder[5] + " " + arrExamOrder[6] + " " + arrExamOrder[1] + "년 " + arrExamOrder[2] + "회차 " + arrExamOrder[8];        ms_ExamMgno = arrExamOrder[3];            }}]]></Script></Window>
<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="128" Id="frmspcledu0095SInternetJubsuRepayInfo" Left="8" OnLoadCompleted="Form_OnLoadCompleted" PidAttrib="7" Style="sty_Form" Title="환불정보DIV" Top="8" Ver="1.0" Width="728" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingRepayFee">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REPAY" size="256" summ="default" type="STRING"/>
					<colinfo id="REPAYTEXT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="124" Height="112" Id="Shape1" Left="1" LineColor="user15" Right="724" TabOrder="5" Top="12" Type="Rectangle" Width="723"></Shape>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edProcReason" ImeMode="native" Left="108" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="21" Top="100" UserData="S" Visible="FALSE" Width="612"></Edit>
		<Static Align="Center" Height="20" Id="lbProcReason" Left="4" Style="sty_Label" TabOrder="20" Text="비고" Top="100" VAlign="Middle" Visible="FALSE" Width="100"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medAmount" Left="108" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="19" Top="76" Width="92"></MaskEdit>
		<Static Align="Center" Height="20" Id="lbBank" Left="244" Style="sty_Label" TabOrder="4" Text="환불은행" Top="28" VAlign="Middle" Width="84"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edBank" ImeMode="native" Left="332" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="2" Top="28" Width="164"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edAccount" ImeMode="native" Left="108" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="3" Top="52" Width="132"></Edit>
		<Static Align="Center" Height="20" Id="Static10" Left="12" Style="sty_LabelGruopBox" TabOrder="6" Text="환불정보" Top="4" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Height="20" Id="lbPersonNm" Left="4" Style="sty_Label" TabOrder="7" Text="예금주" Top="28" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPersonNm" ImeMode="native" Left="108" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="1" Top="28" Width="132"></Edit>
		<Static Align="Center" Height="20" Id="lbAmount" Left="4" Style="sty_Label" TabOrder="8" Text="환불금액" Top="76" VAlign="Middle" Width="100"></Static>
		<Static Align="Center" Height="20" Id="lbAccount" Left="4" Style="sty_Label" TabOrder="9" Text="환불계좌" Top="52" VAlign="Middle" Width="100"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edReason" ImeMode="native" Left="332" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="10" Top="52" Width="388"></Edit>
		<Static Align="Center" Height="20" Id="lbReason" Left="244" Style="sty_Label" TabOrder="11" Text="환불사유" Top="52" VAlign="Middle" Width="84"></Static>
		<Static Align="Center" Height="20" Id="lbRepayDate" Left="500" Style="sty_Label" TabOrder="12" Text="환불신청일시" Top="28" VAlign="Middle" Width="84"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="meRepayDate" Left="588" LeftMargin="2" Mask="####-##-##&#32;##:##:##" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="13" Top="28" Type="STRING" Width="132"></MaskEdit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="REPAYTEXT" Editable="TRUE" Height="20" Id="cbxTrainingAmount" INDEX="0" InnerDataset="ds_oTrainingRepayFee" Left="203" OnChanged="cbxTrainingAmount_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="15" Top="75" UserData="S" Width="126"></Combo>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edChangeReason" ImeMode="native" Left="136" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="16" Top="100" UserData="S" Width="584"></Edit>
		<Static Align="Center" Height="20" Id="lbAttendance" Left="500" Style="sty_Label" TabOrder="17" Text="결강정보" Top="76" VAlign="Middle" Width="84"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ebAttendance" ImeMode="native" Left="588" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="18" Top="76" Width="132"></Edit>
		<Static Align="Center" Height="20" Id="lbChangeReason" Left="4" Style="sty_Label" TabOrder="14" Text="환불금액변경사유" Top="100" VAlign="Middle" Width="128"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medOtherAmount" Left="440" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="22" Top="76" Visible="FALSE" Width="56"></MaskEdit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="lbOtherAmount" ImeMode="native" Left="332" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="23" Top="76" Width="164"></Edit>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmspcledu0095SInternetJubsuRepayInfo.xml
 * 설명 : 환불정보DIV
 * 작성일 : 2009.09.14
 * 작성자 : 김동현
 */

#include "LIB::COMMON.js"; // 공통 관련

function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj);
}

/*
 * 기능 : 강습 환불/수납 수수료 정보를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchTrainingSunapRepayFee() {
    ds_oTrainingRepayFee.ClearData();

    tit_clearActionInfo();
    tit_addCsvSearchActionInfo("com:searchTrainingRepayFeeAll", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oTrainingRepayFee=ds_oTrainingRepayFee" // outDs
        ,"TJMGNO=" + quote(parent.ds_oRepay.GetColumn(0, "TJHTJMGNO"))
        ,""
        ,false
        ,false
        ,true
    );
    
    lfn_TotalAmount();

}

function cbxTrainingAmount_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
    lfn_TotalAmount();
}

function lfn_TotalAmount() {
    medAmount = toNumber(ds_oTrainingRepayFee.GetColumn(ds_oTrainingRepayFee.searchrow("CD='"+cbxTrainingAmount.Value+"'"),"REPAY"))
        + toNumber(medOtherAmount.Value);
}]]></Script>
</Window>
<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="574" Id="frmspcledu1040SInternetTrainingRepayBatchProc" Left="8" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" PidAttrib="7" Style="sty_Form" Title="인터넷강습환불일괄처리" Top="8" Ver="1.0" Width="792" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_ioRepayBundle">				<Contents>					<colinfo id="COMPANYNAME" size="8" summ="default" type="STRING"/>					<colinfo id="ONLYKEY" size="81" summ="default" type="STRING"/>					<colinfo id="PPACCOUNT" size="15" summ="default" type="STRING"/>					<colinfo id="PMAMT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PPABANKNM" size="20" summ="default" type="STRING"/>					<colinfo id="PPAOWNER" size="40" summ="default" type="STRING"/>					<colinfo id="PPAOWNER_A" size="43" summ="default" type="STRING"/>					<colinfo id="SEL" size="1" summ="default" type="STRING"/>					<colinfo id="TJADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="TJADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="TJHMGGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="TJHPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="TJHSTATUSCD" size="2" summ="default" type="STRING"/>					<colinfo id="TJHTJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJHTOHSEQREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJHTSSEQREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJPERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="TOHJUBSUNO" size="6" summ="default" type="STRING"/>					<colinfo id="TOMGGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="TOTCCOURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="PPABANKCD" size="256" summ="default" type="STRING"/>					<colinfo id="STARTJUBSUDATE" size="8" summ="default" type="STRING"/>					<colinfo id="TSGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="TJHSEQ" size="3" summ="default" type="INT"/>					<colinfo id="PMYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="15" summ="default" type="DECIMAL"/>					<colinfo id="PMINPUT" size="1" summ="default" type="STRING"/>					<colinfo id="PMPCGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="PMPCORDERNO" size="13" summ="default" type="STRING"/>					<colinfo id="PMPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="PMPIID" size="12" summ="default" type="STRING"/>					<colinfo id="PMPGMID" size="2" summ="default" type="STRING"/>					<colinfo id="PMPGMPK" size="100" summ="default" type="STRING"/>					<colinfo id="PMBUYER" size="50" summ="default" type="STRING"/>					<colinfo id="PMCLAS" size="2" summ="default" type="STRING"/>					<colinfo id="PMPGMGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="PMITEM1" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM2" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM3" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM4" size="100" summ="default" type="STRING"/>					<colinfo id="PMVAT" size="8" summ="default" type="DECIMAL"/>					<colinfo id="PMPAYMENTFLAG" size="1" summ="default" type="STRING"/>					<colinfo id="PMRESULT" size="1" summ="default" type="STRING"/>					<colinfo id="TSTJMGNO" size="13" summ="default" type="DECIMAL"/>					<colinfo id="TSSEQ" size="3" summ="default" type="INT"/>					<colinfo id="TCCOURSENM" size="100" summ="default" type="STRING"/>					<colinfo id="REPAYDAY" size="1" summ="default" type="STRING"/>					<colinfo id="REPAYAMT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="PPEXCELYN" size="1" summ="default" type="STRING"/>					<colinfo id="PCUSERTYPE" size="256" summ="default" type="STRING"/>					<colinfo id="TOYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="TOTRAININGORDER" size="3" summ="default" type="STRING"/>					<colinfo id="CHK" size="1" summ="default" type="STRING"/>					<colinfo id="TSPROCAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSTRAININGAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSEXAMAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSLICENSEAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSAMOUNTGUBUN" size="1" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJibu">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oCourse">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oIProcStatus">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD>5</CD>						<DATA>환불신청(미입금)</DATA>					</record>					<record>						<CD>6</CD>						<DATA>환불접수(신청확인)</DATA>					</record>					<record>						<CD>7</CD>						<DATA>환불완료(입금)</DATA>					</record>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioRepayBundleCopy">				<Contents>					<colinfo id="COMPANYNAME" size="8" summ="default" type="STRING"/>					<colinfo id="ONLYKEY" size="81" summ="default" type="STRING"/>					<colinfo id="PPACCOUNT" size="15" summ="default" type="STRING"/>					<colinfo id="PMAMT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PPABANKNM" size="20" summ="default" type="STRING"/>					<colinfo id="PPAOWNER" size="40" summ="default" type="STRING"/>					<colinfo id="PPAOWNER_A" size="43" summ="default" type="STRING"/>					<colinfo id="SEL" size="1" summ="default" type="STRING"/>					<colinfo id="TJADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="TJADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="TJHMGGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="TJHPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="TJHSTATUSCD" size="2" summ="default" type="STRING"/>					<colinfo id="TJHTJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJHTOHSEQREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJHTSSEQREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJPERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="TOHJUBSUNO" size="6" summ="default" type="STRING"/>					<colinfo id="TOMGGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="TOTCCOURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="PPABANKCD" size="256" summ="default" type="STRING"/>					<colinfo id="STARTJUBSUDATE" size="8" summ="default" type="STRING"/>					<colinfo id="TSGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="TJHSEQ" size="3" summ="default" type="INT"/>					<colinfo id="PMYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="15" summ="default" type="DECIMAL"/>					<colinfo id="PMINPUT" size="1" summ="default" type="STRING"/>					<colinfo id="PMPCGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="PMPCORDERNO" size="13" summ="default" type="STRING"/>					<colinfo id="PMPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="PMPIID" size="12" summ="default" type="STRING"/>					<colinfo id="PMPGMID" size="2" summ="default" type="STRING"/>					<colinfo id="PMPGMPK" size="100" summ="default" type="STRING"/>					<colinfo id="PMBUYER" size="50" summ="default" type="STRING"/>					<colinfo id="PMCLAS" size="2" summ="default" type="STRING"/>					<colinfo id="PMPGMGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="PMITEM1" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM2" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM3" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM4" size="100" summ="default" type="STRING"/>					<colinfo id="PMVAT" size="8" summ="default" type="DECIMAL"/>					<colinfo id="PMPAYMENTFLAG" size="1" summ="default" type="STRING"/>					<colinfo id="PMRESULT" size="1" summ="default" type="STRING"/>					<colinfo id="TSTJMGNO" size="13" summ="default" type="DECIMAL"/>					<colinfo id="TSSEQ" size="3" summ="default" type="INT"/>					<colinfo id="TCCOURSENM" size="100" summ="default" type="STRING"/>					<colinfo id="REPAYDAY" size="1" summ="default" type="STRING"/>					<colinfo id="REPAYAMT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="PPEXCELYN" size="1" summ="default" type="STRING"/>					<colinfo id="PCUSERTYPE" size="256" summ="default" type="STRING"/>					<colinfo id="TOYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="TOTRAININGORDER" size="3" summ="default" type="STRING"/>					<colinfo id="CHK" size="1" summ="default" type="STRING"/>					<colinfo id="TSPROCAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSTRAININGAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSEXAMAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSLICENSEAMOUNT" size="9" summ="default" type="DECIMAL"/>					<colinfo id="TSAMOUNTGUBUN" size="1" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_iExcelLoad">				<Contents>					<colinfo id="COL01" size="256" summ="default" type="STRING"/>					<colinfo id="COL02" size="256" summ="default" type="STRING"/>					<colinfo id="COL03" size="256" summ="default" type="STRING"/>					<colinfo id="COL04" size="256" summ="default" type="STRING"/>					<colinfo id="COL05" size="256" summ="default" type="STRING"/>					<colinfo id="COL06" size="256" summ="default" type="STRING"/>					<colinfo id="COL07" size="256" summ="default" type="STRING"/>					<colinfo id="COL08" size="256" summ="default" type="STRING"/>					<colinfo id="COL09" size="256" summ="default" type="STRING"/>					<colinfo id="COL10" size="256" summ="default" type="STRING"/>					<colinfo id="COL11" size="256" summ="default" type="STRING"/>					<colinfo id="COL12" size="256" summ="default" type="STRING"/>					<colinfo id="COL13" size="256" summ="default" type="STRING"/>					<colinfo id="COL14" size="256" summ="default" type="STRING"/>					<colinfo id="COL15" size="256" summ="default" type="STRING"/>					<colinfo id="COL16" size="256" summ="default" type="STRING"/>					<colinfo id="COL17" size="256" summ="default" type="STRING"/>					<colinfo id="COL18" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioReport"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioReportFilter"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioPosData">				<Contents>					<colinfo id="PMYEAR" size="255" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="15" summ="default" type="DECIMAL"/>					<colinfo id="TSTJMGNO" size="13" summ="default" type="DECIMAL"/>					<colinfo id="TSSEQ" size="3" summ="default" type="INT"/>					<colinfo id="TSSUNAPACTIONREF" size="255" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioReportEnd"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioPosDataEnd">				<Contents>					<colinfo id="PMYEAR" size="255" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="15" summ="default" type="DECIMAL"/>					<colinfo id="TSTJMGNO" size="13" summ="default" type="DECIMAL"/>					<colinfo id="TSSEQ" size="3" summ="default" type="INT"/>					<colinfo id="TSSUNAPACTIONREF" size="255" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioPosDataFilter">				<Contents>					<colinfo id="PMYEAR" size="255" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="15" summ="default" type="DECIMAL"/>					<colinfo id="TSTJMGNO" size="13" summ="default" type="DECIMAL"/>					<colinfo id="TSSEQ" size="3" summ="default" type="INT"/>					<colinfo id="TSSUNAPACTIONREF" size="255" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oInternetReport">				<Contents></Contents>			</Dataset>		</Datasets>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="347" LineColor="user14" Right="788" TabOrder="61" Top="1" Type="Rectangle" Width="441"></Shape>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioRepayBundle" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="568" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="456" Id="gdRepay" InputPanel="FALSE" Left="4" LineColor="default" OnHeadClick="gdRepay_OnHeadClick" Right="788" RowHeight="20" Style="sty_Grid" TabOrder="15" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UserData="인터넷강습일괄환불목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">			<contents>				<format id="Default">					<columns>						<col fix="left" width="30"/>						<col width="80"/>						<col width="60"/>						<col width="130"/>						<col width="60"/>						<col width="80"/>						<col width="80"/>						<col width="130"/>						<col width="80"/>						<col width="80"/>						<col width="180"/>						<col width="180"/>					</columns>					<head>						<cell align="center" col="0" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" display="text" text="지부"/>						<cell col="2" display="text" text="년도"/>						<cell align="center" col="3" display="text" text="직능"/>						<cell col="4" display="text" text="회차"/>						<cell align="center" col="5" display="text" text="접수번호"/>						<cell align="center" col="6" display="text" text="성명"/>						<cell align="center" col="7" display="text" text="접수상태"/>						<cell align="center" col="8" display="text" text="신청일"/>						<cell align="center" col="9" display="text" text="완료일"/>						<cell align="center" col="10" display="text" text="주소1"/>						<cell align="center" col="11" display="text" text="주소2"/>					</head>					<body>						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" colid="TOMGGTMGNO" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>						<cell align="center" col="2" colid="TOYEAR" display="text"/>						<cell align="center" col="3" colid="TOTCCOURSECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>						<cell align="center" col="4" colid="TOTRAININGORDER" display="text"/>						<cell align="center" col="5" colid="TOHJUBSUNO" display="text"/>						<cell align="center" col="6" colid="TJPERSONNM" display="text"/>						<cell align="center" col="7" colid="TJHSTATUSCD" combocol="CD" combodataset="ds_oIProcStatus" combotext="DATA" display="combo"/>						<cell align="center" col="8" colid="STARTJUBSUDATE" display="text" Mask="####-##-##"/>						<cell align="center" col="9" colid="TJHPROCDATE" display="text" Mask="####-##-##"/>						<cell align="left" col="10" colid="TJADDR1" display="text"/>						<cell align="left" col="11" colid="TJADDR2" display="text"/>					</body>				</format>				<format id="Default2">					<columns>						<col fix="left" width="30"/>						<col width="80"/>						<col width="60"/>						<col width="130"/>						<col width="60"/>						<col width="80"/>						<col width="80"/>						<col width="130"/>						<col width="80"/>						<col width="80"/>						<col width="80"/>						<col width="180"/>						<col width="180"/>					</columns>					<head>						<cell align="center" col="0" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" display="text" text="지부"/>						<cell col="2" display="text" text="년도"/>						<cell align="center" col="3" display="text" text="직능"/>						<cell col="4" display="text" text="회차"/>						<cell align="center" col="5" display="text" text="접수번호"/>						<cell align="center" col="6" display="text" text="성명"/>						<cell align="center" col="7" display="text" text="접수상태"/>						<cell col="8" display="text" text="엑셀생성"/>						<cell align="center" col="9" display="text" text="신청일"/>						<cell align="center" col="10" display="text" text="완료일"/>						<cell align="center" col="11" display="text" text="주소1"/>						<cell align="center" col="12" display="text" text="주소2"/>					</head>					<body>						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" colid="TOMGGTMGNO" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>						<cell align="center" col="2" colid="TOYEAR" display="text"/>						<cell align="center" col="3" colid="TOTCCOURSECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>						<cell align="center" col="4" colid="TOTRAININGORDER" display="text"/>						<cell align="center" col="5" colid="TOHJUBSUNO" display="text"/>						<cell align="center" col="6" colid="TJPERSONNM" display="text"/>						<cell align="center" col="7" colid="TJHSTATUSCD" combocol="CD" combodataset="ds_oIProcStatus" combotext="DATA" display="combo"/>						<cell align="center" col="8" colid="PPEXCELYN" display="text"/>						<cell align="center" col="9" colid="STARTJUBSUDATE" display="text" Mask="####-##-##"/>						<cell align="center" col="10" colid="TJHPROCDATE" display="text" Mask="####-##-##"/>						<cell align="left" col="11" colid="TJADDR1" display="text"/>						<cell align="left" col="12" colid="TJADDR2" display="text"/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="714" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="14" Top="88" Transparent="TRUE" Width="74"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="437" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="2" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="525" OnClick="lfn_Excel" Style="sty_Button" TabOrder="3" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="612" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="4" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="699" OnClick="lfn_End" Style="sty_Button" TabOrder="5" ToolTipText="닫기" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="350" OnClick="lfn_Search" Style="sty_Button" TabOrder="1" ToolTipText="조회" Top="4" Width="85"></Button>		<Shape Bottom="84" Height="52" Id="shpGubunBox" Left="4" LineColor="user15" Right="788" TabOrder="23" Top="32" Type="Rectangle" Width="784"></Shape>		<Static Align="Center" Height="20" Id="lbCourse" Left="256" Style="sty_Label" TabOrder="17" Text="직능" Top="36" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxCourse" INDEX="0" InnerDataset="ds_oCourse" Left="347" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="7" Top="35" UserData="S" Width="152"></Combo>		<Static Align="Center" Height="20" Id="lbReIssueDate" Left="256" Style="sty_Label" TabOrder="19" Text="접수일자" Top="60" UserData="S" VAlign="Middle" Width="88"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calReIssueDateEnd" Left="472" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="10" Top="60" WeeksFont="돋음,9" Width="98"></Calendar>		<Static Align="Center" Height="20" Id="lbDateWave" Left="454" Style="sty_Text" TabOrder="22" Text="~" Top="60" VAlign="Middle" Width="10"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calReIssueDateStart" Left="348" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="9" Top="60" WeeksFont="돋음,9" Width="98"></Calendar>		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="16" Text="지부" Top="36" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="6" Top="35" UserData="S" Width="152"></Combo>		<Static Align="Center" Height="20" Id="lbIProcStatus" Left="8" Style="sty_Label" TabOrder="18" Text="접수상태" Top="61" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxIProcStatus" INDEX="0" InnerDataset="ds_oIProcStatus" Left="99" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="59" UserData="S:접수상태" Width="152"></Combo>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnMakeRepayFile" ImageID="BTN_TEXT_15" Left="575" OnClick="lfn_Export" Style="sty_Button" TabOrder="12" Text="일괄환불용&#32;엑셀파일&#32;생성" Top="35" Visible="FALSE" Width="209"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPatchRepay" ImageID="BTN_TEXT_15" Left="575" OnClick="lfn_Check" Style="sty_Button" TabOrder="13" Text="송금후&#32;일괄환불처리&#32;(엑셀로딩)" Top="59" Visible="FALSE" Width="209"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsu" ImageID="BTN_TEXT_15" Left="575" OnClick="lfn_Save" Style="sty_Button" TabOrder="11" Text="환불접수" Top="35" Visible="FALSE" Width="209"></Button>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioRepayBundleCopy" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="610" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="20" Id="grdExport" InputPanel="FALSE" LineColor="default" Right="20" RowHeight="20" Style="sty_Grid" TabOrder="24" TabStop="true" Top="590" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="20">			<contents>				<format id="Default">					<columns>						<col width="88"/>						<col width="176"/>						<col width="106"/>						<col width="109"/>						<col width="142"/>						<col width="165"/>						<col width="118"/>						<col width="100"/>						<col width="177"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="입금은행"/>						<cell align="center" col="1" display="text" text="입금계좌"/>						<cell align="center" col="2" display="text" text="입금인성명"/>						<cell align="center" col="3" display="text" text="입금액"/>						<cell align="center" col="4" display="text" text="출금통장표시"/>						<cell align="center" col="5" display="text" text="입금통장표시"/>						<cell align="center" col="6" display="text" text="입금인코드"/>						<cell align="center" col="7" display="text" text="비고"/>						<cell align="center" col="8" display="text" text="업체사용key"/>					</head>					<body>						<cell align="center" col="0" colid="PPABANKCD" display="normal" edit="normal"/>						<cell align="center" col="1" colid="PPACCOUNT" display="text"/>						<cell align="center" col="2" display="text"/>						<cell align="center" col="3" colid="REPAYAMT" display="number" expr="ABS(REPAYAMT)+TSEXAMAMOUNT+TSLICENSEAMOUNT"/>						<cell align="center" col="4" colid="PPAOWNER_A" display="text"/>						<cell align="center" col="5" colid="COMPANYNAME" display="text"/>						<cell align="center" col="6" display="text" Mask="####-##-##"/>						<cell align="center" col="7" display="text" Mask="####-##-##"/>						<cell align="center" col="8" colid="ONLYKEY" display="text"/>					</body>				</format>				<format id="Default2">					<columns>						<col width="29"/>						<col width="65"/>						<col width="71"/>						<col width="84"/>						<col width="85"/>						<col width="92"/>						<col width="84"/>						<col width="92"/>						<col width="81"/>						<col width="141"/>						<col width="119"/>					</columns>					<head>						<cell align="center" col="0" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" display="text" text="지부"/>						<cell align="center" col="2" display="text" text="상태"/>						<cell align="center" col="3" display="text" text="직능"/>						<cell align="center" col="4" display="text" text="신청번호"/>						<cell align="center" col="5" display="text" text="성명"/>						<cell align="center" col="6" display="text" text="신청일"/>						<cell align="center" col="7" display="text" text="신청완료일"/>						<cell align="center" col="8" display="text" text="신청상태"/>						<cell align="center" col="9" display="text" text="주소1"/>						<cell align="center" col="10" display="text" text="주소2"/>					</head>					<body>						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" colid="TOMGGTMGNO" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>						<cell align="center" col="2" colid="TJHSTATUSCD" combocol="CD" combodataset="ds_oIProcStatus" combotext="DATA" display="combo"/>						<cell align="center" col="3" colid="TOTCCOURSECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>						<cell align="center" col="4" colid="TOHJUBSUNO" display="text"/>						<cell align="center" col="5" colid="TJPERSONNM" display="text"/>						<cell align="center" col="6" display="text"/>						<cell align="center" col="7" colid="TJHPROCDATE" display="text" Mask="####-##-##"/>						<cell align="center" col="8" display="text"/>						<cell align="left" col="9" colid="TJADDR1" display="text"/>						<cell align="left" col="10" colid="TJADDR2" display="text"/>					</body>				</format>			</contents>		</Grid>		<FileDialog Bottom="614" Filter="Excel&#32;File(*.xls)|*.xls|All(*.*)|*.*|" Height="24" Id="fdImport" Left="24" Right="48" TabOrder="26" Top="590" Width="24"></FileDialog>		<Div BKColor="user0" Height="24" Id="divPos" Left="660" OnLoadCompleted="Form_OnLoadCompleted" OnTimer="frmCOM3010SPOS_OnTimer" OnUnloadCompleted="frmCOM3010SPOS_OnUnloadCompleted" Style="sty_Form" TabOrder="25" TabStop="FALSE" Text="Div0" Top="590" Url="COM::frmCOM3010SPOS.xml" Visible="FALSE" Width="128">			<Contents></Contents>		</Div>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnReportBatch" ImageID="BTN_TEXT_08" Left="227" OnClick="btnReportBatch_OnClick" Style="sty_Button" TabOrder="26" Text="환불신청서출력" Top="4" Transparent="TRUE" Width="118"></Button>		<Image Height="10" Id="imgImage" ImageID="IMG_BULLET" Left="8" Style="sty_Image" TabOrder="27" Top="9" Transparent="TRUE" Width="12"></Image>		<Static Font="굴림,12,Bold" Height="20" Id="lbWorkFormTitle" Left="28" TabOrder="21" Text="인터넷강습환불일괄처리" Top="4" VAlign="Middle" Width="272"></Static>		<Static Align="Center" Height="20" Id="lbTotalCnt" Left="4" Style="sty_LabelStat" TabOrder="29" Text="전체건수" Top="88" VAlign="Middle" Width="88"></Static>		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioResult" Border="Flat" Enable="FALSE" Height="20" Id="medTotalCnt" Left="96" OnChanged="medJubsuCnt_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="28" Top="88" Width="88"></MaskEdit>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu1040SInternetTrainingRepayBatchProc.xml * 설명 : 인터넷강습환불일괄처리 * 작성일 : 2009.09.23 * 작성자 : 이창희 */#include "LIB::training.js"; // 공통업무 관련var ls_ResultMsg = ""; // 결과메시지var ln_Cnt = 0; // 처리횟수/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {	tit_createActionInfo(); // X-Framework용        gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정        lfn_SetFormAuth(true); // 저장 권한    } else if (ms_FormAuth == "R") {        lfn_SetFormAuth(false); // 읽기 권한    } else {        gfn_Alert(MSGI00080);        close();    }        // 공통 코드 조회    gfn_SearchJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회    gfn_SearchTrainingCourse("T", ds_oCourse, "Y", "전체"); // 직능 코드 조회    cbxCourse.Value = "60";	// gfn_SearchCommonCode(ds_oIProcStatus, "JUBSUSTAT", "Y", "전체"); // 접수상태 조회    cbxIProcStatus.Index = 0;    // calReIssueDateStart.Value = left(toString(AddMonth(GetDate(), -1)), 6) + "01";    calReIssueDateStart.Value = left(AddDate(GetDate(), -7), 8);    calReIssueDateEnd.Value = left(GetDate(), 8);        gdRepay.AutoScrollBar = "Both"; // ScrollBar를 자동으로 표시    for (var i=0; i<1000; i++) idle(); // 화면 로딩을 위한 delay용    Form_OnSize(this, 792, 560, ""); // Form의 크기가 변경}function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    // to do    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리}function Form_OnSize(obj,nCx,nCy,nState) {    if (gs_IsResizingForm == "Y") {        gdRepay.Height = nCy - gdRepay.Top - 4;        gdRepay.Width = nCx - gdRepay.Left - 4;    }}/* * 기능 : 조회 */function lfn_Search(obj) {    if (cbxIProcStatus.Value == "5") {        gdRepay.Format = "Default";        btnJubsu.Visible = true;        // 환불접수버튼        btnPatchRepay.Visible = false;        btnMakeRepayFile.Visible = false;    } else if (cbxIProcStatus.Value == "6") {        gdRepay.Format = "Default2";        btnJubsu.Visible = false;        // 환불접수버튼        btnPatchRepay.Visible = true;        btnMakeRepayFile.Visible = true;    } else {        gdRepay.Format = "Default";        btnJubsu.Visible = false;        // 환불접수버튼        btnPatchRepay.Visible = false;        btnMakeRepayFile.Visible = false;    }    		ds_ioRepayBundle.ClearData(); // 데이타셋 초기화	tit_clearActionInfo();		if (cbxIProcStatus.Value == "5" || cbxIProcStatus.Value == "6") {        tit_addSearchActionInfo("spcledu:searchTrainingRepayBatch", false);        // 서버 호출 		tit_callService(			""			,""			,""	// inDs			,"ds_ioRepayBundle=ds_oRepayBundle"	// outDs			,"TOMGGTMGNO=" + quote(cbxJibu.value)   //-- 지부				+" TOTCCOURSECD=" + quote(cbxCourse.value)  //-- 직능				+" TJHSTATUSCD=" + quote(cbxIProcStatus.value) // -- 신청상태					+" TJHPROCDATE=" + quote(calReIssueDateStart.value) // -- 처리날짜1				+" TJHPROCDATE2=" + quote(calReIssueDateEnd.value) // -- 처리날짜2  // args 			,"lfn_AfterSearchRepay"			,false			,false			,true		);	} else {		tit_addSearchActionInfo("spcledu:searchTrainingRepayBatchEnd", false);		// 서버 호출 		tit_callService(			""			,""			,""	// inDs			,"ds_ioRepayBundle=ds_oRepayBundle"	// outDs			,"TOMGGTMGNO=" + quote(cbxJibu.value)   //-- 지부				+" TOTCCOURSECD=" + quote(cbxCourse.value)  //-- 직능				+" TJHSTATUSCD=" + quote(cbxIProcStatus.value) // -- 신청상태					+" TJHPROCDATE=" + quote(calReIssueDateStart.value) // -- 처리날짜1				+" TJHPROCDATE2=" + quote(calReIssueDateEnd.value) // -- 처리날짜2  // args 			,"lfn_AfterSearchRepay"			,false			,false			,true		);	}}/* * 기능 : 저장 (환불접수버튼) */function lfn_Save() {	//선택여부체크	if (ds_ioRepayBundle.FindRow("SEL", "1") < 0) {		gfn_alert("선택한 인원이 없습니다.");		return;    }        if (!Confirm("선택한 인원에 대해 접수하시겠습니까?")) {		return;    }        tit_clearActionInfo();    tit_addMultiActionInfo("spcledu:insertTrainingRepayBatch", "", 0, "", "N");    // 서버 호출     tit_callService(        ""        ,""        ,"ds_iRepayBundle=ds_ioRepayBundle:U" // inDs		        ,""	// outDs        ,"PDEPTCD=" + gds_oUserInfo.GetColumn(0, "PDEPTCD") // -- 지부            +" PSABUN=" + gds_oUserInfo.GetColumn(0, "PSABUN") // -- 사번 // args         ,"lfn_AfterSaveRepay"        ,false        ,false		,true    );  }/* * 기능 : 엑셀로딩정보를 비교하여 결제 및 이력처리한다. */function lfn_Check() {	fdImport.Type = "OPEN";    fdImport.Filter = "Excel(.xls)|*.xls|";    var result = fdImport.Open("C:\\");        if (result) {        if (!Confirm("송금후 일괄환불처리 (엑셀로딩)을 적용하시겠습니까?")) {			return;		}                var ls_FilePath = fdImport.FilePath + '\\' + fdImport.FileName;        ds_iExcelLoad.ClearData();        ext_ExcelImportByIndex(ls_FilePath, 0,"ds_iExcelLoad");        ds_iExcelLoad.DeleteRow(0); //첫번째로우 삭제    } else {        return;    }    //ext_ExcelImportByIndex("C:\\강습_recv_sample.xls", 0, "ds_iExcelLoad");    //for (i=0; i<ds_iExcelLoad.GetCount();i++) {	    //alert(ds_iExcelLoad.GetColumn(i, "COL17"));    //}	     for (i = 0; i < ds_ioRepayBundle.GetRowCount(); i++) {             for(j = 0; j < ds_iExcelLoad.GetRowCount(); j++) {                   if (ds_ioRepayBundle.GetColumn(i, "ONLYKEY") == ds_iExcelLoad.GetColumn(j, "COL17")) {                              ds_ioRepayBundle.SetColumn(i, "CHK", "1");  // 데이터셋 값을 변경한다. 트랜잭션 일으키기 위함                 }        }                }          ds_ioReport.Copy(ds_ioRepayBundle);  // 1) 원본 복사               ds_ioReport.Filter("CHK = '1'"); // 2) 복사 후 필터함             ds_ioReportFilter.CopyF(ds_ioReport);  // 3) 필터한 값을 실제 사용 위해 다른 곳에 복사         ds_ioReport.ClearData(); // 4) 데이타셋 초기화        //비교대상의 데이터셋을 걸러 주기 위해 작동함     for (i = 0; i < ds_ioReportFilter.GetRowCount(); i++) {        if (ds_ioReportFilter.GetColumn(i, "CHK") == "1") {                       ds_ioReportFilter.SetColumn(i, "CHK", "0");                   }     }                          if (ds_ioReportFilter.GetRowCount() == 0) {  //비교할 데이터 셋이 없으면 작동하지 않는다.                gfn_alert("일괄환불 처리 대상자를 다시 조회하세요.");                return;    }        //Http.Sync = true; // 동기화 시작    ls_ResultMsg = ""; // 결과메시지 초기화    ln_Cnt = 0; // 에러횟수 초기화        // 일치하면 결재추가, 접수결재번호업데이트, 이력 추가, 접수이력번호 업데이트    tit_clearActionInfo();    tit_addMultiActionInfo("spcledu:insertTrainingRepayBatchEnd", "", 0, "", "N");    // 서버 호출     tit_callService(        ""        ,""        ,"ds_iRepayBundle=ds_ioReportFilter:U"// inDs		        ,""	// outDs        ,"PDEPTCD=" + gds_oUserInfo.GetColumn(0, "PDEPTCD") // -- 지부            +" PSABUN=" + gds_oUserInfo.GetColumn(0, "PSABUN") // -- 사번               // args         ,"lfn_AfterCheckRepay"        ,false        ,false        ,true    );}/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchRepay(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SearchMessage(gdRepay); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.    gdRepay.SetCellProp("head", 0, "text", 0); // 체크박스 초기화    medTotalCnt.Value = ds_ioRepayBundle.GetRowCount(); // 전체건수        gdRepay.AutoScrollBar = "Both"; // ScrollBar를 자동으로 표시    for (var i=0; i<1000; i++) idle(); // 화면 로딩을 위한 delay용    Form_OnSize(this, 792, 560, ""); // Form의 크기가 변경}/* * 기능 : 접수 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSaveRepay(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SaveMessage(); // 저장 메세지를 처리한다.    lfn_Search(); // 조회    gdRepay.SetCellProp("head", 0, "text", 0); // 체크박스 초기화}/* * 기능 : 환불 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterCheckRepay(nErrorCode, strErrorMsg) {	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }        ds_ioReportEnd.ClearData();    ds_ioReportEnd.Copy(ds_ioReportFilter); // 데이터셋복사        // 현금영수증일 경우 데이콤 처리    for (k = 0; k < ds_ioReportFilter.GetRowCount(); k++) {        //현금영수증이 아닐때 삭제후 처리함        if (ds_ioReportFilter.GetColumn(k, "PMPGMGUBUN") <> "22" && ds_ioReportFilter.GetColumn(k, "PMPGMGUBUN") <> "25") {             ds_ioReportEnd.DeleteRow(ds_ioReportEnd.FindRow("ONLYKEY", ds_ioReportFilter.GetColumn(k, "ONLYKEY")));        }            }        if (ds_ioReportEnd.GetRowCount() > 0) {		for (i = 0; i < ds_ioReportEnd.GetRowCount(); i++) {			ds_ioPosData.ClearData();			tit_clearActionInfo();			tit_addSearchActionInfo("spcledu:searchTrainingRepayBatchPos", false);			// 서버 호출 			tit_callService(				""				,""				,""	// inDs				,"ds_ioPosData=ds_oPosData"	// outDs				,"TJHTJMGNO=" + quote(ds_ioReportEnd.GetColumn(i, "TJHTJMGNO"))   // args 				,""				,false				,false				,true			);						// 포스관련 조회 후 작업			var ls_PosResult = ""; // POS처리결과			var ls_RtnValue = "T";						ds_ioPosDataFilter.ClearData();			ds_ioPosDataEnd.ClearData();			ds_ioPosDataFilter.Copy(ds_ioPosData);			ds_ioPosDataFilter.Filter("TSSUNAPACTIONREF = '0'");			ds_ioPosDataEnd.CopyF(ds_ioPosDataFilter);						for (j = 0; j < ds_ioPosData.GetRowCount(); j++) {								if (ds_ioPosData.GetColumn(j, "TSSUNAPACTIONREF") <> "0") { // 수납이 아닐때					ls_PosResult = lfn_PosProc(ds_ioPosData.GetColumn(j, "PMYEAR"), ds_ioPosData.GetColumn(j, "PMMGNO"));					// 테스트					// if (ds_ioPosData.GetColumn(j, "TSTJMGNO") == "10000035") {						// ls_PosResult = "3";					// } else if (ds_ioPosData.GetColumn(j, "TSTJMGNO") == "10000036") {						// ls_PosResult = "0"; 					// } else {						// ls_PosResult = "0"; 					// }										if (ls_PosResult <> "0") { // 성공이 아니면												tit_clearActionInfo();						tit_addMultiActionInfo("spcledu:deleteTrainingRepayBatchPos", "", 0, "", "N");						// 서버 호출 						tit_callService(							""							,""							,"ds_iPosData=ds_ioPosData:A"	// inDs							,""	// outDs							,"" // args 							,""							,false							,false							,true						);												var ls_CompValue = "지부:" + gdRepay.GetCellText("body", ds_ioRepayBundle.FindRow("TSTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), 1) 											+ "/년도:" + gdRepay.GetCellText("body", ds_ioRepayBundle.FindRow("TSTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), 2) 											+ "/직능:" + gdRepay.GetCellText("body", ds_ioRepayBundle.FindRow("TSTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), 3) 											+ "/회차:" + gdRepay.GetCellText("body", ds_ioRepayBundle.FindRow("TSTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), 4) 											+ "/접수번호:" + gdRepay.GetCellText("body", ds_ioRepayBundle.FindRow("TSTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), 5) 											+ "/성명:" + gdRepay.GetCellText("body", ds_ioRepayBundle.FindRow("TSTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), 6) 											+ "    " + "\r\n"; 																	if (IndexOf(ls_ResultMsg, ls_CompValue) < 0) {							ln_Cnt++; // 에러횟수증가							//ls_ResultMsg += "강습접수관리번호 : " + ds_ioPosData.GetColumn(j, "TSTJMGNO") + "\r\n"; 							ls_ResultMsg += ls_CompValue;							ds_ioReportFilter.SetColumn(ds_ioReportFilter.FindRow("TJHTJMGNO", ds_ioPosData.GetColumn(j, "TSTJMGNO")), "CHK", "1");						}					}				} 				}						tit_clearActionInfo();			tit_addMultiActionInfo("spcledu:updateTrainingRepayBatchPos", "", 0, "", "N");			// 서버 호출 			tit_callService(				""				,""				,"ds_iPosData=ds_ioPosDataEnd:A"	// inDs				,""	// outDs				,""	// args 				,""				,false				,false				,true			);		}				if (length(ls_ResultMsg) > 0 && ds_ioReportEnd.GetRowCount() == i) {			//gfn_alert(ls_ResultMsg + "\r\n" + "일괄환불 처리시 " + ln_Cnt + "건이 실패했습니다. 위의 자료를 다시 환불 처리하세요.");			lfn_ResultPopUp(); // 처리결과 팝업을 처리한다.		} else {			//gfn_SaveMessage(); // 저장 메세지를 처리한다.			lfn_ResultPopUp(); // 처리결과 팝업을 처리한다.		}		    } else {		//gfn_SaveMessage(); // 저장 메세지를 처리한다.		lfn_ResultPopUp(); // 처리결과 팝업을 처리한다.    }        lfn_Search(); // 조회	gdRepay.SetCellProp("head", 0, "text", 0); // 체크박스 초기화	//Http.Sync = false;  // 동기화 종료}/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterUpdateRepay(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }        grdExport.ExportExcelEx("sheet1");	//grdExport.SaveExcelEx("C:\\강습_send_sample.xls", "sheet1");    lfn_Search(); // 조회    gdRepay.SetCellProp("head", 0, "text", 0); // 체크박스 초기화}/* * 기능 : 버튼 활성/비활성시킨다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetFormAuth(bStatus) {    btnMakeRepayFile.Enable = bStatus;    btnPatchRepay.Enable = bStatus;    gdRepay.Editable = bStatus;}/* 사용자 이벤트 함수 */function btnMutilSort_OnClick(obj) {	gfn_GridMultiSort(gdRepay, 1); // 멀티 정렬을 실행한다.}function gdRepay_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {    var lobj_Dataset = object(obj.BindDataset);	if (nCell == 0) { // 선택        if (obj.GetCellProp("head", nCell, "text") == 1) { // 전체가 이미 선택된 경우            obj.SetCellProp("head", nCell, "text", 0);            for (i = 0; i < lobj_Dataset.RowCount(); i++) {                lobj_Dataset.SetColumn(i, "SEL", "0");            }        } else { // 전체가 이미 선택되지 않은 경우            obj.SetCellProp("head", nCell, "text", 1);            for (i = 0; i < lobj_Dataset.RowCount(); i++) {                lobj_Dataset.SetColumn(i, "SEL", "1");            }        }	} else { // 헤드 정렬        lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex);	}}/* 엑셀 이벤트 함수 *//*================================================================ 기능 : Excel File Export===============================================================*/function lfn_Export(obj) {	// 선택여부 체크    if (ds_ioRepayBundle.FindRow("SEL", "1") < 0) {		gfn_alert("선택한 인원이 없습니다.");		return;    }    	if (!Confirm("선택한 인원에 대해 엑셀로 변환하시겠습니까?")) {		return;    }        ds_ioRepayBundleCopy.Copy(ds_ioRepayBundle);        for (i=0;i<ds_ioRepayBundleCopy.GetCount();i++) {        if (ds_ioRepayBundleCopy.GetColumn(i, "SEL") == 0) {            ds_ioRepayBundleCopy.DeleteRow(i);        }    }        // 인터넷환불계좌 일괄처리엑셀다운로드여부 수정	tit_clearActionInfo();	tit_addMultiActionInfo("spcledu:updatePosPayAccountExcelYn", "", 0, "", "N");    // 서버 호출     tit_callService(        ""        ,""        ,"ds_iPosPayAccount=ds_ioRepayBundleCopy:N"	// inDs        ,""	// outDs        ,""	// args         ,"lfn_AfterUpdateRepay"        ,false        ,false        ,true    );}/* POS 결과 코드 - ls_PosResultCode    MI_RSCODE - ○:성공, Ⅹ:실패    LGD   DB   코드    ○    ○    0    ○    Ⅹ    1    Ⅹ    ○    2    Ⅹ    Ⅹ    3    無    無    4    초기입력    ?     ?     5    알수없음*//* * POS처리 */function lfn_PosProc(sYear, sMgno) {        divPos.ds_ioPosInput.ClearData();    divPos.ds_ioPosInput.InsertRow(0);    divPos.ds_ioPosInput.SetColumn(0, "PMYEAR", sYear);    divPos.ds_ioPosInput.SetColumn(0, "PMMGNO", sMgno);    divPos.ds_ioPosInput.SetColumn(0, "STATUS", "4");                    var sArg = "";    var ls_PosResultCode = ""; // POS 결과코드    //var ls_RetPos = Dialog("COM::frmCOM3001PPOSProgressBar.xml", sArg, 300, 123, "TitleBar=false", -1, -1);	divPos.ds_ioPosOutput.ClearData();	var ls_RetPos = divPos.lfn_POS(); // POS 호출	    if (ls_RetPos == "OK") {        ls_ResultPrintPosMsg = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSMSG"); // 결과메세지        ls_PosResultCode = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSCODE"); // 결과코드    } else if (ls_RetPos == "FAIL"){ // 실패        ls_ResultPrintPosMsg = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSMSG"); // 결과메세지        if ("OK" == divPos.lfn_POSSearch()) { // 실시간 POS 결과를 조회한다.            ls_PosResultCode = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSCODE"); // 결과코드        } else {            ls_PosResultCode = "5"; // 결과코드        }    } else { // 10초 이후(실패)        ls_ResultPrintPosMsg = "10초 - 시간 초과입니다.";        if ("OK" == divPos.lfn_POSSearch()) { // 실시간 POS 결과를 조회한다.            ls_PosResultCode = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSCODE"); // 결과코드        } else {            ls_PosResultCode = "5"; // 결과코드        }    }		return ls_PosResultCode;}/* * 기능 : 처리결과 팝업창 호출 */function lfn_ResultPopUp() {	var sArg = "iTotalCnt=" + quote(ds_ioReportFilter.GetRowCount())        + " iFailCnt=" + quote(ln_Cnt);            Dialog("spcledu::frmspcledu1041PInternetTrainingRepayBatchProcResult.xml", sArg, 800, 400, "", -1, -1);}/* * 기능 : 종료 */function lfn_End(obj) {    Close();}/* * 기능 : 환불신청서 일괄출력 */function btnReportBatch_OnClick(obj) {    // 선택여부체크	if (ds_ioRepayBundle.FindRow("SEL", "1") < 0) {		gfn_alert("선택한 인원이 없습니다.");		return;    }        if (!Confirm("선택한 인원에 대해 출력하시겠습니까?")) {		return;    }        var ls_RexFile = "";    ds_oInternetReport.ClearData();        tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchTrainingRepayBatchReport", false);    tit_callService(        ""        ,""        ,"ds_iPosData=ds_ioRepayBundle:U" // inDs        ,"ds_oInternetReport=ds_oPosData"	// outDs        ,"" // args        ,"lfn_AfterReportRepay"        ,false        ,false        ,true    );        ls_RexFile = "frmspcledu1040R01TrainingRepayBatch.rex";    gfn_CallReportPopup(ls_RexFile        , "ds_oInternetReport"        , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"        , true    );}/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterReportRepay(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }        lfn_Search(); // 조회    gdRepay.SetCellProp("head", 0, "text", 0); // 체크박스 초기화}]]></Script></Window>
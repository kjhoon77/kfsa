<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="400" Id="frmspcledu0023PTrainingSeatNoList" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="강습좌석검색팝업" Top="8" Ver="1.0" Width="688" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_oTrainingSeatNo">				<Contents></Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oPassYn">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD></CD>						<DATA>&#32;</DATA>					</record>					<record>						<CD>Y</CD>						<DATA>수료</DATA>					</record>					<record>						<CD>N</CD>						<DATA>미수료</DATA>					</record>				</Contents>			</Dataset>		</Datasets>		<Shape Bottom="53" Height="52" Id="shpBtnBox" Left="420" LineColor="user14" Right="685" TabOrder="61" Top="1" Type="Rectangle" Width="265"></Shape>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSelect" ImageID="BTN_TEXT_COM" Left="510" OnClick="btnSelect_OnClick" Style="sty_Button" TabOrder="2" Text="선택" ToolTipText="선택" Top="4" Transparent="TRUE" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="BTN_MULTI_SORT" Left="608" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="4" Top="32" Transparent="TRUE" Width="74"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="423" OnClick="lfn_Search" Style="sty_Button" TabOrder="1" ToolTipText="조회" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="597" OnClick="lfn_End" Style="sty_Button" TabOrder="3" ToolTipText="닫기" Top="4" Width="85"></Button>		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oTrainingSeatNo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="400" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="344" Id="gdTrainingSeatNo" InputPanel="FALSE" LineColor="default" MinWidth="100" OnCellDBLClick="gdTrainingSeatNo_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="684" RowHeight="20" Style="sty_Grid" TabOrder="5" TabStop="true" Top="56" UseDBuff="true" UsePopupMenu="true" UserData="교육좌석목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="684">			<contents>				<format id="Default">					<columns>						<col width="95"/>						<col width="70"/>						<col width="60"/>						<col width="40"/>						<col width="50"/>						<col width="120"/>						<col width="70"/>						<col width="70"/>						<col width="110"/>					</columns>					<head>						<cell col="0" display="text" text="선택구분"/>						<cell align="center" col="1" display="text" text="좌석번호"/>						<cell col="2" display="text" text="지부"/>						<cell align="center" col="3" display="text" text="년도"/>						<cell align="center" col="4" display="text" text="회차"/>						<cell align="center" col="5" display="text" text="직능"/>						<cell align="center" col="6" display="text" text="접수번호"/>						<cell align="center" col="7" display="text" text="성명"/>						<cell align="center" col="8" display="text" text="주민번호"/>					</head>					<body>						<cell align="center" col="0" colid="ON_OFF_GUBUN" display="text"/>						<cell align="center" col="1" colid="SEATNO" display="text"/>						<cell align="center" col="2" colid="GTDEPTNM" display="text"/>						<cell align="center" col="3" colid="TOYEAR" display="combo"/>						<cell align="center" col="4" colid="TOTRAININGORDER" display="normal"/>						<cell align="center" col="5" colid="TCCOURSENM" display="text"/>						<cell align="center" col="6" colid="TOHJUBSUNO" display="text"/>						<cell align="center" col="7" colid="TJPERSONNM" display="text"/>						<cell align="center" col="8" colid="TJRESIDENTNO" display="text" Mask="######-#######"/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeatNoLoopDelete" ImageID="BTN_TEXT_COM" Left="510" OnClick="btnSeatNoLoopDelete_OnClick" Style="sty_Button" TabOrder="7" Text="예약좌석삭제" ToolTipText="미접수예약좌석일괄삭제" Top="28" Transparent="TRUE" Width="85"></Button>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu0023PTrainingSeatNoList.xml * 설명 : 강습좌석검색팝업 * 작성일 : 2009.08.28 * 작성자 : 장성호 */#include "LIB::COMMON.js"; // 공통 관련/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    if (IsExistVar("sOrderMgno")) {        lfn_Search();    }}function Form_OnUnloadCompleted(obj) {    Close();}function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    switch (nChar) {        case 27 : // 종료(Esc)            lfn_End();            break;        case 113 : // 조회(F2)            lfn_Search();            break;    }}/* * 기능 : 조회 */function lfn_Search(obj) {    ds_oTrainingSeatNo.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();	tit_addSearchActionInfo("spcledu:searchTrainingSeatNoList", false);	// 서버 호출 	tit_callService(		""		,""		,""	// inDs		,"ds_oTrainingSeatNo=ds_oTrainingSeatNo"	// outDs		,"TOMGNO=" + quote(sOrderMgno) // args		,"lfn_AfterSearchTrainingSeatNoList"		,false	);}/* * 기능 : 종료 */function lfn_End(obj) {    Close();}/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchTrainingSeatNoList(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SearchMessage(gdTrainingSeatNo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* 사용자 이벤트 함수 */function lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {    var lobj_Dataset = object(obj.BindDataset);    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.    if (lobj_Dataset.GetRowCount() > 1) {        gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.    }}function btnMutilSort_OnClick(obj){	gfn_GridMultiSort(gdTrainingSeatNo, 0); // 멀티 정렬을 실행한다.}function btnSelect_OnClick(obj){    if (ds_oTrainingSeatNo.GetCount() > 0) {        if (gfn_IsNull(ds_oTrainingSeatNo.GetColumn(ds_oTrainingSeatNo.currow, "TOHDECISIONSEATNO"))) {            var arrArg = Array(1);            arrArg[0] = ds_oTrainingSeatNo.GetColumn(ds_oTrainingSeatNo.currow, "SEATNO"); // 좌석번호            Close(arrArg);        } else {            gfn_Alert("이미 할당된 좌석번호입니다.");            return false;        }    }}function gdTrainingSeatNo_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex){    btnSelect_OnClick(obj);}function edTrainingSeatNo_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){	if (nChar == 13) {        lfn_Search();	}}/** 접수상태를 확인하여 접수 되지 않고 20분 경과 한 내방 예약자를 일괄 삭제함 */function btnSeatNoLoopDelete_OnClick(obj){   if (!gfn_Confirm("본 교육에 대해 접수(저장)를 하지 않고 예약대기시간이 20분이 지난 좌석정보는 삭제됩니다.\n"                  + "                           삭제 하시겠습니까?")) {            return false;        }   	lfn_SeatNoDelete();}/* * 접수시 좌석번호 테이블의 해당 데이터 일괄삭제하기 * return value : 없음 */function lfn_SeatNoDelete() {          tit_clearActionInfo();	tit_addSearchActionInfo("spcledu:deleteTrainingLoopSeatNo", false);		// 서버 호출 	tit_callService( 		""		,""		,""	// inDs		,""	// outDs	   	    ,"TOMGNO_A= " + quote(sOrderMgno)   // 회차관리번호args 		,"lfn_SeatNoDeleteAfter"		,false		,""		,true	);                  }/** 좌석정보 삭제 후 에러 처리 */function lfn_SeatNoDeleteAfter(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);                return;    }    gfn_DeleteMessage() ;  // 삭제 메세지 표시}]]></Script></Window>
<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" DisableBKColor="user4" Height="595" Id="frmtraining0020MTrainingJubsuManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="강습접수관리" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioTrainingJubsu">
				<Contents>
					<colinfo id="ABSENTDAY" size="1" summ="default" type="STRING"/>
					<colinfo id="ABSENTYN" size="7" summ="default" type="STRING"/>
					<colinfo id="ADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="AUTHYN" size="1" summ="default" type="STRING"/>
					<colinfo id="BARCODE" size="12" summ="default" type="STRING"/>
					<colinfo id="COMPNM" size="30" summ="default" type="STRING"/>
					<colinfo id="COURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="COURSEMUNJECD" size="3" summ="default" type="STRING"/>
					<colinfo id="COURSENM" size="30" summ="default" type="STRING"/>
					<colinfo id="DECISIONSEATNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EMAILDOMAIN" size="40" summ="default" type="STRING"/>
					<colinfo id="EMAILID" size="40" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LASTSUNAPGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="LASTTJHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LASTTOHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LASTTSSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MGJIBUCD" size="4" summ="default" type="STRING"/>
					<colinfo id="MGJIBUNICK" size="20" summ="default" type="STRING"/>
					<colinfo id="MGJIBUNM" size="70" summ="default" type="STRING"/>
					<colinfo id="MUNJEGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="PASSYN" size="1" summ="default" type="STRING"/>
					<colinfo id="PERSONNM" size="20" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="100" summ="default" type="STRING"/>
					<colinfo id="REMARKCD" size="2" summ="default" type="STRING"/>
					<colinfo id="RESIDENTNO" size="13" summ="default" type="STRING"/>
					<colinfo id="TEL" size="16" summ="default" type="STRING"/>
					<colinfo id="TJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TPMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TOMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZIPCD" size="6" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="IIIMGBINARY" size="4000" summ="default" type="BLOB"/>
					<colinfo id="TJFIREMANYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TJADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRPNUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRROADBUILDMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRROADDETAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRROADREMAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRSANGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRMAINBUNJI" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRSUBBUNJI" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRBUILDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRADDRETC" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRCONVPGM" size="256" summ="default" type="STRING"/>
					<colinfo id="TJRCONVSTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TJMEMAGREEGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TJAMOUNTGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EVALYN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSONKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="DI" size="256" summ="default" type="STRING"/>
					<colinfo id="CI" size="256" summ="default" type="STRING"/>
					<colinfo id="CIVER" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY7" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEmailDomain">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oImage">
				<Contents>
					<colinfo id="FILE_NAME" size="260" summ="default" type="STRING"/>
					<colinfo id="SHORT_FILE_NAME" size="14" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="4" summ="default" type="INT"/>
					<colinfo id="CREATE_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="UPDATE_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="ACCESS_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="ATTR_ARCHIVE" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_SYSTEM" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_HIDDEN" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_READONLY" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_DIRECTORY" size="4" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRemarkGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingOrderMgno"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSeatNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuAllInfo" OnRowPosChanged="ds_oJubsuAllInfo_OnRowPosChanged">
				<Contents>
					<colinfo id="COURSECD" size="2" type="STRING"/>
					<colinfo id="COURSEMUNJECD" size="4" type="STRING"/>
					<colinfo id="JUBSUNO" size="6" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>
					<colinfo id="MGJIBUCD" size="4" type="STRING"/>
					<colinfo id="PASSDATE" size="8" type="STRING"/>
					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TJPASSYN" size="1" type="STRING"/>
					<colinfo id="TOMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TORDER" size="3" type="STRING"/>
					<colinfo id="YEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oOrderHist">
				<Contents>
					<colinfo id="ABSENTYN" size="7" summ="default" type="STRING"/>
					<colinfo id="AFTERJIBU" size="4" summ="default" type="STRING"/>
					<colinfo id="AFTERJUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="AFTERMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AFTERORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="BEFORJIBU" size="4" summ="default" type="STRING"/>
					<colinfo id="BEFORJUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="BEFORMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BEFORORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" summ="default" type="STRING"/>
					<colinfo id="TJLASTSUNAPGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="TJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TOHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BEFORTOTCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORTOMUNJEGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSetlmentHist" OnRowPosChanged="ds_oSetlmentHist_OnRowPosChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMenuTree">
				<Contents>
					<colinfo id="MORDERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MENULEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="MPARENTMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MURL" size="256" summ="default" type="STRING"/>
					<colinfo id="MREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="MURLTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MSYSGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oModifyColumn">
				<Contents>
					<colinfo id="COLUMNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="COLUMNNM" size="256" summ="default" type="STRING"/>
					<record>
						<COLUMNCD>PERSONNM</COLUMNCD>
						<COLUMNNM>성명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>RESIDENTNO</COLUMNCD>
						<COLUMNNM>주민번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ZIPCD</COLUMNCD>
						<COLUMNNM>우편번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR1</COLUMNCD>
						<COLUMNNM>주소1</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR2</COLUMNCD>
						<COLUMNNM>주소2</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TEL</COLUMNCD>
						<COLUMNNM>전화번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>HPTEL</COLUMNCD>
						<COLUMNNM>휴대폰</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EMAILID</COLUMNCD>
						<COLUMNNM>이메일ID</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EMAILDOMAIN</COLUMNCD>
						<COLUMNNM>이메일주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>COMPNM</COLUMNCD>
						<COLUMNNM>근무처</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>REMARKCD</COLUMNCD>
						<COLUMNNM>적요구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>REMARK</COLUMNCD>
						<COLUMNNM>적요내용</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>PICTURE</COLUMNCD>
						<COLUMNNM>사진</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>JUBSUNO</COLUMNCD>
						<COLUMNNM>접수번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>DECISIONSEATNO</COLUMNCD>
						<COLUMNNM>좌석번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>BARCODE</COLUMNCD>
						<COLUMNNM>바코드</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJFIREMANYN</COLUMNCD>
						<COLUMNNM>소방공무원여부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>IIIMGSEQ</COLUMNCD>
						<COLUMNNM>사진</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJADDRGUBUN</COLUMNCD>
						<COLUMNNM>주소구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRROADBUILDMGNO</COLUMNCD>
						<COLUMNNM>건물관리번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRROADDETAIL</COLUMNCD>
						<COLUMNNM>상세주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRROADREMAIN</COLUMNCD>
						<COLUMNNM>부가주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRSANGUBUN</COLUMNCD>
						<COLUMNNM>산여부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRMAINBUNJI</COLUMNCD>
						<COLUMNNM>주번지</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRSUBBUNJI</COLUMNCD>
						<COLUMNNM>부번지</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRBUILDNM</COLUMNCD>
						<COLUMNNM>건물명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRADDRETC</COLUMNCD>
						<COLUMNNM>기타주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJMEMAGREEGUBUN</COLUMNCD>
						<COLUMNNM>안전원회원가입동의</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJAMOUNTGUBUN</COLUMNCD>
						<COLUMNNM>선후불구분</COLUMNNM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingOrder"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oPosResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>소속지부접수</DATA>
					</record>
					<record>
						<CD>T</CD>
						<DATA>타지부접수</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingPearson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oChangeTpmgno">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>조회</DATA>
					</record>
					<record>
						<CD>C</CD>
						<DATA>성명/주민번호&#32;변경</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioYearbizlink"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioT_E_L_JubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTraing_JubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTraing_ReturnTpmgnoJubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTrainingPerson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioSettelYN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>Y</CD>
						<DATA>입금</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>미입금</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEducationNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioControl">
				<Contents>
					<colinfo id="No" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTraingSeatNoCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSiteMember"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCyberLearning">
				<Contents>
					<colinfo id="CLPROGRESSPCT" size="256" summ="default" type="STRING"/>
					<colinfo id="CLPROGRESSSCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="CLEXAMSCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="CLHOMEWORKSCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="CLDISCUSSSCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="CLPASSSCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="CLTJMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CPPASSSTATUS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCyberPass">
				<Contents>
					<colinfo id="CPPROGRESSPCT" size="256" summ="default" type="STRING"/>
					<colinfo id="CPPASSSCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="CPPASSSTATUS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAddr">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>지번주소</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>도로명주소</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oYN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>Y</CD>
						<DATA>예</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>아니오</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioManager">
				<Contents>
					<colinfo id="MMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="FMLASTFMHSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="FMRESIDENTERR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMemberStatus">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDeleteSettlement"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAmountGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>B</CD>
						<DATA>선불</DATA>
					</record>
					<record>
						<CD>A</CD>
						<DATA>후불</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamCheat"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oForm">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택</DATA>
					</record>
					<record>
						<CD>0002</CD>
						<DATA>강습교육&#32;일정변경신청서</DATA>
					</record>
					<record>
						<CD>0003</CD>
						<DATA>강습교육&#32;환불신청서</DATA>
					</record>
					<record>
						<CD>0009</CD>
						<DATA>심폐소생술&#32;교육원서</DATA>
					</record>
					<record>
						<CD>0011</CD>
						<DATA>심폐소생술&#32;환불신청서</DATA>
					</record>
					<record>
						<CD>0014</CD>
						<DATA>생활안전강사&#32;교육원서</DATA>
					</record>
					<record>
						<CD>0016</CD>
						<DATA>생활안전강사&#32;환불신청서</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormSave">
				<Contents>
					<colinfo id="I_PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FRDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormSave"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormDelete">
				<Contents>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormDelete"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioScicheck" OnLoadCompleted="ds_ioScicheck_OnLoadCompleted"></Dataset>
		</Datasets>
		<Shape Bottom="297" Height="259" Id="shpGubunBox3" Left="332" LineColor="user15" Right="996" TabOrder="100" Top="38" Type="Rectangle" Width="664"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnApplyPicture" ImageID="BTN_TEXT_06" Left="782" OnClick="btnApplyPicture_OnClick" Style="sty_Button" TabOrder="49" Text="최근사진반영" Top="153" Transparent="TRUE" Width="93"></Button>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="175" LineColor="user14" Right="996" TabOrder="83" Top="1" Type="Rectangle" Width="821"></Shape>
		<Shape Bottom="449" Height="28" Id="shpGubunBox2" Left="4" LineColor="user15" Right="330" TabOrder="101" Top="421" Type="Rectangle" Width="326"></Shape>
		<Shape Bottom="410" Height="372" Id="shpGubunBox1" Left="4" LineColor="user15" Right="330" TabOrder="100" Top="38" Type="Rectangle" Width="326"></Shape>
		<Shape Bottom="450" Height="138" Id="shpGubunBox4" Left="332" LineColor="user15" Right="996" TabOrder="101" Top="312" Type="Rectangle" Width="664"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="78" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="172">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oSetlmentHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="447" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="97" Id="gdSetlmentHist" InputPanel="FALSE" Left="435" LineColor="default" Right="992" RowHeight="20" Style="sty_Grid" TabOrder="61" TabStop="true" Top="350" UseDBuff="true" UsePopupMenu="true" UserData="결제내역" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="557">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="71"/>
						<col width="62"/>
						<col width="55"/>
						<col width="70"/>
						<col width="106"/>
						<col width="62"/>
						<col width="55"/>
						<col width="0"/>
						<col width="70"/>
						<col width="73"/>
						<col width="94"/>
						<col width="55"/>
						<col width="70"/>
						<col width="70"/>
						<col width="77"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="처리일자"/>
						<cell align="center" col="2" display="text" text="결제여부"/>
						<cell col="3" display="text" text="선수납"/>
						<cell align="center" col="4" display="text" text="결제구분"/>
						<cell align="center" col="5" display="text" text="결제방법"/>
						<cell align="center" col="6" display="text" text="금액(원)"/>
						<cell col="7" display="text" text="계산서"/>
						<cell align="center" col="8" display="text" text="세금계산서발행여부"/>
						<cell align="center" col="9" display="text" text="처리지부"/>
						<cell align="center" col="10" display="text" text="처리자"/>
						<cell align="center" col="11" display="text" text="주문번호"/>
						<cell align="center" col="12" display="text" text="환불No"/>
						<cell align="center" col="13" display="text" text="관리지부"/>
						<cell align="center" col="14" display="text" text="POS지부"/>
						<cell align="center" col="15" display="text" text="정산일자"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="0" colid="TSSEQ" display="number"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="1" colid="TSPROCDATE" display="text" Mask="####-##-##"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="2" colid="TSSETLMTYN" color='expr:iif(TSSETLMTYN==&quot;N&quot;,&quot;red&quot;,&quot;default&quot;)' combocol="CD" combodataset="ds_ioSettelYN" combotext="DATA" display="combo" font="굴림,10"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="3" colid="EARLYSUNAPGUBUN" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="4" colid="TSGUBUNCDNM" display="text"/>
						<cell align="left" bkcolor="expr:fn_bkcolor(currow)" col="5" colid="TSGUBUNNM" display="text"/>
						<cell align="right" bkcolor="expr:fn_bkcolor(currow)" col="6" colid="TSPROCAMOUNT" display="number" Mask="#,###"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="7" colid="PVINFO" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="8" colid="TAXRCPTYN" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="9" colid="TSPROCGTMGNONM" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="10" colid="PROCSABUN" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="11" colid="TSJUMUNNO" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="12" colid="TSREPAYREF" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="13" colid="TSMGGTMGNONM" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="14" colid="TSPOSGTMGNONM" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="15" colid="TSPONYDATE" display="text" Mask="####-##-##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="178" OnClick="lfn_Search" Style="sty_Button" TabOrder="68" ToolTipText="조회" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="352" OnClick="lfn_Delete" Style="sty_Button" TabOrder="24" ToolTipText="삭제&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="265" OnClick="lfn_Save" Style="sty_Button" TabOrder="23" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="734" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="28" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="821" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="29" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="908" OnClick="lfn_End" Style="sty_Button" TabOrder="30" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="79" Text="지부" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnChanged="lfn_SearchTrainingLatestOrder" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="3" Top="55" UserData="I:지부" Width="88"></Combo>
		<Static Align="Center" Height="105" Id="lbCourse" Left="6" Style="sty_Label" TabOrder="80" Text="직능" Top="80" UserData="S" VAlign="Middle" Width="16" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="20" Id="lbTrainingYear" Left="192" Style="sty_Label" TabOrder="81" Text="년도" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingYear" ImeMode="native" Left="284" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edTrainingYear_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="4" Top="56" UserData="I:년도" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lbTrainingOrder" Left="8" Style="sty_Label" TabOrder="82" Text="회차" Top="189" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbPersonNm" Left="336" Style="sty_Label" TabOrder="83" Text="성명" Top="56" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingOrder" ImeMode="native" Left="100" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edTrainingOrder_OnKeyDown" OnKillFocus="edTrainingOrder_OnKillFocus" Style="sty_Edit" TabOrder="6" Top="189" UserData="S:회차" Width="28"></Edit>
		<Static Align="Center" Height="20" Id="lbResidentNo" Left="336" Style="sty_Label" TabOrder="84" Text="주민번호" Top="80" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbCompNm" Left="336" Style="sty_Label" TabOrder="85" Text="근무처" Top="224" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="COMPNM" Height="20" Id="edCompNm" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="19" Top="224" UserData="S" Width="212"></Edit>
		<Static Align="Center" Height="20" Id="lbAt" Left="522" Style="sty_Text" TabOrder="86" Text="@" Top="200" VAlign="Middle" Width="16"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfo" ImageID="BTN_TEXT_08" Left="537" OnClick="btnSearchPersonInfo_OnClick" Style="sty_Button" TabOrder="38" Text="접수자&#32;검색" Top="55" Transparent="TRUE" Width="118"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="PERSONNM" Height="20" Id="edPersonNm" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="56" UserData="S:성명" Width="106"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuNo" ImeMode="native" Left="100" LeftMargin="2" MaxLength="6" Number="TRUE" OnChanged="edJubsuNo_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edJubsuNo_OnKeyDown" OnKillFocus="edJubsuNo_OnKillFocus" Style="sty_Edit" TabOrder="7" Top="213" UserData="S:접수번호" Width="50"></Edit>
		<Static Align="Center" Height="20" Id="lbSeq" Left="8" Style="sty_Label" TabOrder="87" Text="접수번호" Top="213" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbAddr" Left="336" Style="sty_Label" TabOrder="90" Text="주소" Top="128" VAlign="Middle" Width="32"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioTrainingJubsu" BKColor="user4" Border="Flat" Column="ZIPCD" Height="20" Id="medZipCode" Left="371" LeftMargin="2" Mask="######" OnFocus="edZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="14" Top="128" Type="STRING" UserData="S" Width="52"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchZipCode" ImageID="BTN_SEARCH" Left="427" OnClick="btnSearchZipCode_OnClick" Style="sty_Button" TabOrder="40" Top="128" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="ADDR1" Height="20" Id="edAddr1" ImeMode="native" Left="451" LeftMargin="2" OnChanged="edAddr1_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="12" Top="128" UserData="S" Width="328"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="ADDR2" Height="20" Id="edAddr2" ImeMode="native" Left="336" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="13" Top="152" UserData="S" Width="442"></Edit>
		<Static Align="Center" Height="20" Id="lbTel" Left="336" Style="sty_Label" TabOrder="88" Text="전화번호" Top="176" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="TEL" Height="20" Id="edTel" ImeMode="native" Left="428" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="15" Top="176" UserData="S" Width="104"></Edit>
		<Static Align="Center" Height="20" Id="lbHpTel" Left="336" Style="sty_Label" TabOrder="89" Text="휴대폰" Top="104" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="HPTEL" Height="20" Id="edHpTel" ImeMode="native" Left="428" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="11" Top="104" UserData="S" Width="104"></Edit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="BIRTHDAY7" Height="20" Id="medResidentNo" Left="428" LeftMargin="2" Mask="######-#######" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="10" Top="80" Type="STRING" UserData="S:주민번호" Width="106"></MaskEdit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxEmailDomain" INDEX="0" InnerDataset="ds_oEmailDomain" Left="642" OnChanged="cbxEmailDomain_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="18" Top="199" Width="92"></Combo>
		<Static Align="Center" Height="20" Id="lbEmail" Left="336" Style="sty_Label" TabOrder="91" Text="E-Mail" Top="200" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="EMAILID" Height="20" Id="edEmail" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="16" Top="200" UserData="S" Width="95"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAuthResidentNo" ImageID="BTN_TEXT_07" Left="658" OnClick="btnAuthResidentNo_OnClick" Style="sty_Button" TabOrder="39" Text="실명인증" Top="79" Transparent="TRUE" Width="105"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="PASSYN" Enable="FALSE" Height="20" Id="edPassYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="73" Top="360" UserData="S" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lbPassYn" Left="8" Style="sty_Label" TabOrder="91" Text="수료여부" Top="360" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="ABSENTYN" Enable="FALSE" Height="20" Id="edAbsentYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="74" Text="Y&#32;:&#32;1일차" Top="384" UserData="S" Width="64"></Edit>
		<Static Align="Center" Height="20" Id="lbAbsentYn" Left="8" Style="sty_Label" TabOrder="92" Text="결강여부" Top="384" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAbsentManageLink" ImageID="BTN_TEXT_05" Left="168" OnClick="btnAbsentManageLink_OnClick" Style="sty_Button" TabOrder="36" Text="결강자관리" Top="384" Transparent="TRUE" Width="79"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTrainingJubsuModify" ImageID="BTN_TEXT_COM" Left="100" OnClick="btnTrainingJubsuModify_OnClick" Style="sty_Button" TabOrder="35" Text="회차변경" Top="311" Transparent="TRUE" Width="85"></Button>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oJubsuAllInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="592" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdJubsuInfo" InputPanel="FALSE" Left="4" LineColor="default" OnCellClick="gdJubsuInfo_OnCellClick" Right="496" RowHeight="20" Style="sty_Grid" TabOrder="62" TabStop="true" Top="484" UseDBuff="true" UsePopupMenu="true" UserData="개인접수정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="492">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="60"/>
						<col width="36"/>
						<col width="140"/>
						<col width="31"/>
						<col width="58"/>
						<col width="83"/>
						<col width="59"/>
						<col width="83"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="지부"/>
						<cell align="center" col="2" display="text" text="년도"/>
						<cell align="center" col="3" display="text" text="직능"/>
						<cell align="center" col="4" display="text" text="회차"/>
						<cell align="center" col="5" display="text" text="접수번호"/>
						<cell align="center" col="6" display="text" text="수료일자"/>
						<cell align="center" col="7" display="text" text="환불여부"/>
						<cell align="center" col="8" display="text" text="접수일자"/>
					</head>
					<body>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="0" display="number" expr="ln_TotalGridInfoCount&#32;-&#32;CURROW"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="1" colid="MGJIBUCD" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="2" colid="YEAR" display="text"/>
						<cell align="left" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="3" colid="COURSEMUNJECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="4" colid="TORDER" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="5" colid="JUBSUNO" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="6" colid="PASSDATE" display="text" Mask="####-##-##"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="7" colid="LASTSUNAPGUBUN" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="8" colid="FIRSTREGDATE" display="text" Mask="####-##-##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJubsuInfo" Left="4" Style="sty_LabelGruopBox" TabOrder="93" Text="개인접수정보" Top="460" VAlign="Middle" Width="120"></Static>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oOrderHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="592" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdOrderHist" InputPanel="FALSE" Left="500" LineColor="default" OnCellClick="gdOrderHist_OnCellClick" Right="996" RowHeight="20" Style="sty_Grid" TabOrder="63" TabStop="true" Top="484" UseDBuff="true" UsePopupMenu="true" UserData="회차변경정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="496">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="85"/>
						<col width="189"/>
						<col width="60"/>
						<col width="70"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2" SuppressAlign="Middle" text="순번">
							<cell col="0" display="text" rowspan="2" text="순번"/>
						</cell>
						<cell col="1" display="text" rowspan="2" SuppressAlign="Middle" text="지부">
							<cell col="0" display="text" rowspan="2" text="지부"/>
						</cell>
						<cell col="2" display="text" rowspan="2" SuppressAlign="Middle" text="회차">
							<cell col="0" display="text" rowspan="2" text="회차"/>
						</cell>
						<cell col="3" display="text" rowspan="2" SuppressAlign="Middle" text="접수번호">
							<cell col="0" display="text" rowspan="2" text="접수번호"/>
						</cell>
						<cell col="4" colspan="3" display="text" text="변경&#32;후">
							<cell col="0" colspan="3" display="text" text="변경&#32;후"/>
						</cell>
						<cell col="7" display="text" rowspan="2" SuppressAlign="Middle" text="처리일자">
							<cell col="0" display="text" rowspan="2" text="처리일자"/>
						</cell>
						<cell col="8" display="text" rowspan="2" SuppressAlign="Middle" text="사유">
							<cell col="0" display="text" rowspan="2" text="사유"/>
						</cell>
						<cell col="9" display="text" rowspan="2" SuppressAlign="Middle" text="환불여부">
							<cell col="0" display="text" rowspan="2" text="환불여부"/>
						</cell>
						<cell col="10" display="text" rowspan="2" SuppressAlign="Middle" text="결강일차">
							<cell col="0" display="text" rowspan="2" text="결강일차"/>
						</cell>
						<cell align="center" col="4" display="text" row="1" text="지부"/>
						<cell align="center" col="5" display="text" row="1" text="회차"/>
						<cell align="center" col="6" display="text" row="1" text="접수번호"/>
					</head>
					<body>
						<cell align="center" col="0" display="number" expr="ln_TotalGridOrderCount&#32;-&#32;CURROW"/>
						<cell align="center" col="1" colid="BEFORJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="2" colid="BEFORORDER" display="text"/>
						<cell align="center" col="3" colid="BEFORJUBSUNO" display="text"/>
						<cell align="center" col="4" colid="AFTERJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="5" colid="AFTERORDER" display="text"/>
						<cell align="center" col="6" colid="AFTERJUBSUNO" display="text"/>
						<cell align="center" col="7" colid="PROCDATE" display="text" Mask="####-##-##"/>
						<cell col="8" colid="REMARK" display="text"/>
						<cell align="center" col="9" colid="LASTSUNAPGUBUN" display="text"/>
						<cell align="center" col="10" colid="ABSENTYN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJubsuHist" Left="500" Style="sty_LabelGruopBox" TabOrder="94" Text="개인접수회차이력" Top="460" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="20" Id="lbSetlmt" Left="340" Style="sty_LabelGruopBox" TabOrder="95" Text="결제내역" Top="304" VAlign="Middle" Width="120"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="EMAILDOMAIN" Height="20" Id="edEmailDomain" ImeMode="native" Left="536" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="17" Top="200" UserData="S" Width="104"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeqList" ImageID="BTN_TEXT_06" Left="154" OnClick="btnSeqList_OnClick" Style="sty_Button" TabOrder="32" Text="접수목록" ToolTipText="현접수번호를&#32;제외한&#32;이후&#32;목록" Top="212" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchTrainingOrder" ImageID="BTN_TEXT_06" Left="130" OnClick="btnSearchTrainingOrder_OnClick" OnKeyDown="btnSearchTrainingOrder_OnClick" Style="sty_Button" TabOrder="31" Text="접수가능회차" Top="188" Transparent="TRUE" Width="92"></Button>
		<FileDialog Bottom="52" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage" Left="718" Right="742" TabOrder="93" Top="28" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage" Left="745" Top="28" Width="24"></HttpFile>
		<Static Align="Center" Height="20" Id="lbRemark" Left="1008" Style="sty_Label" TabOrder="96" Text="적요" Top="248" VAlign="Middle" Visible="FALSE" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edRemark" ImeMode="native" Left="1188" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="42" Top="248" UserData="S" Visible="FALSE" Width="354"></Edit>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Font="굴림,9" Height="104" Id="radCourse" INDEX="0" InnerDataset="ds_oCourse" Left="22" OnChanged="lfn_SearchTrainingLatestOrder" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="5" Top="80" UserData="I:직능" Width="306"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTraingJubsuHist" ImageID="BTN_TEXT_08" Left="537" OnClick="btnTraingJubsuHist_OnClick" Style="sty_Button" TabOrder="53" Text="기존접수이력(F6)" Top="79" Transparent="TRUE" Width="118"></Button>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxRemarkGubun" INDEX="0" InnerDataset="ds_oRemarkGubun" Left="1099" OnChanged="cbxRemarkGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="41" Top="247" UserData="S" Visible="FALSE" Width="88"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnChangeProcDate" ImageID="BTN_TEXT_06" Left="631" OnClick="btnChangeProcDate_OnClick" Style="sty_Button" TabOrder="58" Text="처리일자변경" Top="325" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnProcRct" ImageID="BTN_TEXT_06" Left="725" OnClick="btnProcRct_OnClick" Style="sty_Button" TabOrder="59" Text="현금영수증처리" Top="325" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRct" ImageID="BTN_TEXT_06" Left="819" OnClick="btnPrintReRct_OnClick" Style="sty_Button" TabOrder="60" Text="영수증재발행" Top="325" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendSms" ImageID="BTN_TEXT_08" Left="537" OnClick="btnSendSms_OnClick" Style="sty_Button" TabOrder="43" Text="문자발송" Top="103" Transparent="TRUE" Width="118"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintJubsu" ImageID="BTN_TEXT_05" Left="533" OnClick="btnPrintJubsu_OnClick" Style="sty_Button" TabOrder="26" Text="수강증출력" ToolTipText="수강증출력" Top="4" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendEmail" ImageID="BTN_TEXT_04" Left="736" OnClick="btnSendEmail_OnClick" Style="sty_Button" TabOrder="45" Text="메일발송" Top="200" Transparent="TRUE" Width="66"></Button>
		<Static Align="Center" Height="20" Id="lbSeatNo" Left="8" Style="sty_Label" TabOrder="98" Text="좌석번호" Top="237" VAlign="Middle" Width="88"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Border="Flat" Height="20" Id="edSeatNo" ImeMode="native" Left="100" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="8" Top="237" UserData="S" Width="50"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" DisableBKColor="user7" Enable="FALSE" Font="굴림,10,Bold" Height="97" Id="btnSetlmt" Left="336" OnClick="btnSetlmt_OnClick" Style="sty_Button" TabOrder="55" Text="결제(POS)" Top="350" Width="96"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeatList" ImageID="BTN_TEXT_06" Left="154" OnClick="btnSeatList_OnClick" Style="sty_Button" TabOrder="34" Text="좌석목록" Top="236" Transparent="TRUE" Width="92"></Button>
		<Static Align="Center" Height="20" Id="lbOrderChange" Left="8" Style="sty_Label" TabOrder="99" Text="회차변경" Top="312" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="#cc0000" Bottom="302" Height="4" Id="shpBox1" Left="328" LineColor="#cc0000" Right="1000" TabOrder="99" Top="298" Type="Rectangle" Width="672"></Shape>
		<Shape BKColor="#cc0000" Bottom="456" Height="4" Id="shpBox2" Left="0" LineColor="#cc0000" Right="1000" TabOrder="99" Top="452" Type="Rectangle" Width="1000"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSmsStat" ImageID="BTN_TEXT_07" Left="658" OnClick="btnSmsStat_OnClick" Style="sty_Button" TabOrder="44" Text="문자현황" Top="103" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEmailStat" ImageID="BTN_TEXT_04" Left="804" OnClick="btnEmailStat_OnClick" Style="sty_Button" TabOrder="46" Text="메일현황" Top="200" Transparent="TRUE" Width="66"></Button>
		<Static Align="Center" Height="46" Id="lbTrainingInfo" Left="8" Style="sty_Label" TabOrder="99" Text="회차정보" Top="261" VAlign="Middle" Width="36" WordWrap="TRUE"></Static>
		<Image BindDataset="ds_ioTrainingJubsu" Border="Flat" FillType="STRETCH" Height="144" Id="imgPicture" Left="876" Style="sty_Image" TabOrder="65" Text="사진" Top="47" Transparent="TRUE" Width="112"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="105" Id="imgLastestPicture" Left="784" Style="sty_Image" TabOrder="64" Text="최근사진" Top="47" Transparent="TRUE" Width="87"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchRegPicture" ImageID="BTN_TEXT_06" Left="782" OnClick="btnSearchRegPicture_OnClick" Style="sty_Button" TabOrder="47" Text="등록사진조회" Top="176" Transparent="TRUE" Width="93"></Button>
		<Static Align="Center" Height="20" Id="lbTrainingPersonInfo" Left="340" Style="sty_LabelGruopBox" TabOrder="101" Text="접수자&#32;정보" Top="32" VAlign="Middle" Width="100"></Static>
		<Static Align="Center" Height="20" Id="lbJubsu" Left="13" Style="sty_LabelGruopBox" TabOrder="101" Text="접수" Top="31" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Height="20" Id="lbBarCode" Left="8" Style="sty_Label" TabOrder="102" Text="수강증&#32;바코드" Top="425" UserData="S" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnBarCodeSearch" ImageID="BTN_TEXT_08" Left="196" OnClick="btnBarCodeSearch_OnClick" Style="sty_Button" TabOrder="37" Text="바코드로&#32;조회" Top="424" Transparent="TRUE" Width="118"></Button>
		<Shape BKColor="#cc0000" Bottom="417" Height="4" Id="shpBox3" Left="0" LineColor="#cc0000" Right="328" TabOrder="102" Top="413" Type="Rectangle" Width="328"></Shape>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbTrainingInfo2" Left="48" Style="sty_Label" TabOrder="72" Top="284" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnUnUseJubsuNo" ImageID="BTN_TEXT_04" Left="250" OnClick="lfn_SearchUnUseJubsuNo" Style="sty_Button" TabOrder="33" Text="빈번호" ToolTipText="빈접수번호조회" Top="212" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnLoadPicture_OnClick" Style="sty_Button" TabOrder="52" Text="사진찾기" Top="244" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadScanPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnLoadScanPicture_OnClick" Style="sty_Button" TabOrder="51" Text="스캔사진불러오기" Top="220" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnScanPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnScanPicture_OnClick" Style="sty_Button" TabOrder="50" Text="사진스캔실행" Top="196" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPictureManagement" ImageID="BTN_TEXT_06" Left="1008" OnClick="btnPictureManagement_OnClick" Style="sty_Button" TabOrder="48" Text="사진관리" Top="104" Transparent="TRUE" Visible="FALSE" Width="93"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnShowVirtualAccount" ImageID="BTN_TEXT_05" Left="550" OnClick="btnShowVirtualAccount_OnClick" Style="sty_Button" TabOrder="57" Text="가상계좌보기" Top="325" Transparent="TRUE" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnModifyHistory" ImageID="BTN_TEXT_04" Left="252" OnClick="btnModifyHistory_OnClick" Style="sty_Button" TabOrder="54" Text="변경이력" ToolTipText="접수정보변경이력" Top="359" Transparent="TRUE" Width="66"></Button>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medBarCode" Left="100" LeftMargin="2" Mask="############" MaxLength="12" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medBarCode_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="103" Top="425" Type="STRING" UserData="S" Width="92"></MaskEdit>
		<File Bottom="52" Height="24" Id="fiImageFile" Left="772" Right="796" TabOrder="99" Top="28" Width="24"></File>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPosResultList" ImageID="BTN_TEXT_08" Left="430" OnClick="btnPosResultList_OnClick" Style="sty_Button" TabOrder="56" Text="결제처리결과조회" Top="325" Transparent="TRUE" Width="120"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_TEXT_08" Left="614" OnClick="lfn_Print" Style="sty_Button" TabOrder="27" Text="강습원서출력(F9)" ToolTipText="강습원서출력" Top="4" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintJubsuResult" ImageID="BTN_TEXT_06" Left="439" OnClick="btnPrintJubsuResult_OnClick" Style="sty_Button" TabOrder="25" Text="접수결과출력" ToolTipText="강습접수결과출력" Top="4" Transparent="TRUE" Width="93"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radJibuGubun" INDEX="0" InnerDataset="ds_oJibuGubun" Left="96" LeftMargin="2" OnChanged="radJibuGubun_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="2" Top="32" Value="S" Width="200"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLicenseList" ImageID="BTN_TEXT_06" Left="155" OnClick="btnLicenseList_OnClick" Style="sty_Button" TabOrder="104" Text="수첩보유현황" ToolTipText="수첩보유현황" Top="359" Transparent="TRUE" Width="92"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radChangeTpmgno" INDEX="0" InnerDataset="ds_oChangeTpmgno" Left="784" LeftMargin="2" OnChanged="radChangeTpmgno_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="105" Top="32" Value="S" Visible="FALSE" Width="200"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsuHistory" ImageID="BTN_TEXT_04" Left="252" OnClick="btnJubsuHistory_OnClick" Style="sty_Button" TabOrder="106" Text="접수이력" Top="383" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="Button0" ImageID="BTN_TEXT_07" Left="658" OnClick="btnSearchPersonInfoChange_OnClick" Style="sty_Button" TabOrder="107" Text="접수자정보변경" Top="55" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPosvath" ImageID="BTN_TEXT_05" Left="913" OnClick="btnPrintEstimate_OnClick" Style="sty_Button" TabOrder="108" Text="부가세정보" Top="325" Transparent="TRUE" Width="79"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnUnSeatList" ImageID="BTN_TEXT_04" Left="250" OnClick="btnUnSeatList_OnClick" Style="sty_Button" TabOrder="109" Text="좌석선택" ToolTipText="좌석선택" Top="236" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTraingJubsuinfo" ImageID="BTN_TEXT_11" Left="336" OnClick="btnTraingJubsuInfo_OnClick" Style="sty_Button" TabOrder="110" Text="개인접수정보&#32;상세보기" Top="458" Transparent="TRUE" Visible="FALSE" Width="158"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPosReport" ImageID="BTN_TEXT_06" Left="336" OnClick="btnPosReport_OnClick" Style="sty_Button" TabOrder="111" Text="통합영수증조회" Top="325" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCyberInfo" ImageID="BTN_TEXT_08" Left="200" OnClick="btnCyberInfo_OnClick" Style="sty_Button" TabOrder="112" Text="사이버교육&#32;정보" ToolTipText="사이버교육&#32;정보" Top="311" Transparent="TRUE" Width="118"></Button>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbTrainingInfo1" Left="48" Style="sty_Label" TabOrder="113" Top="262" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_ioTrainingJubsu" Border="Flat" CodeColumn="CD" Column="TJADDRGUBUN" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxAddrGubun" INDEX="0" InnerDataset="ds_oAddr" Left="691" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="114" Top="151" UserData="S" Visible="FALSE" Width="89"></Combo>
		<Static Align="Center" Height="20" Id="Static0" Left="1008" Style="sty_Label" TabOrder="115" Text="안전원회원가입동의" Top="224" VAlign="Middle" Visible="FALSE" Width="116"></Static>
		<Radio BindDataset="ds_ioTrainingJubsu" CodeColumn="CD" Column="TJMEMAGREEGUBUN" ColumnCount="2" DataColumn="DATA" Height="22" Id="radMemAgreeYN" INDEX="1" InnerDataset="ds_oYN" Left="1126" TabOrder="116" Top="224" Value="I" Visible="FALSE" Width="110"></Radio>
		<Edit BindDataset="ds_ioTrainingJubsu" Column="TJMGNO" Height="20" Id="edImsiTJMGNO" Left="700" TabOrder="117" Top="459" Width="62"></Edit>
		<Edit BindDataset="ds_ioTrainingJubsu" Column="TPMGNO" Height="20" Id="edImsiTPMGNO" Left="824" TabOrder="118" Top="459" Width="62"></Edit>
		<Static Align="Center" BKColor="user36" BorderColor="user0" Height="20" Id="lbImsiTJMGNO" Left="645" Style="sty_Label" TabOrder="119" Text="TJMGNO" Top="459" VAlign="Middle" Width="55"></Static>
		<Static Align="Center" BKColor="user36" BorderColor="user0" Height="20" Id="lbImsiTPMGNO" Left="765" Style="sty_Label" TabOrder="120" Text="TPMGNO" Top="459" VAlign="Middle" Width="60"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDeleteSettlement" ImageID="BTN_TEXT_05" Left="462" OnClick="btnDeleteSettlement_OnClick" Style="sty_Button" TabOrder="121" Text="결제삭제" Top="302" Transparent="TRUE" Width="81"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRctPDF" ImageID="BTN_TEXT_09" Left="714" OnClick="btnPrintReRctPDF_OnClick" Style="sty_Button" TabOrder="122" Text="영수증재발행(PDF용)" Top="302" Transparent="TRUE" Width="133"></Button>
		<Static Align="Center" BKColor="darkred" Height="20" Id="Static1" Left="336" Style="sty_Label" TabOrder="123" Text="선·후불구분" Top="248" VAlign="Middle" Width="88"></Static>
		<Radio BindDataset="ds_ioTrainingJubsu" CodeColumn="CD" Column="TJAMOUNTGUBUN" ColumnCount="3" DataColumn="DATA" Height="22" Id="radAmountGubun" INDEX="0" InnerDataset="ds_oAmountGubun" Left="428" TabOrder="20" Top="247" Value="I" Width="140"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnEstimate" ImageID="BTN_TEXT_10" Left="848" OnClick="btnEstimate_OnClick" Style="sty_Button" TabOrder="124" Text="작성일자별&#32;계산서발행" Top="302" Transparent="TRUE" Width="144"></Button>
		<Static Align="Center" Height="20" Id="Static2" Left="8" Style="sty_Label" TabOrder="125" Text="실무능력평가&#32;결과" Top="336" VAlign="Middle" Width="120"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="EVALYN" Enable="FALSE" Height="20" Id="edEvalYN" ImeMode="native" Left="132" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="126" Top="336" UserData="S" Width="44"></Edit>
		<Shape Bottom="296" Height="27" Id="Shape0" Left="334" LineColor="darkgoldenrod" Right="992" TabOrder="127" Top="269" Type="Rectangle" Width="658"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSave" ImageID="BTN_TEXT_04" Left="911" OnClick="btnScanSave_OnClick" Style="sty_Button" TabOrder="134" Text="③서류저장" ToolTipText="서류저장" Top="272" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLocalFormView" ImageID="BTN_SEARCH" Left="885" OnClick="btnLocalFormView_OnClick" Style="sty_Button" TabOrder="135" Top="272" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edScanFileName" ImeMode="native" Left="810" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="133" Top="272" UserData="S" Width="74"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSearch" ImageID="BTN_TEXT_04" Left="741" OnClick="btnScanSearch_OnClick" Style="sty_Button" TabOrder="132" Text="②불러오기" ToolTipText="불러오기" Top="272" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScan" ImageID="BTN_TEXT_04" Left="672" OnClick="btnScan_OnClick" Style="sty_Button" TabOrder="131" Text="①스캔실행" ToolTipText="스캔실행" Top="272" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeverFormView" ImageID="BTN_SEARCH" Left="646" OnClick="btnSeverFormView_OnClick" Style="sty_Button" TabOrder="130" Top="272" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edFormResult" ImeMode="native" Left="600" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="129" Top="272" UserData="S" Width="45"></Edit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxForm" INDEX="0" InnerDataset="ds_oForm" Left="427" OnChanged="cbxForm_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="21" Top="271" Width="172"></Combo>
		<Static Align="Center" BKColor="firebrick" Height="20" Id="Static3" Left="336" Style="sty_Label" TabOrder="128" Text="민원서류&#32;등록" Top="272" VAlign="Middle" Width="88"></Static>
		<FileDialog Bottom="267" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage2" Left="684" Right="708" TabOrder="135" Top="243" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage2" Left="711" Top="243" Width="24"></HttpFile>
		<File Bottom="267" Height="24" Id="fiImageFile2" Left="738" Right="762" TabOrder="136" Top="243" Width="24"></File>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnFormDelete" ImageID="BTN_MINUS" Left="979" OnClick="btnFormDelete_OnClick" Style="sty_Button" TabOrder="136" ToolTipText="서류삭제" Top="275" Transparent="TRUE" Visible="FALSE" Width="16"></Button>
		<Static Align="Center" Font="굴림,9" Height="20" Id="Static4" Left="443" Style="sty_Label" TabOrder="137" Text="개인식별번호" Top="33" VAlign="Middle" Width="80"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" BKColor="palegoldenrod" Border="Flat" Column="PERSONKEY" Font="굴림,9" Height="20" Id="medPersonKey" Left="524" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="22" Top="33" Type="STRING" Width="75"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAwaiter" ImageID="BTN_TEXT_07" Left="223" OnClick="btnAwaiter_OnClick" Style="sty_Button" TabOrder="138" Text="ⓘ접수대기자보기" ToolTipText="ⓘ접수대기자보기" Top="188" Transparent="TRUE" Width="106"></Button>
	</Form>
	<Script><![CDATA[/*

 * 프로그램명 : frmtraining0020MTrainingJubsuManagement.xml

 * 설명 : 강습접수관리

 * 작성일 : 2009.07.17

 * 작성자 : 장성호

 */



#include "LIB::training.js"; // 공통업무 관련



var ls_FileUploadPath = "/IMGDATA/" + left(GetDate(), 4) + "/" + substr(GetDate(), 4, 2); // 사진이미지경로;

var ls_UploadRealName = ""; // 사진이미지 실제파일명

var lb_FileUpload = false; // 사진등록여부

var ls_FormUploadPath = "/IMGDATA/Form/" + left(GetDate(), 4); // 서류스캔파일경로;

var ls_UploadFormName = false; // 서류스캔 저장파일명

var lb_FormFileUpload = false; // 서류스캔파일등록여부

var lb_BarcodeCheck = false; // 바코드로 조회 여부

var ls_OldSeatNo = ""; // 기존 좌석번호

var ls_OldPictureNo = ""; // 기존 사진번호

var ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부

var ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부

var ls_IsChangedPictureYn = "N"; // 사진 변경여부

var ls_RetTjmgno = "";

var ls_oldMEMAGREEGUBUN = ""; // 안전원회원가의동의여부

var ls_AgreeFileUploadFolder = "/PRTDATA/";

var ls_AgreeRealFilePath = "";

var ls_AgreeRealFileName = "";

var Tomgno_AA = "";     // 회차관리번호 이전  좌석 선택시 가비지 정보 제거 위함

var TohjubsuNo_AA = "";   // 접수번호 이전

var ls_DI = "";			// SCI DI 값
var ls_CI = "";			// SCI CI 값
var ls_CIVER = "";		// SCI CI버전
var ls_PERSONKEY = "";	// PERSONKEY 값
var ls_RESIDENTNO = "";	// 조회시 주민번호
var ls_BIRTHDAY7 = "";	// 생년월일7자리


var serch_falg = "";   // 조회 버튼으로 한 것인지 선택해서 조회 인지 여부 "0", "1"




/* 공통 필수 시작 */

function Form_OnLoadCompleted(obj) {

    

    gfn_Form_OnLoadCompletedCheck(obj); //공통 폼 로딩 이벤트 처리(공통코드 조회되었는지 확인)

    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정

    ls_SystemGubun = gs_SystemGubun;

    ls_SystemMenuId = gs_SystemMenuId;

    var ls_FormId = split(sFormUrl, "::");

    ls_FormId = split(ls_FormId[1], ".");

    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";



    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.



    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.

    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정

        lfn_SetFormAuth(true); // 저장 권한

    } else if (ms_FormAuth == "R") {

        lfn_SetFormAuth(false); // 읽기 권한

    } else {

        gfn_Alert(MSGI00080);

        close();

    }

	// 시스템관리자만 tjmgno, tpmgno가 보이도록 설정
	if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM") {
		lbImsiTJMGNO.Visible = true;
		edImsiTJMGNO.Visible = true;
		edImsiTJMGNO.Text = "";
		lbImsiTPMGNO.Visible = true;
		edImsiTPMGNO.Visible = true;
		edImsiTPMGNO.Text = "";
		btnDeleteSettlement.Visible = true;
		btnDeleteSettlement.Enable = true;
		btnFormDelete.Visible = true;	// 민원서류 삭제
		btnAuthResidentNo.Visible = true;	// 실명인증
		
	} else {
		lbImsiTJMGNO.Visible = false;
		edImsiTJMGNO.Visible = false;
		edImsiTJMGNO.Text = "";
		lbImsiTPMGNO.Visible = false;
		edImsiTPMGNO.Visible = false;
		edImsiTPMGNO.Text = "";
		btnDeleteSettlement.Visible = false;
		btnDeleteSettlement.Enable = false;
		btnFormDelete.Visible = false;	// 민원서류 삭제
		btnAuthResidentNo.Visible = false;	// 실명인증
	}
	

    // 공통 코드 조회
    gfn_SearchTrainingCourseMunje("T", ds_oCourse, "Y"); // 직능 코드 조회

	ds_oCourse.SetColumn(0,"DATA","공공기관소관(집합)");
	ds_oCourse.SetColumn(1,"DATA","공공기관소관(혼합)");

    radCourse.Value = "22N";

    gfn_SearchAllJibu(cbxJibu, "Y", "선택"); // 지부 코드 조회

    gfn_SearchCommonCode(ds_oEmailDomain, "EMAILDOMAIN", "Y", "직접입력"); // 이메일도메인 조회

    gfn_SearchCommonCode(ds_oRemarkGubun, "REMARKGUBUN", "Y", "선택"); // 적요



    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

    edTrainingYear.Text = left(GetDate(), 4);

    lfn_SearchTrainingLatestOrder(); // 최근 접수가능회차 조회



    edTrainingOrder.SetFocus();

    btnSetlmt.Enable = false;

    

    serch_falg = "0" ;

    edEmail.ImeMode = "english";

    edEmailDomain.ImeMode = "english";

	radMemAgreeYN.Value = "N";	// 안전원회원가입동의
    
    radAmountGubun.Value = "B";	// 선후불구분
    
	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 Call ID 가져오기(Unique ID)
		global.mnuLeft.lfn_CallUIDImport();
	}

	// 메뉴ID 찾기
	// gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID");
	
	// 민원서류 등록현황에서 바로가기 연계
	if (IsExistVar("sPK1")) {  
		if (!gfn_isNull(sPK1)) {
			edjubsuNo.SetFocus();
			ls_RetTjmgno = sPK1;
		
			lfn_SearchTrainingJubsuList();
		}
	}

}



function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

    if (nChar == 117) {

        btnTraingJubsuHist_OnClick();

        return;

    }



    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리

}



function Form_OnSize(obj,nCx,nCy,nState) {

    if (gs_IsResizingForm == "Y") {

        gdSetlmentHist.Width = nCx - gdSetlmentHist.Left - 4 - 4;

        shpGubunBox4.Width = nCx - shpGubunBox4.Left - 4;

        gdJubsuInfo.Height = nCy - gdJubsuInfo.Top - 4;

        gdOrderHist.Height = nCy - gdOrderHist.Top - 4;

        gdOrderHist.Width = nCx - gdOrderHist.Left - 4;

        shpBox1.Width = nCx - shpBox1.Left;

        shpBox2.Width = nCx;

    }

}



/*

 * 기능 : 취소

 */

function lfn_Cancel(obj) {

    gfn_FormInit(this);

    ms_TrainingMgno = ""; // 강습관리번호


    // 시험정보

    lbTrainingInfo1.Text = "";

    lbTrainingInfo2.Text = "";



    // 접수 디폴트값 설정

    edTrainingYear.Text = left(GetDate(), 4);

    radCourse.Value = "22N";



    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

    // 그리드 초기화

    ds_oJubsuAllInfo.ClearData();

    gdJubsuInfo.NoDataText = "";

    ds_oOrderHist.ClearData();

    gdOrderHist.NoDataText = "";

    ds_oSetlmentHist.ClearData();

    gdSetlmentHist.NoDataText = "";

    btnSetlmt.Enable = false; // 결제(POS) 버튼

    btnProcRct.Enable = false;

    btnShowVirtualAccount.Enable = false;

	btnPosResultList.Enable = false;

	btnChangeProcDate.Enable = false;

	btnPrintReRct.Enable = false;
	
	btnPrintReRctPDF.Enable = false;



    edPersonNm.Readonly = false;

    medResidentNo.Readonly = false;

    Button0.Enable = false;

    btnSearchPersonInfo.Enable = true;



    edTrainingOrder.SetFocus();

}



/*

 * 기능 : 조회

 */

function lfn_Search(obj) {

    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }

    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert("접수번호를 입력해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }



    lfn_SearchTrainingJubsuList(obj);

}



/*

 * 기능 : 삭제

 */

function lfn_Delete(obj) {

    if ((ds_ioTrainingJubsu.currow < 0) || gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.

        return false;

    }



    // 결제를 하지 않았을 경우에는 삭제 가능

    if (ds_oSetlmentHist.GetCount() > 0) {

        gfn_Alert("결제가 진행되어 삭제할 수 없습니다.");

        return false;

    } else {

        if (!gfn_Confirm(MSGW00030)) { // 삭제 하시겠습니까?

            return false;

        }



        lfn_SaveModifyHistory("D"); // 변경이력을 저장한다.
        
		tit_clearActionInfo();
		
		var inDS = "";
		var outDS = "";
		
		// 등록된 서류파일이 있으면 삭제
		if (edFormResult.Text == "완료") {

			var vFAMGNO = "";
			var vPK1 = "";
			var vPK2 = "";
			var vPathArr = "";
			var vPath = "";
			var vfile = "";
			
			// 교육원서(심폐소생술, 생활안전강사)
			if (cbxForm.Value == "0009" || cbxForm.Value == "0014") {
				if (!gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TJFAMGNO"))) {
					vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
					vPK2 = "";
					vFAMGNO = ds_ioTrainingJubsu.GetColumn(0, "TJFAMGNO");
					vPathArr = split(ds_ioTrainingJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
					vPath = substr(vPathArr[1],0,18);	// 서버경로
					vfile = substr(vPathArr[1],19,21);	// 파일명
				}
			}
	
			ds_iFormDelete.ClearData();
			ds_iFormDelete.AddRow();
			
			ds_iFormDelete.SetColumn(0, "I_FCCD", cbxForm.Value);		//FORMCODE.FCCD 서식관리번호
			ds_iFormDelete.SetColumn(0, "I_FAMGNO", vFAMGNO);			//FormAttach.FAmgno
			ds_iFormDelete.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값
			ds_iFormDelete.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록
			ds_iFormDelete.SetColumn(0, "I_PATH", vPath);				//저장경로
			ds_iFormDelete.SetColumn(0, "I_FILENM", vfile);				//파일명
			
			inDS = "ds_iFormDelete=ds_iFormDelete";
			outDS = "ds_oFormDelete=ds_oFormDelete";
			
			ds_oFormDelete.ClearData(); // 결과 데이타셋 초기화
	
			tit_addSingleActionInfo("com:deleteForm", "", 0, "");
			
		}
	
        tit_addSingleActionInfo("training:deleteTrainingJubsu", "", 0, "");

        //서버 호출

        tit_callService(

            ""

            ,""

            ,inDS	// inDs

            ,outDS	// outDs

            ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args

                + " TOMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"))

            ,"lfn_AfterDeleteTrainingJubsu"

            ,false

            ,false

            ,true

        );

    }

}



function lfn_searchJubsuList() {

/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기



    ds_ioT_E_L_JubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchTraing_JubsuCheck", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioTraing_JubsuCheck=ds_oTraing_JubsuCheck"	// outDs

        , "TOMGGTMGNO_A=" + quote(cbxJibu.Value)  // 지부

        + " TOYEAR_A=" + quote(edTrainingYear.Text) // 년도

        + " TOTCCOURSECD_A=" + quote(radCourse.Value) // 직능

        + " TOTRAININGORDER_A=" + quote(edTrainingOrder.Text) // 회차 

        + " TPNM_A=" + quote(edPersonNm.Text) // 성명 

        + " PERSONKEY_A=" + quote(ls_PERSONKEY) // PERSONKEY
        
        + " BIRTHDAY_A=" + quote(left(medResidentNo.Value,6))

//        + " HP_A=" + quote(edHpTel.Text)

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}

///////////////////


function lfn_searchPERSON(sNM, sDI, sBirthday, sHP) {

/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면

/////////////////// 값을 미리 넣어주기 위해 강습자관리번호를 검색함



    ds_ioT_E_L_JubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchPersonInfo", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioTrainingPerson=ds_oTrainingPerson"	// outDs

        , "TPNM=" + quote(sNM) // 성명 

        + " DI=" + quote(sDI) // DI값
        
        + " BIRTHDAY=" + quote(sBirthday) // DI값
        
        + " HP=" + quote(replace(replace(replace(replace(sHP,"-",""),".",""),",","")," ","")) // DI값

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}


function lfn_searchTraingPerson() {

/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면

/////////////////// 값을 미리 넣어주기 위해 강습자관리번호를 검색함



    ds_ioT_E_L_JubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchTrainingPerson", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioTrainingPerson=ds_oTrainingPerson"	// outDs

        , "TPNM=" + quote(edPersonNm.Text) // 성명 

        + " BIRTHDAY=" + quote(substr(medResidentNo.value,0,6)) // 생년월일
        
        + " HP=" + quote(edHpTel.Text) // 휴대폰
        
        + " DI=" + quote(ls_DI) // DI값

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}



/*

* 예약 좌석 테이블에 좌석이 있는지 확인한다.

*/

function lfn_searchTraingSeatNoCheck() {

////////// 좌석 예약 정보가 있는지 미리 확인한다.

    ds_ioTraingSeatNoCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("training:searchTrainingSeatNoCheck", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioTraingSeatNoCheck=ds_oTraingSeatNoCheck"	// outDs

        , "SEATNO=" + quote(edSeatNo.Text) // 좌석번호 

        + " TOMGNO=" + quote(ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO")) // 회차관리번호 

        + " JUBSUNO=" + quote(edJubsuNo.Text) // 접수번호                        

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}



/*

 * 기능 : 저장

 */

var ls_ServiceName = "";

var ls_CallBackServiceName = "";

function lfn_Save(obj) {

    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {// 신규이면서
    
		if (ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT") <= ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT")) {

			gfn_Alert("접수인원수를 초과하였습니다.");
	
				// 시스템관리자만 변경 허용
			if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
	
				return false;
				
			}
        
        }
        
		if (ds_oTrainingOrderMgno.GetColumn(0, "JUBSUPOSSIBLECNT") == 0) {
		
			gfn_Alert("접수가 불가합니다.[접수가능인원:0]");
		
			// 시스템관리자만 변경 허용
			if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
        
				return false;
				
			}
		
		}

    }


 ////////////////////  신규이면서 교육종료일 지나면 접수 안되게 함 (추가함)

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서

                && (left(GetDAte(), 8) > ds_oTrainingOrderMgno.GetColumn(0, "TOENDDATE"))

            ) {

        gfn_Alert("교육종료일이 지나서 접수하실 수 없습니다.");

		// 시스템관리자만 변경 허용
		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
        
			return false;
			
		}

    }

 ////////////////////   

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서

                && (left(GetDAte(), 8) > ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"))

            ) {

            if (!gfn_Confirm("교육시작일이 지났습니다. 그래도 접수하시겠습니까?")) {

                return false;

            }

    }

	// 생활안전강사 or 심폐소생술 이면 
	if (left(radCourse.Value,2) == "50" || left(radCourse.Value,2) == "51") {
	
		if (length(medResidentNo.Value) > 7) {
		
			gfn_Alert("생활안전강사 또는 심폐소생술 과정은 [생년월일]만 입력하세요!");
			
			return false;
		
		}
	
	} else { //강습과정이면
	
		if (gfn_IsNull(medPersonKey.Value) && length(medResidentNo.Value) < 13) {
		
			gfn_Alert("강습교육 과정은 주민등록번호 13자리를 입력하세요!");
			
			return false;
		
		}
		
		if (!gfn_IsNull(medPersonKey.Value) && length(medResidentNo.Value) < 7) {
		
			gfn_Alert("생년월일+성별(7자리)을 정확하게 입력하세요!");
			
			return false;
		
		}

		// DI가 없는경우 실명확인 후 저장
		if (gfn_IsNull(ls_DI)) {
		
			lfn_AuthResidentNo();
			
			if (gds_ioSciCheck.GetColumn(0, "STRRESULT") <> "1") {
			
				if (!gfn_Confirm("실명확인 오류 입니다. 강제로 저장 하시겠습니까?\n\n" +
				
								 "* 오류내용 : " + gds_ioSciCheck.GetColumn(0, "STRCI2"))) {

					medResidentNo.SetFocus();

					return false;
					
				} else {
					// 실명확인 오류시 DI값에 오류코드 3자리 입력
					ls_DI = gds_ioSciCheck.GetColumn(0, "STRRETUNCODE");
				
				}
				
			}
	
		}
	
	}



    if (!gfn_FormValidate(this)) { // 입력 Validation Check

        return false;

    }
    
    //trace(ds_oTrainingOrderMgno.GetColumn(0, "TOJUBSUENDDATE"));
/*    
    if (radCourse.Value == "20C") {
/*     
		if (!lfn_CheckSiteMemberJoin()) {// 사이트에 가입되어있지 않으면

			gfn_Alert("안전원사이트에 가입한 내역이 없어서 접수하실 수 없습니다.\n\n안전원사이트에 회원가입하신 후 접수가능합니다.");
	
			return false;
		}
*/		
/*		if (ds_oTrainingOrderMgno.GetColumn(0, "TOCYBERSTARTDATE") <= left(GetDate(), 8)) {

			gfn_Alert("혼합교육 접수기간이 지나서 접수하실 수 없습니다.\n\n소집교육 또는 다음회차의 혼합교육으로 접수하시기 바랍니다.");
	
			return false;
		
		}
	}
*/


    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서

                && lfn_CheckTrainingJubsuEduPassed() // 수료한 교육이 있으면

            ) {

        if (!gfn_Confirm("수료한 강습이 있습니다." 
        
					   + "\n\n  * 수료일자 : " + ds_oTrainingCheck.GetColumn(0,"TOENDDATE")
					   
					   + "\n\n신규 접수 하시겠습니까?")) {

            return false;

        }

    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서

                && lfn_CheckTrainingJubsuHaveSameCourseLcs() // 보유한 수첩이 있으면

            ) {

        gfn_Alert("보유한 수첩이 있어서 접수하실 수 없습니다.\n\n"
        
					   + " * 수첩번호 : " + ds_oTrainingCheck.GetColumn(0,"LLCSNO")
					   
					   + "\n\n * 취득일자 : " + ds_oTrainingCheck.GetColumn(0,"ISSUEDATE"));
        
            return false;

    }



    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "N") {

        gfn_Alert("회차변경된 접수번호는 수정하실 수 없습니다.");

        return false;

    }

 /*

    if (!gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규가 아니면서 ds 바인딩 되어 있어서 변경시 동일하게 변경됨

                && (ds_ioTrainingJubsu.GetOrgBuffColumn(0, "PERSONNM") <> ds_ioTrainingJubsu.GetColumn(0, "PERSONNM"))

                && (ds_ioTrainingJubsu.GetOrgBuffColumn(0, "RESIDENTNO") <> ds_ioTrainingJubsu.GetColumn(0, "RESIDENTNO"))

            ) {

        trace("버퍼 : "+ds_ioTrainingJubsu.GetOrgBuffColumn(0, "PERSONNM"));  

        trace("수정 : " + ds_ioTrainingJubsu.GetColumn(0, "PERSONNM"));  

        gfn_Alert("수강자의 기본정보에 대해 변경사항이 없습니다.");

        return false;

    }

*/

//해당 자격시험 부정행위자로 등록되어 (0000.00.00)까지 시험응시자격 정지
 //-  교육수강은 가능하나, 시험에는 응시할 수 없음을 안내바람


	// 시험 부정행위 이력 조회
	lfn_ExamCheatSearch(); // 부정행위 여부 확인
	if (ds_oExamCheat.rowcount > 0) {
	
        gfn_Alert("시험 부정행위 이력이 있어 교육수강은 가능하나, 시험에는 응시할 수 없습니다.\n\n"
                  + "부정행위 구분 : " + ds_oExamCheat.GetColumn(0, "ECCHEATREASON")
                  + "\n응시불가 기간 : " + substr(ds_oExamCheat.GetColumn(0, "ECSTOPSTARTDATE"),0,4)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPSTARTDATE"),4,2)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPSTARTDATE"),6,2)+" ∼ "+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPENDDATE"),0,4)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPENDDATE"),4,2)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPENDDATE"),6,2)
                  + "\n비             고 : " + ds_oExamCheat.GetColumn(0, "ECREMARK")
        );
	
	}

////////////////// 좌석번호, 좌석 예정 있는지 확인

//    trace(ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO"));

    lfn_searchTraingSeatNoCheck(); 

    if(ds_ioTraingSeatNoCheck.count > 0) {

        gfn_Alert("선택한 좌석 번호는 다른 인원이 예약했습니다. 다시 확인 하시기 바랍니다.");    

        return false;

    }

    

//////////////////
	// 주민등록번호가 13자리이면
	if (length(medResidentNo.Value) == 13) {

		var lb_ValidRedidentNoYn = gfn_CheckResidentNo(medResidentNo.Value); // 주민번호체계 검사
	
		var lb_ValidForeignNoYn = gfn_CheckForeignNo(medResidentNo.Value); // 재외국인 등록번호 검사
	
		if (!lb_ValidRedidentNoYn && !lb_ValidForeignNoYn) { // 둘다 실패면
	
			if (!gfn_Confirm("주민등록번호가 형식에 맞지 않습니다.\n강제로 저장 하시겠습니까?")) {
	
				medResidentNo.SetFocus();
	
				return false;
	
			}
	
		}

	}


    // 정현호 대리 요청은 실명인증부분 주석처리함.2009.09.29

    // if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서

            // && (ds_ioTrainingJubsu.GetColumn(0, "AUTHYN") <> "Y")) {

        // gfn_Alert("실명인증을 먼저 실행해주십시오.");

        // return false;

    // }

    // 정현호대리 요청으로 코멘트 처리함.2009.09.28.

    // if (gfn_IsNull(imgPicture.ImageID)) {

        // gfn_Alert("사진을 먼저 등록해주십시오.");

        // return false;

    // }



    var sArg = "";

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) { // 신규



      ///////////////////  해당 동일 직능 회차에 이미 접수 내역이 있으면 접수 안되게 함      

		lfn_searchJubsuList();     

        if (ds_ioTraing_JubsuCheck.count > 0) {



             gfn_Alert("   아래와 같이 동일인이 접수가 되어 있습니다. 확인 바랍니다. \n\n"

                + "         성          명 :   " + edPersonNm + "\n" 
                
                + "         직          능 :   " + radCourse.Text + "\n" 

                + "         회          차 :   " + ds_ioTraing_JubsuCheck.Getcolumn(0, "TOTRAININGORDER") + "\n" 

                + "         접수 번호는 :   " + ds_ioTraing_JubsuCheck.Getcolumn(0, "TOHJUBSUNO")+ " 입니다. \n" );



            

           // return false;

        }


        if (gds_oUserInfo.GetColumn(0, "PDEPTCD") == cbxJibu.Value) { // 소속지부

            if (!gfn_Confirm("저장 하시겠습니까?")) {

                return false;

            }

        } else {

            if (!gfn_Confirm("타지부 접수입니다. 접수 저장 하시겠습니까?")) {

                return false;

            }

        }


		
		////////////////////   
	
		////////////////////
	
		// trace(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));
	
		// 기본정보, 실명 인증 하지 않고 저장시 개인정보 유무 체크 안하고 저장시 무결성 오류 발생 해결위함
	
		//  강습자관리번호 없을 경우 한번 체크하여 동일자가 있을 경우 값을 넣어줌  
	
		if (gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {        
	
			//lfn_searchTraingPerson();
			
			lfn_searchPERSON(edPersonNm.Text, ls_DI, substr(medResidentNo.value,0,6), edHpTel.Text);
	
			ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", ds_ioTrainingPerson.GetColumn(0, "TPMGNO"));
	
		}

     

		////////////////////



        ls_ServiceName = "training:insertTrainingJubsu";

        ls_CallBackServiceName = "lfn_AfterInsertTrainingJubsu";

        sArg = "IsNewPictureYn=" + quote(iif(lb_FileUpload, "Y", "N"));

    } else { // 수정
    
  
		// 교육종료일이 지나면 수정 불가
		if (left(GetDAte(), 6) > left(ds_oTrainingOrderMgno.GetColumn(0, "TOENDDATE"),6)) {
	
			gfn_Alert("교육월이 지나서 수정하실 수 없습니다.");
	

			// 시스템관리자만 변경 허용
			if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
			
				return false;
				
			}
	
		}
    

        if (!gfn_Confirm("수정 하시겠습니까?")) {

            return false;

        }



        ls_ServiceName = "training:updateTrainingJubsu";

        ls_CallBackServiceName = "lfn_AfterUpdateTrainingJubsu";

        lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.

        sArg = "IsChangedJubsuInfoYn=" + quote(ls_IsChangedJubsuInfoYn);

        sArg += " IsChangedSeatNoYn=" + quote(ls_IsChangedSeatNoYn);

        sArg += " IsChangedPictureYn=" + quote(ls_IsChangedPictureYn);

    }


    if (lb_FileUpload) { // 사진등록인 경우(파일 업로드일 경우)

        tit_FileWrite(

            hfImage

            , ls_FileUploadPath

            , fdImage.FilePath

            , fdImage.FileName

            , ls_UploadRealName

            , "U"

            , true

        );

        hfImage.CloseFile();

    }



    ds_ioTrainingJubsu.SetColumn(0, "TOMGNO", ms_TrainingMgno);

    ds_ioTrainingJubsu.SetColumn(0, "JUBSUNO", edJubsuNo.Text);

    ds_ioTrainingJubsu.SetColumn(0, "DECISIONSEATNO", edSeatNo.Text);
    
    ds_ioTrainingJubsu.SetColumn(0, "DI", ls_DI);
    
    ds_ioTrainingJubsu.SetColumn(0, "CI", ls_CI);
    
    ds_ioTrainingJubsu.SetColumn(0, "CIVER", ls_CIVER);
    
    //ds_ioTrainingJubsu.SetColumn(0, "PERSONKEY", ls_PERSONKEY);
    ds_ioTrainingJubsu.SetColumn(0, "PERSONKEY", iif(length(ls_PERSONKEY)==10, ls_PERSONKEY, ""));
    
    ds_ioTrainingJubsu.SetColumn(0, "BIRTHDAY7", iif(gfn_IsNull(ls_BIRTHDAY7), substr(medResidentno.Value,0,7), ls_BIRTHDAY7));

//	TRACE(ds_ioTrainingJubsu.SAVEXML());

    ds_oTrainingJubsuResult.ClearData(); // 결과 데이타셋 초기화


    tit_clearActionInfo();

    tit_addSingleActionInfo(ls_ServiceName, "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iTrainingJubsu=ds_ioTrainingJubsu"    // inDs

        ,"ds_oTrainingJubsuResult=ds_oTrainingJubsu"    // outDs

        ,sArg    // args

        ,ls_CallBackServiceName

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 출력

 */

function lfn_Print(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    if (!gfn_Confirm("강습원서를 출력 하시겠습니까?")) {

        return false;

	}



    // 출력이력을 저장한다.

    gfn_InsertSearchPrintHistory(

            "P"

            , this.ID

            , global.mnuLeft.cbxOpenForm.Text + "(강습원서)"

            , "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")

        );


	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
		
				"P"
				
				, gs_CallCenterUID
	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")

				, this.ID
	
				, global.mnuLeft.cbxOpenForm.Text + "(강습원서)"
	
				, "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
				
			);
	}


    ds_oTrainingJubsuPrint.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchInternetTrainingJubsuReport", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oTrainingJubsuPrint=ds_oInternetTrainingJubsuInfoReport"    // outDs

        ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args

        ,""

        ,false

        ,false

        ,true

    );



	if (radCourse.Value <> "50N") {	// 생활안전강사 가 아니면
		var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0060R03TrainingApplicationBatch.rex"
	
									, "ds_oTrainingJubsuPrint"
	
									, "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
	
									, false
	
								);
	} else {	// 생활안전강사 이면
	
		var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0060R04TrainingApplicationBatch.rex"
	
									, "ds_oTrainingJubsuPrint"
	
									, "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
	
									, false
	
								);

	}
}

/* 공통 필수 종료 */



/* 사용자 함수 */

/*

 * 기능 : 최근 접수가능회차를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchTrainingLatestOrder(obj) {

    ds_oTrainingOrder.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

	tit_addSearchActionInfo("training:searchTrainingOrderList_NoToday", false);

	// 서버 호출

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_oTrainingOrder=ds_oTrainingOrder"	// outDs

		,"TCCOURSECD=" + quote(radCourse.Value)

            + " TOMGJIBUCD=" + quote(cbxJibu.Value)

            + " TOYEAR=" + quote(edTrainingYear.Text)

            + " sPosiYn=" + quote("Y") // 접수가능여부

            + " sRowCount=" + quote("1") // 건수

		,"lfn_AfterSearchTrainingLatestOrder"

        ,false

        ,false

        ,true

	);
	

}



/*

 * 기능 : 최근 접수가능회차 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchTrainingLatestOrder(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oTrainingOrder.GetCount() > 0) {

        ms_TrainingMgno = ds_oTrainingOrder.GetColumn(0, "TOMGNO"); // 관리번호

        cbxJibu.Value = ds_oTrainingOrder.GetColumn(0, "TOMGGTMGNO"); // 지부코드

        edTrainingYear.Text = ds_oTrainingOrder.GetColumn(0, "TOYEAR"); // 년도

        radCourse.Value = ds_oTrainingOrder.GetColumn(0, "COURSEMUNJECD"); // 직능코드

        edTrainingOrder.Text = ds_oTrainingOrder.GetColumn(0, "TOTRAININGORDER"); // 회차



        lfn_SearchTrainingOrderMgno(); // 강습회차관리번호를 조회한다.

    } else {

        ms_TrainingMgno = ""; // 강습관리번호
        

        // 시험정보

        lbTrainingInfo1.Text = "";

        lbTrainingInfo2.Text = "";



        edJubsuNo.Text = "";

        edSeatNo.Text = "";



        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

        // 그리드 초기화

        ds_oJubsuAllInfo.ClearData();

        gdJubsuInfo.NoDataText = "";

        ds_oOrderHist.ClearData();

        gdOrderHist.NoDataText = "";

        ds_oSetlmentHist.ClearData();

        gdSetlmentHist.NoDataText = "";

        btnSetlmt.Enable = false; // 결제(POS) 버튼

        btnProcRct.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnPosResultList.Enable = false;

        btnChangeProcDate.Enable = false;

        btnPrintReRct.Enable = false;
        
        btnPrintReRctPDF.Enable = false;

    }

}



/*

 * 기능 : 직능별교육자접수 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchTrainingJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    gfn_SearchMessage(gdTrainingJubsu); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

    lb_FileUpload = false;

}



/*

 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용

 * parameter : strSvcID - 서비스ID

 *             nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterDeleteTrainingJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

	if (edFormResult.Text == "완료") {
	
		lfn_AfterFormDelete(nErrorCode, strErrorMsg);
	
	}



    gfn_Alert("정상적으로 삭제되었습니다.");



    lb_FileUpload = false;

    lfn_SearchTrainingOrderMgno(); // 강습정보를 조회한다.

}



/*

 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용

 * parameter : strSvcID - 서비스ID

 *             nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterUpdateTrainingJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    ///// 정상 수정접수 후 좌석 TEMP임시 테이블의 동일 자료를 삭제 함

	/** 안전원회원 가입동의 */
/*	
	if ((ls_oldMEMAGREEGUBUN == "N" && radMemAgreeYN.Value == "Y") ||
	   (ls_oldMEMAGREEGUBUN == "Y" && radMemAgreeYN.Value == "N")) {
		lfn_MemberAgreeModify(radMemAgreeYN.Value, ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));
	}
*/    

    ds_ioControl.SetColumn(0, "No", "1"); // 트랜잭션 호출 위함

    

    lfn_SeatNoDelete();

    /////

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

    lb_FileUpload = false;



    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부

    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부

    ls_IsChangedPictureYn = "N"; // 사진 변경여부



    lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.

}



/*

 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용

 * parameter : strSvcID - 서비스ID

 *             nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterInsertTrainingJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    switch (ds_oTrainingJubsuResult.GetColumn(0, "RESULTCODE")) {

        case "JUBSUNO" : // 접수번호중복

            var ls_NewJubsuNo = lpad((toNumber(edJubsuNo.Text) + 1), "0", 6); // 접수번호

            if (!gfn_Confirm("접수번호가 중복되었습니다.\n다음 접수번호[" + ls_NewJubsuNo + "]로 접수하시겠습니까?")) {

                return false;

            }

            edJubsuNo.Text = ls_NewJubsuNo;



            tit_addSingleActionInfo(ls_ServiceName, "", 0, "");

            // 서버 호출
	
            tit_callService(

                ""

                ,""

                ,"ds_iTrainingJubsu=ds_ioTrainingJubsu:U"    // inDs

                ,"ds_oTrainingJubsuResult=ds_oTrainingJubsu"    // outDs

                ,""    // args

                ,ls_CallBackServiceName

                ,false

                ,false

                ,true

            );

            break;

        case "SEATNO" : // 좌석번호중복

            gfn_Alert("좌석번호가 중복되었습니다.\n확인하신 후 다시 저장해 주십시오");

            break;

        case "OK" : // 정상처리
        
        
			/** 안전원회원 가입동의 */
/*			
			if ((radMemAgreeYN.Value == "Y") ||
				(ls_oldMEMAGREEGUBUN == "Y" && radMemAgreeYN.Value == "N")) {
				lfn_MemberAgreeModify(radMemAgreeYN.Value, ds_oTrainingJubsuResult.GetColumn(0, "RESULTTJMGNO"));
			}
*/
            lfn_SaveModifyHistory("I"); // 변경이력을 저장한다.

            ///// 정상 접수 후 좌석 TEMP임시 테이블의 동일 자료를 삭제 함

                lfn_SeatNoDelete();

            /////

            gfn_SaveMessage(); // 저장 메세지를 처리한다.

            lb_FileUpload = false;

            lfn_Search();

            break;

    }

}



/*

 * 접수시 좌석번호 테이블의 해당 데이터 삭제하기

 * return value : 없음

 */

function lfn_SeatNoDelete() {

    tit_clearActionInfo();

    tit_addMultiActionInfo("training:deleteTrainingSeatNo", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iTrainingSeatNo=ds_ioControl:U" // inDs

        ,"" // outDs

        ,  "SEATNO_A= " + quote(edSeatNo.Text)  // 좌석번호

         + " JUBSUNUM_A= " + quote(edJubsuNo.Text)  // 접수번호

         + " TOMGNO_A= " + quote(ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO"))    // 회차관리번호// args

        ,"lfn_SeatNoDeleteAfter"

        ,false

        ,false

        ,true

    );

}



/*

* 좌석정보 삭제 후 에러 처리 

*/

function lfn_SeatNoDeleteAfter(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        

        return;

    }

    

}



/*

 * 기능 : 강습회차관리번호를 조회한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_SearchTrainingOrderMgno() {

    if (gfn_IsNull(cbxJibu.Value)

            || gfn_IsNull(radCourse.Value)

            || gfn_IsNull(edTrainingYear.Text)

            || gfn_IsNull(edTrainingOrder.Text)) {

        return false;

    }



    ds_oTrainingOrderMgno.ClearData(); // 데이타셋 초기화


 
    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingOrderMgno", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oTrainingOrderMgno=ds_oTrainingOrderMgno"    // outDs

        ,"TOMGJIBUCD=" + quote(cbxJibu.Value)

            + " TCCOURSECD=" + quote(radCourse.Value)

            + " TOYEAR=" + quote(edTrainingYear.Text)

            + " TOORDER=" + quote(lpad(edTrainingOrder.Text, "0", 3))

        ,"lfn_AfterSearchTrainingOrderMgno"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 :  강습회차관리번호 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchTrainingOrderMgno(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oTrainingOrderMgno.GetCount() > 0) {

        ms_TrainingMgno = ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO"); // 회차관리번호

        // 회차정보1
        
		if (radCourse.Value == "20C") {		// 사이버교육이면
		
			var ls_CSdate = ds_oTrainingOrderMgno.GetColumn(0, "TOCYBERSTARTDATE"); // 사이버교육시작일
			
			var ls_CEdate = ds_oTrainingOrderMgno.GetColumn(0, "TOCYBERENDDATE"); // 사이버교육종료일
			
			var ls_Sdate = ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"); // 교육시작일
			
			var ls_Edate = ds_oTrainingOrderMgno.GetColumn(0, "TOENDDATE"); // 교육종료일
			
			lbTrainingInfo1.Height = 16;
			
			lbTrainingInfo2.Height = 28;
			
			lbTrainingInfo2.Top = 278;
			
			lbTrainingInfo1 = " 교육정원:" + ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT") + // 좌석수
			
								//"  최대인원수:" + ds_oTrainingOrderMgno.GetColumn(0, "TOJUBSUMAXCNT") + // 최대접수인원수
								
								"  현재접수인원:" + ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT") + // 현재접수인원수
								
								"  접수가능인원:" + ds_oTrainingOrderMgno.GetColumn(0, "JUBSUPOSSIBLECNT") ; // 접수가능인원
								
			lbTrainingInfo2 =	" 사이버교육기간 : " + left(ls_CSdate, 4) + "-" + substr(ls_CSdate, 4, 2) + "-" + right(ls_CSdate, 2) + // 사이버교육시작일
	
								" ~ " + left(ls_CEdate, 4) + "-" + substr(ls_CEdate, 4, 2) + "-" + right(ls_CEdate, 2) + // 사이버교육종료일
								
								//"\n " + ds_oTrainingOrderMgno.GetColumn(0, "TOCOURSEGUBUNNM") +  // 과정구분
								
								"\n       소집교육일 : " + left(ls_Sdate, 4) + "-" + substr(ls_Sdate, 4, 2) + "-" + right(ls_Sdate, 2) + // 교육시작일
	
								" ~ " + left(ls_Edate, 4) + "-" + substr(ls_Edate, 4, 2) + "-" + right(ls_Edate, 2); // 교육종료일
								
		} else {		// 사이버교육이 아니면

			lbTrainingInfo1.Height = 22;

			lbTrainingInfo1.Height = 22;
		
			lbTrainingInfo2.Top = 284;

			lbTrainingInfo1 = " 교육정원:" + ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT"); // 좌석수
	
			//lbTrainingInfo1 = lbTrainingInfo1 + "  최대인원수:" + ds_oTrainingOrderMgno.GetColumn(0, "TOJUBSUMAXCNT"); // 최대접수인원수
	
			lbTrainingInfo1 = lbTrainingInfo1 + "  현재접수인원:" + ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT"); // 현재접수인원수
			
			lbTrainingInfo1 = lbTrainingInfo1 + "  접수가능인원:" + ds_oTrainingOrderMgno.GetColumn(0, "JUBSUPOSSIBLECNT"); // 접수가능인원
	
			// 회차정보2
	
			lbTrainingInfo2 = " " + ds_oTrainingOrderMgno.GetColumn(0, "TOCOURSEGUBUNNM"); // 과정구분
	
			var ls_date = ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"); // 교육시작일
	
			lbTrainingInfo2 = lbTrainingInfo2 + "   교육일:" + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + right(ls_date, 2); // 교육시작일
	
			ls_date = ds_oTrainingOrderMgno.GetColumn(0, "TOENDDATE"); // 교육종료일
	
			lbTrainingInfo2 = lbTrainingInfo2 + " ~ " + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + right(ls_date, 2); // 교육종료일
	
		}

        if (!lb_BarcodeCheck) {

            edJubsuNo.Text = lpad((toNumber(ds_oTrainingOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 6); // 접수번호

            lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.



            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

            

            if(serch_falg == "0") {  // 조회하는 플래그를 통해 초기화하는 DS를 선택

                // 그리드 초기화

                ds_oJubsuAllInfo.ClearData();

                gdJubsuInfo.NoDataText = "";

                ds_oOrderHist.ClearData();

                gdOrderHist.NoDataText = "";

                ds_oSetlmentHist.ClearData();

                gdSetlmentHist.NoDataText = "";

                btnSetlmt.Enable = false; // 결제(POS) 버튼

                btnProcRct.Enable = false;

                btnShowVirtualAccount.Enable = false;

                btnPosResultList.Enable = false;

                btnChangeProcDate.Enable = false;

                btnPrintReRct.Enable = false;

				btnPrintReRctPDF.Enable = false;

            } else if (serch_falg == "1") {

                ds_oSetlmentHist.ClearData();

                gdSetlmentHist.NoDataText = "";

                btnSetlmt.Enable = false; // 결제(POS) 버튼

                btnProcRct.Enable = false;

                btnShowVirtualAccount.Enable = false;

                btnPosResultList.Enable = false;

                btnChangeProcDate.Enable = false;

                btnPrintReRct.Enable = false;
                
				btnPrintReRctPDF.Enable = false;

            }

            

        } else {

            if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

                edJubsuNo.Text = lpad((toNumber(ds_oTrainingOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 6); // 접수번호

                lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.

            }

        }

    } else {

        gfn_Alert("접수할 회차정보가 없습니다. 다시 선택해 주십시오.");

        lfn_Cancel();

    }



    lb_BarcodeCheck = false;


	radMemAgreeYN.Value = "N";	// 안전원회원가입동의
	
	if (radCourse.Value <> "50N") {	// 생활안전강사가 아니면 선불
	
		radAmountGubun.Value = "B";	// 선후불구분
		
	} else {	// 생활안전강사이면 후불
	
		radAmountGubun.Value = "A";	// 선후불구분
	
	}

    edJubsuNo.SetFocus();

}



/*

 * 기능 : 접수자목록을 조회한다.

 * parameter : sOrderMgno - 회차관리번호

 *             sJubsuNo - 접수번호

 *             sLikeYn - LIKE 검색 여부

 * return value : 강습접수자목록 정보를 가진 배열 오브젝트

 */

function lfn_SearchTrainingJubsuList(obj) {

    var ls_HistoryArg = "";

    var ls_SearchArg = "";

    if (lb_BarcodeCheck) {

        if (gfn_IsNUll(ls_RetTjmgno)) {

            ls_HistoryArg = "바코드=" + medBarCode.Value;

            ls_SearchArg = "BARCODE=" + quote(medBarCode.Value);

        } else {

            ls_HistoryArg = "접수관리번호=" + ls_RetTjmgno;

            ls_SearchArg = "TJMGNO=" + quote(ls_RetTjmgno);

            ls_RetTjmgno = "";

        }

    } else {

        if (gfn_IsNull(ms_TrainingMgno)

                || gfn_IsNull(edJubsuNo.Text)) {

            return false;

        }

        if (!gfn_IsNUll(ls_RetTjmgno)) {

            ls_HistoryArg = "접수관리번호=" + ls_RetTjmgno;

            ls_SearchArg = "TJMGNO=" + quote(ls_RetTjmgno);

            ls_RetTjmgno = "";

        } else {

			ls_HistoryArg = "회차관리번호=" + ms_TrainingMgno
		
				+ ", 접수번호=" + lpad(edJubsuNo.Text, "0", 6);
		
			ls_SearchArg = "TOMGNO=" + quote(ms_TrainingMgno)
		
				+ " TOHJUBSUNO=" + quote(lpad(edJubsuNo.Text, "0", 6));
            
		}

    }




    ds_ioTrainingJubsu.ClearData(); // 데이타셋 초기화

    lfn_SetChangedJubsuInfo(true);



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingJubsuList", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_ioTrainingJubsu=ds_oTrainingJubsu"    // outDs

        ,ls_SearchArg

        ,"lfn_AfterSearchTrainingJubsuList"

        ,false

        ,false

        ,true

    );
    

    // 조회이력을 저장한다.

    gfn_InsertSearchPrintHistory(

            "S"

            , this.ID

            , global.mnuLeft.cbxOpenForm.Text

            , ls_HistoryArg
            
            //, ds_ioTrainingJubsu.SaveXML("ds_ioTrainingJubsu","",false)

        );
    
	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
		
				"S"
				
				, gs_CallCenterUID
	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")

				, this.ID
	
				, global.mnuLeft.cbxOpenForm.Text
	
				, ls_HistoryArg
				
			);
	}

}



/*

 * 기능 : 접수자목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchTrainingJubsuList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_ioTrainingJubsu.GetCount() > 0) {
    
		ms_TrainingMgno = ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"); // 관리번호
		
        cbxJibu.Value = ds_ioTrainingJubsu.GetColumn(0, "MGJIBUCD"); // 지부

        edTrainingYear.Text = ds_ioTrainingJubsu.GetColumn(0, "YEAR"); // 년도

        radCourse.Value = ds_ioTrainingJubsu.GetColumn(0, "COURSEMUNJECD"); // 직능

        edTrainingOrder.Text = ds_ioTrainingJubsu.GetColumn(0, "TORDER"); // 회차

        edJubsuNo.Text = ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO"); // 접수번호

        edSeatNo.Text = ds_ioTrainingJubsu.GetColumn(0, "DECISIONSEATNO"); // 확정좌석번호

        ls_OldSeatNo = edSeatNo.Text; // 기존 좌석번호

		ls_oldMEMAGREEGUBUN = ds_ioTrainingJubsu.GetColumn(0, "TJMEMAGREEGUBUN");	//안전원회원가입동의

        medBarCode.Value = ds_ioTrainingJubsu.GetColumn(0, "BARCODE"); // 바코드
        
        ls_BIRTHDAY7 = ds_ioTrainingJubsu.GetColumn(0, "BIRTHDAY7"); // 생년월일7
        
        ls_PERSONKEY = ds_ioTrainingJubsu.GetColumn(0, "PERSONKEY"); // 개인식별번호
        
        medPersonKey.Value = ds_ioTrainingJubsu.GetColumn(0, "PERSONKEY"); // 개인식별번호
        
        ls_DI = ds_ioTrainingJubsu.GetColumn(0, "DI"); // DI값
        
        ls_CI = ds_ioTrainingJubsu.GetColumn(0, "CI"); // CI값
        
        ls_CIVER = ds_ioTrainingJubsu.GetColumn(0, "CIVER"); // CI버전

        // 실명인증 버튼 활성/비활성

        if (ds_ioTrainingJubsu.GetColumn(0, "BARCODE") == "Y") {

            btnAuthResidentNo.Enable = false;

        } else {

            btnAuthResidentNo.Enable = true;

        }

        // 최근사진

        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "IILASTREALNM"))) {

            imgLastestPicture.Text = "최근사진";

            imgLastestPicture.ImageID = NULL;

        } else {

            imgLastestPicture.Text = "";

            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioTrainingJubsu.GetColumn(0, "IILASTDIRPATH") + "/" + ds_ioTrainingJubsu.GetColumn(0, "IILASTREALNM");
            //imgLastestPicture.ImageID = ds_ioTrainingJubsu.GetColumn(0, "IIIMGLASTBINARY");

        }

        // 사진

        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "IIREALNM"))) {

            imgPicture.Text = "사진";
            
            imgPicture.ImageID = NULL;

        } else {

            imgPicture.Text = "";

            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioTrainingJubsu.GetColumn(0, "IIDIRPATH") + "/" + ds_ioTrainingJubsu.GetColumn(0, "IIREALNM");
            //imgPicture.ImageID = ds_ioTrainingJubsu.GetColumn(0, "IIIMGBINARY");

            ls_OldPictureNo = ds_ioTrainingJubsu.GetColumn(0, "IIIMGSEQ"); // 기존 사진번호

        }

        // 적요 처리

        //cbxRemarkGubun_OnChanged(cbxRemarkGubun, ds_ioTrainingJubsu.GetColumn(0, "REMARKCD"));


		// 민원서류 스캔등록
		
		if (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "N" ||
		
		    gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN"))) {

			// 교육원서
			if (ds_ioTrainingJubsu.GetColumn(0, "TOHSEQ") == 1) {
			
				if (ds_ioTrainingJubsu.GetColumn(0, "COURSECD") < "50") {	// 강습과정이면 강습원서 등록 미대상
				
					cbxForm.Index = 0;
					
					edFormResult.Text = "미대상";
					
				} else if (ds_ioTrainingJubsu.GetColumn(0, "COURSECD") == "51") { 	// 심폐소생술 교육원서
				
					cbxForm.Value = "0009";	// 심폐소생술 교육원서
					
					if (ds_ioTrainingJubsu.GetColumn(0, "ATC0009") == "0" ||
						ds_ioTrainingJubsu.GetColumn(0, "ATC0009") == "E") {
						
						edFormResult.Text = "미등록";
						
					} else {
			
						edFormResult.Text = "완료";
						
					}
					
				} else if (ds_ioTrainingJubsu.GetColumn(0, "COURSECD") == "50") { 	// 생활안전강사 교육원서
				
					cbxForm.Value = "0014";	// 생활안전강사 교육원서
					
					if (ds_ioTrainingJubsu.GetColumn(0, "ATC0014") == "0" ||
						ds_ioTrainingJubsu.GetColumn(0, "ATC0014") == "E") {
						
						edFormResult.Text = "미등록";
						
					} else {
			
						edFormResult.Text = "완료";
						
					}
				
				} else {
				
					cbxForm.Index = 0;
					
					edFormResult.Text = "미등록";
					
				}
			
			// 일정변경
			} else if (ds_ioTrainingJubsu.GetColumn(0, "TOHSEQ") > 1) {	// 일정변경이 있으면			
			
				cbxForm.Value = "0002";	// 일정변경신청서
				
				if (ds_ioTrainingJubsu.GetColumn(0, "ATC0002") == "0" ||
					ds_ioTrainingJubsu.GetColumn(0, "ATC0002") == "E") {
					
					edFormResult.Text = "미등록";
					
				} else {
		
					edFormResult.Text = "완료";
					
				}
					
			}
		
		// 환불
		} else if (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "Y") {
				
			if (ds_ioTrainingJubsu.GetColumn(0, "COURSECD") < "50") {
		
				cbxForm.Value = "0003";	// 강습 환불신청서
				
				if (ds_ioTrainingJubsu.GetColumn(0, "ATC0003") == "0" ||
					ds_ioTrainingJubsu.GetColumn(0, "ATC0003") == "E") {
					
					if (ds_ioTrainingJubsu.GetColumn(0, "TJHJUBSUGUBUN") == "2" ||
						ds_ioTrainingJubsu.GetColumn(0, "INETREPAYYN") == "Y") {	// 인터넷 환불인 경우 미대상
					
						edFormResult.Text = "미대상";
						
					} else {
					
						edFormResult.Text = "미등록";
					
					}
					
				} else {
		
					edFormResult.Text = "완료";
					
				}
				
			} else if (ds_ioTrainingJubsu.GetColumn(0, "COURSECD") == "51") {
			
				cbxForm.Value = "0011";	// 심폐소생술 환불신청서
				
				if (ds_ioTrainingJubsu.GetColumn(0, "ATC0011") == "0" ||
					ds_ioTrainingJubsu.GetColumn(0, "ATC0011") == "E") {
					
					if (ds_ioTrainingJubsu.GetColumn(0, "TJHJUBSUGUBUN") == "2") {	// 인터넷 환불인 경우 미대상
					
						edFormResult.Text = "미대상";
						
					} else {
					
						edFormResult.Text = "미등록";
					
					}
					
				} else {
		
					edFormResult.Text = "완료";
					
				}
			
			} else if (ds_ioTrainingJubsu.GetColumn(0, "COURSECD") == "50") {
			
				cbxForm.Value = "0016";	// 생활안전강사 환불신청서
				
				if (ds_ioTrainingJubsu.GetColumn(0, "ATC0016") == "0" ||
					ds_ioTrainingJubsu.GetColumn(0, "ATC0016") == "E") {
					
					if (ds_ioTrainingJubsu.GetColumn(0, "TJHJUBSUGUBUN") == "2") {	// 인터넷 환불인 경우 미대상
					
						edFormResult.Text = "미대상";
						
					} else {
					
						edFormResult.Text = "미등록";
					
					}
					
				} else {
		
					edFormResult.Text = "완료";
					
				}
			
			}

		} else {
				
			cbxForm.Index = 0;
			
			edFormResult.Text = "미대상";
		}
		
		if (edFormResult.Text == "미대상" || edFormResult.Text == "") {
		
			btnScan.Enable = false;
			btnScanSearch.Enable = false;
			btnScanSave.Enable = false;
			edFormResult.DisableBkColor = "user4";
		
		} else if (edFormResult.Text == "미등록") {
		
			btnScan.Enable = true;
			btnScanSearch.Enable = true;
			btnScanSave.Enable = true;
			edFormResult.DisableBkColor = "user37";
			
		} else if (edFormResult.Text == "완료") {
		
			edFormResult.DisableBkColor = "user4";
			
		}
		
		

        // 결제(POS) 버튼

        if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정

			// 콜센터 직원 사용 이면
			if (gs_IsCallCenter == "Y") {
				btnSetlmt.Enable = false; // 결제(POS) 버튼
			} else {
				btnSetlmt.Enable = true; // 결제(POS) 버튼
			}

        }


        lfn_SearchTrainingSetlmentHistList(); // 결제내역 조회

    } else {

        if (ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT") <= ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT")) {

            gfn_Alert("접수인원수를 초과하였습니다.");

        }



        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

        // 그리드 초기화

        ds_oJubsuAllInfo.ClearData();

        gdJubsuInfo.NoDataText = "";

        ds_oOrderHist.ClearData();

        gdOrderHist.NoDataText = "";

        ds_oSetlmentHist.ClearData();

        gdSetlmentHist.NoDataText = "";

        btnSetlmt.Enable = false; // 결제(POS) 버튼

        btnProcRct.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnPosResultList.Enable = false;

        btnChangeProcDate.Enable = false;

        btnPrintReRct.Enable = false;

		btnPrintReRctPDF.Enable = false;
		

        lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.
        
        radMemAgreeYN.Value = "N";	// 안전원회원가입동의
        
        if (radCourse.Value <> "50N") {	// 생활안전강사가 아니면 선불
        
			radAmountGubun.Value = "B";	// 선후불구분
			
        } else {	// 생활안전강사 이면 후불
        
			radAmountGubun.Value = "A";	// 선후불구분
			
		}

    }



    if (lb_BarcodeCheck) {

        lfn_SearchTrainingOrderMgno();

    }



    if (!gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

//////////////////////////////////////////////////////////////////////////

        if(serch_falg == "0") {

            if(gs_IsTlogin == "N") {

                lfn_SearchTrainingJubsuAllInfoList(); // 개인접수정보 조회

            } else {

                btnTraingJubsuinfo.Visible = true;

                ds_oJubsuAllInfo.Clear();

                ds_oOrderHist.Clear();

                

            }

        } else if (serch_falg == "1") {

    

        }

        serch_falg = "0";   // 플래그 값 초기화 하기

//////////////////////////////////////////////////////////////////////////



    }



    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부

        lfn_SetChangedJubsuInfo(false);

    }



    lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경

    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부

    edPersonNm.SetFocus();

    

///////////////////////////////////  


    if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medResidentNo.Value))) {

    ////////////////////////////////

        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 

        medResidentNo.Readonly = true;

        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 

        Button0.Enable = true;  // 접수자정보변경은 활성화 함

    ////////////////////////////////	


    } else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medResidentNo.Value))) {
    
        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 

        medResidentNo.Readonly = true;

        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 

        Button0.Enable = true;  // 접수자정보변경은 활성화 함    
    

    } else {

    ////////////////////////////////

        edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 

        medResidentNo.Readonly = false;

        btnSearchPersonInfo.Enable = true;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 

        Button0.Enable = false;  // 접수자정보변경은 활성화 함

    ////////////////////////////////

    

    }

    

///////////////////////////////////

    if(ds_ioTrainingJubsu.GetColumn(0, "AUTHYN") == "Y"){  // 이미 실명인증 되었으면 비활성화

        

        btnAuthResidentNo.Enable = false;

        btnAuthResidentNo.Text = "실명인증완료";

    } else {

        btnAuthResidentNo.Enable = true;

        btnAuthResidentNo.Text = "실명인증";

    } 

     
	edScanFileName.Text = "";	// 불러오기한 민원서류 스캔파일명
    

}



/*

 * 기능 : 강습접수자목록 팝업을 호출한다.

 * parameter : sOrderMgno - 회차관리번호

 *             sJubsuNo - 접수번호

 *             sLikeYn - LIKE 검색 여부

 * return value : 강습접수자목록 정보를 가진 배열 오브젝트

 */

function lfn_TrainingJubsuListPopup(sOrderMgno, sJubsuNo, sLikeYn) {

    var sArg = "sOrderMgno=" + quote(sOrderMgno);

    sArg += " sJubsuNo=" + quote(sJubsuNo);

    sArg += " sLikeYn=" + quote(sLikeYn);



    var arrTjmgno = Dialog(iif(gs_IsTlogin == "N", "training", "outerbiz") + "::frmtraining0021PTrainingJubsuList.xml", sArg, 600, 400, "", -1, -1);

    if (length(arrTjmgno) > 0) {

        ls_RetTjmgno = arrTjmgno[0];  // 접수관리번호

        lb_BarcodeCheck = true;

        lfn_SearchTrainingJubsuList();

    } else {

        ls_RetTjmgno = "";

    }

}



/*

 * 기능 : 빈번호를 조회한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_SearchUnUseJubsuNo(obj) {

    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }



    ds_oJubsuNo.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchUnUseTrainingJubsuNo", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oJubsuNo=ds_oJubsuNo"    // outDs

        ,"TOMGNO=" + quote(ms_TrainingMgno)

        ,"lfn_AfterSearchUnUseTrainingJubsuNo"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 빈번호 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchUnUseTrainingJubsuNo(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

    // 그리드 초기화

    ds_oJubsuAllInfo.ClearData();

    gdJubsuInfo.NoDataText = "";

    ds_oOrderHist.ClearData();

    gdOrderHist.NoDataText = "";

    ds_oSetlmentHist.ClearData();

    gdSetlmentHist.NoDataText = "";

    btnSetlmt.Enable = false; // 결제(POS) 버튼

    btnProcRct.Enable = false;

    btnShowVirtualAccount.Enable = false;

	btnPosResultList.Enable = false;

	btnChangeProcDate.Enable = false;

	btnPrintReRct.Enable = false;

	btnPrintReRctPDF.Enable = false;


    var ln_TotalCnt = ds_oJubsuNo.GetCount();

    if (ln_TotalCnt > 0) {

        for (var i = 1; i <= ln_TotalCnt; i++) {

            if (lpad(i, "0", 6) <> ds_oJubsuNo.GetColumn(i - 1, "TOHJUBSUNO")) {

                edJubsuNo.Text = lpad(i, "0", 6); // 접수번호

                lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.

                return true;

            }

        }

        edJubsuNo.Text = lpad((toNumber(ds_oTrainingOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 6); // 접수번호

    } else {

        edJubsuNo.Text = "000001"; // 접수번호

    }



    lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.

}



/*

 * 기능 : 빈좌석번호를 조회한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_SearchUnUseSeatNo(obj) {

    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }



    ds_oSeatNo.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchUnUseTrainingSeatNo", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oSeatNo=ds_oSeatNo"    // outDs

        ,"TOMGNO=" + quote(ms_TrainingMgno)

        ,"lfn_AfterSearchUnUseTrainingSeatNo"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 빈좌석번호 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchUnUseTrainingSeatNo(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    var ln_TotalCnt = ds_oSeatNo.GetCount();

    if (ln_TotalCnt > 0) {

        edSeatNo.Text = toNumber(ds_oSeatNo.GetColumn(0, "TOHDECISIONSEATNO")); // 접수좌석번호

    } else {

        edSeatNo.Text = 1; // 접수좌석번호

    }

    /////////////////// 빈번호 조회후 이름 주민번호 입력할 수 있게 해야 함

    edPersonNm.Readonly = false;

    medResidentNo.Readonly = false;

    btnSearchPersonInfo.Enable =true;

    Button0.Enable = false;

    ///////////////////

}



/*

 * 기능 : 좌석목록 팝업을 호출한다.

 * parameter : sOrderMgno - 회차관리번호

 * return value : 좌석목록 정보를 가진 배열 오브젝트

 */

function lfn_SearchUnUseSeatNoListPopup(sOrderMgno) {

    var sArg = "sOrderMgno=" + quote(sOrderMgno);

    var arrSeatNo = Dialog("training::frmtraining0023PTrainingSeatNoList.xml", sArg, 600, 400, "", -1, -1);

    if (length(arrSeatNo) > 0) {

 

        edSeatNo.Value = arrSeatNo[0];

    }

}


/*

 * 기능 : 안전원보유고객 정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchPersonInfo() {

    var arrTrainingPerson = gfn_PersonInfoListPopup(edPersonNm.Text, medResidentNo.Value); // 고객 조회 팝업

    if (length(arrTrainingPerson) > 0) {

        edPersonNm.text = arrTrainingPerson[0];

        medResidentNo.Value = arrTrainingPerson[33];	// 생년월일7
        
        ls_PERSONKEY = arrTrainingPerson[29];	// PERSONKEY 값
        
        medPersonKey.Value = arrTrainingPerson[29];	// PERSONKEY 값
        
        ls_DI = arrTrainingPerson[30];	// DI 값
        ls_CI = arrTrainingPerson[31];	// CI 값
        ls_CIVER = arrTrainingPerson[32];	// CI버전
		ls_BIRTHDAY7 = arrTrainingPerson[33];	// 생년월일7자리

        ms_TrainingPersonMgno = arrTrainingPerson[2];

        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", arrTrainingPerson[2]);

        edTel.Text = arrTrainingPerson[3];

        edHpTel.Text = arrTrainingPerson[4];

        edEmail.text = arrTrainingPerson[5];

        edEmailDomain.Value = arrTrainingPerson[6];

        ds_ioTrainingJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);

        medZipCode.Value = arrTrainingPerson[12];

        edAddr1.text = arrTrainingPerson[13];

        edAddr2.text = arrTrainingPerson[14];
        
        cbxAddrGubun.Value = iif(gfn_IsNull(arrTrainingPerson[17]), "0", arrTrainingPerson[17]) ;		// ADDRGUBUN
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRPNUCD", arrTrainingPerson[18]);	// TPRPNUCD
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRROADBUILDMGNO", arrTrainingPerson[19]);	// TPRROADBUILDMGNO
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRROADDETAIL", arrTrainingPerson[20]);	// TPRROADDETAIL
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRROADREMAIN", arrTrainingPerson[21]);	// TPRROADREMAIN
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRSANGUBUN", arrTrainingPerson[22]);	// TPRSANGUBUN
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRMAINBUNJI", arrTrainingPerson[23]);	// TPRMAINBUNJI
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRSUBBUNJI", arrTrainingPerson[24]);	// TPRSUBBUNJI
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRBUILDNM", arrTrainingPerson[25]);	// TPRBUILDNM
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRADDRETC", arrTrainingPerson[26]);	// TPRADDRETC
        
        if (arrTrainingPerson[17] == "1") {	// 주소구분이 도로명주소이면
        
			ds_ioTrainingJubsu.SetColumn(0, "TJRCONVPGM", arrTrainingPerson[27]);	// TPRCONVPGM
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRCONVSTATUS", arrTrainingPerson[28]);	// TPRCONVSTATUS

		}

        //실명인증 버튼

        var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부

        if (ls_AuthYn == "Y") {

            ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "Y");

            btnAuthResidentNo.Enable = false;

            edAddr1.SetFocus();

        } else {

            btnAuthResidentNo.Enable = true;

            btnAuthResidentNo_OnClick();

        }



        // 최근사진

        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ"))) {

            imgLastestPicture.Text = "최근사진";

            imgLastestPicture.ImageID = NULL;

        } else {

            imgLastestPicture.Text = "";

            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];
            //imgLastestPicture.ImageID = arrTrainingPerson[30];

        }
        
        // DI 값이 있으면 
        if (length(ls_DI) > 0) {
			
			if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medResidentNo.Value))) {
		
			////////////////////////////////
		
				edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
		
				medResidentNo.Readonly = true;
		
//				btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
		
				Button0.Enable = true;  // 접수자정보변경은 활성화 함
		
			////////////////////////////////	
		
		
			} else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medResidentNo.Value))) {
			
				edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
		
				medResidentNo.Readonly = true;
		
//				btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
		
				Button0.Enable = true;  // 접수자정보변경은 활성화 함    
			
		
			} else {
		
			////////////////////////////////
		
				edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
		
				medResidentNo.Readonly = false;
		
//				btnSearchPersonInfo.Enable = true;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
		
				Button0.Enable = false;  // 접수자정보변경은 활성화 함
		
			////////////////////////////////
		
			}
        }

    } else {

        medResidentNo.SetFocus();

    }



    lfn_CheckTrainingJubsuAlready(); // 기접수여부 조회

//    lfn_CheckTrainingJubsuEduIng(); // 교육중여부 조회

}


/*

 * 기능 : 접수자 기본 정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchPersonNm() {

    var arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medResidentNo.Value); // 고객 조회 팝업

    if (length(arrTrainingPerson) > 0) {

        edPersonNm.text = arrTrainingPerson[0];

        medResidentNo.Value = arrTrainingPerson[1];
        
        //medResidentNo.Value = arrTrainingPerson[29];

        ms_TrainingPersonMgno = arrTrainingPerson[2];

        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", arrTrainingPerson[2]);

        edTel.Text = arrTrainingPerson[3];

        edHpTel.Text = arrTrainingPerson[4];

        edEmail.text = arrTrainingPerson[5];

        edEmailDomain.Value = arrTrainingPerson[6];

        ds_ioTrainingJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);

        medZipCode.Value = arrTrainingPerson[12];

        edAddr1.text = arrTrainingPerson[13];

        edAddr2.text = arrTrainingPerson[14];
        
        cbxAddrGubun.Value = iif(gfn_IsNull(arrTrainingPerson[17]), "0", arrTrainingPerson[17]) ;		// ADDRGUBUN
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRPNUCD", arrTrainingPerson[18]);	// TPRPNUCD
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRROADBUILDMGNO", arrTrainingPerson[19]);	// TPRROADBUILDMGNO
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRROADDETAIL", arrTrainingPerson[20]);	// TPRROADDETAIL
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRROADREMAIN", arrTrainingPerson[21]);	// TPRROADREMAIN
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRSANGUBUN", arrTrainingPerson[22]);	// TPRSANGUBUN
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRMAINBUNJI", arrTrainingPerson[23]);	// TPRMAINBUNJI
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRSUBBUNJI", arrTrainingPerson[24]);	// TPRSUBBUNJI
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRBUILDNM", arrTrainingPerson[25]);	// TPRBUILDNM
        
        ds_ioTrainingJubsu.SetColumn(0, "TJRADDRETC", arrTrainingPerson[26]);	// TPRADDRETC
        
        if (arrTrainingPerson[17] == "1") {	// 주소구분이 도로명주소이면
        
			ds_ioTrainingJubsu.SetColumn(0, "TJRCONVPGM", arrTrainingPerson[27]);	// TPRCONVPGM
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRCONVSTATUS", arrTrainingPerson[28]);	// TPRCONVSTATUS

		}

        //실명인증 버튼

        var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부

        if (ls_AuthYn == "Y") {

            ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "Y");

            btnAuthResidentNo.Enable = false;

            edAddr1.SetFocus();

        } else {

            btnAuthResidentNo.Enable = true;

            btnAuthResidentNo_OnClick();

        }



        // 최근사진

        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ"))) {

            imgLastestPicture.Text = "최근사진";

            imgLastestPicture.ImageID = NULL;

        } else {

            imgLastestPicture.Text = "";

            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];
            //imgLastestPicture.ImageID = arrTrainingPerson[30];

        }

    } else {

        medResidentNo.SetFocus();

    }



    lfn_CheckTrainingJubsuAlready(); // 기접수여부 조회

    lfn_CheckTrainingJubsuEduIng(); // 교육중여부 조회

}



/*

 * 기능 : 개인접수정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchTrainingJubsuAllInfoList(obj) {

    ds_oJubsuAllInfo.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingJubsuAllInfoList", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oJubsuAllInfo=ds_oJubsuAllInfo" // outDs

        , "TPMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO")) // args

        , "lfn_AfterSearchTrainingJubsuAllInfoList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 개인접수정보 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

var ln_TotalGridInfoCount = 0;

function lfn_AfterSearchTrainingJubsuAllInfoList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    ln_TotalGridInfoCount = ds_oJubsuAllInfo.GetCount();



    gfn_SearchMessage(gdJubsuInfo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

	
	ds_oJubsuAllInfo.row = ds_oJubsuAllInfo.FindRow("TJMGNO", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));


    lfn_SearchTrainingOrderHistList(); // 회차변경이력 조회

}



/*

 * 기능 : 회차변경이력를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchTrainingOrderHistList(obj) {

    ds_oOrderHist.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingOrderHistList", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oOrderHist=ds_oOrderHist" // outDs

        , "TJMGNO=" + quote(ds_oJubsuAllInfo.GetColumn(ds_oJubsuAllInfo.currow, "TJMGNO")) // args

        , "lfn_AfterSearchTrainingOrderHistList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 회차변경이력 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

var ln_TotalGridOrderCount = 0;

function lfn_AfterSearchTrainingOrderHistList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if(serch_falg == "1") {

        gdOrderHist_OnCellClick(0,0,0,0,0);

    }



    ln_TotalGridOrderCount = ds_oOrderHist.GetCount();



    gfn_SearchMessage(gdOrderHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

}



/*

 * 기능 : 결제내역를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchTrainingSetlmentHistList(obj) {

    ds_oSetlmentHist.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingSetlmentHistList", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oSetlmentHist=ds_oSetlmentHist" // outDs

        , "TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args

        , "lfn_AfterSearchTrainingSetlmentHistList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 결제내역 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

var ln_TotalGridSetlementCount = 0;

function lfn_AfterSearchTrainingSetlmentHistList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVINFO") == "발행"){

        btnPosvath.Enable = true;

    } else {

        btnPosvath.Enable = false;

    }
    
	// 부가세 관리번호가 있고 // 직능 수수료금액보다 현재금액이 작을경우만 발행 가능
	if (!gfn_isNull(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMMGNO")) &&
	    (ds_oSetlmentHist.GetColumn(0, "TFCFEE") > ds_oSetlmentHist.GetColumn(0, "CURRENTAMOUNT")) &&
	    ds_oSetlmentHist.GetColumn(0, "CURRENTAMOUNT") > 0) {
	    
		btnEstimate.Enable = true;
		
	} else {
	
        btnEstimate.Enable = false;
	
	}

    ln_TotalGridSetlementCount = ds_oSetlmentHist.GetCount();

    if (ln_TotalGridSetlementCount == 0) {

        btnPosResultList.Enable = false;

        btnChangeProcDate.Enable = false;

        btnPrintReRct.Enable = false;
        
        btnPrintReRctPDF.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnPosvath.Enable = false;
        
        btnEstimate.Enable = false;

    }

    gfn_SearchMessage(gdSetlmentHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

}



/*

 * 기능 : 버튼 활성/비활성시킨다.

 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)

 * return : 없음

 */

function lfn_SetFormAuth(bStatus) {

    btnDelete.Enable = bStatus; // 삭제 버튼

    btnSave.Enable = bStatus; // 수정&저장 버튼
    
    // 콜센터 직원 사용 이면
	if (gs_IsCallCenter == "Y") {
		btnPrintScreen.Enable = false; // 화면출력 버튼
		btnChangeProcDate.Enable = false; // 처리일자 변경 버튼
		btnProcRct.Enable = false; // 현금영수증 처리 버튼
		btnAbsentManageLink.Enable = false; // 결강자 관리 버튼
		btnPictureManagement.Enable = false; // 사진관리 버튼
		btnSetlmt.Enable = false; // 결제 버튼
		btnPrintReRct.Enable = false; // 영수증재발행 버튼
	}

}



/*

 * 기능 : 접수자 기본 정보를 초기화한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_InitJubsuBaseInfo() {

    lfn_SetChangedJubsuInfo(true);

    ds_oTrainingJubsuResult.ClearData();



    ds_ioTrainingJubsu.ClearData();

    ds_ioTrainingJubsu.InsertRow(0);



    cbxEmailDomain.Value = "";

    //cbxRemarkGubun.Value = "";

    // 적요

    //edRemark.Text = "";

    //edRemark.Enable = false;
    
    
	ls_DI = "";			// SCI DI 값
	ls_CI = "";			// SCI CI 값
	ls_CIVER = "";		// SCI CI버전
	ls_PERSONKEY = "";	// PERSONKEY 값
	medPersonKey.Value = ""; // PERSONKEY 값
	ls_RESIDENTNO = "";	// 조회시 주민번호
	ls_BIRTHDAY7 = "";	// 생년월일7자리

    // 실명인증버튼

    lb_IsNiceCheckOk = false;

    btnAuthResidentNo.Text = "실명인증";

    btnAuthResidentNo.Enable = true;

    // 사진
	imgLastestPicture.ImageID = NULL;

    imgLastestPicture.Text = "최근사진";
    
    imgPicture.ImageID = NULL;

    imgPicture.Text = "사진";

    ds_ioTrainingJubsu.ApplyChange();



    ls_UploadRealName = ""; // 사진이미지 실제파일명

    lb_FileUpload = false; // 사진등록여부

    lb_BarcodeCheck = false; // 바코드로 조회 여부

    ls_OldSeatNo = ""; // 기존 좌석번호

    ls_OldPictureNo = ""; // 기존 사진번호

    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부

    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부

    ls_IsChangedPictureYn = "N"; // 사진 변경여부



    medBarCode.Value = ""; // 바코드


    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
    
    cbxForm.Index = 0;			// 민원서류 종류
    
    edFormResult.Text = "";		// 민원서류 등록여부
    
    edFormResult.DisableBkColor = "user4";
    
    edScanFileName.Text = "";	// 민원서류 불러오기한 파일
    
    hfImage2.CloseFile();		// 민원서류 파일객체

}



/*

 * 기능 : 강습접수자정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchTrainingPearsonMgno(obj) {

    ds_oTrainingPearson.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingPearsonMgno", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oTrainingPearson=ds_oTrainingPearson" // outDs

        , "TPNM=" + quote(edPersonNm.Text) // args

            + " BIRTHDAY=" + quote(substr(medResidentNo.Value,0,6)) // args
            
            + " HP=" + quote(edHpTel.Text) // args
            
            + " DI=" + quote(ls_DI) // args
            
        , ""

        ,false

        ,false

        ,true

    );



    if (ds_oTrainingPearson.GetCount() == 1) {

        ms_TrainingPersonMgno = ds_oTrainingPearson.getcolumn(0, "TPMGNO");

        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", ds_oTrainingPearson.getcolumn(0, "TPMGNO"));

    }

}



/*

 * 기능 : 회차변경된 정보 상태변경한다.

 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)

 * return : 없음

 */

function lfn_SetChangedJubsuInfo(bStatus) {

    if (bStatus) {

        shpGubunBox3.BkColor = "";

    } else {

        shpGubunBox3.BkColor = "user18";

    }



    if (bStatus && ms_FormAuth == "W") { // 권한에 따른 버튼 설정

        btnSave.Enable = true;

        btnDelete.Enable = true;

    } else {

        btnSave.Enable = false;

        btnDelete.Enable = false;

    }



    btnApplyPicture.Enable = bStatus; // 사진반영

    // btnCancel.Enable = bStatus; // 초기화

    // btnEnd.Enable = bStatus; // 종료

    // btnSearchPersonInfo.Enable = bStatus; // 기본정보

    btnSearchZipCode.Enable = bStatus; // 우편번호

    btnAuthResidentNo.Enable = bStatus; // 실명인증

    btnTrainingJubsuModify.Enable = bStatus; // 회차변경

    // btnSeqList.Enable = bStatus; // 접수목록

    // btnSearchTrainingOrder.Enable = bStatus; // 접수가능회차

    // btnTraingJubsuHist.Enable = bStatus; // 접수정보

    // btnSeatList.Enable = bStatus; // 좌석목록

    // btnSmsStat.Enable = bStatus; // SMS현황

    // btnEmailStat.Enable = bStatus; // 이메일현황

    btnSearchRegPicture.Enable = bStatus; // 등록사진조회

    // btnBarCodeSearch.Enable = bStatus; // 바코드조회

    // btnUnUseJubsuNo.Enable = bStatus; // 빈좌석

    btnLoadPicture.Enable = bStatus; // 사진찾기

    btnLoadScanPicture.Enable = bStatus; // 스캔사진불러오기

    btnScanPicture.Enable = bStatus; // 사진스캔

    // btnPictureManagement.Enable = bStatus; // 사진관리

    btnShowVirtualAccount.Enable = bStatus; // 가상계좌보기

    // btnModifyHistory.Enable = bStatus; // 변경이력

    //btnScan.Enable = bStatus; // 민원서류 스캔
    
    //btnScanSearch.Enable = bStatus; // 민원서류 스캔 불러오기

    // 콜센터 직원 사용 이면
	if (gs_IsCallCenter == "Y") {
	
		btnChangeProcDate.Enable = false; // 처리일자변경
	
		btnProcRct.Enable = false; // 현금영수증처리

		btnAbsentManageLink.Enable = false; // 결강관리
		
		btnPrintReRct.Enable = false; // 영수증재발행
		
	    btnSetlmt.Enable = false; // 결제(POS) 버튼
	    
	    btnScanSave.Enable = false; // 민원서류 저장 버튼
	    
	} else {
	
		btnChangeProcDate.Enable = bStatus; // 처리일자변경
	
		btnProcRct.Enable = bStatus; // 현금영수증처리
	
		btnAbsentManageLink.Enable = bStatus; // 결강관리

		btnPrintReRct.Enable = bStatus; // 영수증재발행
		
	    btnSetlmt.Enable = bStatus; // 결제(POS) 버튼
	    
	    //btnScanSave.Enable = bStatus; // 민원서류 저장 버튼
	
	}

    btnPrintReRctPDF.Enable = bStatus;	// 영수증재발행PDF

    // btnSendSms.Enable = bStatus; // SMS 전송

    // btnSendEmail.Enable = bStatus; // 이메일 전송

    btnPosResultList.Enable = bStatus; // POS처리결과조회

    
    


    btnPrintJubsu.Enable = bStatus; // 수강증출력 버튼

    btnPrint.Enable = bStatus; // 강습원서출력 버튼

    btnPrintJubsuResult.Enable = bStatus; // 강습접수결과출력 버튼



    // cbxJibu.Enable = bStatus;

    // edTrainingYear.Enable = bStatus;

    // radCourse.Enable = bStatus;

    // edTrainingOrder.Enable = bStatus;

    // edJubsuNo.Enable = bStatus;

    // edSeatNo.Enable = bStatus;

    // edPersonNm.Enable = bStatus;

    // medResidentNo.Enable = bStatus;

    // medBarCode.Enable = bStatus;



    edCompNm.Enable = bStatus;

    edAddr1.Enable = bStatus;

    edAddr2.Enable = bStatus;

    edTel.Enable = bStatus;

    edHpTel.Enable = bStatus;

    edEmail.Enable = bStatus;

    edEmailDomain.Enable = bStatus;

    cbxEmailDomain.Enable = bStatus;

    //edRemark.Enable = false;

    //cbxRemarkGubun.Enable = bStatus;

}



/*

 * 기능 : 업무 변경이력을 저장한다.

 * parameter : sGubun - 변경구분. 예) I, U, D

 * return : 없음

 */

function lfn_SaveModifyHistory(sGubun) {
	
	gds_iModifyHistory.ClearData();
	
    if (sGubun = "I") { // 신규

        gds_iModifyHistory.InsertRow(0);

        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분

        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oTrainingJubsuResult.GetColumn(0, "RESULTTJMGNO")); // KEY값

        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명

        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값

        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값

    } else if (sGubun = "D") { // 삭제

        gds_iModifyHistory.InsertRow(0);

        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분

        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // KEY값

        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명

        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값

        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값

    } else if (sGubun = "U") { // 수정

        var ln_TotalCount = ds_oModifyColumn.GetCount();

        var ls_ColumnCd = "";

        var ls_ColumnNm = "";

        for (var i = 0; i < ln_TotalCount; i++) {

            ls_ColumnCd = ds_oModifyColumn.GetColumn(i, "COLUMNCD");

            ls_ColumnNm = ds_oModifyColumn.GetColumn(i, "COLUMNNM");

            if (ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd) <> ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd)

                        && (!gfn_IsNull(ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd)) || !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd)))

                    ) {

                gds_iModifyHistory.InsertRow(0);

                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분

                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // KEY값

                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_ColumnNm); // 변경 컬럼명

				if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", substr(ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd),0,7)); // 변경 전 값
				} else {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd)); // 변경 전 값
				}

				if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", substr(ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd),0,7)); // 변경 후 값
				} else {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd)); // 변경 후 값
				}



                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부

            }

        }

        // 좌석번호 변경

        if (ls_OldSeatNo <> edSeatNo.Text) {

            gds_iModifyHistory.InsertRow(0);

            gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분

            gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

            gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // KEY값

            gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "좌석번호"); // 변경 컬럼명

            gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldSeatNo); // 변경 전 값

            gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", edSeatNo.Text); // 변경 후 값



            ls_IsChangedSeatNoYn = "Y"; // 좌석번호 변경여부

        }

        // 사진 변경

        if (lb_FileUpload || ls_OldPictureNo <> ds_ioTrainingJubsu.GetColumn(0, "IIIMGSEQ")) {

            if (lb_FileUpload) {

                ls_IsChangedPictureYn = "Y"; // 사진 변경여부

                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부

            } else {

                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부

            }

        }

    }



    gfn_InsertModifyHistory(); // 업무 변경이력을 저장한다.

}



/*

 * 기능 : 기접수여부를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_CheckTrainingJubsuAlready(obj) {

    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchCheckTrainingJubsuAlready", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs

        ,"TOMGNO=" + quote(ms_TrainingMgno)

            + " TPNM=" + quote(edPersonNm.Text)

            + " DI=" + quote(ls_DI)
            
            + " PERSONKEY=" + quote(ls_PERSONKEY)
            
            + " BIRTHDAY=" + quote(substr(medResidentNo.Value,7))

        ,"lfn_AfterSearchCheckTrainingJubsuAlready"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 기접수여부 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchCheckTrainingJubsuAlready(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oTrainingCheck.GetCount() > 0) {

        if (ds_oTrainingCheck.GetColumn(0, "TOHJUBSUGUBUN") == "1") { // 내방_인터넷구분(1:내방,2:인터넷)

            gfn_Alert("내방으로 이미 접수하셨습니다.");

        } else {

            gfn_Alert("인터넷으로 이미 접수/신청 하셨습니다.");

        }



        ls_RetTjmgno = ds_oTrainingCheck.GetColumn(0, "TJMGNO");  // 접수관리번호

        lb_BarcodeCheck = true;

        lfn_SearchTrainingJubsuList();

    }

}



/*

 * 기능 : 교육중여부를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_CheckTrainingJubsuEduIng(obj) {

    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchCheckTrainingJubsuEduIng", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs

        ,"TOMGNO=" + quote(ms_TrainingMgno)

            + " TPNM=" + quote(edPersonNm.Text)

            + " DI=" + quote(ls_DI)
            
            + " PERSONKEY=" + quote(ls_PERSONKEY)
            
            + " BIRTHDAY=" + quote(substr(medResidentNo.Value,7))

        ,"lfn_AfterSearchCheckTrainingJubsuEduIng"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 교육중여부 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchCheckTrainingJubsuEduIng(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oTrainingCheck.GetCount() > 0) {

        gfn_Alert("교육 중인 해당 직능의 다른 회차는 교육종료 후 접수가능하십니다.");

        ls_RetTjmgno = ds_oTrainingCheck.GetColumn(0, "TJMGNO");  // 접수관리번호

        lb_BarcodeCheck = true;

        lfn_SearchTrainingJubsuList();

    }

}



/*

 * 기능 : 수료한 교육이 있는지 조회한다.

 * parameter : 없음

 * Return : 있으면 true, 없으면 false

 */

function lfn_CheckTrainingJubsuEduPassed(obj) {

    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchCheckTrainingJubsuEduPassed", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs

        ,"COURSECD=" + quote(substr(radCourse.Value,0,2))

            + " TPNM=" + quote(edPersonNm.Text)

            + " DI=" + quote(ls_DI)
            
            + " PERSONKEY=" + quote(ls_PERSONKEY)
            
            + " BIRTHDAY=" + quote(left(medResidentNo.Value,6))
            
            + " HP=" + quote(edHpTel.Text)

        ,""

        ,false

        ,false

        ,true

    );



    if (ds_oTrainingCheck.GetCount() > 0) {

        return true;

    } else {

        return false;

    }

}



/*

 * 기능 : 수첩이 있는지 조회한다.

 * parameter : 없음

 * Return : 있으면 true, 없으면 false

 */

function lfn_CheckTrainingJubsuHaveSameCourseLcs(obj) {

    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchCheckTrainingJubsuHaveSameCourseLcs", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs

        ,"TOMGNO=" + quote(ms_TrainingMgno)

            + " TPNM=" + quote(edPersonNm.Text)
            
            + " DI=" + quote(ls_DI)

            + " PERSONKEY=" + quote(ls_PERSONKEY)

            + " TPMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))
            
            + " BIRTHDAY=" + quote(left(medResidentNo.Value,6))
            
            + " HP=" + quote(edHpTel.Text)

        ,""

        ,false

        ,false

        ,true

    );

    if (ds_oTrainingCheck.GetCount() > 0) {

        return true;

    } else {

        return false;

    }

}



/*

 * 기능 : 위험물안전관리자 수첩여부를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_CheckTrainingJubsuHaveLcs(obj) {

    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchCheckTrainingJubsuHaveLcs", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs

        ,"TPMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))

            + " TPNM=" + quote(edPersonNm.Text)

            + " DI=" + quote(ls_DI)

            + " PERSONKEY=" + quote(ls_PERSONKEY)

        ,"lfn_AfterSearchCheckTrainingJubsuHaveLcs"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 위험물안전관리자 수첩여부 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchCheckTrainingJubsuHaveLcs(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (!(ds_oTrainingCheck.GetColumn(0, "LCSCNT") > 0)) { // 소유 수첩이 없는 경우

        gfn_Alert("위험물안전관리자 수첩을 소유지 않아, 2급소방안전관리자 면제과정을 접수할 수 없습니다.");

        radCourse.Value = "22N";

        lfn_SearchTrainingLatestOrder();

    }

}



/*

 * 기능 : 소속지부 버튼 변경

 * parameter : 없음

 * return value : 없음

 */

function lfn_ChangeJibuRadioButton() {

	if (gds_oUserInfo.GetColumn(0, "PDEPTCD") == cbxJibu.Value) { // 소속지부

        cbxJibu.Enable = false;

        radJibuGubun.Value = "S";

        radJibuGubun.BkColor = "";

	} else { // 타지부

        cbxJibu.Enable = true;

        radJibuGubun.Value = "T";

        radJibuGubun.BkColor = "red";

	}

}



/* 사용자 이벤트 함수 */

function lfn_SortGrid2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {

    var lobj_Dataset = object(obj.BindDataset);

    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.

    if (lobj_Dataset.GetRowCount() > 1) {

 	    if (nCell > 0) {

            gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.

        }

    }

}



// 년도

function edTrainingYear_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) { // Enter key

        edTrainingOrder.SetFocus();

        

        //gfn_EnterNextFocus();

	} else {

        if (!gfn_IsNull(ms_TrainingMgno)) {

            ms_TrainingMgno = ""; // 강습관리번호

            // 시험정보

            lbTrainingInfo1.Text = "";

            lbTrainingInfo2.Text = "";



            edJubsuNo.Text = "";

            edSeatNo.Text = "";



            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

            // 그리드 초기화

            ds_oJubsuAllInfo.ClearData();

            gdJubsuInfo.NoDataText = "";

            ds_oOrderHist.ClearData();

            gdOrderHist.NoDataText = "";

            ds_oSetlmentHist.ClearData();

            gdSetlmentHist.NoDataText = "";

            btnSetlmt.Enable = false; // 결제(POS) 버튼

            btnProcRct.Enable = false;

            btnShowVirtualAccount.Enable = false;

            btnPosResultList.Enable = false;

            btnChangeProcDate.Enable = false;

            btnPrintReRct.Enable = false;
            
            btnPrintReRctPDF.Enable = false;

        }

	}

}



// 회차

function edTrainingOrder_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) { // Enter key

        btnSearchTrainingOrder.SetFocus();

        lfn_SearchTrainingOrderMgno(obj);

	} else {

        if (!gfn_IsNull(ms_TrainingMgno)) {

            ms_TrainingMgno = ""; // 강습관리번호
            

            // 시험정보

            lbTrainingInfo1.Text = "";

            lbTrainingInfo2.Text = "";



            edJubsuNo.Text = "";

            edSeatNo.Text = "";



            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

            // 그리드 초기화

            ds_oJubsuAllInfo.ClearData();

            gdJubsuInfo.NoDataText = "";

            ds_oOrderHist.ClearData();

            gdOrderHist.NoDataText = "";

            ds_oSetlmentHist.ClearData();

            gdSetlmentHist.NoDataText = "";

            btnSetlmt.Enable = false; // 결제(POS) 버튼

            btnProcRct.Enable = false;

            btnShowVirtualAccount.Enable = false;

            btnPosResultList.Enable = false;

            btnChangeProcDate.Enable = false;

            btnPrintReRct.Enable = false;

			btnPrintReRctPDF.Enable = false;

        }

	}     

}



function edTrainingOrder_OnKillFocus(obj) {

    gfn_ComponentOnKillFocus(obj);



    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));



    lfn_SearchTrainingOrderMgno(); // 강습정보를 조회한다.

}



// 접수가능회차

function btnSearchTrainingOrder_OnClick(obj) {

    var arrTrainingOrder = gfn_TrainingOrderListPopup("Y", cbxJibu.Value, edTrainingYear.Text, radCourse.Value); // 교육일정관리목록 조회 팝업

    if (length(arrTrainingOrder) > 0) {

        ms_TrainingMgno = arrTrainingOrder[0];

        cbxJibu.Value = arrTrainingOrder[1];

        edTrainingYear.Text = arrTrainingOrder[2];

        radCourse.Value = arrTrainingOrder[3];

        edTrainingOrder.Text = arrTrainingOrder[4];

        lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경



        lfn_SearchTrainingOrderMgno(); // 강습회차관리번호를 조회한다.

    } else {

        lfn_cancel();

    }

}



// 접수번호

function edJubsuNo_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) { // Enter key

        btnSeqList.SetFocus();

        lfn_SearchTrainingJubsuList(obj);

	}

}



function edJubsuNo_OnKillFocus(obj) {

    gfn_ComponentOnKillFocus(obj);



    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 6));

}



// 접수목록

function btnSeqList_OnClick(obj) {



    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }



    lfn_TrainingJubsuListPopup(ms_TrainingMgno, edJubsuNo.Text, iif(gfn_IsNull(edJubsuNo.Text), "", "Y")); // 교육접수자목록 조회 팝업

}



// 좌석목록

function btnSeatList_OnClick(obj) {

    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }



    lfn_SearchUnUseSeatNoListPopup(ms_TrainingMgno); // 빈좌석번호를 조회한다.

    

}



// 결강자관리

function btnAbsentManageLink_OnClick(obj) {

    var ArrMenuInfo = gfn_SearchMenuInfo("training", "training::frmtraining0040MTrainingAbsentManagement.xml");	//메뉴정보조회

    if(length(ArrMenuInfo) > 0 ) {

        ls_SystemGubun = arrMenuInfo[7];                      //"training";

        gs_SystemMenuId = arrMenuInfo[5];                     //"0000000003";

        global.mnuLeft.tabMenu.tabpgMenu.Text = arrMenuInfo[6];	 //"강습관리";

        var ls_MenuId = arrMenuInfo[0];                          //"0000000043";

        var ls_MenuTitle = arrMenuInfo[1];                       //"결강자관리";

        var ls_MenuUrl = arrMenuInfo[2];             //"training::frmtraining0040MTrainingAbsentManagement.xml";

    

        global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", ls_SystemGubun);

        gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId);

    } else {

			gfn_Alert("해당 메뉴를 찾을 수 없습니다.");

		}

}



// 회차변경

function btnTrainingJubsuModify_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        edJubsuNo.SetFocus();

        return false;

    }


//    if (left(GetDAte(), 8) > ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE")) {

//        gfn_Alert("교육시작일이 지나서 회차변경하실 수 없습니다.");

//        return false;

//    }

    if (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") <> "N") { // 수납상태가 아니면

        gfn_Alert("수납 상태가 아니므로 회차변경할 수 없습니다.");

		// 시스템관리자만 변경 허용
		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
		
			return false;
			
		}

    }

    // 2009.10.09 이길호 주임 요청

    if ((ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "13"

            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "23"

            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "15"

            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "25") // 가상계좌이면서

            && (ds_oSetlmentHist.GetColumn(0, "TSSETLMTYN") == "N")) { // 결제여부가 'N'인 경우

        gfn_Alert("가상계좌 결제처리 중 입니다.");

        return false;

    }
    
    // 사이버교육일 경우
    if (radCourse.Value == "20C") {
        // 사이버교육을 수료한 경우에는 일정변경 불가(환불조치)
		lfn_CyberPassCheck();
		
		if (ds_oCyberPass.GetColumn(0, "CPPASSSTATUS") = "수료") { // 진행, 수료, 미수료
		
			gfn_Alert("사이버교육을 수료한 경우에는 일정변경 하실 수 없습니다. 환불만 가능합니다.");
			
			return false;
		
		}
	}


    var sArg = "sJibu=" + quote(cbxJibu.Text);

    sArg += " sJibuCd=" + quote(cbxJibu.Value);

    sArg += " sCourse=" + quote(ds_oCourse.GetColumn(ds_oCourse.FindRow("CD", radCourse.Value), "DATA"));

    sArg += " sCourseCd=" + quote(radCourse.Value);

    sArg += " sYear=" + quote(edTrainingYear.Text);

    sArg += " sOrder=" + quote(edTrainingOrder.Text);

    sArg += " sTjmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));

    sArg += " sTomgno=" + quote(ms_TrainingMgno);


    return Dialog("training::frmtraining0022PTrainingOrderChange.xml", sArg, 800, 400, "", -1, -1);



    lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경

}



// 성명

function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

   if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면

        if (nChar == 13) {

            btnAuthResidentNo.SetFocus();

            //lfn_SearchPersonNm();
            lfn_SearchPersonInfo();

        } else {

            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

                lfn_ResetPerson();

                medResidentNo.Value = "";

            }

        }

    }

}



// 기본정보

function btnSearchPersonInfo_OnClick(obj) {

    //lfn_SearchPersonNm();
    lfn_SearchPersonInfo();

}



// 주민등록번호

function medResidentNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {

    if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13)){ // (Ctrl + C)가 아니면

        if (nChar == 13) {

			if(ds_ioTrainingJubsu.GetColumn(0, "AUTHYN") != "Y"){  // 이미 실명인증 되었으면 실명인증 안함

				btnAuthResidentNo.SetFocus();
	
			    if (!gfn_IsNull(edPersonNm.Text) && !gfn_IsNull(medResidentNo.Value)) {	// 성명&주민번호 입력한 경우
    
					if (length(medResidentNo.Value) < 13) {	// 주민번호가 13자리가 아니면
						
						lfn_SearchPersonInfo();		// 안전원고객정보 조회
						
					} else {
					
						ls_RESIDENTNO = medResidentNo.Value;
	
						btnAuthResidentNo_OnClick(); // 실명인증					
					
					}
				} else {
					
					lfn_SearchPersonInfo();		// 안전원고객정보 조회
					
				}

			} else {
			
				//lfn_SearchPersonNm();			
				lfn_SearchPersonInfo();
			
			}

        } else {
        
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

                lfn_ResetPerson();

            }

        }

    }

}



function lfn_ResetPerson() {

    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부



    lfn_SetChangedJubsuInfo(true);

    ds_ioTrainingJubsu.SetColumn(0, "TJMGNO", ""); // 접수관리번호

    ms_TrainingPersonMgno = "";

    ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", "");

    medZipCode.Value = "";

    edAddr1.Text = "";

    edAddr2.Text = "";

    edCompNm.Text = "";

    edTel.Text = "";

    edHpTel.Text = "";

    edEmail.text = "";

    edEmailDomain.Value = "";

    ds_ioTrainingJubsu.SetColumn(0, "LASTIMGSEQ", "");



    //실명인증 버튼

    btnAuthResidentNo.Text = "실명인증";

    btnAuthResidentNo.Enable = true;

    ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "");



    // 최근사진

    imgLastestPicture.Text = "최근사진";

    imgLastestPicture.ImageID = NULL;



    // 그리드 초기화

    ds_oJubsuAllInfo.ClearData();

    gdJubsuInfo.NoDataText = "";

    ds_oOrderHist.ClearData();

    gdOrderHist.NoDataText = "";

    ds_oSetlmentHist.ClearData();

    gdSetlmentHist.NoDataText = "";

    btnSetlmt.Enable = false; // 결제(POS) 버튼

    btnProcRct.Enable = false;

    btnShowVirtualAccount.Enable = false;

    btnPosResultList.Enable = false;

    btnChangeProcDate.Enable = false;

    btnPrintReRct.Enable = false;
    
    btnPrintReRctPDF.Enable = false;

}


function check_mem() {

	if(edPersonNm.Text == "") {
		gfn_Alert("이름을 입력해 주십시요.");
		edPersonNm.SetFocus();
		return false;
	}
	
	if(medResidentNo.Value == "") {
		gfn_Alert("주민번호를 입력해 주십시요.");
		medResidentNo.SetFocus();
		return false;
	}
	
	if(Length(medResidentNo.Value) != 13) {
		gfn_Alert("주민번호에 오류가 있습니다. 다시 확인하여 주십시오.");
		medResidentNo.SetFocus();
		return false;
	}

}

// 실명인증

var lb_IsNiceCheckOk = false;

function btnAuthResidentNo_OnClick(obj) {

    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medResidentNo.Value)) {
        gfn_Alert("성명과 주민번호를 입력해 주십시오.");
        return false;
    }
    
    if (length(medResidentNo.Value) < 13) {
        gfn_Alert("주민번호 자리수가 맞지 않습니다.");
        return false;
    }
/*
    if (gfn_IsNull(ds_oTrainingPearson.getcolumn(0, "TPMGNO"))) {

        lfn_SearchTrainingPearsonMgno(); // 강습자정보를 조회한다.

    }
*/
/*
	Https.Sync = true;  
	gfn_CheckSCI(edPersonNm.Text, medResidentNo.Value); // 실명인증
	//alert(gds_ioSciCheck.GetColumn(0, "STRRESULT"));
	Https.Sync = false;  
*/	
	// 실명인증 및 personkey 조회
	ls_PERSONKEY = gfn_SearchPERSONKEY(edPersonNm.Text, medResidentNo.Value, replace(edHpTel.Text,"-",""));
	medPersonKey.Value = ls_PERSONKEY; // PERSONKEY 값
	ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
	ls_CI = gds_ioSciCheck.GetColumn(0, "STRCI");
	ls_CIVER = gds_ioSciCheck.GetColumn(0, "STRVER");
		
	if (gds_ioSciCheck.GetColumn(0, "STRRESULT") == "1") {

        btnAuthResidentNo.Text = "실명인증완료";

        btnAuthResidentNo.Enable = false;

        ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "Y");

        edAddr1.SetFocus();


        ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함

        lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
        
        ls_PERSONKEY = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY");
        medPersonKey.Value = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY"); // PERSONKEY 값

//ALERT(ls_DI + "    " +ls_CI+ "    " +ls_CIVER+ "    " +ls_PERSONKEY);
        //////////////////
        
        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", ds_ioTrainingPerson.GetColumn(0, "TPMGNO"));

        ds_ioTrainingJubsu.SetColumn(0, "LASTIMGSEQ", ds_ioTrainingPerson.GetColumn(0, "TPLASTIMGSEQ"));

        ds_ioTrainingJubsu.SetColumn(0, "ZIPCD", ds_ioTrainingPerson.GetColumn(0, "TPZIPCD"));
        
       // medZipCode.Text = ds_ioTrainingPerson.GetColumn(0, "TPZIPCD");
       
        cbxAddrGubun.Value = ds_ioTrainingPerson.GetColumn(0, "TPADDRGUBUN");

        edAddr1.Text = iif(ds_ioTrainingPerson.GetColumn(0, "TPADDRGUBUN") == "0",
							ds_ioTrainingPerson.GetColumn(0, "TPADDR1"), ds_ioTrainingPerson.GetColumn(0, "TPROADADDR1"));

        edAddr2.Text = iif(ds_ioTrainingPerson.GetColumn(0, "TPADDRGUBUN") == "0",
							ds_ioTrainingPerson.GetColumn(0, "TPADDR2"), ds_ioTrainingPerson.GetColumn(0, "TPROADADDR2"));

        edTel.Text = ds_ioTrainingPerson.GetColumn(0, "TPTEL");

        edHpTel.Text = ds_ioTrainingPerson.GetColumn(0, "TPHPTEL");

        edEmail.Text = ds_ioTrainingPerson.GetColumn(0, "TPEMAILID");

        edEmailDomain.Text = ds_ioTrainingPerson.GetColumn(0, "TPEMAILDOMAIN");

        

        // 최근사진

        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ"))) {

            imgLastestPicture.Text = "최근사진";

            imgLastestPicture.ImageID = NULL;

        } else {

            imgLastestPicture.Text = "";

            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioTrainingPerson.GetColumn(0, "IIDIRPATH") + "/" + ds_ioTrainingPerson.GetColumn(0, "IIREALNM");
            //imgLastestPicture.ImageID = ds_ioTrainingPerson.GetColumn(0, "IIIMGLASTBINARY");

        }

        ////////////////////////////////

    } else {
    
		gfn_Alert(gds_ioSciCheck.GetColumn(0, "STRCI2"));
    
		ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "N");

		if (length(ls_DI) > 0) {
			lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
			ls_PERSONKEY = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY");
			medPersonKey.Value = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY");
		}
        

        btnAuthResidentNo.Text = "실명인증";

        btnAuthResidentNo.Enable = true;

        medResidentNo.SetFocus();

    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        if (radCourse.Value == "22Y") { // 2급소방안전관리자 면제과정이면

            lfn_CheckTrainingJubsuHaveLcs(); // 위험물안전관리자 수첩여부를 조회

        }

        lfn_CheckTrainingJubsuAlready(); // 기접수여부 조회

        lfn_CheckTrainingJubsuEduIng(); // 교육중여부 조회

    }
  
}



// 저장시 실명인증

var lb_IsNiceCheckOk = false;

function lfn_AuthResidentNo() {

    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medResidentNo.Value)) {
        gfn_Alert("성명과 주민번호를 입력해 주십시오.");
        return false;
    }
    
    if (length(medResidentNo.Value) < 13) {
        gfn_Alert("주민번호 자리수가 맞지 않습니다.");
        return false;
    }
/*
    if (gfn_IsNull(ds_oTrainingPearson.getcolumn(0, "TPMGNO"))) {

        lfn_SearchTrainingPearsonMgno(); // 강습자정보를 조회한다.

    }
*/
/*
	Https.Sync = true;  
	gfn_CheckSCI(edPersonNm.Text, medResidentNo.Value); // 실명인증
	//alert(gds_ioSciCheck.GetColumn(0, "STRRESULT"));
	Https.Sync = false;  
*/	
	// 실명인증 및 personkey 조회
	ls_PERSONKEY = gfn_SearchPERSONKEY(edPersonNm.Text, medResidentNo.Value, replace(edHpTel.Text,"-",""));
	medPersonKey.Value = ls_PERSONKEY; // PERSONKEY 값
	ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
	ls_CI = gds_ioSciCheck.GetColumn(0, "STRCI");
	ls_CIVER = gds_ioSciCheck.GetColumn(0, "STRVER");
		
	if (gds_ioSciCheck.GetColumn(0, "STRRESULT") == "1") {

        btnAuthResidentNo.Text = "실명인증완료";

        btnAuthResidentNo.Enable = false;

        ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "Y");

        edAddr1.SetFocus();


        ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함

        lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
        
        ls_PERSONKEY = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY");

        medPersonKey.Value = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY"); // PERSONKEY 값

        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", ds_ioTrainingPerson.GetColumn(0, "TPMGNO"));


        ////////////////////////////////

    } else {
    
		ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "N");

		if (length(ls_DI) > 0) {
			lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
			ls_PERSONKEY = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY");
			medPersonKey.Value = ds_ioTrainingPerson.GetColumn(0, "PERSONKEY");
		}
        

        btnAuthResidentNo.Text = "실명인증";

        btnAuthResidentNo.Enable = true;

        medResidentNo.SetFocus();

    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        if (radCourse.Value == "22Y") { // 2급소방안전관리자 면제과정이면

            lfn_CheckTrainingJubsuHaveLcs(); // 위험물안전관리자 수첩여부를 조회

        }

        lfn_CheckTrainingJubsuAlready(); // 기접수여부 조회

        lfn_CheckTrainingJubsuEduIng(); // 교육중여부 조회

    }
  
}


// 접수정보

function btnTraingJubsuHist_OnClick(obj) {

    if (gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medResidentNo.Value)) {

        gfn_Alert("성명이나 주민등록번호를 입력해 주십시오.");

        edPersonNm.SetFocus();

        return false;

    }


    var sArg = "sPersonNm=" + quote(edPersonNm.Text);

    sArg += " sBirthday=" + quote(medResidentNo.Value);
    
    sArg += " sPersonkey=" + quote(ls_PERSONKEY);
    
    sArg += " sDI=" + quote(ls_DI);
    
    sArg += " sHP=" + quote(edHpTel.Text);

    var arrTjmgno = Dialog( iif(gs_IsTlogin == "N", "training", "outerbiz") + "::frmtraining0024PTrainingJubsuHistList.xml", sArg, 600, 400, "", -1, -1);

    if (length(arrTjmgno) > 0) {

        ls_RetTjmgno = arrTjmgno[0];  // 접수관리번호

        lb_BarcodeCheck = true;

        lfn_SearchTrainingJubsuList();

    } else {

        ls_RetTjmgno = "";

    }

}



// 변경이력

function btnModifyHistory_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        return false;

    }



	gfn_ModifyHistoryListPopup("강습접수", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));

}



// 우편번호

function edZipCode_OnFocus(obj) {



    btnSearchZipCode.SetFocus();

}



// 우편번호

function btnSearchZipCode_OnClick(obj) {

	// 지번주소/도로명주소 조회 팝업
	var arrAddrInfo = gfn_PostRoadListPopup(cbxJibu.Value		// 지부코드
											, ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")		// 구새주소 구분[0:구주소, 1:새주소]
											, ds_ioTrainingJubsu.GetColumn(0, "ZIPCD")			// 구:지번 우편번호
											, ds_ioTrainingJubsu.GetColumn(0, "ADDR1")		// 구:지번주소1
											, ds_ioTrainingJubsu.GetColumn(0, "ADDR2")		// 구:지번주소2
											, ds_ioTrainingJubsu.GetColumn(0, "TJRSANGUBUN")		// 구:산여부
											, ds_ioTrainingJubsu.GetColumn(0, "TJRMAINBUNJI")	// 구:주번지
											, ds_ioTrainingJubsu.GetColumn(0, "TJRSUBBUNJI")		// 구:부번지
											, ds_ioTrainingJubsu.GetColumn(0, "TJRBUILDNM")		// 구:아파트,건물명
											, ds_ioTrainingJubsu.GetColumn(0, "TJRADDRETC")	// 구:상세주소
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ZIPCD"))	// 새1:도로명 우편번호
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR1"))		// 새1:도로명주소11
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR2"))		// 새1:도로명주소12
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADBUILDMGNO"))	// 새1:건물관리번호1
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADDETAIL"))	// 새1:상세주소1
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADREMAIN"))		// 새1:부가주소1
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ZIPCD"))	// 새2:도로명 우편번호
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR1"))		// 새2:도로명주소21
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR2"))		// 새2:도로명주소22
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADBUILDMGNO"))	// 새2:건물관리번호2
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADDETAIL"))	// 새2:상세주소2
											, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADREMAIN"))	// 새2:부가주소2
											); 

    if (length(arrAddrInfo) > 0) {

		if (arrAddrInfo[0] == 0) {
			
			/* 지번주소 조회 Tab */
			// 구주소
			ds_ioTrainingJubsu.SetColumn(0, "TJADDRGUBUN", "0");
			
			medZipCode.Value = arrAddrInfo[1];
	
			edAddr1.Text = arrAddrInfo[2];
	
			edAddr2.Text = arrAddrInfo[3];
			
			if (arrAddrInfo[11] <> "") {
				
				// 새주소
				ds_ioTrainingJubsu.SetColumn(0, "TJADDRGUBUN", "1");
				
				medZipCode.Value = arrAddrInfo[10];
				
				edAddr1.Text = arrAddrInfo[11];
				
				edAddr2.Text = arrAddrInfo[12];
				
			}
		 
			ds_ioTrainingJubsu.SetColumn(0, "TJRPNUCD", arrAddrInfo[9]);		// PNU 코드
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
				   
			ds_ioTrainingJubsu.SetColumn(0, "TJRSANGUBUN", arrAddrInfo[4]);
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRMAINBUNJI", arrAddrInfo[5]);
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRSUBBUNJI", arrAddrInfo[6]);
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRBUILDNM", arrAddrInfo[7]);
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRADDRETC", arrAddrInfo[8]);
			
			if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
			
				ds_ioTrainingJubsu.SetColumn(0, "TJRCONVPGM", "1");
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRCONVSTATUS", "01");
			
			};
			
		} else {
		
			/* 도로명주소 조회 Tab */
			
			ds_ioTrainingJubsu.SetColumn(0, "TJADDRGUBUN", "1");
		
			medZipCode.Value = arrAddrInfo[10];	// 우편번호
	
			edAddr1.Text = arrAddrInfo[11];		// 도로명주소1
	
			edAddr2.Text = arrAddrInfo[12];		// 도로명주소2
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRSANGUBUN", arrAddrInfo[4]);		// 산여부
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRMAINBUNJI", arrAddrInfo[5]);		// 주번지
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRSUBBUNJI", arrAddrInfo[6]);		// 부번지
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRPNUCD", arrAddrInfo[9]);			// PNU 코드
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
			
			ds_ioTrainingJubsu.SetColumn(0, "TJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
	
			if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
			
				ds_ioTrainingJubsu.SetColumn(0, "TJRCONVPGM", "1");
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRCONVSTATUS", "01");
			
			};
	
		}

    }



}



// 주소1

function edAddr1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

    if (nChar == 13) {

		// 지번주소/도로명주소 조회 팝업
		var arrAddrInfo = gfn_PostRoadListPopup(cbxJibu.Value		// 지부코드
												, ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")		// 구새주소 구분[0:구주소, 1:새주소]
												, ds_ioTrainingJubsu.GetColumn(0, "ZIPCD")			// 구:지번 우편번호
												, ds_ioTrainingJubsu.GetColumn(0, "ADDR1")		// 구:지번주소1
												, ds_ioTrainingJubsu.GetColumn(0, "ADDR2")		// 구:지번주소2
												, ds_ioTrainingJubsu.GetColumn(0, "TJRSANGUBUN")		// 구:산여부
												, ds_ioTrainingJubsu.GetColumn(0, "TJRMAINBUNJI")	// 구:주번지
												, ds_ioTrainingJubsu.GetColumn(0, "TJRSUBBUNJI")		// 구:부번지
												, ds_ioTrainingJubsu.GetColumn(0, "TJRBUILDNM")		// 구:아파트,건물명
												, ds_ioTrainingJubsu.GetColumn(0, "TJRADDRETC")	// 구:상세주소
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ZIPCD"))	// 새1:도로명 우편번호
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR1"))		// 새1:도로명주소11
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR2"))		// 새1:도로명주소12
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADBUILDMGNO"))	// 새1:건물관리번호1
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADDETAIL"))	// 새1:상세주소1
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADREMAIN"))		// 새1:부가주소1
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ZIPCD"))	// 새2:도로명 우편번호
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR1"))		// 새2:도로명주소21
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "ADDR2"))		// 새2:도로명주소22
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADBUILDMGNO"))	// 새2:건물관리번호2
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADDETAIL"))	// 새2:상세주소2
												, iif(ds_ioTrainingJubsu.GetColumn(0, "TJADDRGUBUN")=="0", "", ds_ioTrainingJubsu.GetColumn(0, "TJRROADREMAIN"))	// 새2:부가주소2
												); 
	
		if (length(arrAddrInfo) > 0) {
	
			if (arrAddrInfo[0] == 0) {
				
				/* 지번주소 조회 Tab */
				// 구주소
				ds_ioTrainingJubsu.SetColumn(0, "TJADDRGUBUN", "0");
				
				medZipCode.Value = arrAddrInfo[1];
		
				edAddr1.Text = arrAddrInfo[2];
		
				edAddr2.Text = arrAddrInfo[3];
				
				if (arrAddrInfo[11] <> "") {
					
					// 새주소
					ds_ioTrainingJubsu.SetColumn(0, "TJADDRGUBUN", "1");
					
					medZipCode.Value = arrAddrInfo[10];
					
					edAddr1.Text = arrAddrInfo[11];
					
					edAddr2.Text = arrAddrInfo[12];
					
				}
			 
				ds_ioTrainingJubsu.SetColumn(0, "TJRPNUCD", arrAddrInfo[9]);		// PNU 코드
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
					   
				ds_ioTrainingJubsu.SetColumn(0, "TJRSANGUBUN", arrAddrInfo[4]);
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRMAINBUNJI", arrAddrInfo[5]);
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRSUBBUNJI", arrAddrInfo[6]);
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRBUILDNM", arrAddrInfo[7]);
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRADDRETC", arrAddrInfo[8]);
				
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioTrainingJubsu.SetColumn(0, "TJRCONVPGM", "1");
					
					ds_ioTrainingJubsu.SetColumn(0, "TJRCONVSTATUS", "01");
				
				};
				
			} else {
			
				/* 도로명주소 조회 Tab */
				
				ds_ioTrainingJubsu.SetColumn(0, "TJADDRGUBUN", "1");
			
				medZipCode.Value = arrAddrInfo[10];	// 우편번호
		
				edAddr1.Text = arrAddrInfo[11];		// 도로명주소1
		
				edAddr2.Text = arrAddrInfo[12];		// 도로명주소2
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRSANGUBUN", arrAddrInfo[4]);		// 산여부
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRMAINBUNJI", arrAddrInfo[5]);		// 주번지
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRSUBBUNJI", arrAddrInfo[6]);		// 부번지
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRPNUCD", arrAddrInfo[9]);			// PNU 코드
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioTrainingJubsu.SetColumn(0, "TJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
		
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioTrainingJubsu.SetColumn(0, "TJRCONVPGM", "1");
					
					ds_ioTrainingJubsu.SetColumn(0, "TJRCONVSTATUS", "01");
				
				};

		
			}
	
        } else {

            edAddr1.SetFocus();

        }

    }

}



// E-Mail

function cbxEmailDomain_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

    if (strText == "직접입력") {

        edEmailDomain.Enable = true;

        edEmailDomain.Value = "";

        edEmailDomain.SetFocus();

    } else {

        edEmailDomain.Value = cbxEmailDomain.Value;

        edEmailDomain.SetFocus();

    }

}



// SMS발송

function btnSendSms_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");

        return false;

    }

    if (gfn_IsNull(edHpTel.Text)) {

        gfn_Alert("발송할 휴대폰번호가 존재하지 않습니다.");

        return false;

    }


	// gfn_KTSendOneSmsPopup(sMBCCD, sMPK1, sMPK2, sMPK3, sMBSMGNO, sMRECVNM, sMRECVTEL, sMTITLE, sMMSG);
    var arrSms = gfn_KTSendOneSmsPopup("101" // 강습-접수

                    , ds_ioTrainingJubsu.GetColumn(0, "TOMGNO")

                    , ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")

                    , ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO")
                    
                    , ""
                    
                    , edPersonNm.Text
                    
                    , edHpTel.Text
                    
                    , "한국소방안전원"

                    , radCourse.Text +" 강습교육이 접수되었습니다.\n"+"*"+substr(lbTrainingInfo2.text,1)+
                      "\n*교육장소:"+ds_ioTrainingJubsu.GetColumn(0, "EPNM")

                ); // 단일문자메시지발송 팝업

}



// 적요
/*
function cbxRemarkGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

    if (gfn_IsNull(strCode)) {

        cbxRemarkGubun.Value = "";

        edRemark.Enable = false;

        edRemark.Text = "";

    } else {

        edRemark.Enable = true;

    }

}

*/


// 결제(POS)

function btnSetlmt_OnClick(obj) {

    // 2009.10.01 이길호 주임 요청

    if ((ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "13"

            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "23"

            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "15"

            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "25") // 가상계좌이면서

            && (ds_oSetlmentHist.GetColumn(0, "TSSETLMTYN") == "N")) { // 결제여부가 'N'인 경우

        gfn_Alert("가상계좌 결제처리 중 입니다.");

        return false;

    }

/////////////////  결제의 마지막 정보가 현금으로 선수납을 부분환불 할 경우 더이상 진행 안되도록 막음  

    if(ds_oSetlmentHist.GetColumn(0, "TSREPAYCD") == 'S' 

     ||ds_oSetlmentHist.GetColumn(0, "TSREPAYCD") == 'M') {

        gfn_Alert("선수납한 수첩교부(혹은 시험응시) 수수료를 부분환불이 아닌 현금으로 직접 환불시에는\n\n "

            + "                      더 이상 결제과정을 진행 할 수 없습니다.");

        return false;

    }

////////////////

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");

        return false;

    }



    if (left(GetDate(), 8) >= left(AddDate(ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"), 365), 8)) {

        gfn_Alert("교육시작일로부터 1년이 지났습니다.");

        //return false;

    }

    if (ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '5' // 5:환불신청(미입금)

            || ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '6') { // 6:환불접수(신청확인)

        gfn_Alert("인터넷 환불 처리 중입니다.");

        return false;

    }



    if ((ds_ioTrainingJubsu.GetColumn(0, "PASSYN") == "Y")  // 수료여부

            && (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "N")) { // 최종수납구분:수납

        if (!gfn_Confirm("[수료처리]된 자료입니다.\n[카드 등 납부방법 변경]이 아닌 경우, [수료취소처리]됩니다.\n그래도, 환불처리 하시겠습니까?")) {

            return false;

        }

    }

    // (세금)계산서 발행된 자료인 경우 알림
    if ((ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVINFO") == "발행")
    
		&& (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "N")) {
		
        gfn_Alert("                   < (세금)계산서 발행 자료 >\n\n"

             + "해당 자료는 (세금)계산서가 발행되어 있습니다.\n\n"

             + "    ◇ (세금)계산서 관리번호 : " + ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMYEAR") +"-"
												+ iif(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMBILLTYPE")=="1","F","T") +"-"
												+ ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMVATNO") + "\n\n"

             //+ "회계 담당자에게 (세금)계산서 삭제 후 환불해 주시기 바랍니다.");
             + "환불시 수정계산서가 자동발행됩니다. 유의하시고 환불해 주시기 바랍니다.");
		
	}


	// 사이버교육일 경우
	if (radCourse.Value == "20C") {
	
	        // 사이버교육을 수료한 경우에는 환불 일정변경 불가(환불조치)
		lfn_CyberPassCheck();
/*		
		if ((ds_oTrainingOrderMgno.GetColumn(0,"TOCYBERENDDATE") >= left(GetDate(), 8))
		   && (ds_oCyberPass.GetColumn(0, "CPPROGRESSPCT") >= "90")) { // 진도율이 90%이상이면 1일치 교육수수료 차감
			gfn_Alert("☞ " + edPersonNm.Text + " 님의 사이버교육 진도율 : " + ds_oCyberPass.GetColumn(0, "CPPROGRESSPCT") +"%"+
					  "\n\n사이버교육을 90%이상 수강한 경우에는 1일차 교육수수료를 공제한 금액으로 환불하셔야 합니다.");
		}
*/		
		if ((ds_oTrainingOrderMgno.GetColumn(0,"TOCYBERENDDATE") >= left(GetDate(), 8))
		   && (ds_oCyberPass.GetColumn(0, "CPPASSSTATUS") = "수료")) {   // 수료여부가 "수료"이면 1일치 교육수수료 차감
			gfn_Alert("☞ " + edPersonNm.Text + " 님의 사이버교육 수료여부 : " + ds_oCyberPass.GetColumn(0, "CPPASSSTATUS") +
					  "\n\n사이버교육을 수료한 경우에는 1일차 교육수수료를 공제한 금액으로 환불하셔야 합니다.");
		}
	}


    var ls_Key1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"); // KEY값1-접수관리번호
    
    var ls_Key2 = ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"); // KEY값2-회차관리번호
    
    var ls_Key3 = ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO"); // KEY값3-접수번호

    var ls_Key4 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMMGNO"); // KEY값2
    
    // 통합영수증발급(POS)시스템 팝업을 호출한다.

    var arrPos = gfn_TrainingPOSPopup("21", ls_Key1, ls_Key2, ls_Key3, ls_Key4);

    var sSMMSG;

    var SunapGubunSms;

    if(arrPos[1] = 0) {  // 수납여부

        SunapGubunSms = "수납";

    } else if(arrPos[1] = 1) {

        SunapGubunSms = "환불";

    }

    

    sSMMSG = "[한국소방안전원] 강습교육 수수료 " + NumFormat(abs(arrPos[2])) + "원 " + SunapGubunSms + " 되었습니다.";  // arrPos[2] 금액

    

    if (arrPos[0] == "OK") {

        if (arrPos[1] = "0") { // 수납이면        

			if (arrPos[3] < "3") {	// 가상계좌가 아니면
	
			
	
				if (gfn_Confirm("결제내역을 문자메시지로 전송 하시겠습니까?")) {
		
					// gfn_KTSendOneSmsPopup(sMBCCD, sMPK1, sMPK2, sMPK3, sMBSMGNO, sMRECVNM, sMRECVTEL, sMTITLE, sMMSG);
					var arrSms = gfn_KTSendOneSmsPopup("101" // 강습-접수
				
									, ds_ioTrainingJubsu.GetColumn(0, "TOMGNO")
				
									, ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
				
									, ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO")
									
									, ""
									
									, edPersonNm.Text
									
									, edHpTel.Text
									
									, "한국소방안전원"
				
									, sSMMSG
				
								); // 단일문자메시지발송 팝업
		
				}
	
			}  

            btnPrintJubsu_OnClick(); // 수강증 출력

        }

    }



    if (arrPos[0] <> "END") {
    
		//lfn_UpdateTrainingOrderJubsuCnt();	// 접수자수 Update 

        lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.

    }

}



// 개인접수정보

function ds_oJubsuAllInfo_OnRowPosChanged(obj,nOldRow,nRow) {

    if (nRow <> -1) {

        lfn_SearchTrainingOrderHistList(); // 회차변경이력 조회

    }

}



// 바코드 검색

function medBarCode_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) {

        btnBarCodeSearch.SetFocus();

        btnBarCodeSearch_OnClick();

    }

}



function btnBarCodeSearch_OnClick(obj) {

    if (gfn_IsNull(medBarCode.Value)) {

        gfn_Alert("바코드를 입력해 주십시오.");

        medBarCode.SetFocus();

        return false;

    }

    if (length(medBarCode.Value) <> 12) {

        gfn_Alert("바코드를 12자리 숫자로 정확히 입력해 주십시오.");

        medBarCode.SetFocus();

        return false;

    }



	lb_BarcodeCheck = true;

	lfn_SearchTrainingJubsuList();

}



/*

 * 사진관리 링크

 */

function btnPictureManagement_OnClick(obj) {

    var ArrMenuInfo = gfn_SearchMenuInfo("training",  iif(gs_IsTlogin == "N", "training", "outerbiz") + "::frmtraining9100MPictureManagement.xml");	//메뉴정보조회

    if(length(ArrMenuInfo) > 0 ) {

        var sArg = "sPersonNm=" + quote(edPersonNm.Text)

            + " sResidentNo=" + quote(medResidentNo.Value);

        ls_SystemGubun = arrMenuInfo[7];  //"training";

        gs_SystemMenuId = arrMenuInfo[5]; //"0000000003";

        global.mnuLeft.tabMenu.tabpgMenu.Text = arrMenuInfo[6]; //"강습관리";

        var ls_MenuId = arrMenuInfo[0];                         //"0000000120";

        var ls_MenuTitle = arrMenuInfo[1];                      //"사진관리";

        var ls_MenuUrl = arrMenuInfo[2];                   //"training::frmtraining9100MPictureManagement.xml";

    

        global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", ls_SystemGubun);

        gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sArg);

    } else {

			gfn_Alert("해당 메뉴를 찾을 수 없습니다.");

	}    

}



/*

 * 최근사진반영

 */

function btnApplyPicture_OnClick(obj) {

	if (gfn_IsNull(imgLastestPicture.ImageID)) {

        gfn_Alert("최근사진 등록을 먼저 해주십시오.");

        return false;

	}



	imgPicture.ImageID = imgLastestPicture.ImageID;

	imgPicture.Text = "";

	lb_FileUpload = false;

	ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ"));

}



/*

 * 사진찾기

 */

function btnLoadPicture_OnClick(obj) {

    fdImage.Type = "OPEN";

    if (fdImage.open()) {

        fiImageFile = fdImage.FilePath + "\\" + fdImage.FileName;

        fiImageFile.Open("rb");



        var ln_ImageSize = fiImageFile.GetLength();

        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경

        if (ln_ImageSize > 300) {

            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");

            return false;

        }

        ds_ioTrainingJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        imgPicture.ImageID = fdImage.FilePath + "\\" + fdImage.FileName;

        imgPicture.Text = "";

        lb_FileUpload = true;



        ls_UploadRealName = left(medResidentNo.Value, 6) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);

        ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ") + 1);

        ds_ioTrainingJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);

        ds_ioTrainingJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);

        ds_ioTrainingJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);

    }

}



// 등록사진조회

function btnSearchRegPicture_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

        gfn_Alert("이미지 정보가 없습니다.");

        return;

    }

    var sArg = "sTpMgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));

    sArg += " sPersonNm=" + quote(edPersonNm.Text);

    var arrImage = Dialog("training::frmtraining0255PTrainingPersonPicture.xml", sArg, 536, 440, "", -1, -1); // 고객 사진 조회



    if (length(arrImage) > 0) {

        if (ds_ioTrainingJubsu.GetColumn(0, "IIIMGSEQ") <> arrImage[0]) {

            ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", arrImage[0]);

            imgPicture.Text = "";

            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"

                + arrImage[1]

                + "/" + arrImage[2];

        }

    }

}



/*

 * 스캔실행

 */

function btnScanPicture_OnClick(obj) {

	ExecProc(gs_ScanProgramName);

}



/*

 * 스캔사진불러오기

 */

function btnLoadScanPicture_OnClick(obj) {

    imgPicture.ImageID = NULL;

	imgPicture.Text = "사진";

	

    var ls_File = split(gs_ScanFileName,"\\");



    fdImage.FilePath = left(gs_ScanFileName, length(gs_ScanFileName) - length(ls_File[length(ls_file) - 1]));

    fdImage.FileName = ls_File[length(ls_file) - 1];



    fiImageFile.FileName = gs_ScanFileName;

    if (fiImageFile.Open()) {

        fiImageFile.Open("rb");



        var ln_ImageSize = fiImageFile.GetLength();

        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경

        if (ln_ImageSize > 300) {

            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");

            return false;

        }



        ds_ioTrainingJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        fiImageFile.Close();

    } else {

        gfn_Alert("스캔 이미지가 없습니다.");

        return;

    }



    imgPicture.ImageID = gs_ScanFileName;

    imgPicture.Text = "";

    lb_FileUpload = true;



    ls_UploadRealName = left(medResidentNo.Value, 6) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);

    ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ") + 1);

    ds_ioTrainingJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);

    ds_ioTrainingJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);

    ds_ioTrainingJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);

}



// 결제내역

function ds_oSetlmentHist_OnRowPosChanged(obj,nOldRow,nRow) {


    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "Y") { // 회차변경여부

        var ls_PaymentGubun = obj.GetColumn(nRow, "PMPAYMENTFLAG"); // 납입방법

        var ls_SunapGubun = obj.GetColumn(nRow, "TSGUBUNCD"); // 수납구분

        var ln_RepayRefNo = obj.GetColumn(nRow, "TSREPAYREF"); // 환불번호

        if (ls_PaymentGubun == "0") { // 현금

            btnProcRct.Text = "현금영수증처리";

            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
            
				// 콜센터 직원 사용 이면
				if (gs_IsCallCenter == "Y") {

					btnProcRct.Enable = false;
					
				} else {
				
					btnProcRct.Enable = true;
				
				}

            } else {

                btnProcRct.Enable = false;

            }

            btnShowVirtualAccount.Enable = false;

            btnPosResultList.Enable = false;

        } else if (ls_PaymentGubun == "1") { // 카드

            btnProcRct.Enable = false;

            btnShowVirtualAccount.Enable = false;

            btnPosResultList.Enable = true;

        } else if (ls_PaymentGubun == "2") { // 현금영수증

            btnProcRct.Text = "현금영수증취소";

            if (((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) ||  // 수납 또는 회계수납이면서 환불이 안된 경우
            
				(obj.GetColumn(nRow, "TFCFEE") - obj.GetColumn(nRow, "CURRENTAMOUNT") <= 10000)) {	// 수첩비만 환불한 경우

				// 콜센터 직원 사용 이면
				if (gs_IsCallCenter == "Y") {

					btnProcRct.Enable = false;
					
				} else {
				
					btnProcRct.Enable = true;
				
				}

            } else {

                btnProcRct.Enable = false;

            }

            btnShowVirtualAccount.Enable = false;

            btnPosResultList.Enable = true;

        } else if (ls_PaymentGubun == "3") { // 가상계좌

            btnProcRct.Text = "현금영수증처리";

            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우

				// 콜센터 직원 사용 이면
				if (gs_IsCallCenter == "Y") {

					btnProcRct.Enable = false;
					
				} else {
				
					btnProcRct.Enable = true;
				
				}

            } else {

                btnProcRct.Enable = false;

            }

            btnShowVirtualAccount.Enable = true;

            btnPosResultList.Enable = true;

        } else {

            btnProcRct.Enable = false;

            btnShowVirtualAccount.Enable = false;

            btnPosResultList.Enable = false;

        }

        if (obj.GetColumn(nRow, "TSGUBUN") == "15" || obj.GetColumn(nRow, "TSGUBUN") == "25" ) { // 가상계좌보기

            btnShowVirtualAccount.Enable = true;

        }

		// 콜센터 직원 사용 이면
		if (gs_IsCallCenter == "Y") {

			btnChangeProcDate.Enable = false;
			
			btnPrintReRct.Enable = false;
	
		} else {
			
			btnChangeProcDate.Enable = true;

			btnPrintReRct.Enable = true;
		
		}


		btnPrintReRctPDF.Enable = true;

    } else {

        btnPosResultList.Enable = false;

        btnChangeProcDate.Enable = false;

        btnPrintReRct.Enable = false;
        
        btnPrintReRctPDF.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnShowVirtualAccount.Enable = false;

    }

    if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVINFO") == "발행"){

        btnPosvath.Enable = true;

    } else {

        btnPosvath.Enable = false;

    }
    
    
    
	// 부가세 관리번호가 있고 // 직능 수수료금액보다 현재금액이 작을경우만 발행 가능
	if (!gfn_isNull(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMMGNO")) &&
	    ds_oSetlmentHist.GetColumn(0, "TFCFEE") > ds_oSetlmentHist.GetColumn(0, "CURRENTAMOUNT")) {
	    
		btnEstimate.Enable = true;
		
	} else {
	
        btnEstimate.Enable = false;
	
	}

}



// 결제처리결과조회

function btnPosResultList_OnClick(obj) {

    // 안전원와 LGD 결과 내용 조회

	var ls_Regfn_Check = gfn_CheckPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")

                            , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"));

}



// 가상계좌보기

function btnShowVirtualAccount_OnClick(obj) {

    if ((ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG") <> "3")

                && (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUN") <> "15")

                && (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUN") <> "25")

            ) { // 납입방법

        gfn_Alert("선택하신 결제는 가상계좌결제가 아닙니다.");

        return false;

    }



    // POS 결과 정보를 조회한다.

	var lb_Result = gfn_SearchPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")

        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO")

        , ds_oPosResult);

    if (!lb_Result) {

        gfn_Alert("가상계좌정보가 없습니다.");

        return false;

    }


    var sArg = ""; // 팝업파라메터

    sArg = "sVirtCloseDate=" + quote(ds_oPosResult.GetColumn(0, "VIRTCLOSEDATE")); // 가상계좌유효기간

    sArg += " sVirtStat=" + quote(ds_oPosResult.GetColumn(0, "VIRTRESULT")); // 입금여부(R-계좌 할당,I-입금,C-취소)

    sArg += " sVirtAccountNo=" + quote(ds_oPosResult.GetColumn(0, "VIRTACCOUNT")); // 계좌번호

    sArg += " sVirtBankCd=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKCD")); // 은행코드

    sArg += " sVirtBankNm=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKNM")); // 은행명칭

    sArg += " sVirtInputAmount=" + quote(ds_oPosResult.GetColumn(0, "VIRTINPUTAMT")); // 입금액

    sArg += " sVirtBankDate=" + quote(ds_oPosResult.GetColumn(0, "PCBANKDATE")); // 입금/취소일자

    sArg += " sGubun=" + quote("21"); // 업무구분 : 21 강습 22 시험
    
    sArg += " sTpmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO")); // 강습자 관리번호
    
    sArg += " sTjmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // 접수관리번호
    
    sArg += " sCoursecd=" + quote(ds_ioTrainingJubsu.GetColumn(0, "COURSECD")); // 직능코드

    sArg += " sPMPIID=" + quote(ds_oPosResult.GetColumn(0, "PMPIID")); // 상점아이디
    
    sArg += " sPCTRANSACTION=" + quote(ds_oPosResult.GetColumn(0, "PCTRANSACTION")); // 거래번호
    
    sArg += " sPMORGGUBUN=" + quote(ds_oPosResult.GetColumn(0, "PMORGGUBUN")); // 가상계좌 발급기관구분

	var arrVirtGubun = Dialog("COM::frmCOM3401PVirtualAccountPOSResult.xml", sArg, 400, 224, "", -1, -1); // 가상계좌 삭제 여부 판단 위함(삭제시 재 조회)

	

	if (arrVirtGubun[0] == "1") {  //가상계좌를 삭제 했다면

        lfn_Search(); // 다시 조회 함

	}

}



// 처리일자변경

function btnChangeProcDate_OnClick(obj) {

    

    if (ds_oSetlmentHist.currow < 0) {

        gfn_Alert("결제 내역을 선택해 주세십시오.");

        return false;

    }



	//////////////////////////////////

	//// 처리일자 변경시 결제 시스템에 내용이 있는지 먼저 확인함 

	

	ds_ioYearbizlink.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("com:searchYearbizlink", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_ioYearbizlink=ds_oYearbizlink" // outDs

        , "TSTJMGNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSTJMGNO")) // args

            + " TSSEQ=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSSEQ")) // args

        , ""

        ,false

        ,""

        ,true

    );

	

		

	if (ds_ioYearbizlink.count > 0) {

        gfn_Alert("      < 수수료관리번호 및 수납일자 변경 불가 >\n\n"

                  

             + "해당 자료는 회계시스템에서 시스템연동을 통해 결의서를 \n"

             + "생성하였습니다. 생성정보는 아래와 같습니다.\n\n\n"

             

             + "                - 결의서 번호 : " + ds_ioYearbizlink.GetColumn(0, "KEYNO") + "\n\n"

             + "                - 성          명 : " + ds_ioYearbizlink.GetColumn(0, "YBLNM") + "\n\n" 

             + "                - 금          액 : " +  ds_ioYearbizlink.GetColumn(0, "YBLAMT") + "원" + "\n\n"

             + "                - 처 리  일 자 : " + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 0, 4) + "-" + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 4, 2) + "-" + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 6, 2));

         return false;   

	}

	///////////////////////////////////	



    var sArg = "sTjmgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSTJMGNO"));

    sArg += " sSetlmtSeq=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSSEQ"));

    sArg += " sProcDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPROCDATE"));

    sArg += " sPonyDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPONYDATE"));

    sArg += " sPonyDateCheck=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPONYGUBUN"));

    sArg += " sPmYear=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR"));

    sArg += " sPmMgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"));

    sArg += " sTsgubun=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUN"));



	var ls_RetProc = Dialog("training::frmtraining0025PTrainingJubsuProcessDateChange.xml", sArg, 572, 184, "", -1, -1);



	if (ls_RetProc == "OK") {

        lfn_SearchTrainingSetlmentHistList(); // 결제내역 조회

	}

}



// 현금영수증처리/취소

function btnProcRct_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");

        return false;

    }

    if (left(GetDate(), 8) >= left(AddDate(ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"), 365), 8)) {

        gfn_Alert("교육시작일로부터 1년이 지났습니다.");

        return false;

    }

    if (ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '5' // 5:환불신청(미입금)

            || ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '6') { // 6:환불접수(신청확인)

        gfn_Alert("인터넷 환불 처리 중입니다.");

        return false;

    }

	if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVINFO") == "발행"){
	
        gfn_Alert("부가세가 발행된 결제입니다.");

//        return false;
	
	}


    var ls_Key1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"); // KEY값1-접수관리번호

    var ls_Key2 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSSEQ"); // KEY값2-결제순차번호

    var ls_RepayPosYear = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR"); // POS년도

    var ls_RepayPosMgno = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"); // POS관리번호

    var ls_RepayPayment = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG"); // 결과출력용 납입방법(0,1,2,3)



    // 통합영수증발급(POS)시스템 현금영수증처리 팝업을 호출한다.

    var arrPos = gfn_TrainingCashChangePOSPopup("21", ls_Key1, ls_Key2, ls_RepayPosYear, ls_RepayPosMgno, ls_RepayPayment);



    if (arrPos[0] <> "END") {

        lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.

    }

}



// 영수증재발행

function btnPrintReRct_OnClick(obj) {

    if (!gfn_Confirm("영수증을 재발행 하시겠습니까?")) {

        return false;

	}



    gfn_PrintReceipt(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")

        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO")); // 영수증을 출력한다.

}


// 영수증재발행PDF

function btnPrintReRctPDF_OnClick(obj) {

    if (!gfn_Confirm("영수증을 재발행 하시겠습니까?")) {

        return false;

	}



    gfn_PrintReceiptPDF(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")

        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO")); // 영수증을 출력한다.

}


// SMS현황

function btnSmsStat_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        return false;

    }



    var sArg = "sTjmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));

	Dialog("training::frmtraining0026PTrainingSmsSendList.xml", sArg, 600, 400, "", -1, -1);



}



// 수강증

function btnPrintJubsu_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    if (!gfn_Confirm("수강증을 출력 하시겠습니까?")) {

        return false;

	}



    // 출력이력을 저장한다.

    gfn_InsertSearchPrintHistory(

            "P"

            , this.ID

            , global.mnuLeft.cbxOpenForm.Text + "(수강증)"

            , "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")

        );

	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
		
				"P"
				
				, gs_CallCenterUID
	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")

				, this.ID
	
				, global.mnuLeft.cbxOpenForm.Text + "(수강증)"
	
				, "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
				
			);
	}


    ds_oTrainingJubsuPrint.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingJubsuPrint", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oTrainingJubsuPrint=ds_oTrainingJubsuPrint"    // outDs

        ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args

        ,""

        ,false

        ,false

        ,true

    );



    var lb_IsPrintedOk = gfn_PrintReport("frmtraining0020R01LectureLicense.rex", "ds_oTrainingJubsuPrint", "", false, "수강증");

}



// 강습접수결과 출력

function btnPrintJubsuResult_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {

        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    if (!gfn_Confirm("강습접수결과를 출력 하시겠습니까?")) {

        return false;

	}



    // 출력이력을 저장한다.

    gfn_InsertSearchPrintHistory(

            "P"

            , this.ID

            , global.mnuLeft.cbxOpenForm.Text + "(강습접수결과)"

            , "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")

        );

	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
		
				"P"
				
				, gs_CallCenterUID
	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")

				, this.ID
	
				, global.mnuLeft.cbxOpenForm.Text + "(강습접수결과)"
	
				, "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
				
			);
	}



    ds_oTrainingJubsuPrint.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingJubsuResultPrint1", false);

    tit_addSearchActionInfo("training:searchTrainingJubsuResultPrint2", false);

    tit_addSearchActionInfo("training:searchTrainingJubsuResultPrint3", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oTrainingJubsuPrint1=ds_oTrainingJubsuPrint1 ds_oTrainingJubsuPrint2=ds_oTrainingJubsuPrint2 ds_oTrainingJubsuPrint3=ds_oTrainingJubsuPrint3" // outDs

        ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args

        ,""

        ,false

        ,false

        ,true

    );



    var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0020R04TrainingJubsuResult.rex"

                                , "ds_oTrainingJubsuPrint1||ds_oTrainingJubsuPrint2||ds_oTrainingJubsuPrint3"

                                , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"

                                , false

                            );

}



function radJibuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (strCode == "S") { // 소속지부

        cbxJibu.Enable = false;

        radJibuGubun.BkColor = "";

        if (ds_oJibu.FindRow("CD", gds_oUserInfo.GetColumn(0, "PDEPTCD")) <> -1) {

            cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");

        }

        lfn_SearchTrainingLatestOrder();

	} else { // 타지부

        cbxJibu.Enable = true;

        radJibuGubun.BkColor = "red";

	}

}



// 수첩보유현황

function btnLicenseList_OnClick(obj) {

	if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
	
        gfn_Alert("조회 대상자를 조회 후 수첩보유현황을 조회하세요!");

        edJubsuNo.SetFocus();

        return false;
       
	}
	

    var sArg = "sPersonNm=" + quote(edPersonNm.Text);

    sArg += " sTpmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));

    Dialog("training::frmtraining0027PTrainingLicenseList.xml", sArg, 600, 400, "", -1, -1);

}



function radChangeTpmgno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (strCode == "C") {

        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

            gfn_Alert("접수 정보가 없습니다.");

            radChangeTpmgno.Value = "S";

            return false;

        } else {

            gfn_Alert("이 기능은 동일 인물에 대한 오타에 의한 성명/주민번호 변경용입니다.\n따라서, 해당 강습자와 관련된 모든 정보가 일괄 변경되므로, 신중히 변경하시기 바랍니다.");

        }

	}

}



// 접수이력

function btnJubsuHistory_OnClick(obj) {

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        return false;

    }



    var sArg = "sTjmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));

    Dialog("training::frmtraining0028PTrainingJubsuHistory.xml", sArg, 600, 400, "", -1, -1);

}



/*

// 회차변경이력 클릭시 상단에 상세 조회 함 (강습접수)

*/

function gdOrderHist_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)

{

    var cnt = nRow; // 선택 row 값			

	var edJubsuNo_Num; // 접수번호 담는 변수

	

	if(ds_oOrderHist.rowcount > 0)

	{

		serch_falg = "1";	

       

        cbxJibu.value = ds_oOrderHist.GetColumn(cnt, "BEFORJIBU");    // 지부

        edTrainingYear.Text = ds_oOrderHist.GetColumn(cnt, "BEFORTOYEAR");  // 년도

        radCourse.Value = ds_oOrderHist.GetColumn(cnt, "BEFORTOTCCOURSECD")   // 직능
        
						+ ds_oOrderHist.GetColumn(cnt, "BEFORTOMUNJEGUBUN");

        edTrainingOrder.Text = ds_oOrderHist.GetColumn(cnt, "BEFORORDER"); // 회차 정보

        edJubsuNo.text  = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호

        edJubsuNo_Num = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호 담음

       // edSeatNo.Text = ds_oOrderHist.GetColumn(cnt, "EOHEXAMSEATNO"); // 좌석번호

 	

		/*

		if(ds_oOrderHist.GetColumn(cnt, "BEFORJIBU") != gds_oUserInfo.GetColumn(0, "PDEPTCD"))

			{

				changeJibuRadio("T", false);	

				radJibuGubun.Value = "T";

			}else{

				

				changeJibuRadio("S", false);

				radJibuGubun.Value = "S";

			}

		*/

		

		lfn_ChangeJibuRadioButton();  // 지부에 따른 자동 선택 

		

		

		lfn_SearchTrainingOrderMgno();  // 시험 회차관리번호를 조회한다.

		

		edJubsuNo.text  = edJubsuNo_Num; // 접수번호

		

		//alert("회차관리번호 조회함");

		lfn_SearchTrainingJubsuList();  // 시험접수 내용을 조회한다.

	}

}



function gdJubsuInfo_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)

{



    serch_falg = "1";  // 조회 플래그만 변경

   

    /*

    if(ds_oJubsuAllInfo.count == "1") {

        gdOrderHist_OnCellClick(0,0,0,0,0);

    }

    */

    

    if(ds_oJubsuAllInfo.currow == nRow) {

        ds_oJubsuAllInfo_OnRowPosChanged(); // ds 변경 함수를 호출함 (같은 row선택시)

    }

    

}



// 메일발송

function btnSendEmail_OnClick(obj)

{

	if (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") != "N") {

        gfn_Alert("수납 완료된 접수자에게만 메일을 발송할 수 있습니다.");

        return false;

    }

	if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");

        return false;

    }

    if (gfn_IsNull(edEmail.Text)) {

        gfn_Alert("발송할 이메일이 존재하지 않습니다.");

        return false;

    }

    

    var sArg = "sMgNo=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));

    sArg += " sGubun=" + quote("T");



    Dialog("COM::frmCOM1300MOneMAILSend.xml", sArg, 504, 130, "", -1, -1);	// 단일메일발송 팝업

}



// 메일발송현황

function btnEmailStat_OnClick(obj)

{

	if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");

        return false;

    }

    

    var sArg = "sMgNo=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));

    sArg += " sGubun=" + quote("T");



    Dialog("COM::frmCOM1400POneMAILSendList.xml", sArg, 600, 400, "", -1, -1);	// MAIL발송현황팝업

}


// 접수자 정보변경
function btnSearchPersonInfoChange_OnClick(obj)

{

	if (gfn_IsNull(medResidentNo.Value) ) {

        gfn_Alert("변경할 정보가 없습니다.\n'접수조회' 후에 사용하여 주시기 바랍니다.");

        return;

    }
    
    if (!gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 접수된 자료이면서

                && (left(GetDAte(), 8) > ds_oTrainingOrderMgno.GetColumn(0, "TOENDDATE"))

            ) {

        gfn_Alert("교육종료일이 지나서 변경하실 수 없습니다.");

		// 시스템관리자만 변경 허용
		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
	
			return false;
			
		}

    }



//////////////////////

    ds_ioT_E_L_JubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchT_E_L_JubsuCheck", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioT_E_L_JubsuCheck=ds_oT_E_L_JubsuCheck"	// outDs

        ,"TPMGNO_A=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO")) // args

        ,"lfn_AfterAllJubsuSearch"

        ,false

        ,""

        ,true

    );

    

    if (ds_ioT_E_L_JubsuCheck.GetRowCount() == 1) {  // 안내메시지 만들었다가 안보이게 함

     /*   alert("   현재 접수내역의 접수자는 신규 접수자 입니다. \n\n"

             + "반드시 '1번의 이름/주민번호 변경'을 통해 변경 바랍니다. \n"); */

        

    } else {

     /*   alert("   현재 접수내역의 접수자는 기존 접수한 내역이 있습니다. \n\n"

             + "반드시 '2번의 접수 대상자 변경'을 통해 변경 바랍니다. \n"); */

    }

////////////////////





	var retArr = gfn_TrainingPersonModifyPopup(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"), ds_ioT_E_L_JubsuCheck.GetRowCount(), "T", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));  //팝업 호출

    if(arrArg[3] == "Y") {

        btnAuthResidentNo.Text  = "실명인증완료";

        btnAuthResidentNo.Enable = false;

    } else {

        btnAuthResidentNo.Text  = "실명인증";

        btnAuthResidentNo.Enable = true;

    }
    
    if(gfn_isNull(retArr[0]) and gfn_isNull(retArr[1]) and gfn_isNull(retArr[2])){

    } else {

        if (edPersonNm.Text != retArr[0]

            || medResidentNo.Value != left(retArr[1],6)

            || ds_ioTrainingJubsu.GetColumn(0, "TPMGNO") != retArr[2] ) {  // 기존값과 조회 변경한 값이 다를 경우 update 수행 

	
	
		//////////////////////// return 되는 강습자관리번호로 해당 직능 및 회차에 동일인 접수 내역있는지 확인
	
			lfn_searchJubsuListReturnTpmgno(retArr[2], retArr[4], retArr[0]);     // return 강습자관리번호로 접수내역 확인
	
/*	
			if (ds_ioTraing_ReturnTpmgnoJubsuCheck.count > 0) {
	
				gfn_Alert("변경예정대상자는 이미 해당 직능 회차에 접수가 되어 있습니다. 확인 바랍니다. \n\n"
	
					+ "         직          능 :   " + radCourse.Text + "\n" 
	
					+ "         회          차 :   " + edTrainingOrder.Text + "\n" 
	
					+ "         이          름 :   " + retArr[0] + "\n" 
	
					+ "         접수 번호는 :   " + ds_ioTraing_ReturnTpmgnoJubsuCheck.Getcolumn(0, "TOHJUBSUNO") + " 입니다. \n" );
	
				return false;
	
			}
*/

			lfn_Search(); 
		
			gfn_SaveMessage(); // 저장 메세지를 처리한다.

/*
   ////////////////////  접수 테이블 자료 update 후 trainingperson 테이블 주소 정보 업데이트 필요
        

            ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", retArr[2]);  // 강습자관리번호를 update함

            tit_addSingleActionInfo("com:updateTrainingJubsuChange", "", 0, "");
	
            tit_callService(

                ""

                ,""

                ,"ds_iTrainingJubsuChange=ds_ioTrainingJubsu:U"	// inDs

                ,""	// outDs

                ,"TPMGNO_A=" + quote(retArr[2])               

                    + " TPBIRTHDAY_A=" + quote(retArr[1])
                    
                    + " TPPERSONKEY_A=" + quote(retArr[4])

                    + " PNM_A=" + quote(retArr[0])

                    + " TPADDRGUBUN_A=" + quote(cbxAddrGubun.Value)

                    + " TPZIPCD_A=" + quote(medZipCode.Value)

                    + " TPADDR1_A=" + quote(edAddr1.Text)

                    + " TPADDR2_A=" + quote(edAddr2.Text)

                    + " TPTEL_A=" + quote(edTel.Text) //전화번호

                    + " TPHPTEL_A=" + quote(edHpTel.Text)  //휴대폰

                    + " TPEMAILID_A=" + quote(edEmail.Text)

                    + " TPEMAILDOMAIN_A=" + quote(edEmailDomain.Text) //E- MAIL

                    + " TJMGNO_A=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args

                ,"lfn_AfterSearchChane"

                ,false

                ,""

                ,true

            );
*/
        }

    }       

}



function lfn_searchJubsuListReturnTpmgno(sTpmgNo, sPERSONKEY, sTNM) {

/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기 return 강습자관리번호로 check

    var TPMGNO_A = sTpmgNo;

    var PERSONKEY_A = sPERSONKEY;

    var TNM_A = sTNM;

    ds_ioTraing_ReturnTpmgnoJubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchTraing_ReturnTpmgnoJubsuCheck", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioTraing_ReturnTpmgnoJubsuCheck=ds_oTraing_ReturnTpmgnoJubsuCheck"	// outDs

        , "TOMGGTMGNO_A=" + quote(cbxJibu.Value)  // 지부

        + " TOYEAR_A=" + quote(edTrainingYear.Text) // 년도

        + " TOTCCOURSECD_A=" + quote(radCourse.Value) // 직능

        + " TOTRAININGORDER_A=" + quote(edTrainingOrder.Text) // 회차 

        + " PERSONKEY_A=" + quote(PERSONKEY_A)

        + " PNM_A=" + quote(TNM_A)            

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}

///////////////////



/* 사용자 함수 */

/*

 * 기능 : 접수내역 update 후 처리

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchChane(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return ;

    }



    lfn_Search(); 

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

  //  lfn_Save();  

	

}



function lfn_AfterAllJubsuSearch(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    	

}







function edJubsuNo_OnChanged(obj,strText)

{

	

}







function btnPrintEstimate_OnClick(obj)

{

//	var retArr = gfn_EstimatePopup(ds_oSetlmentHist.GetColumn(0, "PVPMYEAR"), ds_oSetlmentHist.GetColumn(0, "ACCNTJIBU"), ds_oSetlmentHist.GetColumn(0, "PVVMBILLTYPE"), ds_oSetlmentHist.GetColumn(0, "PVVMVATNO"));  //팝업 호출
	
	var retArr = gfn_EstimateListPopup(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMMGNO"));  //팝업 호출

}

}



/*

* 결재 그리드 배경색을 기본으로 하고 선택한 ROW에 배경색을 지정(셀의 색상속성을 지정위함)

*/

function fn_bkcolor(currow)

{

    if(ds_oSetlmentHist.row == currow)

     {

        return "#DFCF91";

      }else

      {

        return "default";

      }

}



/*

 * 기능 : Flex 좌석을 조회한다.

 * parameter : 없음

 * return : 없음

 */

function btnUnSeatList_OnClick(obj)

{

	ds_oEducationNo.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchEducationPlaceNo", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oEducationNo=ds_oEducationNo" // outDs

        ,"TOMGNO=" + quote(ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO"))

        ,"lfn_AfterSearchEducationPlaceNo"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : Flex 좌석을 삭제한다.(임시테이블의 좌석을 삭제함)

 * parameter : 없음

 * return : 없음

 */



function lfn_FlexDelete()

{	

    tit_clearActionInfo();

    tit_addSearchActionInfo("training:deleteEducationTempseatNo", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"" // outDs

        , "JUBSUNUM_A= " + quote(TohjubsuNo_AA)  // 이전 접수번호

         + " TOMGNO_A= " + quote(Tomgno_AA)    // 이전 회차관리번호// args

        ,""

        ,false

        ,""

        ,true

    );

}



/*

 * 기능 : Flex 좌석을 임시좌석 삭제 후 처리

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEducationPlaceNo_Temp(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return ;

    }

}	

	

/*

 * 기능 : Flex 좌석을 조회 후 처리

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEducationPlaceNo(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return ;

    }

	

	var rtnSeatNo;



	//////////////////  회차관리번호, 접수 번호 변수에 저장, 새 정보와 비교함 일치 않으면 삭제 일치하면 통과 

    if(!gfn_isNull(TohjubsuNo_AA) && !gfn_isNull(Tomgno_AA) && !gfn_isNull(edJubsuNo.Text) && !gfn_isNull(ds_oEducationNo.GetColumn(0, "TOMGNO"))) {

        if ((edJubsuNo.Text == TohjubsuNo_AA) &&

            (ds_oEducationNo.GetColumn(0, "TOMGNO") == Tomgno_AA) ) {     // 회차관리번호, 접수번호 일치 하면 통과 일치 않으면 삭제 처리

            

        } else {

            lfn_FlexDelete();  // 이전 flex 임시 좌석 삭제 함 

        }

	}

		

	Tomgno_AA = ds_oEducationNo.GetColumn(0, "TOMGNO");   // 현 회차관리번호를 저장함

	TohjubsuNo_AA = edJubsuNo.Text;                       //  현 접수번호를 저장함	

		

	

	/////////////////

	if(ds_oEducationNo.Count() > 0) {

		var sArg  =  "sTomgno=" + quote(ds_oEducationNo.GetColumn(0, "TOMGNO"));	    //회차관리번호

			sArg += " sEmgno=" + quote(ds_oEducationNo.GetColumn(0, "TOEPMGNO"));	    //교육장관리번호

			sArg += " sJubsuno=" + quote(edJubsuNo.Text);	                            //접수번호  

		    sArg += " sToseatCnt=" + quote(ds_oEducationNo.GetColumn(0, "TOSEATCNT"));  //좌석수

		rtnSeatNo = Dialog("training::frmtraining0029PTrainingSeatListViewer.xml", sArg, 730, 605, "", -1, -1);	//좌석배치보기 팝업을 호출한다.

		

		if(!gfn_isNull(rtnSeatNo)) {

			edSeatNo.Text = rtnSeatNo;	//좌석 셋팅

		}

	}

}



/*

* 개인접수정보 상세보기 

*/

function btnTraingJubsuInfo_OnClick(obj)

{

    lfn_SearchTrainingJubsuAllInfoList(); // 개인접수정보 조회

}



/*

* 문자메시지 발송 함수 (단건)

*/



/*

function SmsSendSingle() {

    tit_clearActionInfo();

    tit_addSingleActionInfo("training:insertTraining0020TrainingSmsSend", "", 0, "");

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,""	// outDs

		,"RECVTEL=" + quote(mid(replace(gds_oUserInfo.GetColumn(0, "TEL"), "-", ""), 0, 10)) // --회신전화번호 

                +" SMMSG=" + quote("요청하신 한국소방안전원 강습교육 건에 대해 " + gds_oPosResult.GetColumn(0, "PROCAMT") + "원 " + gds_oPosResult.GetColumn(0, "SUNAPGUBUN") + " 되었습니다." )//   --전문내용

               // +" SHSENDRESVTIME1=" + quote(calReserveDate.value) // --발송예약날짜

               // +" SHSENDRESVTIME2=" + quote(medReserveTime.text) // --발송예약시간  

                +" PDEPTCD=" + gds_oUserInfo.GetColumn(0, "PDEPTCD") // -- 지부 

                +" PSABUN=" + gds_oUserInfo.GetColumn(0, "PSABUN") // -- 사번

                +" TOMGNO=" + parent.ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO") // -- 회차관리번호 

                +" TJMGNO=" + quote(sKey1) // -- 강습접수관리번호

                +" TOHJUBSUNO=" + quote(lpad(parent.ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO"), "0", 6)) // -- 접수번호

                +" TJPERSONNM=" + quote(parent.ds_ioTrainingJubsu.GetColumn(0, "PERSONNM")) // -- 수신자명

                +" TPHPTEL=" + quote(parent.edHpTel.text) // -- 전화번호                   // args 

        ,""

        ,false

    );

}   

*/





// 통합영수증조회 팝업

function btnPosReport_OnClick(obj)

{

    var sArg = "sProgramId=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD"));

    var retDlg = Dialog("posetc::frmposetc0020PPosReport.xml", sArg, 480, 320, "", -1, -1);	

}


/*

 * 기능 : 사이트에 가입했는지 체크한다.

 * parameter : 없음

 * Return : 있으면 true, 없으면 false

 */

function lfn_CheckSiteMemberJoin(obj) {

    ds_oSiteMember.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTraining0020SiteMemberJoinCheck", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oSiteMember=ds_oSiteMember" // outDs

        ,"MNM=" + quote(edPersonNm.Text)

            + " MNO=" + quote(ls_PERSONKEY)

        ,""

        ,false

        ,false

        ,true

    );



    if (ds_oSiteMember.GetCount() > 0) {

        return true;

    } else {

        return false;

    }

}

// 사이버교육 정보
function btnCyberInfo_OnClick(obj)
{
    
    if (gfn_IsNull(edTrainingOrder.Text)) {

        gfn_Alert("회차를 입력해 주십시오.");

        edTrainingOrder.SetFocus();

        return false;

    }

    if (gfn_IsNull(edJubsuNo.Text)) {

        gfn_Alert("접수번호를 입력해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    
    if (gfn_IsNull(edPersonNm.Text)) {

        gfn_Alert("성명을 입력해 주십시오.");

        edPersonNm.SetFocus();

        return false;

    }

    if (gfn_IsNull(medResidentNo.Value)) {

        gfn_Alert("주민등록번호를 입력해 주십시오.");

        medResidentNo.SetFocus();

        return false;

    }
    
    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부
    
		gfn_Alert("회차변경된 자료는 사이버교육 정보가 없습니다.");
		
		return false;
		
	} else {

		var sArg = "sTomggtmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "MGJIBUCD"));
		
		sArg += " sCoursecd=" + quote(ds_ioTrainingJubsu.GetColumn(0, "COURSECD"));
	
		sArg += " sToyear=" + quote(ds_ioTrainingJubsu.GetColumn(0, "YEAR"));
	
		sArg += " sToorder=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TORDER"));
		
		sArg += " sTomgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"));
		
		sArg += " sTohjubsuno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO"));
	
		Dialog("training::frmtraining0020PTrainingCyberInfo.xml", sArg, 600, 400, "", -1, -1);
	
	}
	
}


// 사이버교육 수료 여부
function lfn_CyberPassCheck() {

    ds_oCyberPass.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTraining0020CyberPassCheck", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oCyberPass=ds_oCyberPass" // outDs

        , "CPCOURSECD=" + quote(ds_ioTrainingJubsu.GetColumn(0, "COURSECD")) // args

            + " CPEDUGUBUN='T'"
            
            + " CPYEAR=" + quote(ds_ioTrainingJubsu.GetColumn(0, "YEAR")) // args

            + " CPGTMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "MGJIBUCD"))
            
            + " CPTRAININGORDER=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TORDER")) // args

            + " CPJUBSUNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO"))

        , ""

        ,false

        ,false

        ,true

    );

}
function edAddr1_OnChanged(obj,strText)
{
	
}

function cbxAddrGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	
}


/**
 *  안전원회원 가입동의
 */
/*
function lfn_MemberAgreeModify(sVal, sTJGMMO){
    tit_clearActionInfo();

	tit_addSingleActionInfo("cust:executeCust0018MemberH", 0, "");
	var arg = "MNM=" + quote(edPersonNm.Text);
	arg += " MRESIDENTNO=" + quote(medResidentNo.Value);
	arg += " I_MHMEMGUBUN=" + quote(left(radCourse.Value,2));
	arg += " I_MHMEMCHK=" + quote(sVal);    // 회원가입동의여부 (Y:회원, N:비회원)
	arg += " I_MHMEMNO=" + quote(sTJGMMO);	// 강습관리번호
	arg += " I_MHCOMPANYNM=''";

    // 서버 호출
	   
    tit_callService(
        ""
        ,""
        ,"ds_ioManagerInfo=ds_ioManager:U" // inDs
        ,"ds_oMemberStatus=ds_oMemberStatus"	// outDs
        ,arg
        ,""
        ,false
        ,""
        ,true
    );
}
*/

// 결제삭제
function btnDeleteSettlement_OnClick(obj)
{

	if (!gfn_Confirm("결제내역을 삭제하시겠습니까?")) {

		return false;

	}

    tit_clearActionInfo();

	tit_addSingleActionInfo("training:deleteTrainingSettlement", 0, "");
	var arg = "TJMGNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSTJMGNO"));
	arg += " TSSEQ=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSSEQ"));
	arg += " TSPMYEAR=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR"));
	arg += " TSPMMGNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"));
	arg += " TSGUBUNCD=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUNCD"));	// 수납환불구분

    // 서버 호출

    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oDeleteSettlement=ds_oDeleteSettlement"	// outDs
        ,arg
        ,"lfn_AfterDeleteSettlement"
        ,false
        ,""
        ,true
    );	
}


function lfn_AfterDeleteSettlement(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    if (ds_oDeleteSettlement.GetCount() > 0) {
    
		if(ds_oDeleteSettlement.GetColumn(0, "RESULTCODE") == "OK") {
		
			gfn_Alert(ds_oDeleteSettlement.GetColumn(0, "RESULTMSG"));
			
			lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.
			
		}
    
    }
    
}


/*  접수자수 업데이트


function lfn_UpdateTrainingOrderJubsuCnt(obj)
{	

    tit_clearActionInfo();

    tit_addSearchActionInfo("training:updateTrainingOrderJubsuCnt", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"" // outDs

        ,  " TOMGNO= " + quote(ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"))    // 회차관리번호// args

        ,""

        ,false

        ,""

        ,true

    );

}
*/

// 기준일자별 계산서 발행
function btnEstimate_OnClick(obj)
{
	// 부가세 관리번호가 있고
	if (!gfn_isNull(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMMGNO"))) {
		// 직능 수수료금액보다 현재금액이 작을경우만 발행 가능
		if (ds_oSetlmentHist.GetColumn(0, "TFCFEE") > ds_oSetlmentHist.GetColumn(0, "CURRENTAMOUNT")) {
		
			var retArr = gfn_EstimatePublicationPopup("2", ds_oSetlmentHist.GetColumn(0, "CURRENTAMOUNT"), ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVVMMGNO"));  //팝업 호출
			
		} else {
	
			gfn_Alert("계산서 발행조건에 부합되지 않습니다.");
		
			return false;
		}
		
	} else {
	
		gfn_Alert("계산서 발행조건에 부합되지 않습니다.");
		
		return false;
	}
}

/* 부정행위 여부 조회
*/


function lfn_ExamCheatSearch(){
       
        
        ///////////////////////// 강습접수에 수료한거 중에 해당 직능이 있는지 조회하여 메시지 보여줌
        ds_oExamCheat.ClearData(); // 데이타셋 초기화

        tit_clearActionInfo();
        tit_addSearchActionInfo("training:searchExamCheat", false);
        // 서버 호출 
		       
        tit_callService(
            ""
            ,""
            ,""	// inDs
            ,"ds_oExamCheat=ds_oExamCheat"	// outDs
            ,"TPNM=" + quote(edPersonNm.Text)		// 성명
            + " TOTCCOURSECD=" + quote(substr(radCourse.Value,0,2))  // 직능
            + " PERSONKEY=" + quote(ls_PERSONKEY)	// 개인식별번호
            + " BIRTHDAY=" + quote(left(medResidentNo.Value,6))
            + " HP=" + quote(edHpTel.Text)
            + " PRINTGUBUN='2YEAR'" // args
            ,""
            ,false
            ,""
            ,true
            
        );
        ////////////////////////     
}




// 서류스캔 실행
function btnScan_OnClick(obj)
{
	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	} else {
	
		ExecProc(gs_FormScanProgram);
		
	}
}

// 서류스캔파일 불러오기
function btnScanSearch_OnClick(obj)
{

	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	}

    var ls_File = split(gs_FormScanFile,"\\");



    fdImage2.FilePath = left(gs_FormScanFile, length(gs_FormScanFile) - length(ls_File[length(ls_file) - 1]));

    fdImage2.FileName = ls_File[length(ls_file) - 1];



    fiImageFile2.FileName = gs_FormScanFile;

    if (fiImageFile2.Open()) {

        fiImageFile2.Open("rb");


/*
        var ln_ImageSize = fiImageFile2.GetLength();

        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경

        if (ln_ImageSize > 300) {

            gfn_Alert("서류 스캔파일 사이즈가 300KB를 넘겼습니다.\n 사이즈 : " + NumFormat(ln_ImageSize) + "KB");

            return false;

        }
*/

        fiImageFile2.Close();

    } else {

        gfn_Alert("서류스캔 이미지가 없습니다.");

        return;

    }



    edScanFileName.Text = fdImage2.FileName;


    lb_FormFileUpload = true;	// 서류스캔파일 등록 여부


	// 파일명 형식 : 년월일시분초+ 랜덤(3자리)
    ls_UploadFormName = GetDate() + Random(100,999) + gfn_GetFileExtensionName(fdImage2.FileName);

}

// 민원서류 스캔파일 저장
function btnScanSave_OnClick(obj)
{

	if (gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
	
        gfn_Alert("접수자료가 없습니다.\n\n" +
                  "접수자료 조회 후 저장하세요!");

        return;
	
	}
	
	
	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	}
	
	if (edScanFileName.Text == "") {

        gfn_Alert("스캔한 파일이 없습니다!");

        return;
	
	}
	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 저장하시겠습니까?")) {

		return false;

	}
	
	
		
	ds_iFormSave.ClearData();
	
	ds_iFormSave.AddRow();
			
	var vPROC = "";
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	if (cbxForm.Value == "0002") {	// 일정변경신청서
		if (gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TOHFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
			vPK2 = ds_ioTrainingJubsu.GetColumn(0, "TOHSEQ");
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioTrainingJubsu.GetColumn(0, "TOHFAMGNO");
		}
	} else if (cbxForm.Value == "0003" || cbxForm.Value == "0011" || cbxForm.Value == "0016") {	// 환불신청서
		if (ds_ioTrainingJubsu.GetColumn(0, "ATC0003") == "0" ||
			ds_ioTrainingJubsu.GetColumn(0, "ATC0003") == "E") {
			vPROC = "I";	// 신규
			vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
			vPK2 = ds_ioTrainingJubsu.GetColumn(0, "REPAYTJHSEQ");
		} else {
			vPROC = "A";	// 변경
			var vATC0003 = split(ds_ioTrainingJubsu.GetColumn(0, "ATC0003"), "|");
			vFAMGNO = vATC0003[0];
		}
	} else if (cbxForm.Value == "0009" || cbxForm.Value == "0014") {	// 교육원서(심폐소생술,생활안전강사)
		if (gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TJFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
			vPK2 = "";
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioTrainingJubsu.GetColumn(0, "TOHFAMGNO");
		}
	} 
			
	ds_iFormSave.SetColumn(0, "I_PROC", vPROC);					//신규(I), 화일변경(A)
    ds_iFormSave.SetColumn(0, "I_FCCD", cbxForm.Value);			//FORMCODE.FCCD 서식관리번호(신규/화일변경 공통]
    ds_iFormSave.SetColumn(0, "I_FAMGNO", vFAMGNO);				//FormAttach.FAmgno (화일변경만)
    ds_iFormSave.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값(신규만)
    ds_iFormSave.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록(신규만)
    ds_iFormSave.SetColumn(0, "I_FRDATE", left(getDate(),8));	//보관시작일(신규만)
    ds_iFormSave.SetColumn(0, "I_PATH", ls_FormUploadPath);		//저장위치(신규 /화일변경)
    ds_iFormSave.SetColumn(0, "I_FILENM", ls_UploadFormName);	//파일명(신규 /화일변경)
    
//    TRACE(ds_iFormSave.SaveXML());
						
    ds_oFormSave.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:insertFormSave", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormSave=ds_iFormSave"    // inDs

        ,"ds_oFormSave=ds_oFormSave"    // outDs

        ,""    // args

        ,"lfn_AfterFormSave"

        ,false

        ,false

        ,true

    );
    


}

function lfn_AfterFormSave(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
    if (ds_oFormSave.GetColumn(0, "O_status") == "FAIL") {
    
        gfn_ErrorMsg(ds_oFormSave.GetColumn(0, "O_status"), ds_oFormSave.GetColumn(0, "O_value"));

        return false;    
        
    } else if (ds_oFormSave.GetColumn(0, "O_status") == "SUCCESS") {

		var UploadResult = tit_FileWrite(

						hfImage2
				
						, ls_FormUploadPath
				
						, fdImage2.FilePath
				
						, fdImage2.FileName
				
						, ls_UploadFormName
				
						, "U"
				
						, false
				
					);
						
		/* Array
			0 - 성공 : S / 실패 : E / 파일크기 초과 : O
			1 - 서버에 저장된 실제 경로
			2 - 서버에 저장된 실제 파일명
			3 - 서버에 저장된 파일 사이즈
		*/
		// 성공여부 체크 && 파일사이즈 체크
		if (UploadResult[0] == "S" && UploadResult[3] == fiImageFile2.GetLength()) {
			
			gfn_Alert("서류스캔파일이 정상적으로 저장되었습니다.");
			
			lfn_Search();
		
		} else {
		
			gfn_Alert("서류스캔파일 저장 시 오류가 발생했습니다.");
			
			return false;
		}
							
		hfImage2.CloseFile();
		
	}

}


function btnSeverFormView_OnClick(obj)
{

	if (edFormResult.Text == "완료") {

		var sFile = split(ds_ioTrainingJubsu.GetColumn(0, "ATC" + cbxForm.Value), "|");
		
		sArg = "sURL=" + GF_FILE_SERVER_URL + "kems"+ sFile[1];
		
		//alert(sArg);
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}
	
}

function btnLocalFormView_OnClick(obj)
{
	
	if (!gfn_isNull(edScanFileName.Text)) {
	
		sArg = "sURL="+"C:\\KFSA\\Form.pdf";
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}
}


function cbxForm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	btnScan.SetFocus();
}


// 서류 DB삭제(관리자만)
function btnFormDelete_OnClick(obj)
{

	if (edFormResult.Text <> "완료") {
	
		gfn_Alert("등록된 자료가 없습니다.");

		return false;

	}
	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 삭제하시겠습니까?")) {

		return false;

	}
	
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	var vPathArr = "";
	var vPath = "";
	var vfile = "";
	
	// 교육원서(심폐소생술, 생활안전강사)
	if (cbxForm.Value == "0009" || cbxForm.Value == "0014") {
		if (!gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TJFAMGNO"))) {
			vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
			vPK2 = "";
			vFAMGNO = ds_ioTrainingJubsu.GetColumn(0, "TJFAMGNO");
			vPathArr = split(ds_ioTrainingJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	// 일정변경신청서
	} else if (cbxForm.Value == "0002") {
		if (!gfn_isNull(ds_ioTrainingJubsu.GetColumn(0, "TOHFAMGNO"))) {
			vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
			vPK2 = ds_ioTrainingJubsu.GetColumn(0, "TOHSEQ");
			vFAMGNO = ds_ioTrainingJubsu.GetColumn(0, "TOHFAMGNO");
			vPathArr = split(ds_ioTrainingJubsu.GetColumn(0, "ATC0002"), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	// 환불신청서(강습, 심폐소생술, 생활안전강사)
	} else if (cbxForm.Value == "0003" || cbxForm.Value == "0011" || cbxForm.Value == "0016") {
		if (length(ds_ioTrainingJubsu.GetColumn(0, "ATC0003")) > 2) {
			vPK1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO");
			vPK2 = ds_ioTrainingJubsu.GetColumn(0, "REPAYTJHSEQ");
			vPathArr = split(ds_ioTrainingJubsu.GetColumn(0, "ATC0003"), "|");
			vFAMGNO = vPathArr[0];
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	}

		
	ds_iFormDelete.ClearData();
	ds_iFormDelete.AddRow();
	
    ds_iFormDelete.SetColumn(0, "I_FCCD", cbxForm.Value);		//FORMCODE.FCCD 서식관리번호
    ds_iFormDelete.SetColumn(0, "I_FAMGNO", vFAMGNO);			//FormAttach.FAmgno
    ds_iFormDelete.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값
    ds_iFormDelete.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록
    ds_iFormDelete.SetColumn(0, "I_PATH", vPath);				//저장경로
    ds_iFormDelete.SetColumn(0, "I_FILENM", vfile);				//파일명
    
    ds_oFormDelete.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:deleteForm", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormDelete=ds_iFormDelete"    // inDs

        ,"ds_oFormDelete=ds_oFormDelete"    // outDs

        ,""    // args

        ,"lfn_AfterFormDelete"

        ,false

        ,false

        ,true

    );
    
}

// 민원서류 서버파일삭제
function lfn_AfterFormDelete(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
	var vPathArr = split(ds_ioTrainingJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
	var vPath = substr(vPathArr[1],0,18);	// 서버경로
	var vfile = substr(vPathArr[1],19,21);	// 파일명


	var UploadResult = tit_FileDelete(  //serverSaveDir, serverFileName, isNeedRtn

					vPath	// 서버경로
			
					, vfile	// 파일명
			
					, true				// 처리결과
			
				);
					
	// 결과	true / false

	// 성공여부 체크 && 파일사이즈 체크
	if (UploadResult == true) {
		
		gfn_Alert("서류스캔파일이 정상적으로 삭제되었습니다.");
		
		lfn_Search();
	
	} else {
	
		gfn_Alert("서류스캔파일 삭제 시 오류가 발생했습니다.");
		
		return false;
	}

}

// 접수대기자 리스트 팝업
function btnAwaiter_OnClick(obj)
{
    if (gfn_IsNull(ms_TrainingMgno)) {

        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";

        edTrainingOrder.SetFocus();

        return false;

    }

    lfn_TrainingAwaiterListPopup(ms_TrainingMgno); // 접수대기자목록 조회 팝업
	
}

/*

 * 기능 : 강습접수대기자목록 팝업을 호출한다.

 * parameter : sOrderMgno - 회차관리번호

 * return value : 강습접수대기자목록 정보를 가진 배열 오브젝트

 */

function lfn_TrainingAwaiterListPopup(sOrderMgno) {

    var sArg = "sOrderMgno=" + quote(sOrderMgno);

    Dialog(iif(gs_IsTlogin == "N", "training", "outerbiz") + "::frmtraining0029PTrainingAwaiterList.xml", sArg, 600, 400, "", -1, -1);
/*
    if (length(arrTjmgno) > 0) {

        ls_RetTjmgno = arrTjmgno[0];  // 접수관리번호

        lb_BarcodeCheck = true;

        lfn_SearchTrainingJubsuList();

    } else {

        ls_RetTjmgno = "";

    }
*/
}




function Form_OnActivate(obj)
{
	 gs_SysID = "[stm_01,bsn_3000,dsc_0001]";	// 개인정보접속기록 시스템ID  
}

]]></Script>
	<Images>
		<Images><![CDATA[/614nAthAAEAAf4AVQ==]]></Images>
	</Images>
</Window>
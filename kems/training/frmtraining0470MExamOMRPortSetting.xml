<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="368" Id="frmtraining0470MExamOMRPortSetting" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="(삭제)OMR포트설정" Top="8" Ver="1.0" Width="532" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioOmrPort">
				<Contents>
					<colinfo id="STDYEAR" size="256" summ="default" type="STRING"/>
					<record>
						<STDYEAR></STDYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oPort">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>COM1</CD>
						<DATA>COM1</DATA>
					</record>
					<record>
						<CD>COM2</CD>
						<DATA>COM2</DATA>
					</record>
					<record>
						<CD>COM3</CD>
						<DATA>COM3</DATA>
					</record>
					<record>
						<CD>COM4</CD>
						<DATA>COM4</DATA>
					</record>
					<record>
						<CD>COM5</CD>
						<DATA>COM5</DATA>
					</record>
					<record>
						<CD>COM6</CD>
						<DATA>COM6</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSpeed">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>9600</CD>
						<DATA>9600</DATA>
					</record>
					<record>
						<CD>19200</CD>
						<DATA>19200</DATA>
					</record>
					<record>
						<CD>38400</CD>
						<DATA>38400</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oBoundRate">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>NONE</CD>
						<DATA>NONE</DATA>
					</record>
					<record>
						<CD>EVEN</CD>
						<DATA>EVEN</DATA>
					</record>
					<record>
						<CD>ODD</CD>
						<DATA>ODD</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oParityBit">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>7</CD>
						<DATA>7</DATA>
					</record>
					<record>
						<CD>8</CD>
						<DATA>8</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oStopBit">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>1</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>2</DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Height="60" Id="lbPort" Left="4" Style="sty_Groupbox" TabOrder="9" Text="&#32;포트&#32;선택&#32;" Top="32" Type="Groupbox" VAlign="Middle" Width="524"></Static>
		<Static Height="60" Id="lbSpeed" Left="4" Style="sty_Groupbox" TabOrder="10" Text="&#32;속도&#32;" Top="96" Type="Groupbox" VAlign="Middle" Width="524"></Static>
		<Static Height="60" Id="lbBoundRate" Left="4" Style="sty_Groupbox" TabOrder="12" Text="&#32;바운드&#32;레이트&#32;" Top="160" Type="Groupbox" VAlign="Middle" Width="524"></Static>
		<Static Height="60" Id="lbParityBit" Left="4" Style="sty_Groupbox" TabOrder="13" Text="&#32;패러티&#32;데이타&#32;비트&#32;" Top="232" Type="Groupbox" VAlign="Middle" Width="524"></Static>
		<Static Height="60" Id="lbStopBIt" Left="4" Style="sty_Groupbox" TabOrder="11" Text="&#32;스탑&#32;비트&#32;" Top="300" Type="Groupbox" VAlign="Middle" Width="524"></Static>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="8" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="300">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="351" OnClick="lfn_Save" Style="sty_Button" TabOrder="1" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="441" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Radio Border="None" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radStopBIt" INDEX="0" InnerDataset="ds_oStopBit" Left="28" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="7" Top="324" Value="2" Width="100"></Radio>
		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radParityBit" INDEX="0" InnerDataset="ds_oParityBit" Left="28" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="6" Top="256" Value="7" Width="100"></Radio>
		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radBoundRate" INDEX="0" InnerDataset="ds_oBoundRate" Left="28" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="5" Top="188" Value="NONE" Width="245"></Radio>
		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radSpeed" INDEX="0" InnerDataset="ds_oSpeed" Left="28" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="4" Top="120" Value="19200" Width="245"></Radio>
		<Radio Border="None" CodeColumn="CD" ColumnCount="6" DataColumn="DATA" Height="20" Id="radPort" INDEX="0" InnerDataset="ds_oPort" Left="28" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="3" Top="56" Value="COM1" Width="490"></Radio>
		<File Bottom="32" Height="24" Id="fiConfigFile" Left="325" Right="349" TabOrder="13" Top="8" Width="24"></File>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="347" LineColor="user14" Right="529" TabOrder="61" Top="1" Type="Rectangle" Width="182"></Shape>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmtraining0470MExamOMRPortSetting.xml
 * 설명 : OMR포트설정
 * 작성일 : 2009.07.27
 * 작성자 : 김동현
 */

#include "LIB::training.js"; // 공통업무 관련

var ls_config_file = "c:\\omr.ini";

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }
    
    lfn_search();
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    // to do

    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

/**
 * 기능 : 조회
 */
function lfn_search(obj){

    fiConfigFile.FileName = ls_config_file; // 파일 위치

    if (fiConfigFile.IsExistFile()) { // 파일이 있을 경우
        if (fiConfigFile.Open("t+")) { // 파일을 이상없이 열었을 경우(t: text 모드, +: 읽기/쓰기)
            var ls_TotalString = fiConfigFile.Read(); // 전체 파일의 문자열 읽기
            fiConfigFile.Close();

            var arrString = split(ls_TotalString,"|","webstyle");

            radPort.Value = arrString[0];
            radSpeed.Value = arrString[1];
            radBoundRate.Value = arrString[2];
            radParityBit.Value = arrString[3];
            radStopBIt.Value = arrString[4];
            
        }
    }

}

/*
 * 기능 : 저장
 */
function lfn_Save(obj) {

    var ls_Text = "";//파일 내용
    fiConfigFile.FileName = ls_config_file; // 파일 위치

    if (fiConfigFile.Open("wt")) { // 파일을 이상없이 열었을 경우
        ls_Text = trim(radPort.Value)
            + "|" + trim(radSpeed.Value)
            + "|" + trim(radBoundRate.Value)
            + "|" + trim(radParityBit.Value)
            + "|" + trim(radStopBIt.Value)
            + "|" + chr(13) + chr(10);

        fiConfigFile.write(ls_Text);
        
        fiConfigFile.close();
        
        gfn_SaveMessage(); // 저장 메세지를 처리한다.

    } else {
        gfn_Alert("파일이 잘 못 되었습니다.\n"+ls_config_file+" 파일을 삭제한 후 다시 저장해 주십시오.");
    }

}
/* 공통 필수 종료 */

/* 사용자 함수 */


/*
 * 기능 : 버튼 활성/비활성시킨다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetFormAuth(bStatus) {
    btnSave.Enable = bStatus; // 수정&저장 버튼
}

/* 사용자 이벤트 함수 */

function Form_OnSize(obj,nCx,nCy,nState) {
	
}
]]></Script>
</Window>
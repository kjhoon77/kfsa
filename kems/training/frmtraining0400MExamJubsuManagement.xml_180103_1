<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="595" Id="frmtraining0400MExamJubsuManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="시험접수관리" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEmailDomain">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oImage">
				<Contents>
					<colinfo id="FILE_NAME" size="260" summ="default" type="STRING"/>
					<colinfo id="SHORT_FILE_NAME" size="14" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="4" summ="default" type="INT"/>
					<colinfo id="CREATE_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="UPDATE_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="ACCESS_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="ATTR_ARCHIVE" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_SYSTEM" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_HIDDEN" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_READONLY" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_DIRECTORY" size="4" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRemarkGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamOrderMgno"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSeatNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuAllInfo" OnRowPosChanged="ds_oJubsuAllInfo_OnRowPosChanged">
				<Contents>
					<colinfo id="COURSECD" size="2" type="STRING"/>
					<colinfo id="COURSEMUNJECD" size="4" type="STRING"/>
					<colinfo id="JUBSUNO" size="6" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>
					<colinfo id="MGJIBUCD" size="4" type="STRING"/>
					<colinfo id="PASSDATE" size="8" type="STRING"/>
					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TJPASSYN" size="1" type="STRING"/>
					<colinfo id="EOMGNO" size="22" type="DECIMAL"/>
					<colinfo id="EORDER" size="3" type="STRING"/>
					<colinfo id="YEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oOrderHist">
				<Contents>
					<colinfo id="ABSENTYN" size="7" type="STRING"/>
					<colinfo id="AFTERJIBU" size="4" type="STRING"/>
					<colinfo id="AFTERJUBSUNO" size="6" type="STRING"/>
					<colinfo id="AFTERMGNO" size="22" type="DECIMAL"/>
					<colinfo id="AFTERORDER" size="3" type="STRING"/>
					<colinfo id="BEFORJIBU" size="4" type="STRING"/>
					<colinfo id="BEFORJUBSUNO" size="6" type="STRING"/>
					<colinfo id="BEFORMGNO" size="22" type="DECIMAL"/>
					<colinfo id="BEFORORDER" size="3" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>
					<colinfo id="TJLASTSUNAPGUBUN" size="2" type="STRING"/>
					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>
					<colinfo id="EOHSEQ" size="22" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSetlmentHist" OnRowPosChanged="ds_oSetlmentHist_OnRowPosChanged">
				<Contents>
					<colinfo id="ESSETLMTYN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMenuTree">
				<Contents>
					<colinfo id="MORDERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MENULEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="MPARENTMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MURL" size="256" summ="default" type="STRING"/>
					<colinfo id="MREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="MURLTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MSYSGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oModifyColumn">
				<Contents>
					<colinfo id="COLUMNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="COLUMNNM" size="256" summ="default" type="STRING"/>
					<record>
						<COLUMNCD>PERSONNM</COLUMNCD>
						<COLUMNNM>성명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>BIRTHDAY</COLUMNCD>
						<COLUMNNM>주민번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ZIPCD</COLUMNCD>
						<COLUMNNM>우편번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR1</COLUMNCD>
						<COLUMNNM>주소1</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR2</COLUMNCD>
						<COLUMNNM>주소2</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TEL</COLUMNCD>
						<COLUMNNM>전화번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>HPTEL</COLUMNCD>
						<COLUMNNM>휴대폰</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EMAILID</COLUMNCD>
						<COLUMNNM>이메일ID</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EMAILDOMAIN</COLUMNCD>
						<COLUMNNM>이메일주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>COMPNM</COLUMNCD>
						<COLUMNNM>근무처</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>REMARKCD</COLUMNCD>
						<COLUMNNM>적요구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>REMARK</COLUMNCD>
						<COLUMNNM>적요내용</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>PICTURE</COLUMNCD>
						<COLUMNNM>사진</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>JUBSUNO</COLUMNCD>
						<COLUMNNM>접수번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>DECISIONSEATNO</COLUMNCD>
						<COLUMNNM>좌석번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>BARCODE</COLUMNCD>
						<COLUMNNM>바코드</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJJUBSUGUBUN</COLUMNCD>
						<COLUMNNM>응시자격구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJADDRGUBUN</COLUMNCD>
						<COLUMNNM>구/새주소&#32;구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRPNUCD</COLUMNCD>
						<COLUMNNM>PNU코드</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRROADBUILDMGNO</COLUMNCD>
						<COLUMNNM>건물관리번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRROADDETAIL</COLUMNCD>
						<COLUMNNM>도로명상세주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRROADREMAIN</COLUMNCD>
						<COLUMNNM>도로명부가주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRSANGUBUN</COLUMNCD>
						<COLUMNNM>산번지여부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRMAINBUNJI</COLUMNCD>
						<COLUMNNM>주번지</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRSUBBUNJI</COLUMNCD>
						<COLUMNNM>부번지</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRBUILDNM</COLUMNCD>
						<COLUMNNM>건물명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRADDRETC</COLUMNCD>
						<COLUMNNM>기타주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJREJUBSUYN</COLUMNCD>
						<COLUMNNM>재접수여부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJCHASUGUBUN</COLUMNCD>
						<COLUMNNM>차수구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>GAJUBSUGUBUN</COLUMNCD>
						<COLUMNNM>가접수구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJJUBSUREASON</COLUMNCD>
						<COLUMNNM>학경력인정사유</COLUMNNM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamJubsuResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamJubsuPrint"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamOrder"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioExamJubsu">
				<Contents>
					<colinfo id="ABSENTDAY" size="1" summ="default" type="STRING"/>
					<colinfo id="ABSENTYN" size="7" summ="default" type="STRING"/>
					<colinfo id="ADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="AUTHYN" size="1" summ="default" type="STRING"/>
					<colinfo id="BARCODE" size="12" summ="default" type="STRING"/>
					<colinfo id="COMPNM" size="30" summ="default" type="STRING"/>
					<colinfo id="COURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="COURSEMUNJECD" size="3" summ="default" type="STRING"/>
					<colinfo id="COURSENM" size="30" summ="default" type="STRING"/>
					<colinfo id="DECISIONSEATNO" size="22" summ="default" type="STRING"/>
					<colinfo id="EMAILDOMAIN" size="40" summ="default" type="STRING"/>
					<colinfo id="EMAILID" size="40" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="LASTEJHSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="LASTEOHSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="LASTESSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="MGJIBUCD" size="4" summ="default" type="STRING"/>
					<colinfo id="MGJIBUNICK" size="20" summ="default" type="STRING"/>
					<colinfo id="MGJIBUNM" size="70" summ="default" type="STRING"/>
					<colinfo id="MUNJEGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="PASSYN" size="1" summ="default" type="STRING"/>
					<colinfo id="PERSONNM" size="20" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="100" summ="default" type="STRING"/>
					<colinfo id="REMARKCD" size="2" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="13" summ="default" type="STRING"/>
					<colinfo id="TEL" size="16" summ="default" type="STRING"/>
					<colinfo id="EJMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="TPMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="EOMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="EORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZIPCD" size="6" summ="default" type="STRING"/>
					<colinfo id="EJEXPYN" size="1" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="IIIMGBINARY" size="4000" summ="default" type="BLOB"/>
					<colinfo id="EJJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRPNUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRROADBUILDMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRROADDETAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRROADREMAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRSANGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRMAINBUNJI" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRSUBBUNJI" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRBUILDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRADDRETC" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRCONVPGM" size="256" summ="default" type="STRING"/>
					<colinfo id="EJRCONVSTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="amlml" size="256" summ="default" type="STRING"/>
					<colinfo id="EJREJUBSUYN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJCHASUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GAJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSONKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="DI" size="256" summ="default" type="STRING"/>
					<colinfo id="CI" size="256" summ="default" type="STRING"/>
					<colinfo id="CIVER" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY7" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oPosResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>소속지부접수</DATA>
					</record>
					<record>
						<CD>T</CD>
						<DATA>타지부접수</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamAdd"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oChangeTpmgno">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>조회</DATA>
					</record>
					<record>
						<CD>C</CD>
						<DATA>성명/주민번호&#32;변경</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingPerson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioYearbizlink"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioT_E_L_JubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioExam_ReturnTpmgnoJubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioExam_JubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioExamPerson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTrainingJubsuMatching"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioSettelYN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>Y</CD>
						<DATA>입금</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>미입금</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioJubsuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>20</CD>
						<DATA>강습수료&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</DATA>
					</record>
					<record>
						<CD>00</CD>
						<DATA>경력</DATA>
					</record>
					<record>
						<CD>01</CD>
						<DATA>학력</DATA>
					</record>
					<record>
						<CD>02</CD>
						<DATA>학·경력</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuGubunCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuGubun">
				<Contents>
					<colinfo id="EOMGGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GTTEAMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EOTCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERSERL" size="256" summ="default" type="STRING"/>
					<colinfo id="EJJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TCCOURSENM" size="256" summ="default" type="STRING"/>
					<colinfo id="EOYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="EJJUBSUREASON" size="256" summ="default" type="STRING"/>
					<colinfo id="EJREJUBSUYN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJCHASUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJPASSYN" size="256" summ="default" type="STRING"/>
					<colinfo id="EJAGENCYYN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAddr">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>지번주소</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>도로명주소</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioYN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>Y</CD>
						<DATA>예</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>아니오</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioJubsuGubun2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>10</CD>
						<DATA>강습수료&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</DATA>
					</record>
					<record>
						<CD>00</CD>
						<DATA>경력</DATA>
					</record>
					<record>
						<CD>03</CD>
						<DATA>가접수</DATA>
					</record>
					<record>
						<CD></CD>
						<DATA></DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioChasuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>1·2차&#32;시험</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>1차&#32;시험</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>2차&#32;시험</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSunapRepayAmount">
				<Contents>
					<colinfo id="FECFEE" size="256" summ="default" type="STRING"/>
					<colinfo id="ESPROCAMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AFTERAMOUNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioGaJubsuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택</DATA>
					</record>
					<record>
						<CD>03</CD>
						<DATA>신청</DATA>
					</record>
					<record>
						<CD>04</CD>
						<DATA>완료</DATA>
					</record>
					<record>
						<CD>99</CD>
						<DATA>자격미달</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamCheat"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oLicenseCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamOmrFile">
				<Contents>
					<colinfo id="AFEJMGNO" size="256" type="STRING"/>
					<colinfo id="AFFILENM" size="256" type="STRING"/>
					<colinfo id="AFPATH" size="256" type="STRING"/>
					<colinfo id="AFREGDATE" size="256" type="STRING"/>
					<colinfo id="AFREGSABUN" size="256" type="STRING"/>
					<colinfo id="AFSEQ" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMunje"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oForm">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택</DATA>
					</record>
					<record>
						<CD>0021</CD>
						<DATA>시험응시원서</DATA>
					</record>
					<record>
						<CD>0022</CD>
						<DATA>시험일정변경신청서</DATA>
					</record>
					<record>
						<CD>0023</CD>
						<DATA>시험&#32;환불신청서</DATA>
					</record>
					<record>
						<CD>0013</CD>
						<DATA>심폐소생술&#32;시험응시원서</DATA>
					</record>
					<record>
						<CD>0018</CD>
						<DATA>생활안전강사&#32;시험응시원서</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormSave">
				<Contents>
					<colinfo id="I_PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FRDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormSave"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormDelete">
				<Contents>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormDelete"></Dataset>
		</Datasets>
		<Shape Bottom="294" Height="254" Id="shpGubunBox3" Left="328" LineColor="user15" Right="996" TabOrder="84" Top="40" Type="Rectangle" Width="668"></Shape>
		<Radio Border="Flat" CodeColumn="CD" Column="EJJUBSUGUBUN" ColumnCount="6" DataColumn="DATA" Font="굴림,10" Height="20" Id="radJubsuGubun2" INDEX="0" InnerDataset="ds_ioJubsuGubun2" Left="424" LeftMargin="4" OnChanged="radJubsuGubun2_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="104" Top="196" UserData="S" Width="436"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnApplyPicture" ImageID="BTN_TEXT_06" Left="777" OnClick="btnApplyPicture_OnClick" Style="sty_Button" TabOrder="39" Text="최근사진반영" Top="151" Transparent="TRUE" Width="93"></Button>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="280" LineColor="user14" Right="1000" TabOrder="70" Top="1" Type="Rectangle" Width="720"></Shape>
		<Shape Bottom="400" Height="360" Id="shpGubunBox1" Left="4" LineColor="user15" Right="324" TabOrder="84" Top="40" Type="Rectangle" Width="320"></Shape>
		<Shape Bottom="455" Height="143" Id="shpGubunBox4" Left="328" LineColor="user15" Right="996" TabOrder="84" Top="312" Type="Rectangle" Width="668"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="65" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="192">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" BindDataset="ds_oSetlmentHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="450" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="97" Id="gdSetlmentHist" InputPanel="FALSE" Left="432" LineColor="default" Right="991" RowHeight="20" Style="sty_Grid" TabOrder="53" TabStop="true" Top="353" UseDBuff="true" UsePopupMenu="true" UserData="결제내역" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="559">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="77"/>
						<col width="47"/>
						<col width="47"/>
						<col width="98"/>
						<col width="106"/>
						<col width="70"/>
						<col width="65"/>
						<col width="73"/>
						<col width="73"/>
						<col width="94"/>
						<col width="0"/>
						<col width="94"/>
						<col width="94"/>
						<col width="1"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="처리일자"/>
						<cell col="2" display="text" text="결제"/>
						<cell col="3" display="text" text="선수납"/>
						<cell align="center" col="4" display="text" text="결제구분"/>
						<cell align="center" col="5" display="text" text="결제방법"/>
						<cell align="center" col="6" display="text" text="금액(원)"/>
						<cell align="center" col="7" display="text" text="환불No."/>
						<cell col="8" display="text" text="처리지부"/>
						<cell align="center" col="9" display="text" text="처리자"/>
						<cell align="center" col="10" display="text" text="주문번호"/>
						<cell align="center" col="11" display="text" text="세금계산서발행여부"/>
						<cell col="12" display="text" text="POS지부"/>
						<cell col="13" display="text" text="관리지부"/>
						<cell col="14" display="text" text="선수납여부"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="0" display="number" expr="ln_TotalGridSetlementCount&#32;-&#32;CURROW"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="1" colid="ESPROCDATE" display="text" Mask="####-##-##"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="2" colid="ESSETLMTYN" color='expr:iif(ESSETLMTYN==&quot;N&quot;,&quot;red&quot;,&quot;default&quot;)' combocol="CD" combodataset="ds_ioSettelYN" combotext="DATA" display="combo" font="굴림,10"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="3" colid="EARLYGUBUNNAME" color='expr:iif(EARLYGUBUN==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="4" colid="ESGUBUNCDNM" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="5" colid="ESGUBUNNM" display="text"/>
						<cell align="right" bkcolor="expr:fn_bkcolor(currow)" col="6" colid="ESPROCAMOUNT" display="number" Mask="#,###"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="7" colid="ESREPAYREF" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="8" colid="ESPROCGTMGNM" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="9" colid="PROCSABUN" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="10" colid="ESJUMUNNO" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="11" colid="TAXRCPTYN" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="12" colid="ESPOSGTMGNM" display="text"/>
						<cell align="center" bkcolor="expr:fn_bkcolor(currow)" col="13" colid="ESMGGTMGNM" display="text"/>
						<cell col="14" colid="EARLYGUBUN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="282" OnClick="lfn_Search" Style="sty_Button" TabOrder="56" ToolTipText="조회" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="457" OnClick="lfn_Delete" Style="sty_Button" TabOrder="17" ToolTipText="삭제&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="369" OnClick="lfn_Save" Style="sty_Button" TabOrder="16" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="651" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="18" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="738" OnClick="lfn_Excel" Style="sty_Button" TabOrder="19" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="825" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="20" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="912" OnClick="lfn_End" Style="sty_Button" TabOrder="21" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="66" Text="지부" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnChanged="lfn_SearchExamLatestOrder" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="22" Top="55" UserData="I:지부" Width="88"></Combo>
		<Static Align="Center" Height="96" Id="lbCourse" Left="8" Style="sty_Label" TabOrder="67" Text="직능" Top="80" UserData="S" VAlign="Middle" Width="20" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="20" Id="lbExamYear" Left="192" Style="sty_Label" TabOrder="68" Text="년도" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Height="20" Id="edExamYear" ImeMode="native" Left="284" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExamYear_OnKeyDown" OnKillFocus="lfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="23" Top="56" UserData="I:년도" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lbExamOrder" Left="8" Style="sty_Label" TabOrder="69" Text="회차" Top="181" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbPersonNm" Left="332" Style="sty_Label" TabOrder="70" Text="성명" Top="55" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edExamOrder" ImeMode="native" Left="100" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExamOrder_OnKeyDown" OnKillFocus="edExamOrder_OnKillFocus" Style="sty_Edit" TabOrder="1" Top="182" UserData="S:회차" Width="28"></Edit>
		<Static Align="Center" Height="20" Id="lbBIRTHDAY" Left="332" Style="sty_Label" TabOrder="71" Text="주민등록번호" Top="79" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbAt" Left="1198" Style="sty_Text" TabOrder="72" Text="@" Top="196" VAlign="Middle" Width="16"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfo" ImageID="BTN_TEXT_08" Left="535" OnClick="btnSearchPersonInfo_OnClick" Style="sty_Button" TabOrder="32" Text="접수자&#32;&#32;검색" Top="55" Transparent="TRUE" Width="118"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="PERSONNM" Height="20" Id="edPersonNm" ImeMode="native" Left="424" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="3" Top="55" UserData="S:성명" Width="106"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuNo" ImeMode="native" Left="100" LeftMargin="2" MaxLength="6" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edJubsuNo_OnKeyDown" OnKillFocus="edJubsuNo_OnKillFocus" Style="sty_Edit" TabOrder="2" Top="205" UserData="S:접수번호" Width="50"></Edit>
		<Static Align="Center" Height="20" Id="lbSeq" Left="8" Style="sty_Label" TabOrder="73" Text="접수번호" Top="205" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbAddr" Left="332" Style="sty_Label" TabOrder="76" Text="주소" Top="128" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioExamJubsu" BKColor="user4" Border="Flat" Column="ZIPCD" Height="20" Id="medZipCode" Left="424" LeftMargin="2" Mask="######" OnFocus="edZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="6" Top="128" Type="STRING" UserData="S" Width="50"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchZipCode" ImageID="BTN_SEARCH" Left="475" OnClick="btnSearchZipCode_OnClick" Style="sty_Button" TabOrder="34" Top="128" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="ADDR1" Height="20" Id="edAddr1" ImeMode="native" Left="498" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="7" Top="127" UserData="S" Width="268"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="ADDR2" Height="20" Id="edAddr2" ImeMode="native" Left="332" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="8" Top="150" UserData="S" Width="436"></Edit>
		<Static Align="Center" Height="20" Id="lbTel" Left="332" Style="sty_Label" TabOrder="74" Text="전화번호" Top="173" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="TEL" Height="20" Id="edTel" ImeMode="native" Left="424" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="173" UserData="S" Width="104"></Edit>
		<Static Align="Center" Height="20" Id="lbHpTel" Left="332" Style="sty_Label" TabOrder="75" Text="휴대폰" Top="104" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="HPTEL" Height="20" Id="edHpTel" ImeMode="native" Left="424" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="5" Top="104" UserData="S" Width="106"></Edit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="BIRTHDAY7" Height="20" Id="medBIRTHDAY" Left="424" LeftMargin="2" Mask="######-#######" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medBIRTHDAY_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="4" Top="79" Type="STRING" UserData="S:주민번호" Width="106"></MaskEdit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxEmailDomain" INDEX="0" InnerDataset="ds_oEmailDomain" Left="1318" OnChanged="cbxEmailDomain_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="42" Top="195" Width="92"></Combo>
		<Static Align="Center" Height="20" Id="lbEmail" Left="1012" Style="sty_Label" TabOrder="76" Text="E-Mail" Top="196" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Column="EMAILID" Height="20" Id="edEmail" ImeMode="native" Left="1104" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="25" Top="196" UserData="S" Width="95"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAuthBIRTHDAY" ImageID="BTN_TEXT_07" Left="656" OnClick="btnAuthBIRTHDAY_OnClick" Style="sty_Button" TabOrder="33" Text="실명인증" Top="79" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExamJubsuModify" ImageID="BTN_TEXT_COM" Left="100" OnClick="btnExamJubsuModify_OnClick" Style="sty_Button" TabOrder="31" Text="회차변경" Top="303" Transparent="TRUE" Width="85"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_oJubsuAllInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="591" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdJubsuInfo" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnCellClick="gdJubsuInfo_OnCellClick" Right="496" RowHeight="20" Style="sty_Grid" TabOrder="54" TabStop="true" Top="483" UseDBuff="true" UsePopupMenu="true" UserData="개인접수정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="492">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="68"/>
						<col width="36"/>
						<col width="134"/>
						<col width="31"/>
						<col width="58"/>
						<col width="83"/>
						<col width="59"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="지부"/>
						<cell align="center" col="2" display="text" text="년도"/>
						<cell align="center" col="3" display="text" text="직능"/>
						<cell align="center" col="4" display="text" text="회차"/>
						<cell align="center" col="5" display="text" text="접수번호"/>
						<cell align="center" col="6" display="text" text="합격일자"/>
						<cell align="center" col="7" display="text" text="환불여부"/>
					</head>
					<body>
						<cell align="right" col="0" display="number" expr="ln_TotalGridInfoCount&#32;-&#32;CURROW"/>
						<cell align="center" col="1" colid="MGJIBUCD" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="2" colid="YEAR" display="text"/>
						<cell align="center" col="3" colid="COURSEMUNJECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>
						<cell align="center" col="4" colid="EORDER" display="text"/>
						<cell align="center" col="5" colid="JUBSUNO" display="text"/>
						<cell align="center" col="6" colid="PASSDATE" display="text" Mask="####-##-##" text="####-##-##"/>
						<cell align="center" col="7" colid="LASTSUNAPGUBUN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJubsuInfo" Left="4" Style="sty_LabelGruopBox" TabOrder="77" Text="개인접수정보" Top="462" VAlign="Middle" Width="120"></Static>
		<Grid AutoEnter="TRUE" BindDataset="ds_oOrderHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="591" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdOrderHist" InputPanel="FALSE" Left="500" LineColor="default" OnCellClick="gdOrderHist_OnCellClick" Right="996" RowHeight="20" Style="sty_Grid" TabOrder="55" TabStop="true" Top="483" UseDBuff="true" UsePopupMenu="true" UserData="회차변경정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="496">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="79"/>
						<col width="60"/>
						<col width="200"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2" SuppressAlign="Middle" text="순번">
							<cell col="0" display="text" rowspan="2" text="순번"/>
						</cell>
						<cell col="1" display="text" rowspan="2" SuppressAlign="Middle" text="지부">
							<cell col="0" display="text" rowspan="2" text="지부"/>
						</cell>
						<cell col="2" display="text" rowspan="2" SuppressAlign="Middle" text="회차">
							<cell col="0" display="text" rowspan="2" text="회차"/>
						</cell>
						<cell col="3" display="text" rowspan="2" SuppressAlign="Middle" text="접수번호">
							<cell col="0" display="text" rowspan="2" text="접수번호"/>
						</cell>
						<cell col="4" colspan="3" display="text" text="변경&#32;후">
							<cell col="0" colspan="3" display="text" text="변경&#32;후"/>
						</cell>
						<cell align="center" col="7" display="text" rowspan="2" SuppressAlign="Middle" text="처리일자" Valign="Center" wordwrap="word"/>
						<cell col="8" display="text" rowspan="2" SuppressAlign="Middle" text="환불여부">
							<cell col="0" display="text" rowspan="2" text="환불여부"/>
						</cell>
						<cell col="9" display="text" rowspan="2" text="변경사유"/>
						<cell align="center" col="4" display="text" row="1" text="지부"/>
						<cell align="center" col="5" display="text" row="1" text="회차"/>
						<cell align="center" col="6" display="text" row="1" text="접수번호"/>
					</head>
					<body>
						<cell align="right" col="0" display="number" expr="ln_TotalGridOrderCount&#32;-&#32;CURROW"/>
						<cell align="center" col="1" colid="BEFORJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="2" colid="BEFORORDER" display="text"/>
						<cell align="center" col="3" colid="BEFORJUBSUNO" display="text"/>
						<cell align="center" col="4" colid="AFTERJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="5" colid="AFTERORDER" display="text"/>
						<cell align="center" col="6" colid="AFTERJUBSUNO" display="text"/>
						<cell col="7" colid="EOHPROCDATE" display="text" Mask="####-##-##" text="####-##-##"/>
						<cell align="center" col="8" colid="LASTSUNAPGUBUN" display="text"/>
						<cell col="9" colid="EJHPROCREASON" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJubsuHist" Left="500" Style="sty_LabelGruopBox" TabOrder="78" Text="개인접수회차이력" Top="462" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="20" Id="lbSetlmt" Left="337" Style="sty_LabelGruopBox" TabOrder="79" Text="결제내역" Top="301" VAlign="Middle" Width="120"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Column="EMAILDOMAIN" Height="20" Id="edEmailDomain" ImeMode="native" Left="1212" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="26" Top="196" UserData="S" Width="104"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeqList" ImageID="BTN_TEXT_06" Left="154" OnClick="btnSeqList_OnClick" Style="sty_Button" TabOrder="29" Text="접수목록" ToolTipText="현접수번호를&#32;제외한&#32;이후&#32;목록" Top="204" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchExamOrder" ImageID="BTN_TEXT_06" Left="132" OnClick="btnSearchExamOrder_OnClick" OnKeyDown="btnSearchExamOrder_OnClick" Style="sty_Button" TabOrder="28" Text="접수가능회차" Top="180" Transparent="TRUE" Width="92"></Button>
		<FileDialog Bottom="28" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage" Left="226" Right="250" TabOrder="93" Top="4" Width="24"></FileDialog>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Font="굴림,9" Height="96" Id="radCourse" INDEX="0" InnerDataset="ds_oCourse" Left="32" OnChanged="lfn_SearchExamLatestOrder" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="24" Top="80" UserData="I:직능" Width="288"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTraingJubsuHist" ImageID="BTN_TEXT_08" Left="535" OnClick="btnTraingJubsuHist_OnClick" Style="sty_Button" TabOrder="35" Text="기존접수이력(F6)" Top="79" Transparent="TRUE" Width="118"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnChangeProcDate" ImageID="BTN_TEXT_06" Left="589" OnClick="btnChangeProcDate_OnClick" Style="sty_Button" TabOrder="50" Text="처리일자변경" Top="328" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnProcRct" ImageID="BTN_TEXT_09" Left="683" OnClick="btnProcRct_OnClick" Style="sty_Button" TabOrder="51" Text="현금영수증처리/취소" Top="328" Transparent="TRUE" Width="131"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRct" ImageID="BTN_TEXT_06" Left="816" OnClick="btnPrintReRct_OnClick" Style="sty_Button" TabOrder="52" Text="영수증재발행" Top="328" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendSms" ImageID="BTN_TEXT_08" Left="535" OnClick="btnSendSms_OnClick" Style="sty_Button" TabOrder="40" Text="문자발송" Top="103" Transparent="TRUE" Width="118"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendEmail" ImageID="BTN_TEXT_04" Left="1412" OnClick="btnSendEmail_OnClick" Style="sty_Button" TabOrder="43" Text="메일발송" Top="195" Transparent="TRUE" Width="66"></Button>
		<Button BKColor="user17" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Font="굴림,10,Bold" Height="97" Id="btnSetlmt" Left="336" OnClick="btnSetlmt_OnClick" Style="sty_Button" TabOrder="48" Text="결제(POS)" Top="352" Width="96"></Button>
		<Static Align="Center" Height="20" Id="lbOrderChange" Left="8" Style="sty_Label" TabOrder="81" Text="회차변경" Top="304" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="#cc0000" Bottom="300" Height="4" Id="shpBox1" Left="328" LineColor="#cc0000" Right="1000" TabOrder="81" Top="296" Type="Rectangle" Width="672"></Shape>
		<Shape BKColor="#cc0000" Bottom="461" Height="4" Id="shpBox2" Left="0" LineColor="#cc0000" Right="1000" TabOrder="81" Top="457" Type="Rectangle" Width="1000"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSmsStat" ImageID="BTN_TEXT_07" Left="657" OnClick="btnSmsStat_OnClick" Style="sty_Button" TabOrder="41" Text="문자현황" Top="103" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEmailStat" ImageID="BTN_TEXT_04" Left="1480" OnClick="btnEmailStat_OnClick" Style="sty_Button" TabOrder="44" Text="메일현황" Top="195" Transparent="TRUE" Width="66"></Button>
		<Static Align="Center" Height="46" Id="lbExamInfo" Left="8" Style="sty_Label" TabOrder="81" Text="회차정보" Top="253" VAlign="Middle" Width="36" WordWrap="TRUE"></Static>
		<Image BindDataset="ds_ioExamJubsu" Border="Flat" FillType="STRETCH" Height="144" Id="imgPicture" Left="876" Style="sty_Image" TabOrder="82" Text="사진" Top="47" Transparent="TRUE" Width="112"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="105" Id="imgLastestPicture" Left="778" Style="sty_Image" TabOrder="83" Text="최근사진" Top="45" Transparent="TRUE" Width="87"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchRegPicture" ImageID="BTN_TEXT_06" Left="777" OnClick="btnSearchRegPicture_OnClick" Style="sty_Button" TabOrder="37" Text="등록사진조회" Top="174" Transparent="TRUE" Width="93"></Button>
		<Static Align="Center" Height="20" Id="lbExamPersonInfo" Left="340" Style="sty_LabelGruopBox" TabOrder="84" Text="접수자&#32;기본&#32;정보" Top="32" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="20" Id="lbJubsu" Left="19" Style="sty_LabelGruopBox" TabOrder="84" Text="접수" Top="32" VAlign="Middle" Width="60"></Static>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbExamInfo1" Left="48" Style="sty_Label" TabOrder="60" Top="254" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbExamInfo2" Left="48" Style="sty_Label" TabOrder="61" Top="276" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnUnUseJubsuNo" ImageID="BTN_TEXT_04" Left="250" OnClick="lfn_SearchUnUseJubsuNo" Style="sty_Button" TabOrder="30" Text="빈번호" ToolTipText="빈접수번호조회" Top="204" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadPicture" ImageID="BTN_TEXT_08" Left="870" OnClick="btnLoadPicture_OnClick" Style="sty_Button" TabOrder="47" Text="사진찾기" Top="242" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadScanPicture" ImageID="BTN_TEXT_08" Left="870" OnClick="btnLoadScanPicture_OnClick" Style="sty_Button" TabOrder="46" Text="스캔사진불러오기" Top="218" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnScanPicture" ImageID="BTN_TEXT_08" Left="870" OnClick="btnScanPicture_OnClick" Style="sty_Button" TabOrder="45" Text="사진스캔실행" Top="194" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPictureManagement" ImageID="BTN_TEXT_06" Left="1072" OnClick="btnPictureManagement_OnClick" Style="sty_Button" TabOrder="38" Text="사진관리" Top="112" Transparent="TRUE" Width="93"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnShowVirtualAccount" ImageID="BTN_TEXT_06" Left="495" OnClick="btnShowVirtualAccount_OnClick" Style="sty_Button" TabOrder="49" Text="가상계좌보기" Top="328" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnModifyHistory" ImageID="BTN_TEXT_04" Left="179" OnClick="btnModifyHistory_OnClick" Style="sty_Button" TabOrder="36" Text="변경이력" ToolTipText="접수정보변경이력" Top="229" Transparent="TRUE" Width="66"></Button>
		<File Bottom="28" Height="24" Id="fiImageFile" Left="200" Right="224" TabOrder="99" Top="4" Width="24"></File>
		<Static Align="Center" Height="20" Id="lbExpYn" Left="332" Style="sty_Label" TabOrder="85" Text="응시자격구분" Top="196" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_TEXT_07" Left="544" OnClick="lfn_Print" Style="sty_Button" TabOrder="86" Text="응시원서출력(F9)" ToolTipText="응시원서출력" Top="4" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExamCheatingManageLink" ImageID="BTN_TEXT_06" Left="224" OnClick="btnExamCheatingManageLink_OnClick" Style="sty_Button" TabOrder="87" Text="부정행위관리" Top="303" Transparent="TRUE" Width="92"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPoint" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="88" Top="352" UserData="S" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lbPoint" Left="8" Style="sty_Label" TabOrder="89" Text="점수" Top="352" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPassYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="90" Top="328" UserData="S" Width="52"></Edit>
		<Static Align="Center" Height="20" Id="lbPassYn" Left="8" Style="sty_Label" TabOrder="91" Text="합격여부" Top="328" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbSeatNo" Left="8" Style="sty_Label" TabOrder="93" Text="좌석번호" Top="229" VAlign="Middle" Width="88"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edSeatNo" ImeMode="native" Left="100" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="92" Top="229" UserData="S" Width="50"></Edit>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radJibuGubun" INDEX="0" InnerDataset="ds_oJibuGubun" Left="103" LeftMargin="2" OnChanged="radJibuGubun_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="94" Top="32" Value="S" Width="200"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsuHistory" ImageID="BTN_TEXT_04" Left="250" OnClick="btnJubsuHistory_OnClick" Style="sty_Button" TabOrder="95" Text="접수이력" Top="229" Transparent="TRUE" Width="66"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radChangeTpmgno" INDEX="0" InnerDataset="ds_oChangeTpmgno" Left="1032" LeftMargin="2" OnChanged="radChangeTpmgno_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="96" Top="40" Value="S" Visible="FALSE" Width="200"></Radio>
		<Edit BindDataset="ds_ioExamJubsu" Column="MUNJEGUBUN" Height="16" Id="Edit0" Left="1048" OnChanged="Edit0_OnChanged" TabOrder="97" Text="Edit0" Top="64" Visible="FALSE" Width="24"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="Button0" ImageID="BTN_TEXT_07" Left="656" OnClick="btnSearchPersonInfoChange_OnClick" Style="sty_Button" TabOrder="98" Text="접수자정보변경" Top="55" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPosReport" ImageID="BTN_TEXT_07" Left="388" OnClick="btnPosReport_OnClick" Style="sty_Button" TabOrder="99" Text="통합영수증조회" Top="328" Transparent="TRUE" Width="105"></Button>
		<Radio Border="Flat" CodeColumn="CD" Column="EJJUBSUGUBUN" ColumnCount="4" DataColumn="DATA" Height="20" Id="radJubsuGubun" INDEX="0" InnerDataset="ds_ioJubsuGubun" Left="424" LeftMargin="4" OnChanged="radJubsuGubun_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="11" Top="196" UserData="S" Width="436"></Radio>
		<Combo BindDataset="ds_ioExamJubsu" Border="Flat" CodeColumn="CD" Column="EJADDRGUBUN" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxAddrGubun" INDEX="0" InnerDataset="ds_oAddr" Left="681" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="100" Top="149" UserData="S" Visible="FALSE" Width="89"></Combo>
		<Static Align="Center" Height="20" Id="Static0" Left="332" Style="sty_Label" TabOrder="101" Text="재시험여부" Top="219" VAlign="Middle" Width="88"></Static>
		<Radio BindDataset="ds_ioExamJubsu" Border="Flat" CodeColumn="CD" Column="EJREJUBSUYN" ColumnCount="3" DataColumn="DATA" Height="20" Id="radRejubsuYN" INDEX="1" InnerDataset="ds_ioYN" Left="424" OnChanged="radRejubsuYN_OnChanged" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="12" Top="219" UserData="S" Width="124"></Radio>
		<Static Align="Center" Height="20" Id="lbReason" Left="554" Style="sty_Label" TabOrder="102" Text="학·경력&#32;인정사유" Top="219" VAlign="Middle" Width="106"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="EJJUBSUREASON" Height="20" Id="edReason" ImeMode="native" Left="663" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="103" Top="219" UserData="S" Width="197"></Edit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Font="굴림,10" Height="20" Id="cbxCourse" ImeMode="none" INDEX="0" InnerDataset="ds_oJubsuGubunCourse" Left="503" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="10" Top="195" UserData="S" Width="149"></Combo>
		<Static Align="Center" BKColor="saddlebrown" Height="20" Id="lbChasuGubun" Left="332" Style="sty_Label" TabOrder="105" Text="시험차수선택" Top="242" VAlign="Middle" Width="88"></Static>
		<Radio BindDataset="ds_ioExamJubsu" Border="Flat" CodeColumn="CD" Column="EJCHASUGUBUN" ColumnCount="3" DataColumn="DATA" Height="20" Id="radChasuGubun" INDEX="0" InnerDataset="ds_ioChasuGubun" Left="424" OnChanged="radRejubsuYN_OnChanged" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="13" Top="242" UserData="S" Width="332"></Radio>
		<Static Align="Center" Height="20" Id="lb2Point" Left="8" Style="sty_Label" TabOrder="106" Text="2차&#32;점수" Top="376" VAlign="Middle" Visible="FALSE" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed2Point" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="107" Top="376" UserData="S" Visible="FALSE" Width="36"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed1_1Point" ImeMode="native" Left="180" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="108" Top="352" UserData="S" Visible="FALSE" Width="36"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed2_1Point" ImeMode="native" Left="180" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="109" Top="376" UserData="S" Visible="FALSE" Width="36"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed1_2Point" ImeMode="native" Left="260" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="110" Top="352" UserData="S" Visible="FALSE" Width="36"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed2_2Point" ImeMode="native" Left="260" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="111" Top="376" UserData="S" Visible="FALSE" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lb1_1subject" Left="140" Style="sty_Label" TabOrder="112" Text="1과목" Top="352" VAlign="Middle" Visible="FALSE" Width="36"></Static>
		<Static Align="Center" Height="20" Id="lb2_1subject" Left="140" Style="sty_Label" TabOrder="113" Text="1과목" Top="376" VAlign="Middle" Visible="FALSE" Width="36"></Static>
		<Static Align="Center" Height="20" Id="lb1_2subject" Left="220" Style="sty_Label" TabOrder="114" Text="2과목" Top="352" VAlign="Middle" Visible="FALSE" Width="36"></Static>
		<Static Align="Center" Height="20" Id="lb2_2subject" Left="220" Style="sty_Label" TabOrder="115" Text="2과목" Top="376" VAlign="Middle" Visible="FALSE" Width="36"></Static>
		<Static Align="Center" Height="20" Id="lb1Point" Left="8" Style="sty_Label" TabOrder="116" Text="1차&#32;점수" Top="352" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed1Point" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="117" Top="352" UserData="S" Width="36"></Edit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Font="굴림,10" Height="20" Id="cbxGaJubsuGubun" ImeMode="none" INDEX="0" InnerDataset="ds_ioGaJubsuGubun" Left="780" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="118" Top="195" UserData="S" Width="81"></Combo>
		<Static Align="Center" BKColor="user36" BorderColor="user0" Height="20" Id="lbImsiEJMGNO" Left="8" Style="sty_Label" TabOrder="121" Text="EJMGNO" Top="405" VAlign="Middle" Width="55"></Static>
		<Edit BindDataset="ds_ioExamJubsu" Column="EJMGNO" Height="20" Id="edImsiEJMGNO" Left="63" TabOrder="119" Top="405" Width="62"></Edit>
		<Static Align="Center" BKColor="user36" BorderColor="user0" Height="20" Id="lbImsiTPMGNO" Left="8" Style="sty_Label" TabOrder="122" Text="TPMGNO" Top="429" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_ioExamJubsu" Column="TPMGNO" Height="20" Id="edImsiTPMGNO" Left="67" TabOrder="120" Top="429" Width="62"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRctPDF" ImageID="BTN_TEXT_05" Left="765" OnClick="btnPrintReRctPDF_OnClick" Style="sty_Button" TabOrder="123" Text="영수증PDF" Top="304" Transparent="TRUE" Width="80"></Button>
		<HttpFile Height="24" Id="hfImage" Left="254" Top="4" Width="24"></HttpFile>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPosvath" ImageID="BTN_TEXT_05" Left="911" OnClick="btnPrintEstimate_OnClick" Style="sty_Button" TabOrder="124" Text="부가세정보" Top="328" Transparent="TRUE" Width="79"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnEstimate" ImageID="BTN_TEXT_10" Left="846" OnClick="btnEstimate_OnClick" Style="sty_Button" TabOrder="125" Text="기준일자별&#32;계산서발행" Top="304" Transparent="TRUE" Width="144"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExamOmrImage" ImageID="BTN_TEXT_06" Left="232" OnClick="btnExamOmrImage_OnClick" Style="sty_Button" TabOrder="126" Text="답안지&#32;보기" Top="404" Transparent="TRUE" Width="92"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="ed1PassDate" ImeMode="native" Left="154" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="127" Top="328" UserData="S" Width="142"></Edit>
		<Shape Bottom="292" Height="27" Id="Shape0" Left="330" LineColor="darkgoldenrod" Right="988" TabOrder="128" Top="265" Type="Rectangle" Width="658"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSave" ImageID="BTN_TEXT_04" Left="907" OnClick="btnScanSave_OnClick" Style="sty_Button" TabOrder="135" Text="③서류저장" ToolTipText="서류저장" Top="268" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLocalFormView" ImageID="BTN_SEARCH" Left="881" OnClick="btnLocalFormView_OnClick" Style="sty_Button" TabOrder="136" Top="268" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edScanFileName" ImeMode="native" Left="806" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="134" Top="268" UserData="S" Width="74"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSearch" ImageID="BTN_TEXT_04" Left="737" OnClick="btnScanSearch_OnClick" Style="sty_Button" TabOrder="133" Text="②불러오기" ToolTipText="불러오기" Top="268" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScan" ImageID="BTN_TEXT_04" Left="668" OnClick="btnScan_OnClick" Style="sty_Button" TabOrder="132" Text="①스캔실행" ToolTipText="스캔실행" Top="268" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeverFormView" ImageID="BTN_SEARCH" Left="642" OnClick="btnSeverFormView_OnClick" Style="sty_Button" TabOrder="131" Top="268" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edFormResult" ImeMode="native" Left="596" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="130" Top="268" UserData="S" Width="45"></Edit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxForm" INDEX="0" InnerDataset="ds_oForm" Left="423" OnChanged="cbxForm_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="14" Top="267" Width="172"></Combo>
		<Static Align="Center" BKColor="firebrick" Font="굴림,10" Height="20" Id="Static3" Left="332" Style="sty_Label" TabOrder="129" Text="민원서류&#32;등록" Top="268" VAlign="Middle" Width="88"></Static>
		<FileDialog Bottom="264" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage2" Left="764" Right="788" TabOrder="137" Top="240" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage2" Left="791" Top="240" Width="24"></HttpFile>
		<File Bottom="264" Height="24" Id="fiImageFile2" Left="818" Right="842" TabOrder="138" Top="240" Width="24"></File>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnFormDelete" ImageID="BTN_MINUS" Left="976" OnClick="btnFormDelete_OnClick" Style="sty_Button" TabOrder="137" ToolTipText="서류삭제" Top="271" Transparent="TRUE" Visible="FALSE" Width="16"></Button>
		<Static Align="Center" Font="굴림,9" Height="20" Id="Static4" Left="461" Style="sty_Label" TabOrder="139" Text="개인식별번호" Top="32" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" BKColor="palegoldenrod" Border="Flat" Column="PERSONKEY" Font="굴림,9" Height="20" Id="medPersonKey" Left="550" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="138" Top="32" Type="STRING" Width="75"></MaskEdit>
		<Div Height="27" Id="Div0" Left="330" TabOrder="140" Text="Div0" Top="265" Width="661">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmtraining0400MExamJubsuManagement.xml
 * 설명 : 시험접수관리
 * 작성일 : 2009.07.17
 * 작성자 : 장성호
 */

#include "LIB::training.js"; // 공통업무 관련

var ls_OldSeatNo = "";               // 좌석번호
var ls_OldPictureNo = "";           // 기존 사진번호

var lb_IsNiceCheckOk = false;       // 실명인증
var lb_FileUpload = false;          // 사진등록여부

var ls_ServiceName = "";            // Transaction시 호출 Service 이름
var ls_CallBackServiceName = "";    // Transaction시 CallBack 함수 이름

var ls_IsChangedJubsuInfoYn = "N";  // 접수자기본정보 변경여부
var ls_IsChangedSeatNoYn    = "N";  // 좌석번호 변경여부
var ls_IsChangedPictureYn   = "N";  // 사진 변경여부

var ls_UploadRealName = "";         // 사진이미지 실제파일명
var ls_FileUploadPath = "/IMGDATA/" + left(GetDate(), 4) + "/" + substr(GetDate(), 4, 2); // 사진이미지경로;

var ls_FormUploadPath = "/IMGDATA/Form/" + left(GetDate(), 4); // 서류스캔파일경로;
var ls_UploadFormName = false; 		// 서류스캔 저장파일명
var lb_FormFileUpload = false; 		// 서류스캔파일등록여부

var ls_AgreeFileUploadFolder = "/PRTDATA/";	// 개인정보동의서 업로드 위치
var ls_AgreeRealFilePath = "";				// 개인정보동의서 파일위치
var ls_AgreeRealFileName = "";				// 개인정보동의서 파일명


var ls_OldPersonName = "";
var ls_OldRID        = "";

var ls_SearchFlag = false;          // 조회시 Mogno Information을 셋팅하기 위해 사용

var serch_falg = "";   // 조회 버튼으로 한 것인지 선택해서 조회 인지 여부 "0", "1" 20091015
var ls_PassSavePrintYN = ""; // 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함

var ls_jubsuPossible = "N";  //접수가능여부 Y:가능 N:불가능

var ls_RetEjmgno = ""; // 시험접수관리번호(관리번호로 조회시 사용)

//personkey 추가..
var ls_DI = "";			// SCI DI 값
var ls_CI = "";			// SCI CI 값
var ls_CIVER = "";		// SCI CI버전
var ls_PERSONKEY = "";	// PERSONKEY 값
var ls_BIRTHDAY = "";	// 조회시 주민번호
var ls_BIRTHDAY7 = "";	// 생년월일7자리

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.
    
    lfn_initJibu();
    
    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }

	// 시스템관리자만 tjmgno, tpmgno가 보이도록 설정
	if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM") {
		lbImsiEJMGNO.Visible = true;
		edImsiEJMGNO.Visible = true;
		edImsiEJMGNO.Text = "";
		lbImsiTPMGNO.Visible = true;
		edImsiTPMGNO.Visible = true;
		edImsiTPMGNO.Text = "";
		btnFormDelete.Visible = true;	// 민원서류 삭제
	} else {
		lbImsiEJMGNO.Visible = false;
		edImsiEJMGNO.Visible = false;
		edImsiEJMGNO.Text = "";
		lbImsiTPMGNO.Visible = false;
		edImsiTPMGNO.Visible = false;
		edImsiTPMGNO.Text = "";
		btnFormDelete.Visible = false;	// 민원서류 삭제
	}



    // 공통 코드 조회
    gfn_SearchTrainingCourse("E", ds_oCourse, "Y"); // 직능 코드 조회
    //ds_oCourse.Filter("CD<>'10'");
    
    radCourse.Value = "22";
    gfn_SearchTrainingCourse("E", ds_oJubsuGubunCourse, "Y", "선택"); //  응시자격구분 직능코드 조회    
    gfn_SearchAllJibu(cbxJibu, "Y", "선택"); // 지부 코드 조회
    gfn_SearchCommonCode(ds_oEmailDomain, "EMAILDOMAIN", "Y", "직접입력"); // 이메일도메인 조회
    gfn_SearchCommonCode(ds_oRemarkGubun, "REMARKGUBUN", "Y", "선택"); // 적요

    lfn_InitJubsuBaseInfo(); // 접수기본 정보 초기화
    

    edExamYear.Text = left(GetDate(), 4);
    lfn_SearchExamLatestOrder(); // 최근 접수가능회차 조회

    edExamOrder.SetFocus();
    
    serch_falg = "0" ;    // 화면 실행시 조회 플래그는 0 으로 설정

    edEmail.ImeMode = "english";
    edEmailDomain.ImeMode = "english";
    

    cbxCourse.Enable = true;
    cbxCourse.Value = radCourse.Value;
    if (radCourse.Value == "10") {
		radJubsuGubun2.index = 0;
		radJubsuGubun2_OnChanged(obj,radJubsuGubun2.Value);
    } else {
		radJubsuGubun.index = 0;
		radJubsuGubun_OnChanged(obj,radJubsuGubun.Value);
	}
    
	radRejubsuYN.Value = "N";
    radRejubsuYN_OnChanged(obj,radRejubsuYN.Value);

    // 특급소방안전관리자 1·2차 시험차수 선택
	lbChasuGubun.Visible = false;
	radChasuGubun.Visible = false;
	
	
		// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 Call ID 가져오기(Unique ID)
		global.mnuLeft.lfn_CallUIDImport();
	}

	// 민원서류 등록현황에서 바로가기 연계
	if (IsExistVar("sPK1")) {
		if (!gfn_isNull(sPK1)) {
			edjubsuNo.SetFocus();
			ls_RetEjmgno = sPK1;
	
			lfn_SearchExamJubsuList();
		}
	}	

}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    // to do
    if (nChar == 117) {
        btnTraingJubsuHist_OnClick();
        return;
    }

    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

function Form_OnSize(obj,nCx,nCy,nState) {
    if (gs_IsResizingForm == "Y") {
        gdSetlmentHist.Width = nCx - gdSetlmentHist.Left - 4 - 4;
        shpGubunBox4.Width = nCx - shpGubunBox4.Left - 4;
        gdJubsuInfo.Height = nCy - gdJubsuInfo.Top - 4;
        gdOrderHist.Height = nCy - gdOrderHist.Top - 4;
        gdOrderHist.Width = nCx - gdOrderHist.Left - 4;
        shpBox1.Width = nCx - shpBox1.Left;
        shpBox2.Width = nCx;
    }
}

/*
 * 기능 : 취소
 */
function lfn_Cancel(obj) {
 
    gfn_FormInit(this);
    ms_ExamMgno = ""; // 시험관리번호

    // 시험정보
    lbExamInfo1.Text = "";
    lbExamInfo2.Text = "";

    // 접수 디폴트값 설정
    edExamYear.Text = left(GetDate(), 4);
    //radCourse.Value = "22";

    lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화
    
    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;	
	btnChangeProcDate.Enable = false;
	btnPrintReRct.Enable = false;
	btnPrintReRctPDF.Enable = false;
	
	edPersonNm.Readonly = false;
	medBIRTHDAY.Readonly = false;
	
	Button0.Enable = false;
	btnSearchPersonInfo.Enable = true;
	
	lfn_SetChangedJubsuInfo(true);

    edExamOrder.SetFocus();
    
}

/*
 * 기능 : 날짜 변경한하고 초기화
 */
function lfn_NoDateCancel(obj) {
 
    gfn_FormInit(this);
    ms_ExamMgno = ""; // 시험관리번호

    // 시험정보
    lbExamInfo1.Text = "";
    lbExamInfo2.Text = "";

    // 접수 디폴트값 설정
    //edExamYear.Text = left(GetDate(), 4);
    //radCourse.Value = "22";

    lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화
    
    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;	
	btnChangeProcDate.Enable = false;
	btnPrintReRct.Enable = false;
	btnPrintReRctPDF.Enable = false;
	
	edPersonNm.Readonly = false;
	medBIRTHDAY.Readonly = false;
	
	Button0.Enable = false;
	btnSearchPersonInfo.Enable = true;
	
	lfn_SetChangedJubsuInfo(true);

    edExamOrder.SetFocus();
}

/*
 * 기능 : 조회
 */
function lfn_Search(obj) {
   
     if (gfn_IsNull(ms_ExamMgno)) {
        gfn_Alert(MSGI00200); // "시험을 먼저 선택해 주십시오.";
        edExamOrder.SetFocus();
        return false;
    }
    if (gfn_IsNull(edJubsuNo.Text)) {
        gfn_Alert("접수번호를 입력해 주십시오.");
        edJubsuNo.SetFocus();
        return false;
    }

    lfn_SearchExamJubsuList(obj);    
}

/*
 * 기능 : 삭제
 */
function lfn_Delete(obj) {
	
	if ((ds_ioExamJubsu.currow < 0) || gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.
        return false;
    }

    if (ds_oSetlmentHist.GetCount() > 0){
        gfn_Alert("결제가 진행되어 삭제할 수 없습니다.");
        return false;
	}

	// 시험일이 지나면 삭제불가
	if ((left(GetDAte(), 8) > ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE")) &&
	   (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "ERPASSYN")))) {
		gfn_Alert("시험일이 지나서 삭제하실 수 없습니다.");
		return false;
	}

    if (!gfn_Confirm(MSGW00030)) { // 정말로 삭제 하시겠습니까?
        return false;
    }
	
    // 결제를 하지 않았을 경우에는 삭제 가능

	lfn_SaveModifyHistory("D"); // 변경이력을 저장한다.

	tit_clearActionInfo();

	var inDS = "";
	var outDS = "";
	
	// 등록된 서류파일이 있으면 삭제
	if (edFormResult.Text == "완료") {

		var vFAMGNO = "";
		var vPK1 = "";
		var vPK2 = "";
		var vPathArr = "";
		var vPath = "";
		var vfile = "";
	
		// 응시원서(시험, 심폐소생술시험, 생활안전강사시험)
		if (cbxForm.Value == "0021" || cbxForm.Value == "0013" || cbxForm.Value == "0018") {
			if (!gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EJFAMGNO"))) {
				vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
				vPK2 = "";
				vFAMGNO = ds_ioExamJubsu.GetColumn(0, "EJFAMGNO");
				vPathArr = split(ds_ioExamJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
				vPath = substr(vPathArr[1],0,18);	// 서버경로
				vfile = substr(vPathArr[1],19,21);	// 파일명
			}
		}
			
		inDS = "ds_iFormDelete=ds_iFormDelete";
		outDS = "ds_oFormDelete=ds_oFormDelete";
			
		ds_iFormDelete.ClearData();
		ds_iFormDelete.AddRow();
		
		ds_iFormDelete.SetColumn(0, "I_FCCD", cbxForm.Value);		//FORMCODE.FCCD 서식관리번호
		ds_iFormDelete.SetColumn(0, "I_FAMGNO", vFAMGNO);			//FormAttach.FAmgno
		ds_iFormDelete.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값
		ds_iFormDelete.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록
		ds_iFormDelete.SetColumn(0, "I_PATH", vPath);				//저장경로
		ds_iFormDelete.SetColumn(0, "I_FILENM", vfile);				//파일명
		
		ds_oFormDelete.ClearData(); // 결과 데이타셋 초기화
		
		tit_addSingleActionInfo("com:deleteForm", "", 0, "");
    
    }


	tit_addSingleActionInfo("training:deleteExamJubsu", "", 0, "");
	//서버 호출 
	tit_callService(
		""
		,""
		,inDS	// inDs
		,outDS	// outDs
		,"EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args 
			+ " EOMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EOMGNO"))
		,"lfn_AfterDeleteExamJubsu"
		,false
		,false
		,true
	);
                

    
    lfn_SearchExamLatestOrder();
    
    
}

//personkey 2017.12.11
function lfn_searchPERSON(sNM, sDI, sBirthday, sHP) {
/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면
/////////////////// 값을 미리 넣어주기 위해 강습자관리번호를 검색함
    ds_ioT_E_L_JubsuCheck.ClearData();
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchPersonInfo", false);
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioExamPerson=ds_oTrainingPerson"	// outDs
        , "TPNM=" + quote(sNM) // 성명 
        + " DI=" + quote(sDI) // DI값
        + " BIRTHDAY=" + quote(sBirthday) // DI값
        + " HP=" + quote(replace(replace(replace(replace(sHP,"-",""),".",""),",","")," ","")) // DI값
        // args
        ,""
        ,false
        ,""
        ,true
    );  
}




function lfn_searchTraingPerson() {
/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면
/////////////////// 값을 미리 넣어주기 위해 강습자관리버호를 검색함

    ds_ioT_E_L_JubsuCheck.ClearData();
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchTrainingPerson", false);   ////personkey 2017.12.11
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioExamPerson=ds_oTrainingPerson"	// outDs
        , "TPNM=" + quote(edPersonNm.Text) // 성명 
        + " TPBIRTHDAY=" + quote(medBIRTHDAY.value) // 주민번호                
        // args
        ,""
        ,false
        ,""
        ,true
    );  
}


function lfn_searchExamJubsuCheck() {
/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기

    ds_ioT_E_L_JubsuCheck.ClearData();
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchExam_JubsuCheck", false);
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioExam_JubsuCheck=ds_oExam_JubsuCheck"	// outDs
        , "EOMGGTMGNO_A=" + quote(cbxJibu.Value)  // 지부
        + " EOYEAR_A=" + quote(edExamYear.Text) // 년도
        + " EOTCCOURSECD_A=" + quote(radCourse.Value) // 직능
        + " EOTRAININGORDER_A=" + quote(edExamOrder.Text) // 회차 
        + " EPNM_A=" + quote(edPersonNm.Text) // 성명 
        + " EPBIRTHDAY_A=" + quote(medBIRTHDAY.value) // 주민번호                
        // args
        ,""
        ,false
        ,""
        ,true
    );  
}
///////////////////


/* 자격발급여부 확인
*/
function lfn_searchLicenseCheck(){

	ds_oLicenseCheck.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchLicenseCheck", false);  //personkey  반영...

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oLicenseCheck=ds_oLicenseCheck"	// outDs
		,"PERSONNM=" + quote(edPersonNm.Text)		// 성명
		+ " COURSECD=" + quote(radCourse.Value)  // 직능
		+ " PERSONKEY=" + quote(medPersonKey.Value) // args
		,""
		,false
		,""
		,true
	);
	
    if (ds_oLicenseCheck.GetCount() > 0) {
        return true;
    } else {
        return false;
    }
}



    
    
/* 강습수료여부 찾기
*/
function lfn_TrainingJubsuMatchingSearch(){
        ///////////////////////// 강습접수에 수료한거 중에 해당 직능이 있는지 조회하여 메시지 보여줌
        ds_ioTrainingJubsuMatching.ClearData(); // 데이타셋 초기화

        tit_clearActionInfo();
        tit_addSearchActionInfo("training:searchTrainingJubsuMatching", false); //personkey 2017.12.11 
    
        // 서버 호출 
        tit_callService(
            ""
            ,""
            ,""	// inDs
            ,"ds_ioTrainingJubsuMatching=ds_oTrainingJubsuMatching"	// outDs
            ,"TPNM=" + quote(edPersonNm.Text)		// 성명
            + " PERSONKEY=" +  quote(medPersonKey.Value)    //personkey add...
            + " TOTCCOURSECD=" + quote(radCourse.Value)  // 직능
            //+ " TPBIRTHDAY=" + quote(medBIRTHDAY.Value)
            + " EXAMDATE=" + quote(ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"))// args
            ,"lfn_AfterSearchTrainingPerson"
            ,false
            ,""
            ,true
            
        );
        ////////////////////////     
}

// 강습접수에 수료 내역이 있는지 조회 체크함

function lfn_AfterSearchTrainingPerson(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

/////////start//  시험 접수시 1급, 2급 방화관리자일 경우 강습접수가 없으면 공공기관방화관리자로 검색

    
    if(ds_ioTrainingJubsuMatching.count == "0") {
		if (radCourse.Value == "10" || radCourse.Value == "21" ||radCourse.Value == "22" 
		    ||radCourse.Value == "23" ||radCourse.Value == "50" ||radCourse.Value == "51") { // 특급,1,2,3 소관,생활안전강사,심폐소생술과정일 경우
			lfn_AfterSearchTrainingPersonA(0);
        }
    } else {
		if (!gfn_isNull(ds_ioTrainingJubsuMatching.GetColumn(0, "ECSTOPENDDATE"))) {
		
		}
    
        if(ls_PassSavePrintYN == "1") { // 저장을 통해 수료 가능 여부 조회시 메세지 알려줌
			gfn_Alert("             교육수료일자 : " + left(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4,2) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),6,2) + "\n"
				+ "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"
				+ "           접수 가능 합니다. ");
			ls_jubsuPossible = "Y";
			

        }   
    }
    

   // gfn_SearchMessage(gdTrainingPerson); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
    
}

/*
*  21, 22  로 조회하여 수료자 유무를 파악(메세지 표시함)
*/

function lfn_AfterSearchTrainingPersonA(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    if (ds_ioTrainingJubsuMatching.count > 0 ) {
        if(ls_PassSavePrintYN == "1") { // 저장을 통해 수료 가능 여부 조회시 메세지 알려줌
//            alert("           강습교육 수료 후 2년이내 시험접수가능\n\n"
			gfn_Alert("             교육수료일자 : " + left(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4,2) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),6,2) + "\n"
                + "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"
                + "           접수 가능 합니다. ");
            ls_jubsuPossible = "Y";
            

        }    
    } else {
        if(ls_PassSavePrintYN == "1") { // 저장을 통해 수료 가능 여부 조회시 메세지 알려줌
			// 응시자격구분(과거 접수자료 조회)
			lfn_searchJubsuGubun(ds_ioTrainingJubsuMatching.GetColumn(0, "TPMGNO"), radCourse.Value);

			if (gfn_IsNull(ds_oJubsuGubun.GetColumn(0,"EJJUBSUGUBUN")) ||
			    ds_oJubsuGubun.GetColumn(0,"EJJUBSUGUBUN") >= "10") {
			    
				if (radCourse.Value == "10") {	// 특급소방안전관리자 이면
					if (radJubsuGubun2.Value == "00" || radJubsuGubun2.Value == "03") {
						alert(" 강습교육 수료 및 경력, 가접수 건이 없습니다.\n\n"
							+ " 경력 또는 가접수를 선택하셨습니다. ");
						ls_jubsuPossible = "Y";			    
					} else {			    
						alert(" 강습교육 수료 및 경력, 가접수 건이 없습니다.\n\n"
							+ " 접수 불가 합니다. ");
	//					ls_jubsuPossible = "Y";
						ls_jubsuPossible = "N";
						return false;
					}
				
				} else {	// 타직능이면
				
					if (radJubsuGubun.Value == "00" || radJubsuGubun.Value == "01" || radJubsuGubun.Value == "02"||radJubsuGubun.Value == "03") {
						alert(" 강습교육 수료 및 경력, 학력, 학·경력 건이 없습니다.\n\n"
							+ " 경력 또는 학력 접수를 선택하셨습니다. ");
						ls_jubsuPossible = "Y";			    
					} else {			    
						alert(" 강습교육 수료 및 경력, 학력, 학·경력 건이 없습니다.\n\n"
							+ " 접수 불가 합니다. ");
	//					ls_jubsuPossible = "Y";
						ls_jubsuPossible = "N";
						return false;
					}
				}

			} else {
				var gubunmsg = "";	
				
				cbxCourse.Index = 0;
				cbxCourse.Enable = false;
				
				if (radCourse.Value == "10") {
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						gubunmsg = "경력";
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "03") {   // 가접수
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						gubunmsg = "가접수";
					}
				} else {
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						gubunmsg = "경력";
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "01") {   // 학력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						gubunmsg = "학력";
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "02") {   // 학·경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						gubunmsg = "학·경력";
					}
				}
				
				// 업무대행경력 접수자 접수 불가(2015.01.07)
				if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
					gfn_Alert("기존에 접수내역 중 최종 경력으로 접수하신 이력이 있습니다.\n"
							  + " [ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
							  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
							  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
							  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]"
					         +"\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					         +"접수가 불가합니다.<업무대행경력자 접수불가>"
					);
					ls_jubsuPossible = "Y";
					radRejubsuYN.Value = "Y";	//재접수 여부
				
				} else {
					gfn_Alert(" 기존에 접수내역 중 최종 " + gubunmsg + "(으)로 접수하신 이력이 있습니다.\n\n"
							  + " [ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
							  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
							  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
							  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]\n\n"
							  + " 접수 가능 합니다."
					);
					ls_jubsuPossible = "Y";
					radRejubsuYN.Value = "Y";	//재접수 여부
				}
			}
        }    
    }
    
}

function lfn_Save(obj) {

    if (gfn_IsNull(ms_ExamMgno)) {
        gfn_Alert(MSGI00200); // "시험을 먼저 선택해 주십시오.";
        edExamOrder.SetFocus();
        return false;
    }
    if (ds_oExamOrderMgno.GetColumn(0, "EOSEATCNT") <= ds_oExamOrderMgno.GetColumn(0, "JUBSUCNT")) {
        gfn_Alert("접수인원수를 초과하였습니다.");
        return false;
    }

    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // 신규이면서
                && (left(GetDAte(), 8) > ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"))
            ) {
        gfn_Alert("시험일이 지나서 접수하실 수 없습니다.");
        return false;
    }
   
     
    if (ds_ioExamJubsu.GetColumn(0, "LASTYN") == "N") {
        gfn_Alert("회차변경된 접수번호는 수정하실 수 없습니다.");
        return false;
    }
    
    if (radCourse.Value == "10") {	// 특급소방안전관리자 일때
		if (radJubsuGubun2.Index < 0) {    
			gfn_Alert("응시자격을 선택하세요!");
			return false;
		}
		if (radJubsuGubun2.Value == "10") {
			if (cbxCourse.Index == 0) {
				gfn_Alert("[응시자격구분] 강습수료 직능을 선택하세요!");
				return false;
			}
		}
	} else {	// 다른직능일때
		if (radJubsuGubun.Index < 0) {    
			gfn_Alert("응시자격을 선택하세요!");
			return false;
		}
		if (radJubsuGubun.Value == "20") {
			if (cbxCourse.Index <= 0) {
				gfn_Alert("[응시자격구분] 강습수료 직능을 선택하세요!");
				return false;
			}
		}
	}
    
     
    if (!gfn_FormValidate(this)) { // 입력 Validation Check
        return false;
    }
    
    
    	// 생활안전강사 or 심폐소생술 이면 
	if (left(radCourse.Value,2) == "50" || left(radCourse.Value,2) == "51") {
	
		if (length(medBIRTHDAY.Value) > 7) {
		
			gfn_Alert("생활안전강사 또는 심폐소생술 과정은 [생년월일]만 입력하세요!");
			
			return false;
		
		}
	
	} else { //강습과정이면
		if (gfn_IsNull(medPersonKey.Value) && length(medBIRTHDAY.Value) <> 13) {
			gfn_Alert("강습교육 과정은 주민등록번호 13자리를 입력하세요!");
			return false;
		}
		
		if (!gfn_IsNull(medPersonKey.Value) && length(medBIRTHDAY.Value) < 7) {
			gfn_Alert("주민번호는 최소 7자리 이상입력해야 합니다.");
			return false;
		}		

		// DI가 없는경우 실명확인 후 저장
		if (gfn_IsNull(ls_DI)) {
			lfn_AuthBIRTHDAY();
			if (gds_ioSciCheck.GetColumn(0, "STRRESULT") <> "1") {
				if (!gfn_Confirm("실명확인 오류 입니다. 강제로 저장 하시겠습니까?\n\n" +
								 "* 오류내용 : " + gds_ioSciCheck.GetColumn(0, "STRCI2"))) {
					medBIRTHDAY.SetFocus();
					return false;
				} else {
					// 실명확인 오류시 DI값에 오류코드 3자리 입력
					ls_DI = gds_ioSciCheck.GetColumn(0, "STRRETUNCODE");
				}
			}
		}
	}

	
    if (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // 신규가 아니면서
                && (ds_ioExamJubsu.GetOrgColumn(0, "PERSONNM") <> ds_ioExamJubsu.GetColumn(0, "PERSONNM"))
                && (ds_ioExamJubsu.GetOrgColumn(0, "BIRTHDAY") <> ds_ioExamJubsu.GetColumn(0, "BIRTHDAY"))
            ) {
        gfn_Alert("수강자(성명과 주민등록번호)를 변경하실 수 없습니다.");
        
        return false;
        
    }
    

    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IIIMGBINARY"))) {  // 사진을 선택하지 않아 없을 경우 바이너리 값을 null로 하여 패키지 호출함(패키지 에러방지)  
        ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", "");    
    }           
    var sArg = "";
    ls_PassSavePrintYN = "1"; // 저장을 통해 시험응시가능기간 조회함 (1) 
    
    // 직능
    ds_ioExamJubsu.SetColumn(0, "COURSECD", radCourse.Value);
    
    // 응시자격구분
    if (radCourse.Value == "10") {			// 특급소방안전관리자 이면
		if (radJubsuGubun2.Value == "10") {			// 강습수료
			ds_ioExamJubsu.SetColumn(0, "EJJUBSUGUBUN", cbxCourse.Value);
		} else if (radJubsuGubun2.Value == "00") {	// 경력(00)
			ds_ioExamJubsu.SetColumn(0, "EJJUBSUGUBUN", radJubsuGubun2.Value);
		} else if (radJubsuGubun2.Value == "03") {	// 가접수(03)이면(03:신청,04:완료,99:자격미달)
			ds_ioExamJubsu.SetColumn(0, "EJJUBSUGUBUN", cbxGaJubsuGubun.Value);
			ds_ioExamJubsu.SetColumn(0, "GAJUBSUGUBUN", cbxGaJubsuGubun.Value);
		}
    } else {
		if (radJubsuGubun.Value == "20") {			// 강습수료
			ds_ioExamJubsu.SetColumn(0, "EJJUBSUGUBUN", cbxCourse.Value);
		} else  {	// 경력(00),  학력(01), 학·경력(02)
			ds_ioExamJubsu.SetColumn(0, "EJJUBSUGUBUN", radJubsuGubun.Value);
		}
	}
	
	// 부정행위 이력 조회
	lfn_ExamCheatSearch(); // 부정행위 여부 확인
	if (ds_oExamCheat.rowcount > 0) {
	
        gfn_Alert("부정행위 이력이 있어 접수하실 수 없습니다.\n\n"
                  + "부정행위 구분 : " + ds_oExamCheat.GetColumn(0, "ECCHEATREASON")
                  + "\n접수불가 기간 : " + substr(ds_oExamCheat.GetColumn(0, "ECSTOPSTARTDATE"),0,4)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPSTARTDATE"),4,2)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPSTARTDATE"),6,2)+" ∼ "+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPENDDATE"),0,4)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPENDDATE"),4,2)+"."+
                                           substr(ds_oExamCheat.GetColumn(0, "ECSTOPENDDATE"),6,2)
                  + "\n비             고 : " + ds_oExamCheat.GetColumn(0, "ECREMARK")
        );
        return false;
	
	}
	

    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) { // 신규
        // 자격발급여부 확인
        if (lfn_searchLicenseCheck() == true) {
			gfn_Alert("기존에 발급한 자격수첩이 있습니다. 접수 불가합니다.\n\n" +
			          "수첩번호 : " + ds_oLicenseCheck.GetColumn(0, "LLCSNO") + "\n\n" +
			          "발급일자 : " + substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),0,4)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),4,2)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),6,2));
			return false;
        }; 
        
		if (radCourse.Value == "10") {	// 특급소방안전관리자 1차시험 면제자 여부(2017.06.12)
			lfn_searchExam1ChasuMunje(ds_ioTrainingJubsuMatching.GetColumn(0, "TPMGNO"),
			                          ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"));
			var msg1 = "";
			if (ds_oMunje.GetRowCount() > 0) {	// 1차 합격자료가 있으면
				msg1 = edPersonNm.Text + "님은 제1차시험 면제자입니다.\n";
				msg1 += "  ※ 1차합격 시험일자 : " + substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),0,4) + "-" +
				                                     substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),4,2) + "-" +
				                                     substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),6,2)+"\n\n";
				if (radChasuGubun.Value == "0" ||radChasuGubun.Value == "1" ) {	// 1,2차 및 1차 접수시
					msg1 += "계속 접수하시겠습니까?\n\n"
						  + "① 제2차 시험만 응시 : 응시료 20,000원\n"
						  + "② 제1,2차 시험 응시 : 응시료 35,000원\n"
						  + "③ 제1차 시험만 응시 : 응시료 15,000원";
				    if (!gfn_Confirm(msg1)) {
						return false;
					}
				}
			}
		}
        
        if (ls_jubsuPossible != "Y") {
			gfn_Alert("응시자격에 해당하는 내용이 없어 접수할 수 없습니다.");
			//return false;
        }

        if (!gfn_Confirm("저장 하시겠습니까?")) {
            return false;
        }        
        if(cbxjibu.Value != gds_oUserInfo.GetColumn(0, "PDEPTCD"))
        {
            if (!gfn_Confirm("타지부 접수입니다. 접수 저장하시겠습니까?")) {
                return false;        
            }
        }    
         ////////////////////   
         ////////////////////
         // trace(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));
         // 기본정보, 실명 인증 하지 않고 저장시 개인정보 유무 체크 안하고 저장시 무결성 오류 발생 해결위함
         //  강습자관리번호 없을 경우 한번 체크하여 동일자가 있을 경우 값을 넣어줌  
        if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {        
            //lfn_searchTraingPerson();      구버전.. 
            lfn_searchPerson(edPersonNm.Text, ls_DI, left(medBIRTHDAY.Value,7), replace(edHpTel.Text,"-","")); //  개인정보 조회  personinfo....
            ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));
        }         
         ////////////////////       
         ///////////////////
        ls_ServiceName = "training:insertExamJubsu";
        ls_CallBackServiceName = "lfn_AfterInsertExamJubsu";
        sArg = "IsNewPictureYn=" + quote(iif(lb_FileUpload, "Y", "N"));
         
    } else { // 수정
    
		if (radCourse.Value == "10") {	// 특급소방안전관리자 1차시험 면제자 여부(2017.06.12)
			lfn_searchExam1ChasuMunje(ds_ioTrainingJubsuMatching.GetColumn(0, "TPMGNO"),
			                          ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"));
			var msg1 = "";
			if (ds_oMunje.GetRowCount() > 0) {	// 1차 합격자료가 있으면
				msg1 = edPersonNm.Text + "님은 제1차시험 면제자입니다.\n";
				msg1 += "  ※ 1차합격 시험일자 : " + substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),0,4) + "-" +
				                                     substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),4,2) + "-" +
				                                     substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),6,2)+"\n\n";
				if (radChasuGubun.Value == "0" ||radChasuGubun.Value == "1" ) {	// 1,2차 및 1차 접수시
					msg1 += "계속 접수하시겠습니까?\n\n"
						  + "① 제2차 시험만 응시 : 응시료 20,000원\n"
						  + "② 제1,2차 시험 응시 : 응시료 35,000원\n"
						  + "③ 제1차 시험만 응시 : 응시료 15,000원";
				    if (!gfn_Confirm(msg1)) {
						return false;
					}
				}
			}
		}
    
    
        if (!gfn_Confirm("수정 하시겠습니까?")) {
            return false;
        }

        ls_ServiceName = "training:updateExamJubsu";
        ls_CallBackServiceName = "lfn_AfterUpdateExamJubsu";
        lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.
        
        sArg = "IsChangedJubsuInfoYn=" + quote(ls_IsChangedJubsuInfoYn);
        sArg += " IsChangedSeatNoYn=" + quote(ls_IsChangedSeatNoYn);
        sArg += " IsChangedPictureYn=" + quote(ls_IsChangedPictureYn);
    }
    ds_ioExamJubsu.SetColumn(0, "EOMGNO", ms_ExamMgno);
    ds_ioExamJubsu.SetColumn(0, "JUBSUNO", edJubsuNo.Text);
    ds_ioExamJubsu.SetColumn(0, "DECISIONSEATNO", edSeatNo.Text);
     //add....    
    ds_ioExamJubsu.SetColumn(0, "DI", ls_DI);
    ds_ioExamJubsu.SetColumn(0, "CI", ls_CI);
    ds_ioExamJubsu.SetColumn(0, "CIVER", ls_CIVER);
    ds_ioExamJubsu.SetColumn(0, "PERSONKEY", iif(length(ls_PERSONKEY)==10, ls_PERSONKEY, ""));
    ds_ioExamJubsu.SetColumn(0, "BIRTHDAY7", iif(gfn_IsNull(ls_BIRTHDAY7), substr(medBIRTHDAY.Value,0,7), ls_BIRTHDAY7));

    ds_oExamJubsuResult.ClearData(); // 결과 데이타셋 초기화
    
    if (lb_FileUpload) { // 사진등록인 경우(파일 업로드일 경우)
        tit_FileWrite(
            hfImage
            , ls_FileUploadPath
            , fdImage.FilePath
            , fdImage.FileName
            , ls_UploadRealName
            , "U"
            , true
        );
        hfImage.CloseFile();
    }
    
    tit_clearActionInfo();
    tit_addSingleActionInfo(ls_ServiceName, "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iExamJubsu=ds_ioExamJubsu"    // inDs
        ,"ds_oExamJubsuResult=ds_oExamJubsu"    // outDs
        ,sArg    // args
        ,ls_CallBackServiceName
        ,false
        ,false
        ,true
    );
    
      
    
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterInsertExamJubsu(nErrorCode, strErrorMsg) {

	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    switch (ds_oExamJubsuResult.GetColumn(0, "RESULTCODE")) {
        case "JUBSUNO" : // 접수번호중복
            var ls_NewJubsuNo = lpad((toNumber(edJubsuNo.Text) + 1), "0", 6); // 접수번호
            if (!gfn_Confirm("접수번호가 중복되었습니다.\n다음 접수번호[" + ls_NewJubsuNo + "]로 접수하시겠습니까?")) {
                return false;
            }
            edJubsuNo.Text = ls_NewJubsuNo;

            tit_addSingleActionInfo(ls_ServiceName, "", 0, "");
            // 서버 호출
            tit_callService(
                ""
                ,""
                ,"ds_iExamJubsu=ds_ioExamJubsu:U"    // inDs
                ,"ds_oExamJubsuResult=ds_oExamJubsu"    // outDs
                ,""    // args
                ,ls_CallBackServiceName
                ,false
                ,false
                ,true
            );
            
            break;
        case "SEATNO" : // 좌석번호중복
            gfn_Alert("좌석번호가 중복되었습니다.\n확인하신 후 다시 저장해 주십시오");
            break;
        case "OK" : // 정상처리
            lfn_SaveModifyHistory("I"); // 변경이력을 저장한다.
            gfn_SaveMessage(); // 저장 메세지를 처리한다.
            lb_FileUpload = false;
            lfn_Search();
            break;
        case "EXIST" :
            gfn_Alert( "주민번호 : " + medBIRTHDAY.Text + "님은 해당 직능(회차)에 이미 접수되었습니다.\n\n"
                    + "              접수정보(F6)를 눌러 확인을 바랍니다.");
            break;
    }
    
}


/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterDeleteExamJubsu(nErrorCode, strErrorMsg) {

	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

	if (edFormResult.Text == "완료") {
		lfn_AfterFormDelete(nErrorCode, strErrorMsg);
	}



	alert("정상적으로 삭제 되었습니다.");
    lb_FileUpload = false;
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterUpdateExamJubsu(nErrorCode, strErrorMsg) {
   
   if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    gfn_SaveMessage(); // 저장 메세지를 처리한다.
    lb_FileUpload = false;

    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부
    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부
    ls_IsChangedPictureYn = "N"; // 사진 변경여부

    lfn_SearchExamJubsuList(); // 접수번호로 다시 조회한다.
}

/*
 * 기능 : 출력
 */
function lfn_Print(obj) {
    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");
        edJubsuNo.SetFocus();
        return false;
    }

    ls_PassSavePrintYN = "2"; // 수료 여부 조회 전에 응시원서 출력을 위한 값을 줌  flag
    
    lfn_TrainingJubsuMatchingSearch();  // 수료 여부를 검색함 (시험 응시 가능 기간을 표기 하기 위함)
    
    //trace(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE") );
    
    var sMessage = "";
/*    
    if (ds_ioTrainingJubsuMatching.count() > 0) {
        sMessage = "(*시험응시기한은 " + mid(ds_ioTrainingJubsuMatching.GetColumn(0, "EXAMMAXDATE"), 0, 4) + "년"
                                   + mid(ds_ioTrainingJubsuMatching.GetColumn(0, "EXAMMAXDATE"), 4, 2) + "월"
                                   + mid(ds_ioTrainingJubsuMatching.GetColumn(0, "EXAMMAXDATE"), 6, 2) + "일"
                                   + "입니다. 시험응시가능 기간은 수료일로부터 2년 이내 입니다.)";  // 
    }
 */
    // 출력이력을 저장한다. 
    gfn_InsertSearchPrintHistory(
            "P"
            , this.ID
            , global.mnuLeft.cbxOpenForm.Text + "(응시원서)"
            , "접수관리번호=" + ds_ioExamJubsu.GetColumn(0, "EJMGNO")
        );

	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
				"P"
				, gs_CallCenterUID
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")
				, this.ID
				, global.mnuLeft.cbxOpenForm.Text + "(응시원서)"
				, ls_HistoryArg
			);
	}
	
    ds_oExamJubsuPrint.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamJubsuPrint", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oExamJubsuPrint=ds_oExamJubsuPrint"    // outDs
        ,"EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args
        ,""
        ,true
        ,true
        ,true
    );
/*
    var lb_IsPrintedOk = gfn_PrintReport("frmtraining0400R01ExamJubsu.rex",
                                         "ds_oExamJubsuPrint",
                                          "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
                                        + "^TPPASSDATE=" + sMessage,
                                           true, "응시원서");
*/                                           
	var lb_IsPrintedOk = "";

    if (radCourse.Value < "50") {	//  생활안전강사 가 아니면
		var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0400R01ExamJubsu.rex",
												   "ds_oExamJubsuPrint",
												   "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
												 + "^TPPASSDATE=" + sMessage,
												   true, "응시원서", "50","10");
    } else if (radCourse.Value >= "50") {	// 생활안전강사
		var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0400R02ExamJubsu.rex",
												   "ds_oExamJubsuPrint",
												   "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
												 + "^TPPASSDATE=" + sMessage,
												   true, "응시원서", "50","10");
    }
    
    if (lb_IsPrintedOk) {
        //gfn_Alert("정상적으로 출력되었습니다.");
    }
}
/* 공통 필수 종료 */

/* 사용자 함수 */
/*
 * 기능 : 최근 접수가능회차를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchExamLatestOrder(obj) {
   
   ds_oExamOrder.ClearData(); // 데이타셋 초기화
   
   // 특급소방안전관리자일 경우
   if (radCourse.Value == "10") {
   
		// 응시자격구분 radio 세팅
		radJubsuGubun2.Visible = true;
		radJubsuGubun.Visible = false;
		cbxGaJubsuGubun.Visible = true;
		
		ed1PassDate.Visible = true;
/*		
		// 합격여부
		lbPassYn.Visible = false;
		edPassYn.Visible = false;

		// 점수
		lbPoint.Visible = false;
		edPoint.Visible = false;

		lb1Point.Visible = false;
		ed1Point.Visible = false;
		lb1_1subject.Visible = false;
		ed1_1Point.Visible = false;
		lb1_2subject.Visible = false;
		ed1_2Point.Visible = false;
		lb2Point.Visible = false;
		ed2Point.Visible = false;
		lb2_1subject.Visible = false;
		ed2_1Point.Visible = false;
		lb2_2subject.Visible = false;
		ed2_2Point.Visible = false;
*/
   } else {
		// 응시자격구분 radio 세팅
		radJubsuGubun2.Visible = false;
		radJubsuGubun.Visible = true;
		cbxGaJubsuGubun.Visible = false;

		// 합격여부
		lbPassYn.Visible = true;
		edPassYn.Visible = true;
		ed1PassDate.Visible = false;
		// 점수
		lbPoint.Visible = true;
		edPoint.Visible = true;
		lb1Point.Visible = false;
		ed1Point.Visible = false;
		lb1_1subject.Visible = false;
		ed1_1Point.Visible = false;
		lb1_2subject.Visible = false;
		ed1_2Point.Visible = false;		
		lb2Point.Visible = false;
		ed2Point.Visible = false;
		lb2_1subject.Visible = false;
		ed2_1Point.Visible = false;
		lb2_2subject.Visible = false;
		ed2_2Point.Visible = false;		
		
   }
   

    tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamOrderList", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oExamOrder=ds_oExamOrder"	// outDs
		,"EOTCCOURSECD=" + quote(radCourse.Value)
            + " EOMGGTMGNO=" + quote(cbxJibu.Value)
            + " EOYEAR=" + quote(edExamYear.Text)
            + " sPosiYn=" + quote("Y") // 접수가능여부
            + " sRowCount=" + quote("1") // 건수
		,"lfn_AfterSearchExamLatestOrder"
        ,false
        ,false
        ,true
	);
	
	// 1급 방화관리자면 경력자 여부 체크 비활성화
	// 20100129 정현호 대리님 요청으로 비활성화 활성화로 품
	/*
	if(radCourse.Value == 21)
	{
		chkExpYn.Enable = false;
		chkExpYn.Value = "N";
	}
	*/
	
		
}

/*
 * 기능 : 최근 접수가능회차 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchExamLatestOrder(nErrorCode, strErrorMsg) {
    
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oExamOrder.GetCount() > 0) {
        ms_ExamMgno = ds_oExamOrder.GetColumn(0, "EOMGNO"); // 관리번호
        cbxJibu.Value = ds_oExamOrder.GetColumn(0, "EOMGGTMGNO"); // 지부코드
        edExamYear.Text = ds_oExamOrder.GetColumn(0, "EOYEAR"); // 년도
        radCourse.Value = ds_oExamOrder.GetColumn(0, "EOTCCOURSECD"); // 직능코드
        edExamOrder.Text = ds_oExamOrder.GetColumn(0, "EOEXAMORDER"); // 회차

        lfn_SearchExamOrderMgno(); // 시험회차관리번호를 조회한다.
    }else{
    
          lfn_NoDateCancel();
		//lfn_cancel();
    }
    
    if (radCourse.Value == "10") {	// 특급소방안전관리자일 경우
		radJubsuGubun2.Value = "10";   // 강습수료   00:경력  03:가접수  20 : 강습수료
		radJubsuGubun2.Enable = true;
		
		lbChasuGubun.Visible = true;
		radChasuGubun.Visible = true;
		radChasuGubun.Index = 0;

		// 합격여부
		lbPassYn.Visible = false;
		edPassYn.Visible = false;
		ed1PassDate.Visible = false;
		
	
		// 1차 시험점수 공개일시
		if (left(GetDate(),12) >= ds_oExamOrderMgno.GetColumn(0, "EOEXAM1OPENDATE")) {
			lbPassYn.Visible = true;
			edPassYn.Visible = true;
			ed1PassDate.Visible = true;
			lb1Point.Visible = true;
			ed1Point.Visible = true;
			lb1_1subject.Visible = true;
			ed1_1Point.Visible = true;
			lb1_2subject.Visible = true;
			ed1_2Point.Visible = true;
		} else {
			lbPassYn.Visible = false;
			edPassYn.Visible = false;
			ed1PassDate.Visible = false;
			lb1Point.Visible = false;
			ed1Point.Visible = false;
			lb1_1subject.Visible = false;
			ed1_1Point.Visible = false;
			lb1_2subject.Visible = false;
			ed1_2Point.Visible = false;		
		}
		
		// 2차 시험점수 공개일시
		if (left(GetDate(),12) >= ds_oExamOrderMgno.GetColumn(0, "EOEXAM2OPENDATE")) {
			lb2Point.Visible = true;
			ed2Point.Visible = true;
			lb2_1subject.Visible = true;
			ed2_1Point.Visible = true;
			lb2_2subject.Visible = true;
			ed2_2Point.Visible = true;
		} else {
			lb2Point.Visible = false;
			ed2Point.Visible = false;
			lb2_1subject.Visible = false;
			ed2_1Point.Visible = false;
			lb2_2subject.Visible = false;
			ed2_2Point.Visible = false;
		}
		    
	} else if (radCourse.Value == "20" || radCourse.Value == "24"
	   || radCourse.Value == "28" || radCourse.Value == "29") {
		radJubsuGubun.Value = "20";   // 강습수료   00:경력  01:학력  02:학·경력  20 : 강습수료
		radJubsuGubun.Enable = false;
		
		lbChasuGubun.Visible = false;
		radChasuGubun.Visible = false;
		radChasuGubun.Index = -1;

	} else if (radCourse.Value == "21" || radCourse.Value == "22" || radCourse.Value == "23" || radCourse.Value == "50" || radCourse.Value == "51") {
		radJubsuGubun.Value = "20";   // 강습수료   00:경력  01:학력  02:학·경력  20 : 강습수료
		radJubsuGubun.Enable = true;
		
		lbChasuGubun.Visible = false;
		radChasuGubun.Visible = false;
		radChasuGubun.Index = -1;
	}
	cbxCourse.Value = radCourse.Value;
}


/*
 * 기능 : 시험회차관리번호를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchExamOrderMgno() {

   if (gfn_IsNull(cbxJibu.Value)
            || gfn_IsNull(radCourse.Value)
            || gfn_IsNull(edExamYear.Text)
            || gfn_IsNull(edExamOrder.Text)) {
        ls_SearchFlag = false;
        return false;
    }

    ds_oExamOrderMgno.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamOrderMgno", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oExamOrderMgno=ds_oExamOrderMgno"    // outDs
        ,"EOMGTMGNO=" + quote(cbxJibu.Value)
            + " EOTCCOURSECD=" + quote(radCourse.Value)
            + " EOYEAR=" + quote(edExamYear.Text)
            + " EOEXAMORDER=" + quote(lpad(edExamOrder.Text, "0", 3))
        ,"lfn_AfterSearchExamOrderMgno"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 :  시험회차관리번호 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchExamOrderMgno(nErrorCode, strErrorMsg) {
      
	if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oExamOrderMgno.GetCount() > 0) {
		
		ms_ExamMgno = ds_oExamOrderMgno.GetColumn(0, "EOMGNO"); // 회차관리번호
		// 회차정보1
		lbExamInfo1 = " 좌석수:" + ds_oExamOrderMgno.GetColumn(0, "EOSEATCNT"); // 좌석수
		lbExamInfo1 = lbExamInfo1 + ",    현재접수인원수:" + ds_oExamOrderMgno.GetColumn(0, "EOJUBSUCNT"); // 현재접수인원수
		// 회차정보2
		var ls_date = ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"); // 시험일시
		lbExamInfo2 = "시험일시 : " + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + substr(ls_date, 6, 2); // 교육시작일
		ls_date = ds_oExamOrderMgno.GetColumn(0, "EOSTARTTIME");
		lbExamInfo2 = lbExamInfo2 + "  " + left(ls_date, 2) + ":" + right(ls_date, 2);
		
		if(ls_SearchFlag)
		{			
			ls_SearchFlag = false;
			return;
		}	
			
		edJubsuNo.Text = ds_oExamOrderMgno.GetColumn(0, "NEWJUBSUNO"); // 접수번호

		lfn_SearchUnUseSeatNo();
        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
                   
        if(serch_falg == "0") {

            // 그리드 초기화
            ds_oJubsuAllInfo.ClearData();
            gdJubsuInfo.NoDataText = "";
            ds_oOrderHist.ClearData();
            gdOrderHist.NoDataText = "";
            ds_oSetlmentHist.ClearData();
            gdSetlmentHist.NoDataText = "";
            btnSetlmt.Enable = false; // 결제(POS) 버튼
        } else if(serch_falg == "1") {
           
            ds_oSetlmentHist.ClearData();
            gdSetlmentHist.NoDataText = "";
            btnSetlmt.Enable = false; // 결제(POS) 버튼
        }

        // 응시자격구분
        if (radCourse.Value == "10") {	//특급소방안전관리자
			radJubsuGubun2.index = 0;
		} else {
		    radJubsuGubun.index = 0;
		}
		cbxCourse.Enable = true;
		cbxCourse.Value = radCourse.Value;
        
        
        
    }else{
    
		//lfn_Cancel();
		 lfn_NoDateCancel();
    }
    
    edJubsuNo.SetFocus();
}

/*
 * 기능 : 빈좌석번호를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchUnUseSeatNo(obj)
{

    if (gfn_IsNull(ms_ExamMgno)) {
        gfn_Alert(MSGI00200); // "시험을 먼저 선택해 주십시오.";
        edExamOrder.SetFocus();
        return false;
    }

    ds_oSeatNo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchUnUseExamSeatNo", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oSeatNo=ds_oSeatNo"    // outDs
        ,"EOMGNO =" + quote(ms_ExamMgno)
        ,"lfn_AfterSearchUnUseExamSeatNo"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 빈좌석번호 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchUnUseExamSeatNo(nErrorCode, strErrorMsg) {
    
    // 트랜잭션 에러를 처리한다.
    if (nErrorCode != 0) { 
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    var ln_TotalCnt = ds_oSeatNo.GetCount();
    
    if (ln_TotalCnt > 0) {
        
        edSeatNo.Text = ds_oSeatNo.GetColumn(0, "EOHEXAMSEATNO"); // 접수좌석번호
    } else {
        edSeatNo.Text = 1; // 접수좌석번호
    }
    
   /////////////////// 빈번호 조회후 이름 주민번호 입력할 수 있게 해야 함
    edPersonNm.Readonly = false;
    medBIRTHDAY.Readonly = false;
    btnSearchPersonInfo.Enable =true;
    Button0.Enable = false;
    ///////////////////    
    
}


/*
 * 기능 : 접수자목록을 조회한다.
 * parameter : sOrderMgno - 회차관리번호
 *             sJubsuNo - 접수번호
 *             sLikeYn - LIKE 검색 여부
 * return value : 시험접수자목록 정보를 가진 배열 오브젝트
 */
function lfn_SearchExamJubsuList(obj) {
     
    var ls_HistoryArg = "";
    var ls_SearchArg = "";
    
	if (!gfn_IsNull(ls_RetEjmgno)) {
		ls_HistoryArg = "접수관리번호=" + ls_RetEjmgno;
		ls_SearchArg = "EJMGNO=" + quote(ls_RetEjmgno);
		ls_RetEjmgno = "";
	} else {
		if (gfn_IsNull(ms_ExamMgno)
				|| gfn_IsNull(edJubsuNo.Text)) {
			return false;
		}
	
		ls_HistoryArg = "회차관리번호=" + ms_ExamMgno
			+ ", 접수번호=" + lpad(edJubsuNo.Text, "0", 6);
		ls_SearchArg = "EOMGNO=" + quote(ms_ExamMgno)
			+ " EOHJUBSUNO=" + quote(lpad(edJubsuNo.Text, "0", 6))
			+ " sLikeYn=" + quote("N");
    }
        
        //trace("11::"+ms_ExamMgno);
        //trace("22:"+edJubsuNo.Text);

    // 조회이력을 저장한다.
    gfn_InsertSearchPrintHistory(
            "S"
            , this.ID
            , global.mnuLeft.cbxOpenForm.Text
            , ls_HistoryArg
        );

	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
				"S"
				, gs_CallCenterUID
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")
				, this.ID
				, global.mnuLeft.cbxOpenForm.Text
				, ls_HistoryArg
			);
	}

    ds_ioExamJubsu.ClearData(); // 데이타셋 초기화
    lfn_SetChangedJubsuInfo(true);
  
    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamJubsuList2", false);  //personkey 2017.12.11
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_ioExamJubsu=ds_oExamJubsuList"    // outDs
        ,ls_SearchArg
        ,"lfn_AfterSearchExamJubsuList"
        ,false
        ,false
        ,true
    );

    
}

/*
 * 기능 : 접수자목록 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchExamJubsuList(nErrorCode, strErrorMsg) {
	    
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_ioExamJubsu.GetCount() > 0) {
		ms_ExamMgno = ds_ioExamJubsu.GetColumn(0, "EOMGNO"); // 회차관리번호
        cbxJibu.Value = ds_ioExamJubsu.GetColumn(0, "MGJIBUCD"); // 지부
        edExamYear.Text = ds_ioExamJubsu.GetColumn(0, "YEAR"); // 년도
        radCourse.Value = ds_ioExamJubsu.GetColumn(0, "COURSECD"); // 직능
        edExamOrder.Text = ds_ioExamJubsu.GetColumn(0, "EORDER"); // 회차
        edJubsuNo.Text = ds_ioExamJubsu.GetColumn(0, "JUBSUNO"); // 접수번호
        edSeatNo.Text = ds_ioExamJubsu.GetColumn(0, "DECISIONSEATNO"); // 확정좌석번호
        ls_OldSeatNo = edSeatNo.Text; // 기존 좌석번호
        
        ls_OldPersonName = ds_ioExamJubsu.GetColumn(0, "PERSONNM");
        ls_OldRID   = ds_ioExamJubsu.GetColumn(0, "BIRTHDAY");
        
         //Personinfo 반영 2017.12.07
        ls_BIRTHDAY7 = ds_ioExamJubsu.GetColumn(0, "BIRTHDAY7"); // 생년월일7
        ls_PERSONKEY = ds_ioExamJubsu.GetColumn(0, "PERSONKEY"); // 개인식별번호
        ls_DI = ds_ioExamJubsu.GetColumn(0, "DI"); // DI값
        ls_CI = ds_ioExamJubsu.GetColumn(0, "CI"); // CI값
        ls_CIVER = ds_ioExamJubsu.GetColumn(0, "CIVER"); // CI버전        
        //Personinfo 반영 2017.12.07
        
        
        
        //패스여부
        edPassYn.Text = ds_ioExamJubsu.GetColumn(0, "ERPASSYN");
        if (!gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EO1OPENDATE"))) {
			ed1PassDate.Text = "1차합격 : " + substr(ds_ioExamJubsu.GetColumn(0, "EO1OPENDATE"),0,4) + "." +
											  substr(ds_ioExamJubsu.GetColumn(0, "EO1OPENDATE"),4,2) + "." +
											  substr(ds_ioExamJubsu.GetColumn(0, "EO1OPENDATE"),6,2);
		} else {
			ed1PassDate.Text = "";
		}
        
		if (ds_ioExamJubsu.GetColumn(0, "COURSECD") <> "10") {	// 특급 이외 시험이면
			// 응시자격구분 radio 세팅
			radJubsuGubun2.Visible = false;
			radJubsuGubun.Visible = true;
			cbxGaJubsuGubun.Visible = false;

			lbChasuGubun.Visible = false;
			radChasuGubun.Visible = false;

			// 합격여부
			lbPassYn.Visible = true;
			edPassYn.Visible = true;
			ed1PassDate.Visible = true;
			
			// 점수 세팅
			lbPoint.Visible = true;
			edPoint.Visible = true;
			lb1Point.Visible = false;
			ed1Point.Visible = false;
			lb1_1subject.Visible = false;
			ed1_1Point.Visible = false;
			lb1_2subject.Visible = false;
			ed1_2Point.Visible = false;
			lb2Point.Visible = false;
			ed2Point.Visible = false;
			lb2_1subject.Visible = false;
			ed2_1Point.Visible = false;
			lb2_2subject.Visible = false;
			ed2_2Point.Visible = false;
        
			//점수
			edPoint.Text = ds_ioExamJubsu.GetColumn(0, "ERSCORE");
        
        } else { 	// 특급시험이면
			// 응시자격구분 radio 세팅
			radJubsuGubun2.Visible = true;
			radJubsuGubun.Visible = false;
			cbxGaJubsuGubun.Visible = true;
			
			lbChasuGubun.Visible = true;
			radChasuGubun.Visible = true;

			// 합격여부
			lbPassYn.Visible = false;
			edPassYn.Visible = false;
			ed1PassDate.Visible = false;
			
			// 점수 세팅
			lbPoint.Visible = false;
			edPoint.Visible = false;

			// 1차 시험점수 공개일시
			if (left(GetDate(),12) >= ds_ioExamJubsu.GetColumn(0, "EOEXAM1OPENDATE")) {
				lbPassYn.Visible = true;
				edPassYn.Visible = true;
				ed1PassDate.Visible = true;
				lb1Point.Visible = true;
				ed1Point.Visible = true;
				lb1_1subject.Visible = true;
				ed1_1Point.Visible = true;
				lb1_2subject.Visible = true;
				ed1_2Point.Visible = true;
				
				// 1차 시험 점수
				ed1Point.Text = ds_ioExamJubsu.GetColumn(0, "ER1CHASUSCORE");
				ed1_1Point.Text = ds_ioExamJubsu.GetColumn(0, "ER1CHASU1SUBJECTSCORE");	// 1과목 
				ed1_2Point.Text = ds_ioExamJubsu.GetColumn(0, "ER1CHASU2SUBJECTSCORE"); // 2과목 
			} else {
				lbPassYn.Visible = false;
				edPassYn.Visible = false;
				ed1PassDate.Visible = false;
				lb1Point.Visible = false;
				ed1Point.Visible = false;
				lb1_1subject.Visible = false;
				ed1_1Point.Visible = false;
				lb1_2subject.Visible = false;
				ed1_2Point.Visible = false;

			}

			// 2차 시험점수 공개일시
			if (left(GetDate(),12) >= ds_ioExamJubsu.GetColumn(0, "EOEXAM2OPENDATE")) {
				lb2Point.Visible = true;
				ed2Point.Visible = true;
				lb2_1subject.Visible = true;
				ed2_1Point.Visible = true;
				lb2_2subject.Visible = true;
				ed2_2Point.Visible = true;
				
				// 2차 시험 점수
				ed2Point.Text = ds_ioExamJubsu.GetColumn(0, "ER2CHASUSCORE");
				ed2_1Point.Text = ds_ioExamJubsu.GetColumn(0, "ER2CHASU1SUBJECTSCORE"); // 1과목 
				ed2_2Point.Text = ds_ioExamJubsu.GetColumn(0, "ER2CHASU2SUBJECTSCORE"); // 2과목 
				
			} else {
				lb2Point.Visible = false;
				ed2Point.Visible = false;
				lb2_1subject.Visible = false;
				ed2_1Point.Visible = false;
				lb2_2subject.Visible = false;
				ed2_2Point.Visible = false;
			}
			
		}
		
        // 실명인증 버튼 활성/비활성
        btnAuthBIRTHDAY.Enable = true;
        
        // 최근사진
        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IILASTREALNM"))) {
            imgLastestPicture.Text = "최근사진";
            imgLastestPicture.ImageID = "";
        } else {
            imgLastestPicture.Text = "";
            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamJubsu.GetColumn(0, "IILASTDIRPATH") + "/" + ds_ioExamJubsu.GetColumn(0, "IILASTREALNM");
        }
        // 사진
        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IIREALNM"))) {
            imgPicture.Text = "사진";
            imgPicture.ImageID = "";
        } else {
            imgPicture.Text = "";
            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamJubsu.GetColumn(0, "IIDIRPATH") + "/" + ds_ioExamJubsu.GetColumn(0, "IIREALNM");
            ls_OldPictureNo = ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"); // 기존 사진번호
        }

		// 응시자격구분
        if (radCourse.Value == "10") {	// 특급소방안전관리자 
			if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "10") {	// 강습수료
				radJubsuGubun2.Value = "10";
				cbxCourse.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
				cbxGaJubsuGubun.Index = 0;
				cbxGaJubsuGubun.Enable = false;
			} else if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
				radJubsuGubun2.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
				cbxCourse.Index = 0;
				cbxCourse.Enable = false;
				cbxGaJubsuGubun.Index = 0;
				cbxGaJubsuGubun.Enable = false;
			} else if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "03") {   // 가접수
				radJubsuGubun2.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
				radJubsuGubun2_OnChanged(radJubsuGubun2,radJubsuGubun2.Value);
				cbxGaJubsuGubun.Value = ds_ioExamJubsu.GetColumn(0, "GAJUBSUGUBUN"); // 가접수구분
				cbxCourse.Index = 0;
				cbxCourse.Enable = false;
			}        
        
        } else {
			if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
				radJubsuGubun.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
				cbxCourse.Index = 0;
				cbxCourse.Enable = false;
			} else if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "01") {   // 학력
				radJubsuGubun.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
				cbxCourse.Index = 0;
				cbxCourse.Enable = false;
			} else if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "02") {   // 학·경력
				radJubsuGubun.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
				cbxCourse.Index = 0;
				cbxCourse.Enable = false;
			} else {   // 강습수료
				radJubsuGubun.Value = "20";
				cbxCourse.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
			}
        }
        
        // dataset의 orginal row와 currunt row를 일치시키기 위해
        //Edit0_OnChanged(Edit0, "");
        
        
        
		// 민원서류 스캔등록
		
		if (ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "N" ||		
		    gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN"))) {

			// 응시원서
			if (ds_ioExamJubsu.GetColumn(0, "EOHSEQ") == 1) {
				
				if (ds_ioExamJubsu.GetColumn(0, "COURSECD") == "10" ||	// 특급
					ds_ioExamJubsu.GetColumn(0, "COURSECD") == "21" ||	// 1급
					ds_ioExamJubsu.GetColumn(0, "COURSECD") == "22" ||	// 2급
					ds_ioExamJubsu.GetColumn(0, "COURSECD") == "23") {	// 3급	

					if (ds_ioExamJubsu.GetColumn(0, "EOHJUBSUGUBUN") == "1" && 	// 내방접수
						(ds_ioExamJubsu.GetColumn(0, "EOEXAMORDERGUBUN") = "1" ||	// 특급회차
						 ds_ioExamJubsu.GetColumn(0, "EOEXAMORDERGUBUN") = "5" ||	// 재시험회차
						 ds_ioExamJubsu.GetColumn(0, "EOEXAMORDERGUBUN") = "7")) {	// 학경력회차
				
						cbxForm.Value = "0021";	// 시험 응시원서
						
						if (ds_ioExamJubsu.GetColumn(0, "ATC0021") == "0" ||
							ds_ioExamJubsu.GetColumn(0, "ATC0021") == "E") {
							edFormResult.Text = "미등록";
						} else {
							edFormResult.Text = "완료";
						}
						
					} else {
					
						cbxForm.Index = 0;	// 미대상
						edFormResult.Text = "미대상";
										
					}
					
				} else if (ds_ioExamJubsu.GetColumn(0, "COURSECD") == "51") {	// 심폐소생술 응시원서

					cbxForm.Value = "0013";	// 심폐소생술 응시원서 및 응시표
					
					if (ds_ioExamJubsu.GetColumn(0, "ATC0013") == "0" ||
						ds_ioExamJubsu.GetColumn(0, "ATC0013") == "E") {
						edFormResult.Text = "미등록";
					} else {
						edFormResult.Text = "완료";
					}
					
				} else if (ds_ioExamJubsu.GetColumn(0, "COURSECD") == "50") { 	// 생활안전강사 응시원서
				
					cbxForm.Value = "0018";	// 생활안전강사 응시원서
					
					if (ds_ioExamJubsu.GetColumn(0, "ATC0018") == "0" ||
						ds_ioExamJubsu.GetColumn(0, "ATC0018") == "E") {
						edFormResult.Text = "미등록";
					} else {
						edFormResult.Text = "완료";
					}
				
				} else {
									
					cbxForm.Index = 0;
					edFormResult.Text = "미대상";
				
				}
				
			// 일정변경
			} else if (ds_ioExamJubsu.GetColumn(0, "EOHSEQ") > 1) {	// 일정변경이 있으면			
			
				cbxForm.Value = "0022";	// 시험 일정변경신청서
				
				if (ds_ioExamJubsu.GetColumn(0, "ATC0022") == "0" ||
					ds_ioExamJubsu.GetColumn(0, "ATC0022") == "E") {
					edFormResult.Text = "미등록";
				} else {
					edFormResult.Text = "완료";
				}
					
			}
					
		// 환불이면
		} else if (ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "Y") {
				
			cbxForm.Value = "0023";	// 시험 환불신청서
			
			if (ds_ioExamJubsu.GetColumn(0, "ATC0023") == "0" ||
				ds_ioExamJubsu.GetColumn(0, "ATC0023") == "E") {
				
				if (ds_ioExamJubsu.GetColumn(0, "EJHJUBSUGUBUN") == "2") {	// 인터넷 환불인 경우 미대상
					edFormResult.Text = "미대상";
				} else {
					edFormResult.Text = "미등록";
				}
				
			} else {
	
				edFormResult.Text = "완료";
			
			}

		} else {
				
			cbxForm.Index = 0;
			edFormResult.Text = "미대상";
		}
		
		if (edFormResult.Text == "미대상" || edFormResult.Text == "") {
		
			btnScan.Enable = false;
			btnScanSearch.Enable = false;
			btnScanSave.Enable = false;
			edFormResult.DisableBkColor = "user4";
		
		} else if (edFormResult.Text == "미등록") {
		
			btnScan.Enable = true;
			btnScanSearch.Enable = true;
			btnScanSave.Enable = true;
			edFormResult.DisableBkColor = "user37";
			
		} else if (edFormResult.Text == "완료") {
		
			edFormResult.DisableBkColor = "user4";
			
		}
        
        
        
        // 결제(POS) 버튼
        if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
			// 콜센터 직원 사용 이면
			if (gs_IsCallCenter == "Y") {
				btnSetlmt.Enable = false; // 결제(POS) 버튼
			} else {
				btnSetlmt.Enable = true; // 결제(POS) 버튼
			}
        }

        lfn_SearchExamSetlmentHistList(); // 결제내역 조회

    } else {

        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
        
        // 그리드 초기화
        ds_oJubsuAllInfo.ClearData();
        gdJubsuInfo.NoDataText = "";
        ds_oOrderHist.ClearData();
        gdOrderHist.NoDataText = "";
        ds_oSetlmentHist.ClearData();
        gdSetlmentHist.NoDataText = "";
        btnSetlmt.Enable = false; // 결제(POS) 버튼
        btnProcRct.Enable = false;
        btnShowVirtualAccount.Enable = false;        
        btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;
        btnPrintReRctPDF.Enable = false;
        
        lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.        
        
		// 응시자격구분, 시험차수선택
		if (radCourse.Value == "10") {
			radJubsuGubun2.index = 0;
			radChasuGubun.Index = 0;
		} else {
			radJubsuGubun.index = 0;
			radChasuGubun.Index = -1;
		}
		cbxCourse.Enable = true;
		cbxCourse.Value = radCourse.Value;
		
		radRejubsuYN.Value = "N";
    }

//////////////////////////////////////////////////////////////////////////
    if(serch_falg == "0") { // 플래그로 개인접수정보 조회할지 판별 
        lfn_SearchExamJubsuAllInfoList(); // 개인접수정보 조회
    
    } else if (serch_falg == "1") {
    
    }
    serch_falg = "0";   // 플래그 값 초기화 하기
//////////////////////////////////////////////////////////////////////////

    if (ds_ioExamJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부
        lfn_SetChangedJubsuInfo(false);
    }
    
    if(ls_SearchFlag)
    {
		lfn_SearchExamOrderMgno();
	}
	
	radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
    edPersonNm.SetFocus();
    
////////////////////////////////////////
    if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
    ////////////////////////////////
        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
        medBIRTHDAY.Readonly = true;
        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
        Button0.Enable = true;  // 접수자정보변경은 활성화 함
      
	} else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
        medBIRTHDAY.Readonly = true;
        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
        Button0.Enable = true;  // 접수자정보변경은 활성화 함
        
    ////////////////////////////////	
    } else {
    ////////////////////////////////
        edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
        medBIRTHDAY.Readonly = false;
        btnSearchPersonInfo.Enable = true;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
        Button0.Enable = false;  // 접수자정보변경은 활성화 함
    ////////////////////////////////
    
    }
    if(ds_ioExamJubsu.GetColumn(0, "AUTHYN") == "Y"){  // 이미 실명인증 되었으면 비활성화
        
        btnAuthBIRTHDAY.Enable = false;
        btnAuthBIRTHDAY.Text = "실명인증완료";
        
    }else {        
        btnAuthBIRTHDAY.Enable = true;
        btnAuthBIRTHDAY.Text = "실명인증";
    }   
    
    
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
   	edScanFileName.Text = "";	// 불러오기한 민원서류 스캔파일명
    
////////////////////////////////////////
}






/*
 * 기능 : 시험접수자목록 팝업을 호출한다.
 * parameter : sOrderMgno - 회차관리번호
 *             sJubsuNo - 접수번호
 *             sLikeYn - LIKE 검색 여부
 * return value : 시험접수자목록 정보를 가진 배열 오브젝트
 */
function lfn_ExamJubsuListPopup(eomgno, eohjubsuno, slikeyn) {
	
	var sArg = "sGtMgno=" + quote(cbxJibu.Value)
        + " sYear=" + quote(edExamYear.Text)
        + " sCourse=" + quote(radCourse.Value)
        + " sOrder=" + quote(edExamOrder.Text)       
        + " eomgno=" + quote(eomgno)
        + " eohjubsuno=" + quote(eohjubsuno)
        + " slikeyn=" + quote(slikeyn);
       
    var sRet = Dialog("training::frmtraining0401PExamJubsuList.xml", sArg, 600, 400, "", -1, -1);
    
    if (sRet == "OK") {		
        edJubsuNo.Text = ds_ioExamJubsu.GetColumn(0, "JUBSUNO"); // 접수번호
        edSeatNo.Text = ds_ioExamJubsu.GetColumn(0, "DECISIONSEATNO"); // 확정좌석번호
    }
}

/*
 * 기능 : 빈번호를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchUnUseJubsuNo(obj) {
   
   if (gfn_IsNull(ms_ExamMgno)) {
        gfn_Alert(MSGI00100); // "시험을 먼저 선택해 주십시오.";
        edExamOrder.SetFocus();
        return false;
    }

    ds_oJubsuNo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchUnUseExamJubsuNo", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oJubsuNo=ds_oJubsuNo"    // outDs
        ,"EOMGNO=" + quote(ms_ExamMgno)
        ,"lfn_AfterSearchUnUseExamJubsuNo"
        ,false
        ,false
        ,true
    );
    
    lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.   
}

/*
 * 기능 : 빈번호 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchUnUseExamJubsuNo(nErrorCode, strErrorMsg) {
  
  if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼    
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;	
	btnChangeProcDate.Enable = false;
	btnPrintReRct.Enable = false;
	btnPrintReRctPDF.Enable = false;
		 
	var bcount = 0;

    var ln_TotalCnt = ds_oJubsuNo.GetCount();
    
    if (ln_TotalCnt > 0) {
        
        edJubsuNo.Text = ds_oJubsuNo.GetColumn(0, "EOHJUBSUNO");
    
    } else {
        edJubsuNo.Text = "000001"; // 접수번호
    }
}



/**
 * 실명인증
 */
function lfn_ResidentCheck() {

	if (ls_IsNiceCheckOk == "Y") {
        btnAuthBIRTHDAY.Text = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
        edAddr1.SetFocus();
    } else {
        btnAuthBIRTHDAY.Text = "실명인증";
        btnAuthBIRTHDAY.Enable = true;
    }
}

/*
 * 기능 : 개인접수정보를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchExamJubsuAllInfoList(obj) {
       
    ds_oJubsuAllInfo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamJubsuAllInfoList", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oJubsuAllInfo=ds_oJubsuAllInfo" // outDs
        , "TPMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO")) // args
        , "lfn_AfterSearchExamJubsuAllInfoList"
        , false
    );
}


/*
 * 기능 : 개인접수정보 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
var ln_TotalGridInfoCount = 0;
function lfn_AfterSearchExamJubsuAllInfoList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    ln_TotalGridInfoCount = ds_oJubsuAllInfo.GetCount();

    gfn_SearchMessage(gdJubsuInfo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

    lfn_SearchExamOrderHistList(); // 회차변경이력 조회
}

/*
 * 기능 : 회차변경이력를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchExamOrderHistList(obj) {
    
    ds_oOrderHist.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamOrderHistList", false);
    // 서버 호출
    tit_callService(
          ""
        , ""
        , "" // inDs
        , "ds_oOrderHist=ds_oOrderHist" // outDs
        , "EJMGNO=" + quote(ds_oJubsuAllInfo.GetColumn(ds_oJubsuAllInfo.currow, "EJMGNO")) // args
        , "lfn_AfterSearchExamOrderHistList"
        , false
    );
}

/*
 * 기능 : 회차변경이력 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
var ln_TotalGridOrderCount = 0;
function lfn_AfterSearchExamOrderHistList(nErrorCode, strErrorMsg) {
    
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
        
    if(serch_falg == "1") {
        gdOrderHist_OnCellClick(0,0,0,0,0);
    }
    
    // 응시자격구분
    if (radCourse == "10") {
        radJubsuGubun2_OnChanged(radJubsuGubun2,radJubsuGubun2.Value);
    } else {
        radJubsuGubun_OnChanged(radJubsuGubun,radJubsuGubun.Value);
    }
    // 재시험여부
	radRejubsuYN_OnChanged(radRejubsuYN,radRejubsuYN.Value);    
    
    edPersonNm.SetFocus();
    
    ln_TotalGridOrderCount = ds_oOrderHist.GetCount();

    gfn_SearchMessage(gdOrderHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

/*
 * 기능 : 결제내역를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchExamSetlmentHistList(obj) {
   
    ds_oSetlmentHist.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamSetlmentHistList", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oSetlmentHist=ds_oSetlmentHist" // outDs
        , "EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // args
        , "lfn_AfterSearchExamSetlmentHistList"
        , false
    );
}

/*
 * 기능 : 결제내역 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
var ln_TotalGridSetlementCount = 0;
function lfn_AfterSearchExamSetlmentHistList(nErrorCode, strErrorMsg) {
  
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    ln_TotalGridSetlementCount = ds_oSetlmentHist.GetCount();
    gfn_SearchMessage(gdSetlmentHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

/*
 * 기능 : 버튼 활성/비활성시킨다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetFormAuth(bStatus) {
    btnDelete.Enable = bStatus; // 삭제 버튼
    btnSave.Enable = bStatus; // 수정&저장 버튼
    
    // 콜센터 직원 사용 이면
	if (gs_IsCallCenter == "Y") {
		btnToExcel.Enable = false; // 엑셀출력 버튼
		btnPrintScreen.Enable = false; // 화면출력 버튼
		btnChangeProcDate.Enable = false; // 처리일자 변경 버튼
		btnProcRct.Enable = false; // 현금영수증 처리 버튼
		btnExamCheatingManageLink.Enable = false; // 부정행위자 관리 버튼
		btnPictureManagement.Enable = false; // 사진관리 버튼
		btnSetlmt.Enable = false; // 결제 버튼
		btnPrintReRct.Enable = false; // 영수증출력 버튼
	}
}

/*
 * 기능 : 접수기본 정보를 초기화한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_InitJubsuBaseInfo() {
    
    ds_oExamJubsuResult.ClearData();

    ds_ioExamJubsu.ClearData();
    ds_ioExamJubsu.InsertRow(0);

    //cbxEmailDomain.Value = "";    
    
    // 시험결과 정보
    edPassYn.Text = "";
    ed1PassDate.Text = "";
    edPoint.Text = "";
    ed1Point.Text = "";
    ed1_1Point.Text = "";
    ed1_2Point.Text = "";
    ed2Point.Text = "";
    ed2_1Point.Text = "";
    ed2_2Point.Text = "";
   
    // 실명인증버튼
    lb_IsNiceCheckOk = false;
    btnAuthBIRTHDAY.Text = "실명인증";
    btnAuthBIRTHDAY.Enable = true;
    
    // 사진
    imgLastestPicture.ImageID = "";
    imgLastestPicture.Text = "최근사진";
    imgPicture.ImageID = "";
    imgPicture.Text = "사진";
    
    ds_ioExamJubsu.ApplyChange();

    ls_UploadRealName = ""; // 사진이미지 실제파일명
    lb_FileUpload = false; // 사진등록여부
    ls_OldSeatNo = ""; // 기존 좌석번호
    ls_OldPictureNo = ""; // 기존 사진번호
    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부
    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부
    ls_IsChangedPictureYn = "N"; // 사진 변경여부
    ls_OldPersonName = "";
    ls_OldRID   = "";
    
    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
    ls_SearchFlag = false;    
    
   
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
    cbxForm.Index = 0;			// 민원서류 종류
    edFormResult.Text = "";		// 민원서류 등록여부
    edFormResult.DisableBkColor = "user4";
    edScanFileName.Text = "";	// 민원서류 불러오기한 파일
    hfImage2.CloseFile();		// 민원서류 파일객체
    
    ls_DI = "";			// SCI DI 값
	ls_CI = "";			// SCI CI 값
	ls_CIVER = "";		// SCI CI버전
	ls_PERSONKEY = "";	// PERSONKEY 값
	ls_BIRTHDAY = "";	// 조회시 주민번호
	ls_BIRTHDAY7 = "";	// 생년월일7자리
    
}

/*
 * 기능 : 업무 변경이력을 저장한다.
 * parameter : sGubun - 변경구분. 예) I, U, D
 * return : 없음
 */
function lfn_SaveModifyHistory(sGubun) {
   
   if (sGubun = "I") { // 신규
        gds_iModifyHistory.InsertRow(0);
        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oExamJubsuResult.GetColumn(0, "RESULTEJMGNO")); // KEY값
        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명
        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값
        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값
    } else if (sGubun = "D") { // 삭제
        gds_iModifyHistory.InsertRow(0);
        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값
        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명
        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값
        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값
    } if (sGubun = "U") { // 수정
        var ln_TotalCount = ds_oModifyColumn.GetCount();
        var ls_ColumnCd = "";
        var ls_ColumnNm = "";
        for (var i = 0; i < ln_TotalCount; i++) {
            ls_ColumnCd = ds_oModifyColumn.GetColumn(i, "COLUMNCD");
            ls_ColumnNm = ds_oModifyColumn.GetColumn(i, "COLUMNNM");

            if (ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd) <> ds_ioExamJubsu.GetColumn(0, ls_ColumnCd)) {
                gds_iModifyHistory.InsertRow(0);
                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값
                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_ColumnNm); // 변경 컬럼명
                if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", substr(ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd),0,7)); // 변경 전 값
                } else {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd)); // 변경 전 값
				}
                if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", substr(ds_ioExamJubsu.GetColumn(0, ls_ColumnCd),0,7)); // 변경 후 값
                } else {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ds_ioExamJubsu.GetColumn(0, ls_ColumnCd)); // 변경 후 값
				}
                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            }
        }
        // 좌석번호 변경
        if (ls_OldSeatNo <> edSeatNo.Text) {
            gds_iModifyHistory.InsertRow(0);
            gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
            gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
            gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값
            gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "좌석번호"); // 변경 컬럼명
            gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldSeatNo); // 변경 전 값
            gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", edSeatNo.Text); // 변경 후 값

            ls_IsChangedSeatNoYn = "Y"; // 좌석번호 변경여부
        }
        // 사진 변경
        if (lb_FileUpload || ls_OldPictureNo <> ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ")) {
            gds_iModifyHistory.InsertRow(0);
            gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
            gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
            gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값
            gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "사진"); // 변경 컬럼명
            gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldPictureNo); // 변경 전 값
            gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", iif(lb_FileUpload, ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1, ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"))); // 변경 후 값

            if (lb_FileUpload) {
                ls_IsChangedPictureYn = "Y"; // 사진 변경여부
                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            } else {
                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            }
        }
    }

    gfn_InsertModifyHistory(); // 업무 변경이력을 저장한다.
}

/* 사용자 이벤트 함수 */
function lfn_SortGrid2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
    var lobj_Dataset = object(obj.BindDataset);
    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.
    if (lobj_Dataset.GetRowCount() > 1) {
 	    if (nCell > 0) {
            gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.
        }
    }
}

// 회차
function edExamOrder_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) { // Enter key
        btnSearchExamOrder.SetFocus();
        lfn_SearchExamOrderMgno(obj);
	}
}

function edExamOrder_OnKillFocus(obj) {
    gfn_ComponentOnKillFocus(obj);

    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));
    
    lfn_SearchExamOrderMgno(obj); // 회차관리번호 조회함
    
}

// 접수가능회차
function btnSearchExamOrder_OnClick(obj) {
  
    var arrExamOrder = gfn_ExamOrderListPopup("Y", cbxJibu.Value, edExamYear.Text, radCourse.Value); // 교육일정관리목록 조회 팝업
    
    if (length(arrExamOrder) > 0) {
        radCourse.Value = arrExamOrder[0];
        edExamYear.Text = arrExamOrder[1];
        edExamOrder.Text = arrExamOrder[2];
        ms_ExamMgno = arrExamOrder[3];
        cbxJibu.Value = arrExamOrder[4];

        lfn_SearchExamOrderMgno();
    }else{
		//lfn_cancel();  
		lfn_NoDateCancel(); // 날짜는 초기화 안함
    }
}

// 접수번호
function edJubsuNo_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
	if (nChar == 13) { // Enter key
        btnSeqList.SetFocus();
        lfn_SearchExamJubsuList(obj);
	}
}

function edJubsuNo_OnKillFocus(obj)
{
    gfn_ComponentOnKillFocus(obj);

    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 6));
    
   // lfn_SearchExamJubsuList(obj);  //접수목록 조회함
    
}

// 접수목록
function btnSeqList_OnClick(obj) {
    
    if (gfn_IsNull(ms_ExamMgno)) {
        gfn_Alert("시험을 먼저 선택해 주십시오.");
        edExamOrder.SetFocus();
        return false;
    }

    lfn_ExamJubsuListPopup(ms_ExamMgno, edJubsuNo.Text, iif(gfn_IsNull(edJubsuNo.Text), "", "Y")); // 교육접수자목록 조회 팝업
    lfn_SearchExamJubsuList(obj);
}

// 결강자관리
function btnAbsentManageLink_OnClick(obj) {
   
}

// 회차변경
function btnExamJubsuModify_OnClick(obj) {
    
    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        edJubsuNo.SetFocus();
        return false;
    }

    if (left(GetDAte(), 8) > ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE")) {
        gfn_Alert("시험일이 지나서 회차변경하실 수 없습니다.");
        return false;
    }

    if (ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "Y") { // 환불이면
        gfn_Alert("환불 상태이므로 회차변경할 수 없습니다.");
        return false;
    }

    var sArg = "sJibu=" + quote(cbxJibu.Text);
    sArg += " sJibuCd=" + quote(cbxJibu.Value);
    sArg += " sCourse=" + quote(ds_oCourse.GetColumn(ds_oCourse.FindRow("CD", radCourse.Value), "DATA"));
    sArg += " sCourseCd=" + quote(radCourse.Value);
    sArg += " sYear=" + quote(edExamYear.Text);
    sArg += " sOrder=" + quote(edExamOrder.Text);
    sArg += " sEjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
    sArg += " sEomgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EOMGNO"));
    if (radCourse.Value == "10") {
		sArg += " sJubsuGubun=" + quote(radJubsuGubun2.Value);
	} else {
		sArg += " sJubsuGubun=" + quote(radJubsuGubun.Value);
	}
	
    return Dialog("training::frmtraining0402PExamOrderChange.xml", sArg, 800, 400, "", -1, -1);
}

// 기본정보
function btnSearchPersonInfo_OnClick(obj) {

	//lfn_SearchPersonNm();
	 lfn_SearchPersonInfo(); //Personinfo 반영 2017.12.07
	 edHpTel.SetFocus();
	 
}

	// 안전원고객정보 조회
function lfn_SearchPersonInfo()
{
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
	//var arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medBIRTHDAY.Value,"22"); // 고객 조회 팝업
	var arrTrainingPerson = gfn_PersonInfoListPopup(edPersonNm.Text, medBIRTHDAY.Value); // 고객 조회 팝업
	
    if (length(arrTrainingPerson) > 0) {
    
        edPersonNm.text = arrTrainingPerson[0];        
        
        //----수정부분---- start
        //(old)medBIRTHDAY.Value = arrTrainingPerson[29];        

        medBIRTHDAY.Value = arrTrainingPerson[33];	// 생년월일6
        ls_PERSONKEY = arrTrainingPerson[29];	// PERSONKEY 값
        medPersonKey.Value = arrTrainingPerson[29];	// PERSONKEY 값
        
        ls_DI = arrTrainingPerson[30];	// DI 값
        ls_CI = arrTrainingPerson[31];	// CI 값
        ls_CIVER = arrTrainingPerson[32];	// CI버전
		ls_BIRTHDAY7 = arrTrainingPerson[33];	// 생년월일7자리        
		//----수정부분---- End
			
        
        ms_TrainingPersonMgno = arrTrainingPerson[2];
        
        ds_ioExamJubsu.SetColumn(0, "TPMGNO", arrTrainingPerson[2]);
        
        edTel.Text = arrTrainingPerson[3];
        
        edHpTel.Text = arrTrainingPerson[4];
        
        edEmail.text = arrTrainingPerson[5];
        
        edEmailDomain.Value = arrTrainingPerson[6];
        
        ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);
        
        medZipCode.Value = arrTrainingPerson[12];
        
        edAddr1.text = arrTrainingPerson[13];
        
        edAddr2.text = arrTrainingPerson[14];
        
        cbxAddrGubun.Value = iif(gfn_IsNull(arrTrainingPerson[17]), "0", arrTrainingPerson[17]) ;		// ADDRGUBUN
        
        ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", arrTrainingPerson[18]);	// TPRPNUCD
        
        ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrTrainingPerson[19]);	// TPRROADBUILDMGNO
        
        ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrTrainingPerson[20]);	// TPRROADDETAIL
        
        ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", arrTrainingPerson[21]);	// TPRROADREMAIN
        
        ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrTrainingPerson[22]);	// TPRSANGUBUN
        
        ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrTrainingPerson[23]);	// TPRMAINBUNJI
        
        ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrTrainingPerson[24]);	// TPRSUBBUNJI
        
        ds_ioExamJubsu.SetColumn(0, "EJRBUILDNM", arrTrainingPerson[25]);	// TPRBUILDNM
        
        ds_ioExamJubsu.SetColumn(0, "EJRADDRETC", arrTrainingPerson[26]);	// TPRADDRETC
        
        if (arrTrainingPerson[17] == "1") {	// 주소구분이 도로명주소이면
        
			ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", arrTrainingPerson[27]);	// TPRCONVPGM
			
			ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", arrTrainingPerson[28]);	// TPRCONVSTATUS

		}
        
        
        //실명인증 버튼
        var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부
        if (ls_AuthYn == "Y") {
            ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");
            btnAuthBIRTHDAY.Enable = false;
            btnAuthBIRTHDAY.Text = "실명인증완료";
            edAddr1.SetFocus();
        } else {
            btnAuthBIRTHDAY.Enable = true;
            btnAuthBIRTHDAY.Text = "실명인증";
            btnAuthBIRTHDAY_OnClick();
        }

        // 최근사진
        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ")) || ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") == '0') {
            imgLastestPicture.Text = "최근사진";
            imgLastestPicture.ImageID = "";
        } else {
            imgLastestPicture.Text = "";
            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];
        }
         
        // DI 값이 있으면 //----수정부분---- start
        if (length(ls_DI) > 0) {
			if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
		    	edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
				medBIRTHDAY.Readonly = true;
				Button0.Enable = true;  // 접수자정보변경은 활성화 함
			} else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
				edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
				medBIRTHDAY.Readonly = true;
				Button0.Enable = true;  // 접수자정보변경은 활성화 함    
			} else {
				edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
				medBIRTHDAY.Readonly = false;
				Button0.Enable = false;  // 접수자정보변경은 활성화 함
			}
        }        //----수정부분---- end....
        
        

        // 자격발급여부 확인
        if (lfn_searchLicenseCheck() == true) {
			gfn_Alert("기존에 발급한 자격수첩이 있습니다. 접수 불가합니다.\n\n" +
			          "수첩번호 : " + ds_oLicenseCheck.GetColumn(0, "LLCSNO") + "\n\n" +
			          "발급일자 : " + substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),0,4)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),4,2)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),6,2));
			return false;
        }; 
        
		////////////////////// 수료 여부 있는지 미리 확인하고 메시지 출력
        lfn_TrainingJubsuMatchingSearch(); // 수료여부 확인        
        
		if (ds_ioTrainingJubsuMatching.count > 0 ) {
				gfn_Alert("             교육수료일자 : " + left(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4,2) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),6,2) + "\n"
				+ "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"
				+ "           접수 가능 합니다. ");
			ls_jubsuPossible = "Y";
			if (radCourse.Value == "10") {	// 특급소방안전관리자
				radJubsuGubun2.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
				cbxCourse.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
				cbxCourse.Enable = true;
				cbxGaJubsuGubun.Index = 0;
				cbxGaJubsuGubun.Enable = false;

				// 특급소방안전관리자 1차시험 면제자 여부(2017.06.12)
				lfn_searchExam1ChasuMunje(ds_ioTrainingJubsuMatching.GetColumn(0, "TPMGNO"),
										  ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"));
				var msg1 = "";
				if (ds_oMunje.GetRowCount() > 0) {	// 1차 합격자료가 있으면
					msg1 = edPersonNm.Text + "님은 제1차시험 면제자입니다.\n";
					msg1 += "  ※ 1차합격 시험일자 : " + substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),0,4) + "-" +
														 substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),4,2) + "-" +
														 substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),6,2)+"\n\n";
					if (radChasuGubun.Value == "0" ||radChasuGubun.Value == "1" ) {	// 1,2차 및 1차 접수시
						msg1 += "① 제2차 시험만 응시 : 응시료 20,000원\n"
							  + "② 제1,2차 시험 응시 : 응시료 35,000원\n"
							  + "③ 제1차 시험만 응시 : 응시료 15,000원";
						gfn_alert(msg1);
					}
				}

				
			} else {
				radJubsuGubun.Value = "20";
				cbxCourse.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
			}
		} else {
        
			// 응시자격구분(과거 접수자료 조회)
			lfn_searchJubsuGubun(ms_TrainingPersonMgno, radCourse.Value);
	
			if (!gfn_IsNull(ds_oJubsuGubun.GetColumn(0,"EJJUBSUGUBUN"))) {
				var gubunmsg = "";
				var msg = "";
				
				if (radCourse.Value == "10") {	// 특급소방안전관리자
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "10") {   // 강습수료
						ls_jubsuPossible = "N";	// 접수불가
						radRejubsuYN.Value = "N";	//재접수 여부
							
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						cbxGaJubsuGubun.Index = 0;
						cbxGaJubsuGubun.Enable = false;
						gubunmsg = "기존에 접수내역 중 최종 경력으로 접수하신 이력이 있습니다.\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]";
						ls_jubsuPossible = "Y";	// 접수가능
						radRejubsuYN.Value = "Y";	//재접수 여부
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "03") {   // 가접수
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						cbxGaJubsuGubun.Index = 0;
						cbxGaJubsuGubun.Enable = true;
						gubunmsg = "기존에 접수내역 중 최종 가접수로 접수하신 이력이 있습니다.\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]";
						ls_jubsuPossible = "Y";	// 접수가능
						radRejubsuYN.Value = "Y";	//재접수 여부
					}
							
					if (ls_jubsuPossible == "Y" && (ds_oJubsuGubun.GetColumn(0, "EOYEAR") == toNumber(edExamYear.Text)-1)) { // 1년전 시험응시자이면
						if (ds_oJubsuGubun.GetColumn(0, "EJPASSYN") == "1") {	// 1차만 합격했을 경우
								gubunmsg += "\n\n"+ds_oJubsuGubun.GetColumn(0, "EOYEAR")+"년 제1차시험 합격자입니다.\n"+
										   "제1차시험 면제자로 제2차시험을 접수하시면 됩니다.";
								radChasuGubun.Value = "2";
						}
					}
					if (ls_jubsuPossible == "N") {
						gubunmsg += "\n\n강습교육 수료 또는 경력, 가접수 건이 없습니다.\n 접수 불가 합니다. ";
					}
					
					// 업무대행경력 접수자 접수 불가(2015.01.07)
					if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
						gubunmsg += "\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					               +"접수가 불가합니다.<업무대행경력자 접수불가>";
					};
					gfn_Alert(gubunmsg);
				
				} else {
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "경력";
						ls_jubsuPossible = "Y";	// 접수가능
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "01") {   // 학력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "학력으로";
						ls_jubsuPossible = "Y";	// 접수가능
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "02") {   // 학·경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "학·경력으로";
						ls_jubsuPossible = "Y";	// 접수가능
					} else {   // 강습수료
						ls_jubsuPossible = "N";	// 접수불가
						radRejubsuYN.Value = "N";	//재접수 여부
					}
					
					// 업무대행경력 접수자 접수 불가(2015.01.07)
					if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
						msg = "\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					          +"접수가 불가합니다.<업무대행경력자 접수불가>";
					} else {
						msg = "";
					}
					if (ls_jubsuPossible == "Y") {	// 접수가능
						gfn_Alert("기존에 접수내역 중 최종 "+gubunmsg+" 접수하신 이력이 있습니다.\n\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]"
								  + msg
						);
						radRejubsuYN.Value = "Y";	//재접수 여부
						
					} else {	// 접수불가
					
						gfn_Alert("강습교육 수료 또는 경력, 학력 건이 없습니다.\n\n"
								  + " 접수 불가 합니다. ");
						radRejubsuYN.Value = "N";	//재접수 여부
					
					}
				}
	
			} else {
				gfn_Alert("강습교육 수료 또는 경력, 가접수 건이 없습니다.\n\n"
						  + " 접수 불가 합니다. ");
				radRejubsuYN.Value = "N";	//재접수 여부
				return false;
			}
        }
    } else {
        medBIRTHDAY.SetFocus();
    }
       
}





function lfn_SearchPersonNm()
{
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
	var arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medBIRTHDAY.Value,"22"); // 고객 조회 팝업
	
    if (length(arrTrainingPerson) > 0) {
    
        edPersonNm.text = arrTrainingPerson[0];
        
        medBIRTHDAY.Value = arrTrainingPerson[29];
        
        ms_TrainingPersonMgno = arrTrainingPerson[2];
        
        ds_ioExamJubsu.SetColumn(0, "TPMGNO", arrTrainingPerson[2]);
        
        edTel.Text = arrTrainingPerson[3];
        
        edHpTel.Text = arrTrainingPerson[4];
        
        edEmail.text = arrTrainingPerson[5];
        
        edEmailDomain.Value = arrTrainingPerson[6];
        
        ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);
        
        medZipCode.Value = arrTrainingPerson[12];
        
        edAddr1.text = arrTrainingPerson[13];
        
        edAddr2.text = arrTrainingPerson[14];
        
        cbxAddrGubun.Value = iif(gfn_IsNull(arrTrainingPerson[17]), "0", arrTrainingPerson[17]) ;		// ADDRGUBUN
        
        ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", arrTrainingPerson[18]);	// TPRPNUCD
        
        ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrTrainingPerson[19]);	// TPRROADBUILDMGNO
        
        ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrTrainingPerson[20]);	// TPRROADDETAIL
        
        ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", arrTrainingPerson[21]);	// TPRROADREMAIN
        
        ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrTrainingPerson[22]);	// TPRSANGUBUN
        
        ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrTrainingPerson[23]);	// TPRMAINBUNJI
        
        ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrTrainingPerson[24]);	// TPRSUBBUNJI
        
        ds_ioExamJubsu.SetColumn(0, "EJRBUILDNM", arrTrainingPerson[25]);	// TPRBUILDNM
        
        ds_ioExamJubsu.SetColumn(0, "EJRADDRETC", arrTrainingPerson[26]);	// TPRADDRETC
        
        if (arrTrainingPerson[17] == "1") {	// 주소구분이 도로명주소이면
        
			ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", arrTrainingPerson[27]);	// TPRCONVPGM
			
			ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", arrTrainingPerson[28]);	// TPRCONVSTATUS

		}
        
        
        //실명인증 버튼
        var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부
        if (ls_AuthYn == "Y") {
            ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");
            btnAuthBIRTHDAY.Enable = false;
            btnAuthBIRTHDAY.Text = "실명인증완료";
            edAddr1.SetFocus();
        } else {
            btnAuthBIRTHDAY.Enable = true;
            btnAuthBIRTHDAY.Text = "실명인증";
            btnAuthBIRTHDAY_OnClick();
        }

        // 최근사진
        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ")) || ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") == '0') {
            imgLastestPicture.Text = "최근사진";
            imgLastestPicture.ImageID = "";
        } else {
            imgLastestPicture.Text = "";
            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];
        }
        

        // 자격발급여부 확인
        if (lfn_searchLicenseCheck() == true) {
			gfn_Alert("기존에 발급한 자격수첩이 있습니다. 접수 불가합니다.\n\n" +
			          "수첩번호 : " + ds_oLicenseCheck.GetColumn(0, "LLCSNO") + "\n\n" +
			          "발급일자 : " + substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),0,4)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),4,2)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),6,2));
			return false;
        }; 
        
		////////////////////// 수료 여부 있는지 미리 확인하고 메시지 출력
        lfn_TrainingJubsuMatchingSearch(); // 수료여부 확인        
        
		if (ds_ioTrainingJubsuMatching.count > 0 ) {
				gfn_Alert("             교육수료일자 : " + left(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4,2) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),6,2) + "\n"
				+ "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"
				+ "           접수 가능 합니다. ");
			ls_jubsuPossible = "Y";
			if (radCourse.Value == "10") {	// 특급소방안전관리자
				radJubsuGubun2.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
				cbxCourse.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
				cbxCourse.Enable = true;
				cbxGaJubsuGubun.Index = 0;
				cbxGaJubsuGubun.Enable = false;

				// 특급소방안전관리자 1차시험 면제자 여부(2017.06.12)
				lfn_searchExam1ChasuMunje(ds_ioTrainingJubsuMatching.GetColumn(0, "TPMGNO"),
										  ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"));
				var msg1 = "";
				if (ds_oMunje.GetRowCount() > 0) {	// 1차 합격자료가 있으면
					msg1 = edPersonNm.Text + "님은 제1차시험 면제자입니다.\n";
					msg1 += "  ※ 1차합격 시험일자 : " + substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),0,4) + "-" +
														 substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),4,2) + "-" +
														 substr(ds_oMunje.GetColumn(0, "PASSEXAMDATE"),6,2)+"\n\n";
					if (radChasuGubun.Value == "0" ||radChasuGubun.Value == "1" ) {	// 1,2차 및 1차 접수시
						msg1 += "① 제2차 시험만 응시 : 응시료 20,000원\n"
							  + "② 제1,2차 시험 응시 : 응시료 35,000원\n"
							  + "③ 제1차 시험만 응시 : 응시료 15,000원";
						gfn_alert(msg1);
					}
				}

				
			} else {
				radJubsuGubun.Value = "20";
				cbxCourse.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
			}
		} else {
        
			// 응시자격구분(과거 접수자료 조회)
			lfn_searchJubsuGubun(ms_TrainingPersonMgno, radCourse.Value);
	
			if (!gfn_IsNull(ds_oJubsuGubun.GetColumn(0,"EJJUBSUGUBUN"))) {
				var gubunmsg = "";
				var msg = "";
				
				if (radCourse.Value == "10") {	// 특급소방안전관리자
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "10") {   // 강습수료
						ls_jubsuPossible = "N";	// 접수불가
						radRejubsuYN.Value = "N";	//재접수 여부
							
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						cbxGaJubsuGubun.Index = 0;
						cbxGaJubsuGubun.Enable = false;
						gubunmsg = "기존에 접수내역 중 최종 경력으로 접수하신 이력이 있습니다.\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]";
						ls_jubsuPossible = "Y";	// 접수가능
						radRejubsuYN.Value = "Y";	//재접수 여부
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "03") {   // 가접수
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						cbxGaJubsuGubun.Index = 0;
						cbxGaJubsuGubun.Enable = true;
						gubunmsg = "기존에 접수내역 중 최종 가접수로 접수하신 이력이 있습니다.\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]";
						ls_jubsuPossible = "Y";	// 접수가능
						radRejubsuYN.Value = "Y";	//재접수 여부
					}
							
					if (ls_jubsuPossible == "Y" && (ds_oJubsuGubun.GetColumn(0, "EOYEAR") == toNumber(edExamYear.Text)-1)) { // 1년전 시험응시자이면
						if (ds_oJubsuGubun.GetColumn(0, "EJPASSYN") == "1") {	// 1차만 합격했을 경우
								gubunmsg += "\n\n"+ds_oJubsuGubun.GetColumn(0, "EOYEAR")+"년 제1차시험 합격자입니다.\n"+
										   "제1차시험 면제자로 제2차시험을 접수하시면 됩니다.";
								radChasuGubun.Value = "2";
						}
					}
					if (ls_jubsuPossible == "N") {
						gubunmsg += "\n\n강습교육 수료 또는 경력, 가접수 건이 없습니다.\n 접수 불가 합니다. ";
					}
					
					// 업무대행경력 접수자 접수 불가(2015.01.07)
					if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
						gubunmsg += "\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					               +"접수가 불가합니다.<업무대행경력자 접수불가>";
					};
					gfn_Alert(gubunmsg);
				
				} else {
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "경력";
						ls_jubsuPossible = "Y";	// 접수가능
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "01") {   // 학력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "학력으로";
						ls_jubsuPossible = "Y";	// 접수가능
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "02") {   // 학·경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "학·경력으로";
						ls_jubsuPossible = "Y";	// 접수가능
					} else {   // 강습수료
						ls_jubsuPossible = "N";	// 접수불가
						radRejubsuYN.Value = "N";	//재접수 여부
					}
					
					// 업무대행경력 접수자 접수 불가(2015.01.07)
					if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
						msg = "\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					          +"접수가 불가합니다.<업무대행경력자 접수불가>";
					} else {
						msg = "";
					}
					if (ls_jubsuPossible == "Y") {	// 접수가능
						gfn_Alert("기존에 접수내역 중 최종 "+gubunmsg+" 접수하신 이력이 있습니다.\n\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]"
								  + msg
						);
						radRejubsuYN.Value = "Y";	//재접수 여부
						
					} else {	// 접수불가
					
						gfn_Alert("강습교육 수료 또는 경력, 학력 건이 없습니다.\n\n"
								  + " 접수 불가 합니다. ");
						radRejubsuYN.Value = "N";	//재접수 여부
					
					}
				}
	
			} else {
				gfn_Alert("강습교육 수료 또는 경력, 가접수 건이 없습니다.\n\n"
						  + " 접수 불가 합니다. ");
				radRejubsuYN.Value = "N";	//재접수 여부
				return false;
			}
        }
    } else {
        medBIRTHDAY.SetFocus();
    }
       
}

// 응시자격구분(과거접수자료조회)
function lfn_searchJubsuGubun(vTPMGNO, vCOURSECD)
{
	if(vTPMGNO == "" || vTPMGNO = NULL)
	{
		return false;
	}
	
	tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamJubsuGubun", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oJubsuGubun=ds_oJubsuGubun"    // outDs
        ,"TPMGNO=" + quote(vTPMGNO)
         + " EOTCCOURSECD=" + quote(vCOURSECD)
         + " EOYEAR=" + quote(toNumber(edExamYear.Text)-1)
        ,""
        ,false
        ,false
        ,true
    );
}

function lfn_searchAddr(BIRTHDAY)   //  주소를 따로 구하도록하였지만 필요 없는거 같음
{
	if(BIRTHDAY == "" || BIRTHDAY = NULL)
	{
		return false;
	}
	
	tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExamJubsuAddr", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oExamAdd=ds_oExamAdd"    // outDs
        ,"EJBIRTHDAY=" + quote(BIRTHDAY)        
        ,"lfn_AfterSearchAddr"
        ,false
    );
}

function lfn_AfterSearchAddr(nErrorCode, strErrorMsg)
{
	ds_ioExamJubsu.SetColumn(0, "ZIPCD", ds_oExamAdd.GetColumn(0, "EJZZIPCD"));
	ds_ioExamJubsu.SetColumn(0, "ADDR1", ds_oExamAdd.GetColumn(0, "EJADDR1"));
	ds_ioExamJubsu.SetColumn(0, "ADDR2", ds_oExamAdd.GetColumn(0, "EJADDR2"));
}

// 주민등록번호
function medBIRTHDAY_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {
if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13)){ // (Ctrl + C)가 아니면
        if (nChar == 13) {
			if(ds_ioTrainingJubsu.GetColumn(0, "AUTHYN") != "Y"){  // 이미 실명인증 되었으면 실명인증 안함
				btnAuthBIRTHDAY.SetFocus();
			    if (!gfn_IsNull(edPersonNm.Text) && !gfn_IsNull(medBIRTHDAY.Value)) {	// 성명&주민번호 입력한 경우
					if (length(medBIRTHDAY.Value) < 13) {	// 주민번호가 13자리가 아니면
						lfn_SearchPersonInfo();		// 안전원고객정보 조회
					} else {
						ls_BIRTHDAY = medBIRTHDAY.Value;
						btnAuthBIRTHDAY_OnClick(); // 실명인증					
					}
				} else {
					lfn_SearchPersonInfo();		// 안전원고객정보 조회
				}
			} else {
				//lfn_SearchPersonNm();			
				lfn_SearchPersonInfo();
			}
        } else {
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
                lfn_ResetPerson();
            }
        }

    }
}

// 실명인증
function btnAuthBIRTHDAY_OnClick(obj) {
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medBIRTHDAY.Value)) {
        gfn_Alert("성명과 주민번호를 입력해 주십시오.");
        return false;
    }
    
    
    
    if (length(medBIRTHDAY.Value) < 13) {
        gfn_Alert("[주민번호오류] 실명인증을 위해서는 주민등록번호가 13자리를 입력해 주세요.");
        return false;
    }    
    
    
	//old ... lb_IsNiceCheckOk = gfn_CheckNice(edPersonNm.Text, medBIRTHDAY.Value); // 실명인증
	Https.Sync = true;  
	gfn_CheckSCI(edPersonNm.Text, medBIRTHDAY.Value); // 실명인증
	Https.Sync = false;  
		
    //trace(	gds_ioSciCheck.SaveXML()	);
    
	if (gds_ioSciCheck.GetColumn(0, "STRRESULT") == "1") {
    //old...if (lb_IsNiceCheckOk) {
        btnAuthBIRTHDAY.Text = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
        ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");
        edAddr1.SetFocus();

       ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함
        ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
        
        //lfn_searchTraingPerson();      구버전.. 
        lfn_searchPerson(edPersonNm.Text, ls_DI); //  개인정보 조회  personinfo....        
                
        medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // PERSONKEY 값
        ls_BIRTHDAY7 = ds_ioExamPerson.GetColumn(0, "BIRTHDAY7"); // 생년월일7
        ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // 개인식별번호
        ls_DI = ds_ioExamPerson.GetColumn(0, "DI"); // DI값
        ls_CI = ds_ioExamPerson.GetColumn(0, "CI"); // CI값
        ls_CIVER = ds_ioExamPerson.GetColumn(0, "CIVER"); // CI버전      
        
        //////////////////
        ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));
        ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", ds_ioExamPerson.GetColumn(0, "TPLASTIMGSEQ"));
        ds_ioExamJubsu.SetColumn(0, "ZIPCD", ds_ioExamPerson.GetColumn(0, "TPZIPCD"));
        
       // medZipCode.Text = ds_ioTrainingPerson.GetColumn(0, "TPZIPCD");
        edAddr1.Text = ds_ioExamPerson.GetColumn(0, "TPADDR1");
        edAddr2.Text = ds_ioExamPerson.GetColumn(0, "TPADDR2");
        edTel.Text = ds_ioExamPerson.GetColumn(0, "TPTEL");
        edHpTel.Text = ds_ioExamPerson.GetColumn(0, "TPHPTEL");
        edEmail.Text = ds_ioExamPerson.GetColumn(0, "TPEMAILID");
        edEmailDomain.Text = ds_ioExamPerson.GetColumn(0, "TPEMAILDOMAIN");
        
        // 최근사진
        if (gfn_IsNull(ds_ioExamPerson.GetColumn(0, "LASTIMGSEQ"))) {
            imgLastestPicture.Text = "최근사진";
            imgLastestPicture.ImageID = "";
        } else {
            imgLastestPicture.Text = "";
            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamPerson.GetColumn(0, "IIDIRPATH") + "/" + ds_ioExamPerson.GetColumn(0, "IIREALNM");
        }
        ////////////////////////////////         
        
        // 자격발급여부 확인
        if (lfn_searchLicenseCheck() == true) {
			gfn_Alert("기존에 발급한 자격수첩이 있습니다. 접수 불가합니다.\n\n" +
			          "수첩번호 : " + ds_oLicenseCheck.GetColumn(0, "LLCSNO") + "\n\n" +
			          "발급일자 : " + substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),0,4)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),4,2)+"."+
									  substr(ds_oLicenseCheck.GetColumn(0, "LISSUEDATE"),6,2));
			return false;
        }; 
        
		////////////////////// 수료 여부 있는지 미리 확인하고 메시지 출력
        lfn_TrainingJubsuMatchingSearch(); // 수료여부 확인        
        
		if (ds_ioTrainingJubsuMatching.count > 0 ) {

//			alert("           강습교육 수료 후 2년이내 시험접수가능\n\n"
			gfn_Alert("             교육수료일자 : " + left(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),4,2) + "-"
												 + substr(ds_ioTrainingJubsuMatching.GetColumn(0, "TPPASSDATE"),6,2) + "\n"
				+ "             직            능 : " + ds_ioTrainingJubsuMatching.GetColumn(0, "TCCOURSENM") + "\n\n"
				+ "           접수 가능 합니다. ");
			ls_jubsuPossible = "Y";
			if (radCourse.Value == "10") {	// 특급소방안전관리자
				radJubsuGubun2.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
				cbxCourse.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
				cbxCourse.Enable = true;
				cbxGaJubsuGubun.Index = 0;
				cbxGaJubsuGubun.Enable = false;
			} else {
				radJubsuGubun.Value = "20";
				cbxCourse.Value = ds_ioTrainingJubsuMatching.GetColumn(0, "TOTCCOURSECD");
			}
		} else {
        
			// 응시자격구분(과거 접수자료 조회)
			lfn_searchJubsuGubun(ds_ioExamPerson.GetColumn(0, "TPMGNO"), radCourse.Value);        
			
			if (!gfn_IsNull(ds_oJubsuGubun.GetColumn(0,"EJJUBSUGUBUN"))) {
				var gubunmsg = "";
				var msg = "";
				
				if (radCourse.Value == "10") {	// 특급소방안전관리자
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "10") {   // 강습수료
						ls_jubsuPossible = "N";	// 접수불가
						radRejubsuYN.Value = "N";	//재접수 여부
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						cbxGaJubsuGubun.Index = 0;
						cbxGaJubsuGubun.Enable = false;
						gubunmsg = "기존에 접수내역 중 최종 경력으로 접수하신 이력이 있습니다.\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]";
						ls_jubsuPossible = "Y";	// 접수가능
						radRejubsuYN.Value = "Y";	//재접수 여부
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "03") {   // 가접수
						radJubsuGubun2.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						cbxGaJubsuGubun.Index = 0;
						cbxGaJubsuGubun.Enable = true;
						gubunmsg = "기존에 접수내역 중 최종 가접수로 접수하신 이력이 있습니다.\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]";
						ls_jubsuPossible = "Y";	// 접수가능
						radRejubsuYN.Value = "Y";	//재접수 여부
					}
							
					if (ls_jubsuPossible == "Y" && (ds_oJubsuGubun.GetColumn(0, "EOYEAR") == toNumber(edExamYear.Text)-1)) { // 1년전 시험응시자이면
						if (ds_oJubsuGubun.GetColumn(0, "EJPASSYN") == "1") {	// 1차만 합격했을 경우
								gubunmsg += "\n\n"+ds_oJubsuGubun.GetColumn(0, "EOYEAR")+"년 제1차시험 합격자입니다.\n"+
										   "제1차시험 면제자로 제2차시험을 접수하시면 됩니다.";
								radChasuGubun.Value = "2";
						}
					}
					if (ls_jubsuPossible == "N") {
						gubunmsg += "\n\n강습교육 수료 또는 경력, 가접수 건이 없습니다.\n 접수 불가 합니다. ";
					}
					
					// 업무대행경력 접수자 접수 불가(2015.01.07)
					if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
						gubunmsg += "\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					               +"접수가 불가합니다.<업무대행경력자 접수불가>";
					};
					gfn_Alert(gubunmsg);
				
				} else {
					if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "00") {   // 경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "경력";
						ls_jubsuPossible = "Y";	// 접수가능
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "01") {   // 학력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "학력으로";
						ls_jubsuPossible = "Y";	// 접수가능
					} else if (ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN") == "02") {   // 학·경력
						radJubsuGubun.Value = ds_oJubsuGubun.GetColumn(0, "EJJUBSUGUBUN");
						cbxCourse.Index = 0;
						cbxCourse.Enable = false;
						gubunmsg = "학·경력으로";
						ls_jubsuPossible = "Y";	// 접수가능
					} else {   // 강습수료
						ls_jubsuPossible = "N";	// 접수불가
						radRejubsuYN.Value = "N";	//재접수 여부						
					}
					
					// 업무대행경력 접수자 접수 불가(2015.01.07)
					if (ds_oJubsuGubun.GetColumn(0, "EJAGENCYYN") == "Y") {
						msg = "\n\n화재예방, 소방시설 설치ㆍ유지 및 안전관리에 관한 법률 시행령 개정에 따라\n"
					          +"접수가 불가합니다.<업무대행경력자 접수불가>";
					} else {
						msg = "";
					}
					if (ls_jubsuPossible == "Y") {
						gfn_Alert("기존에 접수내역 중 최종 "+gubunmsg+" 접수하신 이력이 있습니다.\n\n"
								  + "[ " + ds_oJubsuGubun.GetColumn(0, "GTTEAMNM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "EOYEAR") + "년  "
								  + ds_oJubsuGubun.GetColumn(0, "TCCOURSENM") + "  "
								  + ds_oJubsuGubun.GetColumn(0, "ORDERSERL") + " ]"
								  + msg
						);
						radRejubsuYN.Value = "Y";	//재접수 여부
					} else {	// 접수불가
						gfn_Alert("강습교육 수료 또는 경력, 학력 건이 없습니다.\n\n"
								  + " 접수 불가 합니다. ");
						radRejubsuYN.Value = "N";	//재접수 여부
					}
				}
	
			} else {
				gfn_Alert("기존에 접수하신 내역이 없습니다.");
				radRejubsuYN.Value = "N";	//재접수 여부
			}
		}
    } else {
        btnAuthBIRTHDAY.Text = "실명인증";
        btnAuthBIRTHDAY.Enable = true;
        medBIRTHDAY.SetFocus();
        gfn_Alert("[실명인증오류]이름 및 주민등록번호를 확인하세요");
    }
       
}


// 저장시 실명인증
function lfn_AuthBIRTHDAY() {
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medBIRTHDAY.Value)) {
        gfn_Alert("성명과 주민번호를 입력해 주십시오.");
        return false;
    }
    
    
    
    if (length(medBIRTHDAY.Value) < 13) {
        gfn_Alert("[주민번호오류] 실명인증을 위해서는 주민등록번호가 13자리를 입력해 주세요.");
        return false;
    }    
    
    
	//old ... lb_IsNiceCheckOk = gfn_CheckNice(edPersonNm.Text, medBIRTHDAY.Value); // 실명인증
	Https.Sync = true;  
	gfn_CheckSCI(edPersonNm.Text, medBIRTHDAY.Value); // 실명인증
	Https.Sync = false;  
		
	if (gds_ioSciCheck.GetColumn(0, "STRRESULT") == "1") {
    //old...if (lb_IsNiceCheckOk) {
        btnAuthBIRTHDAY.Text = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
        ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");

       ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함
        ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
		ls_CI = gds_ioSciCheck.GetColumn(0, "STRCI");
		ls_CIVER = gds_ioSciCheck.GetColumn(0, "STRVER");
        lfn_searchPerson(edPersonNm.Text, ls_DI); //  개인정보 조회  personinfo....    
        ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // 개인식별번호            
        medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // PERSONKEY 값
        ls_BIRTHDAY7 = ds_ioExamPerson.GetColumn(0, "BIRTHDAY7"); // 생년월일7

        //////////////////
        ds_ioExamJubsu.SetColumn(0, "TPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));

    } else {
        
		ds_ioExamJubsu.SetColumn(0, "AUTHYN", "N");
    
   		ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
		ls_CI = gds_ioSciCheck.GetColumn(0, "STRCI");
		ls_CIVER = gds_ioSciCheck.GetColumn(0, "STRVER");

		if (length(ls_DI) > 0) {
			lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
			ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY");
			medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY");
			ls_BIRTHDAY7 = ds_ioExamPerson.GetColumn(0, "BIRTHDAY7"); // 생년월일7
		}
        
        btnAuthBIRTHDAY.Text = "실명인증";
        btnAuthBIRTHDAY.Enable = true;
        medBIRTHDAY.SetFocus();

    }
       
}


// 접수이력
function btnTraingJubsuHist_OnClick(obj) {
   
    if (gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medBIRTHDAY.Value)) {
        gfn_Alert("성명이나 주민등록번호를 입력해 주십시오.");
        edPersonNm.SetFocus();
        return false;
    }
/*** org...
    var sArg = "sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sBIRTHDAY=" + quote(medBIRTHDAY.Value);
    var arrEjmgno = Dialog("training::frmtraining0403PExamJubsuHistList.xml", sArg, 600, 400, "", -1, -1);
    ***/
    //personkey값이 없는 경우에는   이름,생년월일 순으로...
    var sArg = "sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sBirthday=" + quote(medBIRTHDAY.Value);
    sArg += " sPersonkey=" + quote(medPersonKey.Value);
    
    trace ("sArg"+sArg);
    
    var arrEjmgno = Dialog("training::frmtraining0403PExamJubsuHistList.xml", sArg, 600, 400, "", -1, -1);

    
    if (length(arrEjmgno) > 0) {
    
		ms_ExamMgno = arrEjmgno[0]; // 회차관리번호
		edJubsuNo.Text = arrEjmgno[1]; // 접수번호
		
		if(arrEjmgno[2] != gds_oUserInfo.GetColumn(0, "PDEPTCD"))
		{
			changeJibuRadio("T", false);	
			radJibuGubun.Value = "T";
		}else{
			
			changeJibuRadio("S", false);
			radJibuGubun.Value = "S";
		}
		
		ls_SearchFlag = true;
		lfn_SearchExamJubsuList();
    }
    
    //if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
    //    gfn_Alert("접수 정보가 없습니다.");
    //    return false;
    //}

    //var sArg = "sTjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
    //return Dialog("training::frmtraining0403PExamJubsuHistList.xml", sArg, 600, 400, "", -1, -1);    
}

// 변경이력
function btnModifyHistory_OnClick(obj) {
   
    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        return false;
    }

	gfn_ModifyHistoryListPopup("시험접수", ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
}

// 우편번호
function edZipCode_OnFocus(obj) {

    btnSearchZipCode.SetFocus();
}

// 우편번호
function btnSearchZipCode_OnClick(obj) {

	// 지번주소/도로명주소 조회 팝업
	var arrAddrInfo = gfn_PostRoadListPopup(cbxJibu.Value		// 지부코드
											, ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")		// 구새주소 구분[0:구주소, 1:새주소]
											, ds_ioExamJubsu.GetColumn(0, "ZIPCD")			// 구:지번 우편번호
											, ds_ioExamJubsu.GetColumn(0, "ADDR1")		// 구:지번주소1
											, ds_ioExamJubsu.GetColumn(0, "ADDR2")		// 구:지번주소2
											, ds_ioExamJubsu.GetColumn(0, "EJRSANGUBUN")		// 구:산여부
											, ds_ioExamJubsu.GetColumn(0, "EJRMAINBUNJI")	// 구:주번지
											, ds_ioExamJubsu.GetColumn(0, "EJRSUBBUNJI")		// 구:부번지
											, ds_ioExamJubsu.GetColumn(0, "EJRBUILDNM")		// 구:아파트,건물명
											, ds_ioExamJubsu.GetColumn(0, "EJRADDRETC")	// 구:상세주소
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새1:도로명 우편번호
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새1:도로명주소11
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새1:도로명주소12
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADBUILDMGNO"))	// 새1:건물관리번호1
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADDETAIL"))	// 새1:상세주소1
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADREMAIN"))		// 새1:부가주소1
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새2:도로명 우편번호
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새2:도로명주소21
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새2:도로명주소22
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADBUILDMGNO"))	// 새2:건물관리번호2
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADDETAIL"))	// 새2:상세주소2
											, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADREMAIN"))	// 새2:부가주소2
											); 

    if (length(arrAddrInfo) > 0) {

		if (arrAddrInfo[0] == 0) {
			
			/* 지번주소 조회 Tab */
			// 구주소
			ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "0");
			
			medZipCode.Value = arrAddrInfo[1];
	
			edAddr1.Text = arrAddrInfo[2];
	
			edAddr2.Text = arrAddrInfo[3];
			
			if (arrAddrInfo[11] <> "") {
				
				// 새주소
				ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "1");
				
				medZipCode.Value = arrAddrInfo[10];
				
				edAddr1.Text = arrAddrInfo[11];
				
				edAddr2.Text = arrAddrInfo[12];
				
			}
		 
			ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", arrAddrInfo[9]);		// PNU 코드
			
			ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
			
			ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
			
			ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
				   
			ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrAddrInfo[4]);
			
			ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrAddrInfo[5]);
			
			ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrAddrInfo[6]);
			
			ds_ioExamJubsu.SetColumn(0, "EJRBUILDNM", arrAddrInfo[7]);
			
			ds_ioExamJubsu.SetColumn(0, "EJRADDRETC", arrAddrInfo[8]);
			
			if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
			
				ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", "1");
				
				ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", "01");
			
			};
			
		} else {
		
			/* 도로명주소 조회 Tab */
			
			ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "1");
			
			medZipCode.Value = arrAddrInfo[10];	// 우편번호
	
			edAddr1.Text = arrAddrInfo[11];		// 도로명주소1
	
			edAddr2.Text = arrAddrInfo[12];		// 도로명주소2
			
			ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrAddrInfo[4]);		// 산여부
			
			ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrAddrInfo[5]);		// 주번지
			
			ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrAddrInfo[6]);		// 부번지
			
			ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", arrAddrInfo[9]);			// PNU 코드
			
			ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
			
			ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
			
			ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
	
			if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
			
				ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", "1");
				
				ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", "01");
			
			};
	
		}

    }
    
}

// 주소1
function edAddr1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

    if (nChar == 13) {
        btnSearchZipCode.SetFocus();
		// 지번주소/도로명주소 조회 팝업
		var arrAddrInfo = gfn_PostRoadListPopup(cbxJibu.Value		// 지부코드
												, ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")		// 구새주소 구분[0:구주소, 1:새주소]
												, ds_ioExamJubsu.GetColumn(0, "ZIPCD")			// 구:지번 우편번호
												, ds_ioExamJubsu.GetColumn(0, "ADDR1")		// 구:지번주소1
												, ds_ioExamJubsu.GetColumn(0, "ADDR2")		// 구:지번주소2
												, ds_ioExamJubsu.GetColumn(0, "EJRSANGUBUN")		// 구:산여부
												, ds_ioExamJubsu.GetColumn(0, "EJRMAINBUNJI")	// 구:주번지
												, ds_ioExamJubsu.GetColumn(0, "EJRSUBBUNJI")		// 구:부번지
												, ds_ioExamJubsu.GetColumn(0, "EJRBUILDNM")		// 구:아파트,건물명
												, ds_ioExamJubsu.GetColumn(0, "EJRADDRETC")	// 구:상세주소
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새1:도로명 우편번호
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새1:도로명주소11
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새1:도로명주소12
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADBUILDMGNO"))	// 새1:건물관리번호1
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADDETAIL"))	// 새1:상세주소1
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADREMAIN"))		// 새1:부가주소1
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새2:도로명 우편번호
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새2:도로명주소21
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새2:도로명주소22
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADBUILDMGNO"))	// 새2:건물관리번호2
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADDETAIL"))	// 새2:상세주소2
												, iif(ds_ioExamJubsu.GetColumn(0, "EJADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EJRROADREMAIN"))	// 새2:부가주소2
												); 
	
		if (length(arrAddrInfo) > 0) {
	
			if (arrAddrInfo[0] == 0) {
				
				/* 지번주소 조회 Tab */
				// 구주소
				ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "0");
				
				medZipCode.Value = arrAddrInfo[1];
		
				edAddr1.Text = arrAddrInfo[2];
		
				edAddr2.Text = arrAddrInfo[3];
				
				if (arrAddrInfo[11] <> "") {
					
					// 새주소
					ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "1");
					
					medZipCode.Value = arrAddrInfo[10];
					
					edAddr1.Text = arrAddrInfo[11];
					
					edAddr2.Text = arrAddrInfo[12];
					
				}
			 
				ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", arrAddrInfo[9]);		// PNU 코드
				
				ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
					   
				ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrAddrInfo[4]);
				
				ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrAddrInfo[5]);
				
				ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrAddrInfo[6]);
				
				ds_ioExamJubsu.SetColumn(0, "EJRBUILDNM", arrAddrInfo[7]);
				
				ds_ioExamJubsu.SetColumn(0, "EJRADDRETC", arrAddrInfo[8]);
				
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", "1");
					
					ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", "01");
				
				};
				
			} else {
			
				/* 도로명주소 조회 Tab */
				
				ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "1");
			
				medZipCode.Value = arrAddrInfo[10];	// 우편번호
		
				edAddr1.Text = arrAddrInfo[11];		// 도로명주소1
		
				edAddr2.Text = arrAddrInfo[12];		// 도로명주소2
				
				ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrAddrInfo[4]);		// 산여부
				
				ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrAddrInfo[5]);		// 주번지
				
				ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrAddrInfo[6]);		// 부번지
				
				ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", arrAddrInfo[9]);			// PNU 코드
				
				ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", arrAddrInfo[15]);		// 부가주소
		
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", "1");
					
					ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", "01");
				
				};
		
			}
	
        } else {
            edAddr1.SetFocus();
        }
    }
}

// E-Mail
function cbxEmailDomain_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (strText == "직접입력") {
        edEmailDomain.Enable = true;
        edEmailDomain.Value = "";
        edEmailDomain.SetFocus();
    } else {
        edEmailDomain.Value = cbxEmailDomain.Value;
        edEmailDomain.SetFocus();
    }
}

// SMS발송
function btnSendSms_OnClick(obj) {
  
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    if (gfn_IsNull(edHpTel.Text)) {
        gfn_Alert("발송할 휴대폰번호가 존재하지 않습니다.");
        return false;
    }
	
	// gfn_KTSendOneSmsPopup(sMBCCD, sMPK1, sMPK2, sMPK3, sMBSMGNO, sMRECVNM, sMRECVTEL, sMTITLE, sMMSG);
    var arrSms = gfn_KTSendOneSmsPopup("201" // 시험-접수
                    , ds_ioExamJubsu.GetColumn(0, "EOMGNO")
                    , ds_ioExamJubsu.GetColumn(0, "EJMGNO")
                    , ds_ioExamJubsu.GetColumn(0, "JUBSUNO")
                    , ""
                    , edPersonNm.Text
                    , edHpTel.Text
                    , "한국소방안전원"
                    , radCourse.Text +" 시험이 접수되었습니다.\n"+"*"+substr(lbExamInfo2.text,0)+" (30분전까지 입실완료)"+
                      "\n*시험장소:"+ds_ioExamJubsu.GetColumn(0, "EPNM")
                ); // 단일문자메시지발송 팝업

}

// 결제(POS)
function btnSetlmt_OnClick(obj) {

   /* POPUP 호출시 넘어오는 Parameter
    * parameter : sProgramId - POS단위업무프로그램
	*             sSunapGubun - 수납환불구분
	*             sProcAmount - 수납환불처리금액
	*             sPosYear - 환불용 POS년도
	*             sPosMgno - 환불용 POS관리번호
	*             sKey1 - KEY값1
	*             sKey2 - KEY값2
	*             sHpTel - 휴대폰번호
	*             sRepayPayment - 환불용 수납 결제방법
	*             sRepayAmount - 환불금액
	*             sRepayAbsenGubun - 강습결강일차
	*             sPersonNm // 접수자-가상계좌 예금주
	*/
    /////////////////// 선수납 여부 체크함
    if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {
        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 환불이 불가능합니다.\n\n"
              + "     선수납 한 인원은 강습 결제화면에서 환불이 가능합니다.");
        return false; 
    }
    ///////////////////
    if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    
    if ((ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "13"
            || ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "23"
            || ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "15"
            || ds_oSetlmentHist.GetColumn(0, "ESGUBUN") == "25") // 가상계좌이면서
            && (ds_oSetlmentHist.GetColumn(0, "ESSETLMTYN") == "N")) { // 결제여부가 'N'인 경우
        gfn_Alert("가상계좌 결제처리 중 입니다.");
        return false;
    }
	
    var ls_SunapGubun = "";      // 수납환불구분
    var ls_ProcAmount = "";      // 처리금액
    var ls_PosYear = "";         // 환불영수증년도
    var ls_PosMgno = "";         // 환불영수증관리번호
    var ls_RepayAmount = "";     // 환불일경우 환불할 금액
    var ls_RepayAbsenGubun = ""; // 환불일경우 결강일차
    var ls_RepayPayment = "";
    
    var ls_LastSunapGubun = ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN"); // 최종결제내역
    
    //trace("최종결제내역"+ls_LastSunapGubun);    
    
    lfn_searchExamSunapRepayAmount();	// 시험수수료, 수납된금액, 수날할금액 조회
    
    if (gfn_IsNull(ls_LastSunapGubun)) { // 결제내역이 없으면
        
        ls_SunapGubun = "0"; // 수납        
        ls_ProcAmount = ds_oSunapRepayAmount.GetColumn(0, "SUNAPAMOUNT"); // 수납금액

        
    } else if (ls_LastSunapGubun == "N") { // 수납된 자료이면 환불
        
        ls_SunapGubun = "1"; // 환불
        ls_ProcAmount = ds_oSunapRepayAmount.GetColumn(0, "REPAYAMOUNT");
        ls_PosYear = ds_oSetlmentHist.GetColumn(0, "ESPMYEAR"); // 영수증년도
        ls_PosMgno = ds_oSetlmentHist.GetColumn(0, "ESPMMGNO"); // 영수증관리번호
        ls_RepayAmount = ds_oSetlmentHist.GetColumn(0, "ESPROCAMOUNT"); // 환불금액
        ls_RepayPayment = ds_oSetlmentHist.GetColumn(0, "PMPAYMENTFLAG");
        //ls_RepayAbsenGubun = ds_ioTrainingJubsu.GetColumn(0, "ABSENTDAY"); //환불결강일차

		if (radCourse.Value == "10") {	// 특급소방안전관리자인 경우
			if (ls_ProcAmount == 0) {
				gfn_alert("수납된 금액은 "+ ds_oSunapRepayAmount.GetColumn(0, "ESPROCAMOUNT")+"원 입니다.\n\n"+
				          "환불금액이 맞지 않습니다. 시험차수를 올바르게 선택 저장 후 환불결제 하세요!");
				return false; 
			}
			
			// 특급소방안전관리자는 시험일 5일전까지만 전액환불 가능
			var vTerm = -5;	// 5일전
			if (left(GetDate(), 8) > AddDate(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"), vTerm)) {
				gfn_Alert("환불은 시험일("+
					   substr(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"),0,4)+"."+
					   substr(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"),4,2)+"."+
					   substr(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"),6,2)+") "+
					   toNumber(-vTerm) + "일 전("+
					   substr(AddDate(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"), vTerm),0,4)+"."+
					   substr(AddDate(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"), vTerm),4,2)+"."+
					   substr(AddDate(ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE"), vTerm),6,2)+
					   ")까지만 가능합니다.");
				//return false;
			}
			
			
		//	if ((ds_ioExamJubsu.GetColumn(0, "EOEXAMDATE")
		}
		
		
        
    } else if (ls_LastSunapGubun == "Y") { // 환불이면
    
        ls_SunapGubun = "0"; // 수납
        ls_ProcAmount = ds_oSunapRepayAmount.GetColumn(0, "SUNAPAMOUNT");
        
    }
    
    var ls_Key1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO"); // KEY값1
    var ls_Key2 = ds_ioExamJubsu.GetColumn(0, "EOMGNO"); // KEY값2
    var ls_Key3 = ds_ioExamJubsu.GetColumn(0, "JUBSUNO"); // KEY값3
    var ls_Key4 = ""; // KEY값4
    var ls_HpTel = edHpTel.Text; // 휴대폰번호
    var ls_personNm = edPersonNm.Text; // 응시자

    // 통합영수증발급(POS)시스템 팝업을 호출한다. 
    //TRACE(ls_SunapGubun+", "+ ls_ProcAmount+", "+ls_PosYear+", "+ls_PosMgno+", "+ls_Key1+", "+ls_Key2+", "+ls_HpTel+", "+ls_RepayPayment+", "+ls_RepayAmount+", "+ls_RepayAbsenGubun);
    var arrPos = gfn_POSPopup("22", ls_SunapGubun, ls_ProcAmount, ls_PosYear, ls_PosMgno, ls_Key1, ls_Key2, ls_Key3, ls_Key4, ls_HpTel, ls_RepayPayment, ls_RepayAmount, ls_RepayAbsenGubun, ls_personNm);
    //TRACE("POS CLOSE 상태 : "+arrPos);
    
    //if (arrPos == "OK") {
        lfn_SearchExamJubsuList(); // 접수번호로 다시 조회한다.
    //}
    
}

// 개인접수정보
function ds_oJubsuAllInfo_OnRowPosChanged(obj,nOldRow,nRow) {
  if (nRow <> -1) {
        lfn_SearchExamOrderHistList(); // 회차변경이력 조회
  }
}

/*
 * 사진관리 링크
 */
function btnPictureManagement_OnClick(obj) {

	gs_SystemGubun = "training";
    gs_SystemMenuId = "0000000003";
    global.mnuLeft.tabMenu.tabpgMenu.Text = "강습관리";
    var ls_MenuId = "0000000120";
    var ls_MenuTitle = "사진관리";
    var ls_MenuUrl = "training::frmtraining9100MPictureManagement.xml";
    var sArg = "sPersonNm=" + quote(edPersonNm.Text)
        + " sBIRTHDAY=" + quote(medBIRTHDAY.Value);

    global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);
    gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sArg);
}

/*
 * 최근사진반영
 */
function btnApplyPicture_OnClick(obj) {

	if (gfn_IsNull(imgLastestPicture.ImageID)) {
        gfn_Alert("최근사진 등록을 먼저 해주십시오.");
        return false;
	}
	
	imgPicture.ImageID = imgLastestPicture.ImageID;
	imgPicture.Text = "";
	lb_FileUpload = false;
	ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ"));
	ls_IsChangedJubsuInfoYn = "Y";  // 접수자기본정보 변경여부
	
}

/*
 * 사진찾기
 */
function btnLoadPicture_OnClick(obj) {

    fdImage.Type = "OPEN";
    if (fdImage.open()) {
        fiImageFile = fdImage.FilePath + "\\" + fdImage.FileName;
        fiImageFile.Open("rb");
        
        var ln_ImageSize = fiImageFile.GetLength();
        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
        if (ln_ImageSize > 300) {
            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");
            return false;
        }
        
        ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        
        imgPicture.ImageID = fdImage.FilePath + "\\" + fdImage.FileName;
        imgPicture.Text = "";
        lb_FileUpload = true;
        //alert(ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"));
        ls_UploadRealName = left(medBIRTHDAY.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);
        ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1);
        ds_ioExamJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);
        ds_ioExamJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);
        ds_ioExamJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);
    }

}

// 등록사진조회
function btnSearchRegPicture_OnClick(obj) {
  
  if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {
        gfn_Alert("이미지 정보가 없습니다.");
        return;
    }
    var sArg = "sTpMgno=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO"));
    sArg += " sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sBIRTHDAY=" + quote(medBIRTHDAY.Value);
       
    var arrImage = Dialog("training::frmtraining0255PTrainingPersonPicture.xml", sArg, 536, 440, "", -1, -1); // 고객 사진 조회
    
    if (length(arrImage) > 0) {
        if (ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ") <> arrImage[0]) {
            ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", arrImage[0]);
            imgLastestPicture.Text = "";
            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"
                + arrImage[1]
                + "/" + arrImage[2];
        }
    }
}

/*
 * 스캔실행
 */
function btnScanPicture_OnClick(obj) {
	ExecProc(gs_ScanProgramName);
}

/*
 * 스캔사진불러오기
 */
function btnLoadScanPicture_OnClick(obj) {

    imgPicture.ImageID = "";
	imgPicture.Text = "사진";
    var ls_File = split(gs_ScanFileName,"\\");

    fdImage.FilePath = left(gs_ScanFileName, length(gs_ScanFileName) - length(ls_File[length(ls_file) - 1]));
    fdImage.FileName = ls_File[length(ls_file) - 1];

    fiImageFile.FileName = gs_ScanFileName;
    if (fiImageFile.Open()) {
        
        fiImageFile.Open("rb");

        var ln_ImageSize = fiImageFile.GetLength();
        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
        if (ln_ImageSize > 300) {
            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");
            return false;
        }

        ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        fiImageFile.Close();
    } else {
        gfn_Alert("스캔 이미지가 없습니다.");
        return;
    }

    imgPicture.ImageID = gs_ScanFileName;
    imgPicture.Text = "";
    lb_FileUpload = true;

    ls_UploadRealName = left(medBIRTHDAY.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);
    ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1);
    
    ds_ioExamJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);
    ds_ioExamJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);
    ds_ioExamJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);
}

function btnExamCheatingManageLink_OnClick(obj) {

    gs_SystemGubun = "training";
    gs_SystemMenuId = "0000000003";
    global.mnuLeft.tabMenu.tabpgMenu.Text = "강습관리";
    var ls_MenuId = "0000000105";
    var ls_MenuTitle = "부정행위자관리";
    var ls_MenuUrl = "training::frmtraining0420MExamCheatingManagement.xml";
    var sAddArg = "";

    global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);
	gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sAddArg);
}

function edExamYear_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
	//gfn_EnterNextFocus(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam);
    //lfn_SearchExamLatestOrder();
    if (nChar == 13) { // Enter key
       // gfn_EnterNextFocus();
        lfn_NoDateCancel(); // 날짜는 초기화안함

           
	} else {
        
        gfn_FormInit(this);
        ms_ExamMgno = ""; // 시험관리번호
    
        // 시험정보
        lbExamInfo1.Text = "";
        lbExamInfo2.Text = "";    
    
        lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화
        
        // 그리드 초기화
        ds_oJubsuAllInfo.ClearData();
        gdJubsuInfo.NoDataText = "";
        ds_oOrderHist.ClearData();
        gdOrderHist.NoDataText = "";
        ds_oSetlmentHist.ClearData();
        gdSetlmentHist.NoDataText = "";
        btnSetlmt.Enable = false; // 결제(POS) 버튼
        btnProcRct.Enable = false;
        btnShowVirtualAccount.Enable = false;	
        btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;
        btnPrintReRctPDF.Enable = false;
        
        edPersonNm.Readonly = false;
        medBIRTHDAY.Readonly = false;
        
        Button0.Enable = false;
        btnSearchPersonInfo.Enable = true;
        
        //btnPosReport.Enable = false;    //통합영수증조회 버튼
        
        lfn_SetChangedJubsuInfo(true);    
     
    }
	
    
}

function lfn_PrintScreen(obj)
{
	
}

function lfn_End(obj)
{
	
}

/*
 * 기능 : 회차변경된 정보 상태변경한다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetChangedJubsuInfo(bStatus) {
    if (bStatus) {
        shpGubunBox3.BkColor = "";
    } else {
        shpGubunBox3.BkColor = "user18";
    }

    if (bStatus && ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        btnSave.Enable = true;
        btnDelete.Enable = true;
    } else {
        btnSave.Enable = false;
        btnDelete.Enable = false;
    }

    btnApplyPicture.Enable = bStatus; // 사진반영
    // btnCancel.Enable = bStatus; // 초기화
    // btnEnd.Enable = bStatus; // 종료
    // btnSearchPersonInfo.Enable = bStatus; // 기본정보
    btnSearchZipCode.Enable = bStatus; // 우편번호
    btnAuthBIRTHDAY.Enable = bStatus; // 실명인증
    // btnAbsentManageLink.Enable = bStatus; // 결강관리
    btnExamJubsuModify.Enable = bStatus; // 회차변경
    // btnSeqList.Enable = bStatus; // 접수목록
    // btnSearchTrainingOrder.Enable = bStatus; // 접수가능회차
    // btnTraingJubsuHist.Enable = bStatus; // 접수이력
    // btnSeatList.Enable = bStatus; // 좌석목록
    // btnSmsStat.Enable = bStatus; // SMS현황
    // btnEmailStat.Enable = bStatus; // 이메일현황
    btnSearchRegPicture.Enable = bStatus; // 등록사진조회
    // btnBarCodeSearch.Enable = bStatus; // 바코드조회
    // btnUnUseJubsuNo.Enable = bStatus; // 빈좌석
    btnLoadPicture.Enable = bStatus; // 사진찾기
    btnLoadScanPicture.Enable = bStatus; // 스캔사진불러오기
    btnScanPicture.Enable = bStatus; // 사진스캔
    // btnPictureManagement.Enable = bStatus; // 사진관리
    //btnShowVirtualAccount.Enable = bStatus; // 가상계좌보기
    // btnModifyHistory.Enable = bStatus; // 변경이력
    //btnChangeProcDate.Enable = bStatus; // 처리일자변경
    //btnProcRct.Enable = bStatus; // 현금영수증처리
    //btnPrintReRct.Enable = bStatus; // 영수증재발행
    // btnSendSms.Enable = bStatus; // SMS 전송
    // btnSendEmail.Enable = bStatus; // 이메일 전송
    //btnPosResultList.Enable = bStatus; // POS처리결과조회
    btnScan.Enable = bStatus; // 민원서류 스캔
    btnScanSearch.Enable = bStatus; // 민원서류 스캔 불러오기
    
    
    // 콜센터 직원 사용 이면
	if (gs_IsCallCenter == "Y") {
		btnSetlmt.Enable = false; // 결제(POS) 버튼
	    btnScanSave.Enable = false; // 민원서류 저장 버튼
	} else {
		btnSetlmt.Enable = bStatus; // 결제(POS) 버튼
	    btnScanSave.Enable = bStatus; // 민원서류 저장 버튼
	}
    //btnPrintJubsu.Enable = bStatus; // 수강증출력 버튼
    btnPrint.Enable = bStatus; // 강습원서출력 버튼
    //btnPrintJubsuResult.Enable = bStatus; // 강습접수결과출력 버튼

    // cbxJibu.Enable = bStatus;
    // edTrainingYear.Enable = bStatus;
    // radCourse.Enable = bStatus;
    // edTrainingOrder.Enable = bStatus;
    // edJubsuNo.Enable = bStatus;
    // edSeatNo.Enable = bStatus;
    // edPersonNm.Enable = bStatus;
    // medBIRTHDAY.Enable = bStatus;
    // medBarCode.Enable = bStatus;

    //edCompNm.Enable = bStatus;
    edAddr1.Enable = bStatus;
    edAddr2.Enable = bStatus;
    edTel.Enable = bStatus;
    edHpTel.Enable = bStatus;
    edEmail.Enable = bStatus;
    edEmailDomain.Enable = bStatus;
    cbxEmailDomain.Enable = bStatus;
    //edRemark.Enable = false;
    //cbxRemarkGubun.Enable = bStatus;

   // btnPosReport.Enable = bStatus;//통합영수증조회 버튼

}

function btnSmsStat_OnClick(obj)
{
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        return false;
    }
    
    var sArg = "sEjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
	Dialog("training::frmtraining0426PExamSmsSendList.xml", sArg, 600, 400, "", -1, -1);
}

function btnSendEmail_OnClick(obj)
{
	if (ds_ioExamJubsu.GetColumn(0, "LASTSUNAPGUBUN") != "N") {
        gfn_Alert("수납 완료된 접수자에게만 메일을 발송할 수 있습니다.");
        return false;
    }
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    if (gfn_IsNull(edEmail.Text)) {
        gfn_Alert("발송할 이메일이 존재하지 않습니다.");
        return false;
    }
    
    var sArg = "sMgNo=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
    sArg += " sGubun=" + quote("E");

    Dialog("COM::frmCOM1300MOneMAILSend.xml", sArg, 504, 130, "", -1, -1);	// 단일메일발송 팝업
}

function btnEmailStat_OnClick(obj)
{
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    
    var sArg = "sMgNo=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
    sArg += " sGubun=" + quote("E");
	
    Dialog("COM::frmCOM1400POneMAILSendList.xml", sArg, 600, 400, "", -1, -1);	// MAIL발송현황팝업
}

function btnChangeProcDate_OnClick(obj)
{
    //////////////
     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {
        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 처리일자변경이 불가합니다.\n\n"
              + "     선수납 한 인원은 강습 결제화면에서 처리일자변경이 가능합니다.");
        return false; 
     }

    //////////////
	if (ds_oSetlmentHist.currow < 0) {
        gfn_Alert("결제 내역을 선택해 주십시오.");
        return false;
    }

	//////////////////////////////////
	//// 처리일자 변경시 결제 시스템에 내용이 있는지 먼저 확인함 
	
	ds_ioYearbizlink.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("com:searchYearbizlink", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_ioYearbizlink=ds_oYearbizlink" // outDs
        , "ESEJMGNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESEJMGNO")) // args
            + " ESSEQ=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESSEQ")) // args
        , ""
        ,false
        ,""
        ,true
    );
	
	
	if (ds_ioYearbizlink.count > 0) {
        alert("      < 수수료관리번호 및 수납일자 변경 불가 >\n\n"
                  
             + "해당 자료는 회계시스템에서 시스템연동을 통해 결의서를 \n"
             + "생성하였습니다. 생성정보는 아래와 같습니다.\n\n\n"
             
             + "                - 결의서 번호 : " + ds_ioYearbizlink.GetColumn(0, "KEYNO") + "\n\n"
             + "                - 성          명 : " + ds_ioYearbizlink.GetColumn(0, "YBLNM") + "\n\n" 
             + "                - 금          액 : " +  ds_ioYearbizlink.GetColumn(0, "YBLAMT") + "원" + "\n\n"
             + "                - 처 리  일 자 : " + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 0, 4) + "-" + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 4, 2) + "-" + mid(ds_ioYearbizlink.GetColumn(0, "YBLPROCDATE") , 6, 2));
         return false;   
	}
	///////////////////////////////////	
	


    var sArg = "sEjmgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESEJMGNO"));
    sArg += " sSetlmtSeq=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESSEQ"));
    sArg += " sProcDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPROCDATE"));
    sArg += " sPonyDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPONYDATE"));
    sArg += " sPonyDateCheck=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPONYGUBUN"));
    sArg += " sPmYear=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR"));
    sArg += " sPmMgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO"));
    sArg += " sEsgubun=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESGUBUN"));

	var ls_RetProc = Dialog("training::frmtraining0406PExamJubsuProcessDateChange.xml", sArg, 572, 184, "", -1, -1);

	if (ls_RetProc == "OK") {
        lfn_SearchExamSetlmentHistList(); // 결제내역 조회
	}
}

//영수증재발급
function btnPrintReRct_OnClick(obj)
{
	if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {
        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 영수증재발행이 불가능합니다.\n\n"
              + "     선수납 한 인원은 강습 결제화면에서 영수증재발행 가능합니다.");
        return false; 
     }
	
	if (!gfn_Confirm("정말로 영수증을 재발행 하시겠습니까?")) {
        return false;
	}

    gfn_PrintReceipt(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR")
        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO")); // 영수증을 출력한다.
}

//영수증PDF
function btnPrintReRctPDF_OnClick(obj)
{
	if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {
        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 영수증재발행이 불가능합니다.\n\n"
              + "     선수납 한 인원은 강습 결제화면에서 영수증재발행 가능합니다.");
        return false; 
     }
	
	if (!gfn_Confirm("정말로 영수증을 재발행 하시겠습니까?")) {
        return false;
	}

    gfn_PrintReceiptPDF(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR")
        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO")); // 영수증을 출력한다.
}

//가상계좌보기
function btnShowVirtualAccount_OnClick(obj)
{

     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {
        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 가상계좌 조회가 불가능합니다.\n\n"
              + "     선수납 한 인원은 강습 결제화면에서 가상계좌 조회가 가능합니다.");
        return false; 
     }	
	
	if (!(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESGUBUN") = "13"||
	      ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESGUBUN") = "15"||
	      ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESGUBUN") = "23"||
	      ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESGUBUN") = "25")) { // 납입방법
	//if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG") <> "3") { // 납입방법
        gfn_Alert("선택하신 결제는 가상계좌결제가 아닙니다.");
        return false;
    }

    // POS 결과 정보를 조회한다.
	gfn_SearchPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR")
        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO")
        , ds_oPosResult);

    var sArg = ""; // 팝업파라메터
    sArg = "sVirtCloseDate=" + quote(ds_oPosResult.GetColumn(0, "VIRTCLOSEDATE")); // 가상계좌유효기간
    sArg += " sVirtStat=" + quote(ds_oPosResult.GetColumn(0, "VIRTRESULT")); // 입금여부(R-계좌 할당,I-입금,C-취소)
    sArg += " sVirtAccountNo=" + quote(ds_oPosResult.GetColumn(0, "VIRTACCOUNT")); // 계좌번호
    sArg += " sVirtBankCd=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKCD")); // 은행코드
    sArg += " sVirtBankNm=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKNM")); // 은행명칭
    sArg += " sVirtInputAmount=" + quote(ds_oPosResult.GetColumn(0, "VIRTINPUTAMT")); // 입금액
    sArg += " sVirtBankDate=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKDATE")); // 입금/취소일자
    sArg += " sGubun=" + quote("22"); // 업무구분 : 21 강습 22 시험
    sArg += " sTpmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO")); // 응시자 관리번호
    sArg += " sEjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // 접수관리번호
    sArg += " sPMPIID=" + quote(ds_oPosResult.GetColumn(0, "PMPIID")); // 상점아이디
    sArg += " sPCTRANSACTION=" + quote(ds_oPosResult.GetColumn(0, "PCTRANSACTION")); // 거래번호
    sArg += " sPMORGGUBUN=" + quote(ds_oPosResult.GetColumn(0, "PMORGGUBUN")); // 가상계좌 발급기관구분

	var arrVirtGubun = Dialog("COM::frmCOM3401PVirtualAccountPOSResult.xml", sArg, 400, 224, "", -1, -1);
	
	if (arrVirtGubun[0] == "1") {  //가상계좌를 삭제 했다면
        lfn_Search(); // 다시 조회 함
    }    
}

function ds_oSetlmentHist_OnRowPosChanged(obj,nOldRow,nRow)
{
	if (ds_ioExamJubsu.GetColumn(0, "LASTYN") == "Y") { // 회차변경여부
        var ls_PaymentGubun = obj.GetColumn(nRow, "PMPAYMENTFLAG"); // 납입방법
        var ls_SunapGubun = obj.GetColumn(nRow, "ESGUBUNCD"); // 수납구분
        var ln_RepayRefNo = obj.GetColumn(nRow, "ESREPAYREF"); // 수납구분
        
        if (ls_PaymentGubun == "0") { // 현금
            btnProcRct.Text = "현금영수증처리";
            
            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
				// 콜센터 직원 사용 이면
				if (gs_IsCallCenter == "Y") {
					btnProcRct.Enable = false;
				} else {
					btnProcRct.Enable = true;
				}
            } else {
                btnProcRct.Enable = false;
            }
                        
            btnShowVirtualAccount.Enable = false;
        } else if (ls_PaymentGubun == "1") { // 카드
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
        } else if (ls_PaymentGubun == "2") { // 현금영수증
            btnProcRct.Text = "현금영수증취소";
            
            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
				// 콜센터 직원 사용 이면
				if (gs_IsCallCenter == "Y") {
					btnProcRct.Enable = false;
				} else {
					btnProcRct.Enable = true;
				}
            } else {
                btnProcRct.Enable = false;
            }       

			// 가상계좌이면
			if (obj.GetColumn(nRow, "ESGUBUN") == "15" || obj.GetColumn(nRow, "ESGUBUN") == "25") {
				btnShowVirtualAccount.Enable = true;
			} else {
				btnShowVirtualAccount.Enable = false;
			}

        } else if (ls_PaymentGubun == "3" || obj.GetColumn(nRow, "ESGUBUN") == "15" || obj.GetColumn(nRow, "ESGUBUN") == "25") { // 가상계좌
            
            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
				// 콜센터 직원 사용 이면
				if (gs_IsCallCenter == "Y") {
					btnProcRct.Enable = false;
				} else {
					btnProcRct.Enable = true;
					btnProcRct.Text = "현금영수증처리";
				}
            } else {
                btnProcRct.Enable = false;
            }
            
            btnShowVirtualAccount.Enable = true;
        } else {
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
        }
        
		// 콜센터 직원 사용 이면
		if (gs_IsCallCenter == "Y") {
			btnChangeProcDate.Enable = false;
			btnPrintReRct.Enable = false;
		} else {
			btnChangeProcDate.Enable = true;
			btnPrintReRct.Enable = true;
		}
        btnPrintReRctPDF.Enable = true;
    }else{
    
		btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;
        btnPrintReRctPDF.Enable = false;
        btnShowVirtualAccount.Enable = false;
        btnProcRct.Enable = false;
    }
    
}

function radJibuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "S") { // 소속지부
	
		if (ds_oJibu.FindRow("CD", gds_oUserInfo.GetColumn(0, "PDEPTCD")) <> -1) {
            cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");
        }        
	}
	
	changeJibuRadio(strCode, true);
}


function changeJibuRadio(strCode, isSearch)
{
	if(strCode == "S")
	{
		cbxJibu.Enable = false;
        radJibuGubun.BkColor = "";
		
		if(isSearch)
		{
			lfn_SearchExamLatestOrder();
		}
		
	}else{
		
		cbxJibu.Enable = true;
        radJibuGubun.BkColor = "red";	
	}
}


function lfn_initJibu()
{
	cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");
	cbxJibu.Enable = false;
}
function btnProcRct_OnClick(obj)
{
     if (ds_ioExamJubsu.GetColumn(0, "EJEXAMAMTTJMGNO") > 0 ) {
        alert("시험비를 선수납한 인원입니다. 현재 화면에서는 현금영수증처리/취소가 불가능합니다.\n\n"
              + "     선수납 한 인원은 강습 결제화면에서 현금영수증처리/취소가 가능합니다.");
        return false; 
     }

	
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    // if (!gfn_Confirm(btnProcRct.Text + "하시겠습니까?")) {
        // return false;
	// }
    if (left(GetDate(), 8) >= left(AddDate(ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"), 365), 8)) {
        gfn_Alert("교육시작일로부터 1년이 지났습니다.");
        return false;
    }
    if (ds_ioExamJubsu.GetColumn(0, "EJHSTATUSCD") == '5' // 5:환불신청(미입금)
            || ds_ioExamJubsu.GetColumn(0, "EJHSTATUSCD") == '6') { // 6:환불접수(신청확인)
        gfn_Alert("인터넷 환불 처리 중입니다.");
        return false;
    }

	if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PVINFO") == "발행"){
        gfn_Alert("부가세가 발행된 결제입니다.");
        return false;
	}

    var ls_Key1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO"); // KEY값1-접수관리번호
    var ls_Key2 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESSEQ"); // KEY값2-결제순차번호
    var ls_RepayPosYear = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMYEAR"); // POS년도
    var ls_RepayPosMgno = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "ESPMMGNO"); // POS관리번호
    var ls_RepayPayment = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG"); // 결과출력용 납입방법(0,1,2,3)
    

    // 통합영수증발급(POS)시스템 현금영수증처리 팝업을 호출한다.
    var arrPos = gfn_TrainingCashChangePOSPopup("22", ls_Key1, ls_Key2, ls_RepayPosYear, ls_RepayPosMgno, ls_RepayPayment);

    if (arrPos[0] <> "END") {
        lfn_SearchExamJubsuList(); // 접수번호로 다시 조회한다.
    }
}

function btnJubsuHistory_OnClick(obj)
{
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        return false;
    }

    var sArg = "sEjmgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
    Dialog("training::frmtraining0428PExamJubsuHistory.xml", sArg, 600, 400, "", -1, -1);
}

function radChangeTpmgno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "C") {
        if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
            gfn_Alert("접수 정보가 없습니다.");
            radChangeTpmgno.Value = "S";
            return false;
        } else {
            gfn_Alert("이 기능은 동일 인물에 대한 오타에 의한 성명/주민번호 변경용입니다.\n따라서, 해당 강습자와 관련된 모든 정보가 일괄 변경되므로, 신중히 변경하시기 바랍니다.");
        }
	}
}

function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면
        if (nChar == 13) {
            btnAuthBIRTHDAY.SetFocus();
            //lfn_SearchPersonNm();
            lfn_SearchPersonInfo();  //Person
        } else {
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "TPMGNO"))) {
                lfn_ResetPerson();
                medBIRTHDAY.Value = "";
            }
        }
    }
}

function lfn_ResetPerson() {
    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부

    lfn_SetChangedJubsuInfo(true);
    ds_ioExamJubsu.SetColumn(0, "EJMGNO", ""); // 접수관리번호
    ms_TrainingPersonMgno = "";
    ds_ioExamJubsu.SetColumn(0, "TPMGNO", "");
    medZipCode.Value = "";
    edAddr1.Text = "";
    edAddr2.Text = "";
    edTel.Text = "";
    edHpTel.Text = "";
    edEmail.text = "";
    edEmailDomain.Value = "";
    ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", "");

    //실명인증 버튼
    btnAuthBIRTHDAY.Text = "실명인증";
    btnAuthBIRTHDAY.Enable = true;
    ds_ioExamJubsu.SetColumn(0, "AUTHYN", "");

    // 최근사진
    imgLastestPicture.Text = "최근사진";
    imgLastestPicture.ImageID = "";

    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;    
    btnChangeProcDate.Enable = false;
    btnPrintReRct.Enable = false;
    btnPrintReRctPDF.Enable = false;
}

/*
// 최차변경이력을 선택했을시 상단에 상세 내용을 보여줌 20091015
*/

function gdOrderHist_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
   //alert("회차변경이력" + ds_oOrderHist.currow + nRow);	
	if(ds_oOrderHist.rowcount > 0)
	{
		var cnt = nRow; // 선택 row 값			
		var edJubsuNo_Num; // 접수번호 담는 변수
		
		serch_falg = "1";
		   
			cbxJibu.value = ds_oOrderHist.GetColumn(cnt, "BEFORJIBU");    // 지부
			edExamYear.Text = ds_oOrderHist.GetColumn(cnt, "BEFOREOYEAR");  // 년도
			radCourse.Value = ds_oOrderHist.GetColumn(cnt, "BEFOREOTCCOURSECD");  // 직능
			edExamOrder.Text = ds_oOrderHist.GetColumn(cnt, "BEFORORDER"); // 회차 정보
			edJubsuNo.text  = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호
			edJubsuNo_Num = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호 담음
			edSeatNo.Text = ds_oOrderHist.GetColumn(cnt, "EOHEXAMSEATNO"); // 좌석번호
		
		if(ds_oOrderHist.GetColumn(cnt, "BEFORJIBU") != gds_oUserInfo.GetColumn(0, "PDEPTCD"))
			{
				changeJibuRadio("T", false);	
				radJibuGubun.Value = "T";
			}else{
				
				changeJibuRadio("S", false);
				radJibuGubun.Value = "S";
			}
		
		//alert("회차관리번호 조회함");
		
		lfn_SearchExamOrderMgno();  // 시험 회차관리번호를 조회한다.	
		edJubsuNo.text  = edJubsuNo_Num; // 접수번호	
		lfn_SearchExamJubsuList();  // 시험접수 내용을 조회한다.
		
	}else{
		serch_falg = "0";
	}
}

function gdJubsuInfo_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    serch_falg = "1";  // 조회 플래그만 변경
    
    /*
    if(ds_oJubsuAllInfo.count == "1") {
        gdOrderHist_OnCellClick(0,0,0,0,0);
    }
    */
    
    if(ds_oJubsuAllInfo.currow == nRow) {
       
       ds_oJubsuAllInfo_OnRowPosChanged(); // ds 변경 함수를 호출함 (같은 row선택시)
    }
    
}

function Edit0_OnChanged(obj,strText)
{
	Edit0.Text = "";
}

function btnSearchPersonInfoChange_OnClick(obj)
{   

    if (gfn_IsNull(medBIRTHDAY.Value)) {
        //old gfn_Alert("주민번호가 비어있습니다.\n'기본정보조회' 후에 사용하여 주시기 바랍니다.");
        gfn_Alert("변경할 정보가 없습니다.\n'접수조회' 후에 사용하여 주시기 바랍니다.");
        return;
    }
    
    if (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO")) // 접수된 자료이면서
                && (left(GetDAte(), 8) > ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"))
            ) {
        gfn_Alert("시험일이 지나서 변경하실 수 없습니다.");
		// 시스템관리자만 변경 허용
		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {
			return false;
		}
    }

    //////////////////////
    ds_ioT_E_L_JubsuCheck.ClearData();
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchT_E_L_JubsuCheck", false);
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioT_E_L_JubsuCheck=ds_oT_E_L_JubsuCheck"	// outDs
        ,"TPMGNO_A=" + quote(ds_ioExamJubsu.GetColumn(0, "TPMGNO")) // args
        ,"lfn_AfterAllJubsuSearch"
        ,false
        ,""
        ,true
    );
    
    //   COM::frmCOM1010PTrainingPersonModify.xml
    var retArr = gfn_TrainingPersonModifyPopup(ds_ioExamJubsu.GetColumn(0, "TPMGNO"), ds_ioT_E_L_JubsuCheck.GetRowCount(), "E", ds_ioExamJubsu.GetColumn(0, "EJMGNO"));  //팝업 호출

                  
    if(retArr[3] == "Y") {
        btnAuthBIRTHDAY.Text  = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
    } else {
        btnAuthBIRTHDAY.Text  = "실명인증";
        btnAuthBIRTHDAY.Enable = true;
    }
    
    if(gfn_isNull(retArr[0]) and gfn_isNull(retArr[1]) and gfn_isNull(retArr[2])){
    
    } else {
        if (edPersonNm.Text != retArr[0]
            || medBIRTHDAY.Value != retArr[1]
            || ds_ioExamJubsu.GetColumn(0, "TPMGNO") != retArr[2] ) {  // 기존값과 조회 변경한 값이 다를 경우 update 수행 
        
				   //////////////////////// return 되는 강습자관리번호로 해당 직능 및 회차에 동일인 접수 내역있는지 확인
		//trace(retArr[2]+"/"+retArr[1]+"/"+retArr[0]+"/"+retArr[4]+"|"); 
						lfn_searchJubsuListReturnTpmgno(retArr[2], retArr[1], retArr[0], retArr[4]);     // return 강습자관리번호로 접수내역 확인  
						
						/*****
						if (ds_ioExam_ReturnTpmgnoJubsuCheck.count > 0) {
							alert("변경예정대상자는 이미 해당 직능 회차에 접수가 되어 있습니다. 확인 바랍니다. \n\n"
								+ "         직          능 :   " + radCourse.Text + "\n" 
								+ "         회          차 :   " + edExamOrder.Text + "\n" 
								+ "         이          름 :   " + retArr[0] + "\n" 
								+ "         접수 번호는 :   " + ds_ioExam_ReturnTpmgnoJubsuCheck.Getcolumn(0, "EOHJUBSUNO") + " 입니다. \n" );
							return false;
						}**********/
					 
					 /////////////////////////// 개인정보 변경 후 수료 여부 확인
					 ///////////////////////// 강습접수에 수료한거 중에 해당 직능이 있는지 조회하여 메시지 보여줌
						ds_ioTrainingJubsuMatching.ClearData(); // 데이타셋 초기화
				
						tit_clearActionInfo();
						tit_addSearchActionInfo("training:searchTrainingJubsuMatching", false);  //Personinfo 반영 2017.12.07
						// 서버 호출 
						tit_callService(
							""
							,""
							,""	// inDs
							,"ds_ioTrainingJubsuMatching=ds_oTrainingJubsuMatching"	// outDs
							,"TPNM=" + quote(edPersonNm.Text)		// 성명            
							+ " PERSONKEY=" + quote(retArr[4])     //Personinfo 반영 2017.12.07
							+ " TOTCCOURSECD=" + quote(radCourse.Value)  // 직능
							//+ " TPBIRTHDAY=" + quote(medBIRTHDAY.Value)
							+ " EXAMDATE=" + quote(ds_oExamOrderMgno.GetColumn(0, "EOEXAMDATE"))// args
							,"lfn_AfterSearchTrainingPerson"
							,false
							,""
							,true
						);
						////////////////////////     접수자 변경시 수료여부 체크하여 접수를 변경할지 판단 
               lfn_SearchExamJubsuList();  //REFRESH...						
        }  //if (edPersonNm.Text != retArr[0]
    }    //if(gfn_isNull(retArr[0]    
    
    

}


function lfn_searchJubsuListReturnTpmgno(sTpmgNo, sTPBIRTHDAY, sTNM, sPersonkey) {
/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기 return 강습자관리번호로 check
    var TPMGNO_A = sTpmgNo;
    var TPBIRTHDAY_A = sTPBIRTHDAY;
    var TNM_A = sTNM;
    ds_ioExam_ReturnTpmgnoJubsuCheck.ClearData();
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchExam_ReturnTpmgnoJubsuCheck", false);  //sPersonkey
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioExam_ReturnTpmgnoJubsuCheck=ds_oExam_ReturnTpmgnoJubsuCheck"	// outDs
        , "TOMGGTMGNO_A=" + quote(cbxJibu.Value)  // 지부
        + " TOYEAR_A=" + quote(edExamYear.Text) // 년도
        + " TOTCCOURSECD_A=" + quote(radCourse.Value) // 직능
        + " TOTRAININGORDER_A=" + quote(edExamOrder.Text) // 회차 
        + " PERSONKEY=" + quote(sPersonkey)
        + " TPNM_A=" + quote(TNM_A)  
       // + " TPMGNO_A=" + quote(TPMGNO_A) // 강습자관리관번호              
        // args
        ,""
        ,false
        ,""
        ,true
    );  
}
  
/* 사용자 함수 */
/*
 * 기능 : 접수내역 update 후 처리
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchChane(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
   
    lfn_Search(); 
    gfn_SaveMessage(); // 저장 메세지를 처리한다.
	
}

function lfn_AfterAllJubsuSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    	
}
/*
* 결재 그리드 배경색을 기본으로 하고 선택한 ROW에 배경색을 지정(셀의 색상속성을 지정위함)
*/
function fn_bkcolor(currow)
{
    if(ds_oSetlmentHist.row == currow)
     {
        return "#DFCF91";
      }else
      {
        return "default";
      }
}


function lfn_ComponentOnKillFocus(obj)
{
    lfn_NoDateCancel(); //날짜는 초기화 안함
                  
    if (edExamYear.Text == left(GetDate(), 4)) {
            lfn_SearchExamLatestOrder(); // 최근 접수가능회차 조회     
        }
        
     //   edExamOrder.SetFocus(); 
}


// 통합영수증조회 팝업
function btnPosReport_OnClick(obj)
{
    var sArg = "sProgramId=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD"));
    var retDlg = Dialog("posetc::frmposetc0020PPosReport.xml", sArg, 480, 320, "", -1, -1);	
}


// 응시자격구분 변경시
function radJubsuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "20") {          // 강습수료자
        cbxCourse.Enable = true;
        if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "") {
			cbxCourse.index = 0;
		} else {
			cbxCourse.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
		}
        cbxCourse.SetFocus();
        lbReason.Visible = false;
        edReason.Visible = false;
	} else if(strCode == "00" || strCode == "01" || strCode == "02"){  // 경력자 or 학력자 or 학·경력자
        cbxCourse.Enable = false;
        cbxCourse.index = 0;
        if (radRejubsuYN.Value == "Y") { 	// 재시험이면 학·경력 인정사유입력 안함
			lbReason.Visible = false;
			edReason.Visible = false;
		} else {						// 재시험이 아니면 학·경력 인정사유입력
			lbReason.Visible = true;
			edReason.Visible = true;
		}
	}
}

// 응시자격구분 변경시
function radJubsuGubun2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "10") {          // 강습수료자
        cbxCourse.Enable = true;
        if (ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN") == "") {
			cbxCourse.index = 0;
		} else {
			cbxCourse.Value = ds_ioExamJubsu.GetColumn(0, "EJJUBSUGUBUN");
		}
        cbxCourse.SetFocus();
        lbReason.Visible = false;
        edReason.Visible = false;
        
		cbxGaJubsuGubun.Enable = false;
		cbxGaJubsuGubun.index = 0;
		
	} else if(strCode == "00" || strCode == "03"){  // 경력자 or 가접수자
        cbxCourse.Enable = false;
        cbxCourse.index = 0;
        if (radRejubsuYN.Value == "Y") { 	// 재시험이면 학·경력 인정사유입력 안함
			lbReason.Visible = false;
			edReason.Visible = false;
		} else {						// 재시험이 아니면 학·경력 인정사유입력
			lbReason.Visible = true;
			edReason.Visible = true;
		}

		if (strCode == "00") {	// 경력자이면
			cbxGaJubsuGubun.Enable = false;
			cbxGaJubsuGubun.index = 0;
		
		} else if (strCode == "03") {	// 가접수신청자이면 
			cbxGaJubsuGubun.Enable = true;
			if (ds_ioExamJubsu.GetColumn(0, "GAJUBSUGUBUN") == "") {
				cbxGaJubsuGubun.index = 0;
			} else {
				cbxGaJubsuGubun.Value = ds_ioExamJubsu.GetColumn(0, "GAJUBSUGUBUN");
			}
		}

	}
}

//재시험여부 변경시
function radRejubsuYN_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "Y") {          // 재시험이면
		lbReason.Visible = false;
		edReason.Visible = false;	
	} else {					// 재시험이 아니면
		if (radJubsuGubun.Visible == true) {
			if (radJubsuGubun.Value < "20") { // 경력자 or 학력자 or 학·경력자
				lbReason.Visible = true;
				edReason.Visible = true;
			} else {
				lbReason.Visible = false;
				edReason.Visible = false;
			}
		}
		if (radJubsuGubun2.Visible == true) {
			if (radJubsuGubun2.Value < "10") { // 경력자 or 가접수자
				lbReason.Visible = true;
				edReason.Visible = true;
			} else {
				lbReason.Visible = false;
				edReason.Visible = false;
			}
		}
	}
	
	
}

// 시험수수료, 수납된금액, 수날할금액 조회
function lfn_searchExamSunapRepayAmount(obj) {
    var sArg = "EJMGNO=" + quote(ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // 관리번호
    
    if (radCourse.Value == "10") {
        sArg += " EFCEXAMGUBUN=" + quote(radChasuGubun.Value); // 차수구분
    } else {
		sArg += " EFCEXAMGUBUN='0'";
    }

    tit_clearActionInfo();
    tit_addSearchActionInfo("com:searchExamSunapRepayAmount", false);  //이번에 추가함 선수납인지 확인
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oSunapRepayAmount=ds_oSunapRepayAmount"    // outDs
        ,sArg    // args
        ,""
        ,false
        ,false
        ,true
    );
}



/* 부정행위 여부 조회
*/


function lfn_ExamCheatSearch(){
       
        
        ///////////////////////// 강습접수에 수료한거 중에 해당 직능이 있는지 조회하여 메시지 보여줌
        ds_oExamCheat.ClearData(); // 데이타셋 초기화

        tit_clearActionInfo();
        tit_addSearchActionInfo("training:searchExamCheat", false);  //personkey..
//        alert("TPNM=" + quote(edPersonNm.Text)		// 성명
//            + " TOTCCOURSECD=" + quote(radCourse.Value)  // 직능
//            + " TPBIRTHDAY=" + quote(replace(medBIRTHDAY.Text,"-","")));        
        // 서버 호출 
        tit_callService(
            ""
            ,""
            ,""	// inDs
            ,"ds_oExamCheat=ds_oExamCheat"	// outDs
            ,"TPNM=" + quote(edPersonNm.Text)		// 성명
            + " TOTCCOURSECD=" + quote(radCourse.Value)  // 직능
            + " PERSONKEY=" + quote(medPersonKey.Value)  ////personkey 2017.12.11
           // + " TPBIRTHDAY=" + quote(medBIRTHDAY.Value)
            + " PRINTGUBUN='2YEAR'" // args
            ,""
            ,false
            ,""
            ,true
            
        );
        ////////////////////////     
}
function btnExamOmrImage_OnClick(obj)
{

	ds_oExamOmrFile.ClearData();
	var row = "";
	
	// if("X" == edPassYn.Text || "" == edPassYn.Text) {
		// gfn_Alert("시험답안이 없습니다.");
	// } else {
		tit_clearActionInfo();
		
		row = ds_oExamOmrFile.AddRow();		
		ds_oExamOmrFile.SetColumn(row, "AFEJMGNO", ds_ioExamJubsu.GetColumn(0, "EJMGNO"));
		
		tit_addSearchActionInfo("training:searchViewOmrFile", false);
		
		// 서버 호출 

		tit_callService(

				 ""

			   , ""  

			   , ""   

			   , "ds_oExamOmrFile=ds_oVOmrFile" //outDs

			   , "AFEJMGNO=" + ds_oExamOmrFile.GetColumn(0, "AFEJMGNO") // args

			   , ""  //callBack

			   , false

			   , false

			   , true

		);
		
		var sArg = gfn_OmrViewPopup(
			ds_oExamOmrFile.GetColumn(0, "AFPATH")
			, ds_oExamOmrFile.GetColumn(0, "AFFILENM")
			, ds_oExamOmrFile.GetColumn(0, "AFFILENM")
			, "OMR"
		);
		
		trace(sArg);
	//}
}


// 특급 1차시험 면제 여부
function lfn_searchExam1ChasuMunje(vTPMGNO, vExamdate)
{
	if(vTPMGNO == "" || vTPMGNO = NULL)
	{
		return false;
	}
	
	ds_oMunje.ClearData();
	
	tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchExam1ChasuMunje", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oMunje=ds_oMunje"    // outDs
        ,"TPMGNO=" + quote(vTPMGNO)
         + " EXAMDATE=" + quote(vExamdate)
        ,""
        ,false
        ,false
        ,true
    );
}

// 서류스캔 실행
function btnScan_OnClick(obj)
{
	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	} else {
	
		ExecProc(gs_FormScanProgram);
		
	}
}

// 서류스캔파일 불러오기
function btnScanSearch_OnClick(obj)
{

	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	}

    var ls_File = split(gs_FormScanFile,"\\");



    fdImage2.FilePath = left(gs_FormScanFile, length(gs_FormScanFile) - length(ls_File[length(ls_file) - 1]));

    fdImage2.FileName = ls_File[length(ls_file) - 1];



    fiImageFile2.FileName = gs_FormScanFile;

    if (fiImageFile2.Open()) {

        fiImageFile2.Open("rb");



        var ln_ImageSize = fiImageFile2.GetLength();

        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경

        if (ln_ImageSize > 300) {

            gfn_Alert("서류 스캔파일 사이즈가 300KB를 넘겼습니다.\n 사이즈 : " + NumFormat(ln_ImageSize) + "KB");

            return false;

        }

        fiImageFile2.Close();

    } else {

        gfn_Alert("서류스캔 이미지가 없습니다.");

        return;

    }



    edScanFileName.Text = fdImage2.FileName;


    lb_FormFileUpload = true;	// 서류스캔파일 등록 여부


	// 파일명 형식 : 년월일시분초+ 랜덤(3자리)
    ls_UploadFormName = GetDate() + Random(100,999) + gfn_GetFileExtensionName(fdImage2.FileName);

}

// 민원서류 스캔파일 저장
function btnScanSave_OnClick(obj)
{

	if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EJMGNO"))) {
	
        gfn_Alert("접수자료가 없습니다.\n\n" +
                  "접수자료 조회 후 저장하세요!");

        return;
	
	}
	
	
	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	}
	
	if (edScanFileName.Text == "") {

        gfn_Alert("스캔한 파일이 없습니다!");

        return;
	
	}
	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 저장하시겠습니까?")) {

		return false;

	}
	
	
		
	ds_iFormSave.ClearData();
	
	ds_iFormSave.AddRow();
			
	var vPROC = "";
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	
	// 응시원서(시험, 심폐소생술시험, 생활안전강사시험)
	if (cbxForm.Value == "0021" || cbxForm.Value == "0013" || cbxForm.Value == "0018") {
		if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EJFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
			vPK2 = "";
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioExamJubsu.GetColumn(0, "EJFAMGNO");
		}
	} else if (cbxForm.Value == "0022") {	// 일정변경신청서
		if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EOHFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioExamJubsu.GetColumn(0, "EOHSEQ");
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioExamJubsu.GetColumn(0, "EOHFAMGNO");
		}
	} else if (cbxForm.Value == "0023") {	// 환불신청서
		if (ds_ioExamJubsu.GetColumn(0, "ATC0023") == "0" ||
			ds_ioExamJubsu.GetColumn(0, "ATC0023") == "E") {
			vPROC = "I";	// 신규
			vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioExamJubsu.GetColumn(0, "REPAYEJHSEQ");
		} else {
			vPROC = "A";	// 변경
			var vATC0003 = split(ds_ioExamJubsu.GetColumn(0, "ATC0023"), "|");
			vFAMGNO = vATC0003[0];
		}
	}
			
	ds_iFormSave.SetColumn(0, "I_PROC", vPROC);					//신규(I), 화일변경(A)
    ds_iFormSave.SetColumn(0, "I_FCCD", cbxForm.Value);			//FORMCODE.FCCD 서식관리번호(신규/화일변경 공통]
    ds_iFormSave.SetColumn(0, "I_FAMGNO", vFAMGNO);				//FormAttach.FAmgno (화일변경만)
    ds_iFormSave.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값(신규만)
    ds_iFormSave.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록(신규만)
    ds_iFormSave.SetColumn(0, "I_FRDATE", left(getDate(),8));	//보관시작일(신규만)
    ds_iFormSave.SetColumn(0, "I_PATH", ls_FormUploadPath);		//저장위치(신규 /화일변경)
    ds_iFormSave.SetColumn(0, "I_FILENM", ls_UploadFormName);	//파일명(신규 /화일변경)
    
//    TRACE(ds_iFormSave.SaveXML());
						
    ds_oFormSave.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:insertFormSave", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormSave=ds_iFormSave"    // inDs

        ,"ds_oFormSave=ds_oFormSave"    // outDs

        ,""    // args

        ,"lfn_AfterFormSave"

        ,false

        ,false

        ,true

    );
    


}

function lfn_AfterFormSave(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
    if (ds_oFormSave.GetColumn(0, "O_status") == "FAIL") {
    
        gfn_ErrorMsg(ds_oFormSave.GetColumn(0, "O_status"), ds_oFormSave.GetColumn(0, "O_value"));

        return false;    
        
    } else if (ds_oFormSave.GetColumn(0, "O_status") == "SUCCESS") {

		var UploadResult = tit_FileWrite(

						hfImage2
				
						, ls_FormUploadPath
				
						, fdImage2.FilePath
				
						, fdImage2.FileName
				
						, ls_UploadFormName
				
						, "U"
				
						, true
				
					);
						
		/* Array
			0 - 성공 : S / 실패 : E / 파일크기 초과 : O
			1 - 서버에 저장된 실제 경로
			2 - 서버에 저장된 실제 파일명
			3 - 서버에 저장된 파일 사이즈
		*/
		// 성공여부 체크 && 파일사이즈 체크
		if (UploadResult[0] == "S" && UploadResult[3] == fiImageFile2.GetLength()) {
			
			gfn_Alert("서류스캔파일이 정상적으로 저장되었습니다.");
			
			lfn_Search();
		
		} else {
		
			gfn_Alert("서류스캔파일 저장 시 오류가 발생했습니다.");
			
			return false;
		}
							
		hfImage2.CloseFile();
		
	}

}

// 서버 서식스캔파일 보기
function btnSeverFormView_OnClick(obj)
{

	if (edFormResult.Text == "완료") {

		var sFile = split(ds_ioExamJubsu.GetColumn(0, "ATC" + cbxForm.Value), "|");
		
		sArg = "sURL=" + GF_FILE_SERVER_URL + "kems"+ sFile[1];
		
		//alert(sArg);
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}
	
}

// PC 서식스캔파일 보기
function btnLocalFormView_OnClick(obj)
{
	
	if (!gfn_isNull(edScanFileName.Text)) {
	
		sArg = "sURL="+"C:\\KFSA\\Form.pdf";
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}
}


function cbxForm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	btnScan.SetFocus();
}

// 서류 DB삭제(관리자만)
function btnFormDelete_OnClick(obj)
{

	if (edFormResult.Text <> "완료") {
		gfn_Alert("등록된 자료가 없습니다.");
		return false;
	}
	
	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 삭제하시겠습니까?")) {

		return false;

	}
	
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	var vPathArr = "";
	var vPath = "";
	var vfile = "";
	
	// 응시원서(시험, 심폐소생술시험, 생활안전강사시험)
	if (cbxForm.Value == "0021" || cbxForm.Value == "0013" || cbxForm.Value == "0018") {
		if (!gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EJFAMGNO"))) {
			vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
			vPK2 = "";
			vFAMGNO = ds_ioExamJubsu.GetColumn(0, "EJFAMGNO");
			vPathArr = split(ds_ioExamJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
				
	} else if (cbxForm.Value == "0022") {	// 일정변경신청서
		if (!gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EOHFAMGNO"))) {
			vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioExamJubsu.GetColumn(0, "EOHSEQ");
			vFAMGNO = ds_ioExamJubsu.GetColumn(0, "EOHFAMGNO");
			vPathArr = split(ds_ioExamJubsu.GetColumn(0, "ATC0022"), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	} else if (cbxForm.Value == "0023") {	// 환불신청서
		if (length(ds_ioExamJubsu.GetColumn(0, "ATC0023")) > 2) {
			vPK1 = ds_ioExamJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioExamJubsu.GetColumn(0, "REPAYEJHSEQ");
			vPathArr = split(ds_ioExamJubsu.GetColumn(0, "ATC0023"), "|");
			vFAMGNO = vPathArr[0];
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	}

		
	ds_iFormDelete.ClearData();
	ds_iFormDelete.AddRow();
	
    ds_iFormDelete.SetColumn(0, "I_FCCD", cbxForm.Value);		//FORMCODE.FCCD 서식관리번호
    ds_iFormDelete.SetColumn(0, "I_FAMGNO", vFAMGNO);			//FormAttach.FAmgno
    ds_iFormDelete.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값
    ds_iFormDelete.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록
    ds_iFormDelete.SetColumn(0, "I_PATH", vPath);				//저장경로
    ds_iFormDelete.SetColumn(0, "I_FILENM", vfile);				//파일명
    
    ds_oFormDelete.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:deleteForm", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormDelete=ds_iFormDelete"    // inDs

        ,"ds_oFormDelete=ds_oFormDelete"    // outDs

        ,""    // args

        ,"lfn_AfterFormDelete"

        ,false

        ,false

        ,true

    );
    
}

// 민원서류 서버파일삭제
function lfn_AfterFormDelete(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
	var vPathArr = split(ds_ioExamJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
	var vPath = substr(vPathArr[1],0,18);	// 서버경로
	var vfile = substr(vPathArr[1],19,21);	// 파일명


	var UploadResult = tit_FileDelete(  //serverSaveDir, serverFileName, isNeedRtn

					vPath	// 서버경로
			
					, vfile	// 파일명
			
					, true				// 처리결과
			
				);
					
	// 결과	true / false

	// 성공여부 체크 && 파일사이즈 체크
	if (UploadResult == true) {
		
		gfn_Alert("서류스캔파일이 정상적으로 삭제되었습니다.");
		
		lfn_Search();
	
	} else {
	
		gfn_Alert("서류스캔파일 삭제 시 오류가 발생했습니다.");
		
		return false;
	}
							
}


function Form_OnActivate(obj)
{
	gs_SysID = "[stm_01,bsn_4000,dsc_0001]";	// 개인정보접속기록 시스템ID  
}
]]></Script>
</Window>
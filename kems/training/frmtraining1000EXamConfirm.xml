<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="712" Id="frmtraining1000EXamConfirm" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="응시자격심사" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset CanRowPosChange="ds_ioProfessor_CanRowPosChange" DataSetType="Dataset" Id="ds_ioProfessor" OnColumnChanged="ds_ioProfessor_OnColumnChanged">
				<Contents>
					<colinfo id="EAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EATPMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMGGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EADATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EASTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EATCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="EATCCOURSENM" size="256" summ="default" type="STRING"/>
					<colinfo id="EACONFIRMDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EACONFIRMSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREASON" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMODREASON" size="256" summ="default" type="STRING"/>
					<colinfo id="EAFILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="EAFILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="EACLASSGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREGDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREGSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMODDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMODSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSONNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="EAADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPERNB" size="256" summ="default" type="STRING"/>
					<colinfo id="EACANCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Jibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioExamJubsu">
				<Contents>
					<colinfo id="PERSONNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY7" size="256" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSONKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EATPMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EATCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMGGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EADATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ0" size="22" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="IIIMGBINARY" size="4000" summ="default" type="BLOB"/>
					<colinfo id="IILASTREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTHYN" size="256" summ="default" type="STRING"/>
					<colinfo id="EARPNUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EARROADBUILDMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EARROADDETAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="EARROADREMAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="EARSANGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EARMAINBUNJI" size="256" summ="default" type="STRING"/>
					<colinfo id="EARSUBBUNJI" size="256" summ="default" type="STRING"/>
					<colinfo id="EARBUILDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EARADDRETC" size="256" summ="default" type="STRING"/>
					<colinfo id="EARCONVPGM" size="256" summ="default" type="STRING"/>
					<colinfo id="EARCONVSTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="EAADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="DI" size="256" summ="default" type="STRING"/>
					<colinfo id="CI" size="256" summ="default" type="STRING"/>
					<colinfo id="CIVER" size="256" summ="default" type="STRING"/>
					<colinfo id="PRNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuGubunCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택</DATA>
					</record>
					<record>
						<CD>10</CD>
						<DATA>특급&#32;소방안전관리자</DATA>
					</record>
					<record>
						<CD>21</CD>
						<DATA>1급&#32;소방안전관리자</DATA>
					</record>
					<record>
						<CD>22</CD>
						<DATA>2급&#32;소방안전관리자</DATA>
					</record>
					<record>
						<CD>23</CD>
						<DATA>3급&#32;소방안전관리자</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA2" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA3" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oProfessor" OnRowPosChanged="ds_Professor_OnRowPosChanged">
				<Contents>
					<colinfo id="PERSONNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY7" size="256" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSONKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EATPMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EATCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMGGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EADATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ0" size="22" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="IIIMGBINARY" size="4000" summ="default" type="BLOB"/>
					<colinfo id="IILASTREALNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oChangeTpmgno">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>조회</DATA>
					</record>
					<record>
						<CD>C</CD>
						<DATA>성명/주민번호&#32;변경</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioExamPerson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioT_E_L_JubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuGubunCheck">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuGubun_copy">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA2" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_KemsOnline">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_examaccept"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_examaccept_first"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_examaccept_two"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingPerson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAddr">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>지번주소</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>도로명주소</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamJubsu"></Dataset>
			<Dataset CanRowPosChange="ds_ioProfessor_CanRowPosChange" DataSetType="Dataset" Id="ds_ioProfessorData">
				<Contents>
					<colinfo id="EAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EATPMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMGGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EADATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EASTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EATCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="EACONFIRMDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EACONFIRMSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREASON" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMODREASON" size="256" summ="default" type="STRING"/>
					<colinfo id="EAFILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="EAFILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="EACLASSGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREGDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAREGSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMODDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EAMODSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSONNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="EAJUBSUGUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="EAADDRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPERNB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oForm">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0048</CD>
						<DATA>응시자격심사신청서</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormSave">
				<Contents>
					<colinfo id="I_PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FRDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormSave"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormDelete">
				<Contents>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormDelete"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_examaccept_tree"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Personkey">
				<Contents>
					<colinfo id="PERSONKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="PNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PHP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oExamJubsuResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oModifyColumn"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_examaccept_SW"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ConfirmCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioReport"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_examaccept_Five"></Dataset>
		</Datasets>
		<Shape Bottom="702" Height="288" Id="Shape1" Left="8" LineColor="user15" Right="988" TabOrder="7" Top="414" Type="Rectangle" Width="980"></Shape>
		<Shape Bottom="118" Height="26" Id="Shape3" Left="327" LineColor="darkgoldenrod" Right="993" TabOrder="52" Top="92" Type="Rectangle" Width="666"></Shape>
		<Shape Bottom="702" Height="25" Id="Shape4" Left="16" LineColor="darkgoldenrod" Right="479" TabOrder="36" Top="677" Type="Rectangle" Width="463"></Shape>
		<Shape Bottom="89" Height="49" Id="shpGubunBox1" Left="8" LineColor="user15" Right="992" TabOrder="0" Top="40" Type="Rectangle" Width="984"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" Left="4" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="0" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="284">
			<Contents></Contents>
		</Div>
		<Shape Bottom="30" Height="28" Id="Shape0" Left="476" LineColor="user14" Right="992" TabOrder="21" Top="2" Type="Rectangle" Width="516"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="479" OnClick="lfn_Search" Style="sty_Button" TabOrder="14" ToolTipText="조회" Top="5" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnInput" ImageID="BTN_COM_ADD" Left="330" OnClick="lfn_Input" Style="sty_Button" TabOrder="15" ToolTipText="추가&#32;저장" Top="94" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="905" OnClick="lfn_Delete" Style="sty_Button" TabOrder="17" ToolTipText="삭제&#32;저장" Top="94" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="416" OnClick="lfn_Save" Style="sty_Button" TabOrder="16" ToolTipText="수정&#32;저장" Top="94" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="566" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="11" ToolTipText="입력&#32;초기화" Top="5" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="818" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="12" ToolTipText="화면&#32;출력" Top="5" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="904" OnClick="lfn_End" Style="sty_Button" TabOrder="13" ToolTipText="닫기" Top="5" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static8" Left="-144" Style="sty_LabelGruopBox" TabOrder="21" Text="안전원&#32;교수&#32;관리" Top="63" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="20" Id="lbPersonNm" Left="686" Style="sty_Label" TabOrder="22" Text="성명" Top="42" UserData="S" VAlign="Middle" Width="40"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edSPersonnm" ImeMode="native" Left="728" LeftMargin="2" Style="sty_Edit" TabOrder="9" Top="42" UserData="S" Width="97"></Edit>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioProfessor" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="371" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="251" Id="gdProfessor" InputPanel="FALSE" Left="8" LineColor="default" OnHeadClick="gdProfessor_OnHeadClick" Right="993" RowHeight="20" Style="sty_Grid" TabOrder="10" TabStop="true" Top="120" UseDBuff="true" UsePopupMenu="true" UserData="초빙강사리스트" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="985">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="35"/>
						<col fix="left" width="72"/>
						<col fix="left" width="60"/>
						<col fix="left" width="59"/>
						<col fix="left" width="88"/>
						<col width="0"/>
						<col width="0"/>
						<col width="165"/>
						<col width="100"/>
						<col width="100"/>
						<col width="200"/>
						<col width="130"/>
						<col width="130"/>
						<col width="130"/>
						<col width="130"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox" edit="checkbox" rowspan="2"/>
						<cell col="1" display="text" rowspan="2" text="순번"/>
						<cell align="center" col="2" display="text" rowspan="2" text="신청상태"/>
						<cell col="3" display="text" rowspan="2" text="지부"/>
						<cell col="4" display="text" rowspan="2" text="성명"/>
						<cell align="center" col="5" display="text" rowspan="2" text="생년월일"/>
						<cell align="center" col="6" display="text" rowspan="2" text="휴대폰"/>
						<cell col="7" display="text" rowspan="2" text="주소"/>
						<cell col="8" display="text" rowspan="2" text="직능"/>
						<cell col="9" display="text" rowspan="2" text="신청일"/>
						<cell col="10" display="text" rowspan="2" text="처리자"/>
						<cell col="11" display="text" rowspan="2" text="응시자격"/>
						<cell bkcolor="user4" col="12" colspan="4" display="text" text="사유"/>
						<cell bkcolor="user4" col="12" display="text" row="1" text="승인사유"/>
						<cell bkcolor="user4" col="13" display="text" row="1" text="보완사유"/>
						<cell bkcolor="user4" col="14" display="text" row="1" text="반려사유"/>
						<cell bkcolor="user4" col="15" display="text" row="1" text="신청취소사유"/>
					</head>
					<body>
						<cell align="center" col="0" colid="SEL" display="checkbox" edit="expr:iif(EASTATUS==&apos;6&apos;,&apos;none&apos;,&apos;checkbox&apos;)"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell align="center" col="2" colid="EASTATUS" combocol="cD" combodataset="ds_status" combotext="DATA" display="combo"/>
						<cell align="center" col="3" colid="EAMGGTMGNO" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="4" colid="PERSONNM" display="text"/>
						<cell align="center" col="5" colid="BIRTHDAY" display="text"/>
						<cell align="left" col="6" colid="HPTEL" display="text" Mask="###-####-####"/>
						<cell col="7" colid="ADRESS" display="text"/>
						<cell col="8" colid="EATCCOURSENM" display="text"/>
						<cell align="center" col="9" colid="EADATE" display="date"/>
						<cell align="center" col="10" colid="SITEGUBUNNM" display="text"/>
						<cell col="11" colid="EAJUBSUGUBUN" combocol="CD" combodataset="ds_oJubsuGubun" combotext="DATA" display="combo"/>
						<cell align="left" col="12" colid="EAREMARK" display="text" edit="normal"/>
						<cell align="left" col="13" colid="EAMODREASON" display="text" edit="normal"/>
						<cell align="left" col="14" colid="EAREASON" display="text" edit="normal"/>
						<cell align="left" col="15" colid="EACANCELL" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbDate" Left="216" Style="sty_Label" TabOrder="25" Text="신청일자" Top="42" VAlign="Middle" Width="88"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="cldFromdt" Left="308" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="23" Top="42" UserData="S" WeeksFont="돋음,9" Width="98"></Calendar>
		<Static Align="Center" Height="20" Id="lbDateWave1" Left="410" Style="sty_Text" TabOrder="26" Text="~" Top="42" VAlign="Middle" Width="10"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="cldTodt" Left="424" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="24" Top="42" UserData="S" WeeksFont="돋음,9" Width="98"></Calendar>
		<Static Align="Center" Height="20" Id="lbCourse" Left="524" Style="sty_Label" TabOrder="29" Text="신청상태" Top="42" VAlign="Middle" Width="64"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxStatus" INDEX="0" InnerDataset="ds_status" Left="588" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="27" Top="41" Width="94"></Combo>
		<Static Align="Center" Height="20" Id="Static10" Left="16" Style="sty_Label" TabOrder="29" Text="응시자격" Top="611" UserData="S" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_ioExamJubsu" CodeColumn="CD" Column="EAJUBSUGUBUN" DataColumn="DATA" Height="20" Id="cbxJubsuGubun" INDEX="0" InnerDataset="ds_oJubsuGubun" Left="106" OnChanged="cbxJubsuGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Combo" TabOrder="6" Top="610" Width="724"></Combo>
		<Static Align="Center" Height="20" Id="Static0" Left="16" Style="sty_Label" TabOrder="30" Text="민원서류등록" Top="633" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="21" Id="Static5" Left="18" Style="sty_Label" TabOrder="31" Text="응시서류" Top="679" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="21" Id="edfileNm" ImeMode="native" Left="107" LeftMargin="2" Style="sty_Edit" TabOrder="33" Top="679" UserData="S" Width="304"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="21" Id="btnDownload" ImageID="BTN_TEXT_04" Left="412" OnClick="btnDownload_OnClick" Style="sty_Button" TabOrder="32" Text="&#32;다운로드&#32;" ToolTipText="다운로드" Top="679" Width="65"></Button>
		<Static Align="Center" Height="20" Id="lbJubsu" Left="448" Style="sty_LabelGruopBox" TabOrder="34" Text="신청상태" Top="430" VAlign="Middle" Width="68"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Color="blueviolet" Enable="FALSE" Font="굴림,10,Bold" Height="20" Id="edStatus" ImeMode="native" Left="518" LeftMargin="2" Style="sty_Edit" TabOrder="35" Top="430" Width="74"></Edit>
		<Static Font="굴림,10,Bold" Height="15" Id="Static1" Left="18" TabOrder="37" Text="※&#32;민원서류(민원인&#32;등록)" Top="658" Width="246"></Static>
		<Static Align="Center" BKColor="coral" Border="Flat" Font="굴림,11,Bold" Height="24" Id="lbModetest" Left="449" TabOrder="38" Text="신규입력모드" Top="451" VAlign="Middle" Width="143"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edFormResult" ImeMode="native" Left="107" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="39" Top="633" UserData="S" Width="45"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeverFormView" ImageID="BTN_SEARCH" Left="154" OnClick="btnSeverFormView_OnClick" Style="sty_Button" TabOrder="40" Top="633" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScan" ImageID="BTN_TEXT_04" Left="177" OnClick="btnScan_OnClick" Style="sty_Button" TabOrder="41" Text="①스캔실행" ToolTipText="스캔실행" Top="633" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSearch" ImageID="BTN_TEXT_04" Left="244" OnClick="btnScanSearch_OnClick" Style="sty_Button" TabOrder="42" Text="②불러오기" ToolTipText="불러오기" Top="633" Transparent="TRUE" Width="66"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edScanFileName" ImeMode="native" Left="313" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="43" Top="634" UserData="S" Width="74"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLocalFormView" ImageID="BTN_SEARCH" Left="388" OnClick="btnLocalFormView_OnClick" Style="sty_Button" TabOrder="45" Top="633" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSave" ImageID="BTN_TEXT_04" Left="411" OnClick="btnScanSave_OnClick" Style="sty_Button" TabOrder="44" Text="③서류저장" ToolTipText="서류저장" Top="633" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnFormDelete" ImageID="BTN_MINUS" Left="479" OnClick="btnFormDelete_OnClick" Style="sty_Button" TabOrder="46" ToolTipText="서류삭제" Top="636" Transparent="TRUE" Visible="FALSE" Width="16"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnApprove" ImageID="BTN_TEXT_04" Left="703" OnClick="btnApprove_OnClick" Style="sty_Button" TabOrder="47" Text="승인" ToolTipText="승인" Top="94" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnReject" ImageID="BTN_TEXT_04" Left="771" OnClick="btnReject_OnClick" Style="sty_Button" TabOrder="48" Text="반려" ToolTipText="반려" Top="94" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnJubsu" ImageID="BTN_TEXT_04" Left="502" OnClick="btnJubsu_OnClick" Style="sty_Button" TabOrder="49" Text="접수시작" ToolTipText="접수시작" Top="94" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnMod" ImageID="BTN_TEXT_04" Left="636" OnClick="btnMod_OnClick" Style="sty_Button" TabOrder="50" Text="보완" ToolTipText="반려" Top="94" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btn_Cancell" ImageID="BTN_TEXT_04" Left="569" OnClick="btn_Cancell_OnClick" Style="sty_Button" TabOrder="51" Text="접수취소" ToolTipText="접수시작" Top="94" Transparent="TRUE" Width="66"></Button>
		<Static Align="Center" Height="20" Id="Static6" Left="10" Style="sty_Label" TabOrder="53" Text="지부" Top="42" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" ImeMode="none" INDEX="1" InnerDataset="ds_oJibu" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="54" Top="41" UserData="I:" Width="115"></Combo>
		<Static Align="Center" Height="20" Id="Static3" Left="16" Style="sty_Label" TabOrder="55" Text="직능" Top="457" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_ioExamJubsu" CodeColumn="CD" Column="EATCCOURSECD" DataColumn="DATA" Height="20" Id="cbxCourse" INDEX="0" InnerDataset="ds_oJubsuGubunCourse" Left="106" OnChanged="cbxCourse_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Combo" TabOrder="56" Top="456" Width="137"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnApplyPicture" ImageID="BTN_TEXT_06" Left="1056" OnClick="btnApplyPicture_OnClick" Style="sty_Button" TabOrder="63" Text="최근사진반영" Top="448" Transparent="TRUE" Visible="FALSE" Width="93"></Button>
		<Static Align="Center" Height="20" Id="Static2" Left="16" Style="sty_Label" TabOrder="64" Text="성명" Top="479" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbBIRTHDAY" Left="16" Style="sty_Label" TabOrder="65" Text="주민등록번호" Top="501" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfo" ImageID="BTN_TEXT_08" Left="213" OnClick="btnSearchPersonInfo_OnClick" Style="sty_Button" TabOrder="59" Text="접수자&#32;&#32;검색" Top="479" Transparent="TRUE" Width="118"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="PERSONNM" Height="20" Id="edPersonNm" ImeMode="native" Left="105" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="1" Top="479" UserData="S" Width="106"></Edit>
		<Static Align="Center" Height="20" Id="lbAddr" Left="16" Style="sty_Label" TabOrder="68" Text="주소" Top="545" VAlign="Middle" Width="88"></Static>
		<MaskEdit Align="Center" AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioExamJubsu" BKColor="user4" Border="Flat" Column="ZIPCD" Height="20" Id="medZipCode" Left="106" LeftMargin="2" Mask="#####" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="57" Top="545" Type="STRING" UserData="S" Width="50"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchZipCode" ImageID="BTN_SEARCH" Left="157" OnClick="btnSearchZipCode_OnClick" Style="sty_Button" TabOrder="61" Top="545" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="ADDR1" Height="20" Id="edAddr1" ImeMode="native" Left="179" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="5" Top="545" UserData="S" Width="413"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="ADDR2" Enable="FALSE" Height="20" Id="edAddr2" ImeMode="native" Left="16" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="58" Top="567" UserData="S" Width="576"></Edit>
		<Static Align="Center" Height="20" Id="lbTel" Left="215" Style="sty_Label" TabOrder="66" Text="전화번호" Top="523" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="TEL" Height="20" Id="edTel" ImeMode="native" Left="304" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="4" Top="523" UserData="S" Width="104"></Edit>
		<Static Align="Center" Height="20" Id="lbHpTel" Left="16" Style="sty_Label" TabOrder="67" Text="휴대폰" Top="523" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="BIRTHDAY7" Height="20" Id="medBIRTHDAY" Left="105" LeftMargin="2" Mask="######-#######" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medBIRTHDAY_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="2" Top="501" Type="STRING" UserData="S" Width="106"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAuthBIRTHDAY" ImageID="BTN_TEXT_07" Left="332" OnClick="btnAuthBIRTHDAY_OnClick" Style="sty_Button" TabOrder="60" Text="실명인증" Top="479" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchRegPicture" ImageID="BTN_TEXT_06" Left="762" OnClick="btnSearchRegPicture_OnClick" Style="sty_Button" TabOrder="62" Text="등록사진조회" Top="512" Transparent="TRUE" Width="93"></Button>
		<Static Align="Center" Height="20" Id="lbExamPersonInfo" Left="24" Style="sty_LabelGruopBox" TabOrder="69" Text="접수자&#32;기본&#32;정보" Top="411" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Font="굴림,9" Height="20" Id="Static4" Left="146" Style="sty_Label" TabOrder="71" Text="개인식별번호" Top="411" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" BKColor="palegoldenrod" Border="Flat" Column="PERSONKEY" Font="굴림,9" Height="20" Id="medPersonKey" Left="235" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="70" Top="411" Type="STRING" Width="75"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnScanPicture" ImageID="BTN_TEXT_07" Left="856" OnClick="btnScanPicture_OnClick" Style="sty_Button" TabOrder="72" Text="SVP5300사진스캔" Top="583" Transparent="TRUE" Width="106"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPhotoScan" ImageID="BTN_TEXT_06" Left="856" OnClick="btnPhotoScan_OnClick" Style="sty_Button" TabOrder="73" Text="D400사진스캔" Top="560" Transparent="TRUE" Width="95"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadScanPicture" ImageID="BTN_TEXT_08" Left="857" OnClick="btnLoadScanPicture_OnClick" Style="sty_Button" TabOrder="74" Text="스캔사진불러오기" Top="606" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadPicture" ImageID="BTN_TEXT_08" Left="857" OnClick="btnLoadPicture_OnClick" Style="sty_Button" TabOrder="75" Text="사진찾기" Top="629" Transparent="TRUE" Width="119"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radChangeTpmgno" INDEX="0" InnerDataset="ds_oChangeTpmgno" Left="1040" LeftMargin="2" OnChanged="radChangeTpmgno_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="76" Top="344" Value="S" Visible="FALSE" Width="200"></Radio>
		<Static Align="Center" BKColor="user36" BorderColor="user0" Height="20" Id="lbImsiEATPMGNO" Left="600" Style="sty_Label" TabOrder="79" Text="EATPMGNO" Top="440" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_ioExamJubsu" Column="EATPMGNO" Height="20" Id="edImsiEATPMGNO" Left="681" TabOrder="78" Top="440" Width="70"></Edit>
		<Static Align="Center" BKColor="user36" BorderColor="user0" Height="20" Id="lbImsiEAMGNO" Left="600" Style="sty_Label" TabOrder="78" Text="EAMGNO" Top="461" VAlign="Middle" Width="68"></Static>
		<Edit BindDataset="ds_ioExamJubsu" Column="EAMGNO" Height="20" Id="edImsiEAMGNO" ImeMode="none" Left="670" TabOrder="77" Top="461" Width="79"></Edit>
		<Static Align="Center" Height="20" Id="Static7" Left="249" Style="sty_Label" TabOrder="80" Text="신청일자" Top="435" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_ioExamJubsu" Border="Flat" Column="EADATE" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="cldEADATE" Left="339" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="80" Top="435" UserData="S" WeeksFont="돋음,9" Width="106"></Calendar>
		<Static Align="Center" Height="20" Id="Static9" Left="16" Style="sty_Label" TabOrder="80" Text="응시자격구분" Top="589" UserData="S" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_ioExamJubsu" CodeColumn="CD" Column="EAJUBSUGUBUN2" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxJubsugubunCheck" INDEX="0" InnerDataset="ds_oJubsuGubunCheck" Left="106" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Combo" TabOrder="81" Top="589" Width="107"></Combo>
		<Static Color="red" Font="굴림,10,Bold" Height="13" Id="Static11" Left="217" TabOrder="82" Text="◀--&#32;응시자격&#32;선택&#32;시&#32;자동&#32;선택됩니다.&#32;" Top="593" Width="270"></Static>
		<Static Align="Center" Height="20" Id="Static12" Left="10" Style="sty_Label" TabOrder="83" Text="접수구분" Top="65" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKemsOnline" ImeMode="none" INDEX="0" InnerDataset="ds_KemsOnline" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="84" Top="64" UserData="I:" Width="115"></Combo>
		<FileDialog Bottom="655" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage2" Left="498" Right="522" TabOrder="90" Top="631" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage2" Left="525" Top="631" Width="24"></HttpFile>
		<File Bottom="655" Height="24" Id="fiImageFile2" Left="552" Right="576" TabOrder="91" Top="631" Width="24"></File>
		<Static Align="Center" Height="20" Id="Static13" Left="16" Style="sty_Label" TabOrder="85" Text="지부" Top="435" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_ioExamJubsu" Border="Flat" CodeColumn="CD" Column="EAMGGTMGNO" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbx_jibu" ImeMode="none" INDEX="0" InnerDataset="ds_oJibu2" Left="104" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="434" Width="139"></Combo>
		<Combo BindDataset="ds_ioExamJubsu" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxAddrGubun" INDEX="0" InnerDataset="ds_oAddr" Left="1040" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="86" Top="402" UserData="S" Visible="FALSE" Width="89"></Combo>
		<Static Align="Center" BKColor="user36" Height="20" Id="stfilePath" Left="485" Style="sty_Label" TabOrder="88" Text="파일경로" Top="679" VAlign="Middle" Width="80"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edfilePath" ImeMode="native" Left="567" LeftMargin="2" Style="sty_Edit" TabOrder="87" Top="679" UserData="S" Width="200"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintAll" ImageID="BTN_TEXT_05" Left="652" OnClick="lfn_Print" Style="sty_Button" TabOrder="89" Text="신청서출력" ToolTipText="응시원서출력" Top="5" Width="80"></Button>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxForm" INDEX="0" InnerDataset="ds_oForm" Left="600" OnChanged="cbxForm_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="90" Top="560" Width="172"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btCanCell" ImageID="BTN_TEXT_04" Left="838" OnClick="btCanCell_OnClick" Style="sty_Button" TabOrder="91" Text="신청취소" ToolTipText="신청취소" Top="94" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btConfirmCancell" ImageID="BTN_TEXT_05" Left="910" OnClick="btConfirmCancell_OnClick" Style="sty_Button" TabOrder="92" Text="승인취소" ToolTipText="승인취소" Top="65" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnRemark" ImageID="BTN_TEXT_06" Left="232" OnClick="btnRemark_OnClick" Style="sty_Button" TabOrder="93" Text="사유전체보기" Top="94" Transparent="TRUE" Width="93"></Button>
		<File Bottom="32" Height="24" Id="fiImageFile" Left="304" Right="328" TabOrder="101" Top="8" Width="24"></File>
		<FileDialog Bottom="32" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage" Left="330" Right="354" TabOrder="100" Top="8" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage" Left="358" Top="8" Width="24"></HttpFile>
		<Image Border="Flat" FillType="STRETCH" Height="135" Id="imgLastestPicture" Left="857" Style="sty_Image" TabOrder="98" Text="최근사진" Top="422" Transparent="TRUE" Width="123"></Image>
		<Image BindDataset="ds_ioExamJubsu" Border="Flat" FillType="STRETCH" Height="88" Id="imgPicture" Left="763" Style="sty_Image" TabOrder="97" Text="사진" Top="422" Transparent="TRUE" Width="92"></Image>
		<MaskEdit AutoSelect="TRUE" BKColor="palegoldenrod" Border="Flat" Font="굴림,9" Height="20" Id="edCheckCount" Left="8" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="99" Top="96" Visible="FALSE" Width="24"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="Button0" ImageID="BTN_TEXT_07" Left="438" OnClick="btnSearchPersonInfoChange_OnClick" Style="sty_Button" TabOrder="100" Text="접수자정보변경" Top="479" Transparent="TRUE" Width="105"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioExamJubsu" Border="Flat" Column="HPTEL" Height="20" Id="edHpTel" ImeMode="native" Left="105" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="3" Top="524" UserData="S" Width="106"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnImageZoom" ImageID="BTN_TEXT_05" Left="763" OnClick="btnImageZoom_OnClick" Style="sty_Button" TabOrder="101" Text="이미지확대" Top="535" Transparent="TRUE" Width="79"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="732" OnClick="btnToExcel_OnClick" Style="sty_Button" TabOrder="102" ToolTipText="엑셀로&#32;저장" Top="5" Width="85"></Button>
		<Shape Bottom="404" Height="27" Id="Shape2" Left="7" LineColor="red" Right="992" TabOrder="103" Top="377" Type="Rectangle" Width="985"></Shape>
		<Static Color="red" Font="굴림,10,Bold" Height="13" Id="Static14" Left="13" TabOrder="104" Text="※&#32;수정하려는&#32;대상자를&#32;선택(체크)하셔야&#32;수정이&#32;가능합니다." Top="384" Width="830"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btn_masterSave" ImageID="BTN_TEXT_08" Left="872" OnClick="btn_masterSave_OnClick" Style="sty_Button" TabOrder="105" Text="저장(평가관리과)" ToolTipText="저장(평가관리과)" Top="42" Visible="FALSE" Width="118"></Button>
		<Static Align="Center" Height="20" Id="lbAbsentCnt" Left="216" Style="sty_LabelStat" TabOrder="107" Text="조회건수" Top="65" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medSearchCnt" Left="308" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="106" Top="65" UserData="S" Width="88"></MaskEdit>
		<Static Align="Center" Height="20" Id="Static15" Left="425" Style="sty_LabelStat" TabOrder="109" Text="선택건수" Top="65" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medCheckCnt" Left="517" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="108" Top="65" UserData="S" Width="88"></MaskEdit>
	</Form>
	<Script><![CDATA[ /*

 * 프로그램명 : frmtraining1000ExamConfirm.xml

 * 설명 : 응시자격 신청 접수

 * 작성일 : 2023.04.03

 * 작성자 : 김동한

* ver 2023.08.21

 */

#include "LIB::training.js"; // 공통업무 관련

var ls_OldSeatNo = "";               // 좌석번호
var ls_OldPictureNo = "";           // 기존 사진번호

var lb_IsNiceCheckOk = false;       // 실명인증
var lb_FileUpload = false;          // 사진등록여부

var ls_ServiceName = "";            // Transaction시 호출 Service 이름
var ls_CallBackServiceName = "";    // Transaction시 CallBack 함수 이름

var ls_IsChangedJubsuInfoYn = "N";  // 접수자기본정보 변경여부
var ls_IsChangedSeatNoYn    = "N";  // 좌석번호 변경여부
var ls_IsChangedPictureYn   = "N";  // 사진 변경여부

var ls_UploadRealName = "";         // 사진이미지 실제파일명
var ls_FileUploadPath = "/IMGDATA/" + left(GetDate(), 4) + "/" + substr(GetDate(), 4, 2); // 사진이미지경로;

var ls_FormUploadPath = "/IMGDATA/Form/" + left(GetDate(), 4); // 서류스캔파일경로;
var ls_UploadFormName = false; // 서류스캔 저장파일명
var lb_FormFileUpload = false; // 서류스캔파일등록여부

var ls_AgreeFileUploadFolder = "/PRTDATA/";	// 개인정보동의서 업로드 위치
var ls_AgreeRealFilePath = "";				// 개인정보동의서 파일위치
var ls_AgreeRealFileName = "";				// 개인정보동의서 파일명
    
var ls_OldPersonName = "";
var ls_OldRID        = "";

var ls_SearchFlag = false;          // 조회시 Mogno Information을 셋팅하기 위해 사용

var serch_falg = "";   // 조회 버튼으로 한 것인지 선택해서 조회 인지 여부 "0", "1" 20091015
var ls_PassSavePrintYN = ""; // 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함

var ls_jubsuPossible = "N";  //접수가능여부 Y:가능 N:불가능
var ls_jubsuPossible21 = "";  //접수가능여부   N:불가능 // 22.12 1급시험 접수 시 자격체크  - 공공기관 강습수료자는 못하게, 공공+1급 강습수료자는 가능하게 

var ls_RetEjmgno = ""; // 시험접수관리번호(관리번호로 조회시 사용)

//personkey 추가..
var ls_DI = "";			// SCI DI 값
var ls_CI = "";			// SCI CI 값
var ls_CIVER = "";		// SCI CI버전
var ls_PERSONKEY = "";	// PERSONKEY 값
var ls_BIRTHDAY = "";	// 조회시 주민번호
var ls_BIRTHDAY7 = "";	// 생년월일7자리

var ls_FileUploadPath = "/IMGDATA/" + left(getDate(),4) + "/" + SubStr(getDate(),4,2);
var lb_FileUpload = false;
var ls_RealFileName = "";
var ls_DirPathName = "";
var lb_FileDelete = false;
var PhotoScanFlag = "";	// 사진스캔 프로그램 (1:SVP-5300프로그램, 2:D400 프로그램)
var sArg = "";


// 화면 로드시
function Form_OnLoadCompleted(obj)
{
	gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
	
	// 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";
    
    gfn_SearchJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회
    gfn_SearchJibu(cbx_Jibu, "Y", "전체"); // 지부 코드 조회
    
    /*
    gfn_SearchAllJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회
    gfn_SearchAllJibu(cbx_Jibu, "Y", ""); // 지부 코드 조회
    */
    gfn_SearchKCode(ds_oJubsuGubun, "M", "전체");
    
    gfn_SearchKCode(ds_KemsOnline, "P", "전체");
    gfn_SearchKCode(ds_status, "Q", "전체");
	gfn_SearchKCode(ds_oJubsuGubunCheck, "R", "");
    
   // cbxjibu.Index = 0;
   cbxStatus.Index = 0;
   cbxKemsOnline.Index = 0;
   cldfromdt.Value = left(toString(AddMonth(GetDate(), -1)), 6) + "01"; // 시작일을 전달 1일로 설정
   cldtodt.Value = today();    
   medSearchCnt.Value = 0;
   medCheckCnt.Value = 0;
   
   if(gds_oUserInfo.GetColumn(0, "PDEPTNM") == "평가관리과")
   {
		btConfirmCanCell.Visible = true;
		lbImsiEAMGNO.Visible = false;
		edImsiEAMGNO.Visible = false;
		lbImsiEATPMGNO.Visible = false;   
		edImsiEATPMGNO.Visible = false;
		stfilePath.Visible = false;
		edfilePath.Visible = false;
		edCheckCount.Visible = false;
		btn_masterSave.Visible = true;
   }
   else if(gds_oUserInfo.GetColumn(0, "PSABUN") == "20220952")
   {
		btConfirmCanCell.Visible = true;
		lbImsiEAMGNO.Visible = true;
		edImsiEAMGNO.Visible = true;
		lbImsiEATPMGNO.Visible = true;
		edImsiEATPMGNO.Visible = true;
		stfilePath.Visible = true;
		edfilePath.Visible = true;   
		edCheckCount.Visible = true;
		btn_masterSave.Visible = true;
   }
   else {
		btConfirmCanCell.Visible = false;
		lbImsiEAMGNO.Visible = false;
		edImsiEAMGNO.Visible = false;
		lbImsiEATPMGNO.Visible = false;
		edImsiEATPMGNO.Visible = false;   
		stfilePath.Visible = false;
		edfilePath.Visible = false;
		edCheckCount.Visible = false;
		btn_masterSave.Visible = false;
   }
}

// 실명인증완료
function btnAuthBIRTHDAY_OnClick(obj)
{
    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medBIRTHDAY.Value)) {
        gfn_Alert("성명과 주민번호를 입력해 주십시오.");
        return false;
    }
    
    if (length(medBIRTHDAY.Value) < 13) {
        gfn_Alert("[주민번호오류] 실명인증을 위해서는 주민등록번호가 13자리를 입력해 주세요.");
        return false;
    }    

	// 실명인증 및 personkey 조회
	ls_PERSONKEY = gfn_SearchPERSONKEY(edPersonNm.Text, medBIRTHDAY.Value, replace(edHpTel.Text,"-",""));	
	medPersonKey.Value = ls_PERSONKEY; // PERSONKEY 값
	ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
	ls_CI = gds_ioSciCheck.GetColumn(0, "STRCI");
	ls_CIVER = gds_ioSciCheck.GetColumn(0, "STRVER");
    
	if (gds_ioSciCheck.GetColumn(0, "STRRESULT") == "1") 
	{
		//old...if (lb_IsNiceCheckOk) {
        btnAuthBIRTHDAY.Text = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
        ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");
        edAddr1.SetFocus();

       ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함
//        ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
        
        //lfn_searchTraingPerson();      구버전.. 
        lfn_searchPerson(edPersonNm.Text, ls_DI); //  개인정보 조회  personinfo....        

		if (ds_ioExamPerson.GetRowCount() > 0) 
		{	// 조회건수가 있으면
			medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // PERSONKEY 값
			ls_BIRTHDAY7 = ds_ioExamPerson.GetColumn(0, "BIRTHDAY7"); // 생년월일7
			ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // 개인식별번호
			ls_DI = ds_ioExamPerson.GetColumn(0, "DI"); // DI값
			ls_CI = ds_ioExamPerson.GetColumn(0, "CI"); // CI값
			ls_CIVER = ds_ioExamPerson.GetColumn(0, "CIVER"); // CI버전      
			
			//////////////////
			ds_ioExamJubsu.SetColumn(0, "EATPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));
			ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", ds_ioExamPerson.GetColumn(0, "TPLASTIMGSEQ"));
			ds_ioExamJubsu.SetColumn(0, "ZIPCD", ds_ioExamPerson.GetColumn(0, "TPZIPCD"));
			
		   // medZipCode.Text = ds_ioTrainingPerson.GetColumn(0, "TPZIPCD");
			edAddr1.Text = ds_ioExamPerson.GetColumn(0, "TPADDR1");
			edAddr2.Text = ds_ioExamPerson.GetColumn(0, "TPADDR2");
			edTel.Text = ds_ioExamPerson.GetColumn(0, "TPTEL");
			edHpTel.Text = ds_ioExamPerson.GetColumn(0, "TPHPTEL");
			
			// 최근사진
		
			if (gfn_IsNull(ds_ioExamPerson.GetColumn(0, "TPLASTIMGSEQ"))) {
				imgLastestPicture.Text = "최근사진";
				imgLastestPicture.ImageID = "";
			} else {
				imgLastestPicture.Text = "";
				imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamPerson.GetColumn(0, "IIDIRPATH") + "/" + ds_ioExamPerson.GetColumn(0, "IIREALNM");
			}
		}
	}
	else 
	{
		ds_ioExamJubsu.SetColumn(0, "AUTHYN", "N");
		if (length(ls_DI) > 0) {
			lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
			ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY");
			medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY");
		}  
		btnAuthBIRTHDAY.Text = "실명인증";
		btnAuthBIRTHDAY.Enable = true;
		medBIRTHDAY.SetFocus();
		// 실명인증 안하고 저장했을때 실명인증안된거는 N으로 표시해주기 위해...?
		//ds_ioExamJubsu.SetColumn(0, "AUTHYN", "N");
		gfn_Alert("[실명인증오류]이름 및 주민등록번호를 확인하세요");
	}		
}

/*
function lfn_personkey()
{
	ds_ioProfessor.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();

	tit_addCsvSearchActionInfo("training:searchExamConfirm", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_ioProfessor=ds_oProfessor ds_oProfessor=ds_ioExamJubsu"	// outDs

		,"JIBU=" + quote(cbxJibu.Value)

		+ " FROMDT=" + quote(cldFromdt.Value)
		
		+ " TODT=" + quote(cldTodt.Value)

		+ " EASTATUS=" + quote(cbxStatus.Value)	// args
		
		+ " PERSONNM=" + quote(edSPersonnm.Text)
		
		+ " SITEGUBUN=" + quote(cbxKemsOnline.Value)

		,"lfn_AfterSearchExamConfirm"

		,false

	);	
}
*/

function Form_OnSize(obj,nCx,nCy,nState) {
    if (gs_IsResizingForm == "Y") {
        gdProfessor.Height = nCy - gdProfessor.Top - 4;
        gdProfessor.Width = nCx - gdProfessor.Left - 4;
    }
}

function btnSearchPersonInfo_OnClick(obj)
{
	 lfn_SearchPersonInfo(); //Personinfo 반영 2017.12.07
	 edHpTel.SetFocus();
}

function lfn_SearchPersonInfo()
{
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
	//var arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medBIRTHDAY.Value,"22"); // 고객 조회 팝업
	var arrTrainingPerson = gfn_PersonInfoListPopup(edPersonNm.Text, medBIRTHDAY.Value); // 고객 조회 팝업
	
	if (length(arrTrainingPerson) > 0) 
    {
		edPersonNm.text = arrTrainingPerson[0];   
		
		medBIRTHDAY.Value = arrTrainingPerson[33];	// 생년월일6
        ls_PERSONKEY = arrTrainingPerson[29];		// PERSONKEY 값
        medPersonKey.Value = arrTrainingPerson[29];	// PERSONKEY 값
        
        ls_DI = arrTrainingPerson[30];			// DI 값
        ls_CI = arrTrainingPerson[31];			// CI 값
        ls_CIVER = arrTrainingPerson[32];		// CI버전
		ls_BIRTHDAY7 = arrTrainingPerson[33];	// 생년월일7자리  
		
		ms_TrainingPersonMgno = arrTrainingPerson[2];
        
        ds_ioExamJubsu.SetColumn(0, "EATPMGNO", arrTrainingPerson[2]);        
        
        edTel.Text = arrTrainingPerson[3];
        
        edHpTel.Text = arrTrainingPerson[4];
        
        ds_ioExamJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);
        
        medZipCode.Value = arrTrainingPerson[12];
        
        edAddr1.text = arrTrainingPerson[13];
        
        edAddr2.text = arrTrainingPerson[14];
        
        ds_ioExamJubsu.SetColumn(0, "EARPNUCD", arrTrainingPerson[18]);			// TPRPNUCD
        
        ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrTrainingPerson[19]);	// TPRROADBUILDMGNO
        
        ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrTrainingPerson[20]);	// TPRROADDETAIL
        
        ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", arrTrainingPerson[21]);	// TPRROADREMAIN
        
        ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrTrainingPerson[22]);		// TPRSANGUBUN
        
        ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrTrainingPerson[23]);		// TPRMAINBUNJI
        
        ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrTrainingPerson[24]);		// TPRSUBBUNJI
        
        ds_ioExamJubsu.SetColumn(0, "EARBUILDNM", arrTrainingPerson[25]);		// TPRBUILDNM
        
        ds_ioExamJubsu.SetColumn(0, "EARADDRETC", arrTrainingPerson[26]);		// TPRADDRETC
                
        if (arrTrainingPerson[17] == "1") 
        {	// 주소구분이 도로명주소이면
        
			ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", arrTrainingPerson[27]);	// TPRCONVPGM
			
			ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", arrTrainingPerson[28]);	// TPRCONVSTATUS

		}                
     
		 //실명인증 버튼
		 var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부
		 if (ls_AuthYn == "Y") 
		 {
			ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");
			btnAuthBIRTHDAY.Enable = false;
			btnAuthBIRTHDAY.Text = "실명인증완료";
			edAddr1.SetFocus();
		} else {
			btnAuthBIRTHDAY.Enable = true;
			btnAuthBIRTHDAY.Text = "실명인증"; 
			btnAuthBIRTHDAY_OnClick();
		}
		
		// 최근사진		
		if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ")) || ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") == '0') {
			imgLastestPicture.Text = "최근사진";
			imgLastestPicture.ImageID = "";
		} else {
			imgLastestPicture.Text = "";
			imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];
		}
	
		// DI 값이 있으면 //----수정부분---- start
		if (length(ls_DI) > 0) {
			if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
				edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
				medBIRTHDAY.Readonly = true;
			} else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
				edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
				medBIRTHDAY.Readonly = true;
			} else {
				edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
				medBIRTHDAY.Readonly = false;
			}
		}
	}  
}

// 1. 조회
function lfn_Search(obj)
{
	ifn_ExamConfirm();
	
	//imgPicture.Visible = true;
	
	edCheckCount.Value = 0;
	//imgPicture.Visible = false;

}

function ifn_ExamConfirm()
{
	ds_ioProfessor.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();

	tit_addCsvSearchActionInfo("training:searchExamConfirm", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_ioProfessor=ds_oProfessor ds_oProfessor=ds_ioExamJubsu"	// outDs

		,"JIBU=" + quote(cbxJibu.Value)

		+ " FROMDT=" + quote(cldFromdt.Value)
		
		+ " TODT=" + quote(cldTodt.Value)

		+ " EASTATUS=" + quote(cbxStatus.Value)	// args
		
		+ " PERSONNM=" + quote(edSPersonnm.Text)
		
		+ " SITEGUBUN=" + quote(cbxKemsOnline.Value)

		,"lfn_AfterSearchExamConfirm"

		,false

	);	
}

function lfn_AfterSearchExamConfirm(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;
    }    
    
    var currow = ds_ioProfessor.GetCurrow();
    var EAMGNO = ds_ioProfessor.GetColumn(currow, "EAMGNO");
    var EATPMGNO = ds_ioProfessor.GetColumn(currow, "EATPMGNO");

    if(ds_ioProfessor.GetRowCount() > 0)
    {
		search_eamgno(EAMGNO, EATPMGNO);
	}
	else {
		lbModetest.Text = "신규입력모드";
		lbModetest.BkColor = "Coral";
		
		btnSave.Enable = true;
		btnDelete.Enable = true;
		btnApprove.Enable = true;
		btnReject.Enable = true;
	}
	
	if (cbxForm.Value == "0048") 
	 {		
		ds_ioExamJubsu.GetColumn(0, "ATC0048");
		
		if (ds_ioExamJubsu.GetColumn(0, "ATC0048") == "0" ||
			ds_ioExamJubsu.GetColumn(0, "ATC0048") == "X") {
			edFormResult.Text = "미등록";
		} else {
			edFormResult.Text = "완료";
		}
	}
	
	medSearchCnt.Value = ds_ioProfessor.GetRowCount();
}

// 신규
function lfn_Input(obj)
{	
	if (!gfn_Confirm(MSGI00070)) { // 신규 추가 하시겠습니까?\n입력완료 후 저장 버튼을 누르세요.

	return false;

	}
	
	ds_ioExamJubsu.ClearData();
	ds_ioExamJubsu.AddRow();
	    // 사진
    imgLastestPicture.ImageID = "";
    imgLastestPicture.Text = "최근사진";
    imgPicture.ImageID = "";
    imgPicture.Text = "사진";
	
	edStatus.Text = "신청";
	lbModetest.Text = "신규입력모드";
	lbModetest.BkColor = "coral";
	btnAuthBIRTHDAY.Enable = true;
	btnAuthBIRTHDAY.Text = "실명인증";
	btnSearchPersonInfo.Enable = true;

	mb_IsNewData = true; // 저장버튼이 클릭 설정
	cldEADATE.Value = today();
	edfileNm.Text = ""; // 초기화 
	edfilePath.Text = ""; // 초기화
	edFormResult.Text = "미등록"; // kems에서는 신규할때 미등록으로 설정 
	
	gfn_SearchJibu(cbx_Jibu, "Y", ""); // 지부 코드 조회
	cldEADATE.Enable = true;
	cbxCourse.Enable = true;
	edHpTel.Enable = true;
	edTel.Enable = true;
	edAddr1.Enable = true;
	cbxJubsuGubun.Enable = true;
		
	
	
    ls_DI = "";			// SCI DI 값
	ls_CI = "";			// SCI CI 값
	ls_CIVER = "";		// SCI CI버전
	ls_PERSONKEY = "";	// PERSONKEY 값
	ls_BIRTHDAY = "";	// 조회시 주민번호
	ls_BIRTHDAY7 = "";	// 생년월일7자리    
		
	edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
	medBIRTHDAY.Readonly = false;
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

/*
function lfn_Personkey_Check()
{
	ds_Personkey.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();

	tit_addSearchActionInfo("training:searchExamConfirm_PersonKey", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_Personkey=ds_Personkey"	// outDs

		,"PERSONNM=" + quote(edPersonNm.Text)

		+ " BIRTHDAY=" + quote(medBIRTHDAY.Value)
		
		+ " PHP=" + quote(edHpTel.Text)

		,"lfn_AfterSearchExamConfirm_PersonKey"

		,false
		
		, ""
		
		, true

	);	
	
	if(ds_Personkey.GetRowCount() > 0 )
	{
		return true;
	}
	else 
	{
		return false;
	}
}
*/

// 저장
function lfn_Save(obj)
{
	var TCCOURSENM = "";
	var EASTATUSNM = "";
	var PNM = "";
	
	
	if (edImsiEAMGNO.Text <> "") 
	{
		if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      
        return false;
		}
	}
    
    if(edImsiEAMGNO.Text != "")
    {
		if(ds_ioProfessor.GetColumn(ds_ioProfessor.currow, "EASTATUS") <> 1)
		{
			gfn_Alert("신청단계에서만 수정이 가능합니다.");
			return false;
		}
	}
	
	if(cbxJubsuGubun.Value == "" || cbxJubsuGubun.Value == null)
	{
		gfn_Alert(" 응시자격을 반드시 선택해야 합니다.");
		return false;
	}
	
	// DI가 없는경우 실명확인 후 저장//  personkey가 없으면	
	if (gfn_IsNull(ls_DI) || gfn_IsNull(medPersonKey.Value) || medPersonKey.Value == "NON-MATCH") {
		lfn_AuthBIRTHDAY();
		
		if (gds_ioSciCheck.GetColumn(0, "STRRESULT") <> "1") {
		
			if (!gfn_Confirm("실명확인 오류 입니다. 강제로 저장 하시겠습니까?\n\n" +
							 "* 오류내용 : " + gds_ioSciCheck.GetColumn(0, "STRCI2"))) {
				medBIRTHDAY.SetFocus();
				return false;
			} else {
				// 실명확인 오류시 DI값에 오류코드 3자리 입력
				//ls_DI = gds_ioSciCheck.GetColumn(0, "STRRETUNCODE");
				ls_DI = "";
			}
		}
	}

	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EAMGNO"))) // 신규
	{  
		if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IIIMGBINARY"))) {  // 사진을 선택하지 않아 없을 경우 바이너리 값을 null로 하여 패키지 호출함(패키지 에러방지)  
			ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", "");    
		}
		
		if(cbxCourse.Value == "22" or cbxCourse.Value == "23")
		{
			/***********************************************************************/
			lfn_ExamAcceptFiveSearch(); 
			// 2급,3급 신청할때 ' 공공기관 ' 수료내역 있으면 응시자격 접수없이 시험접수가 가능하다. 
			// 그러므로, 별도로 응시자격을 안해도된다고 알림
			/***********************************************************************/	
			if(ds_examaccept_five.GetRowCount() > 0)
			{
				TCCOURSENM = ds_examaccept_Five.GetColumn(0, "TCCOURSENM");
				PNM = ds_examaccept_Five.GetColumn(0, "LPERSONNM");
				
				gfn_Alert(""+PNM+"님은 "+TCCOURSENM+" 수료 내역이 있습니다. \n\n"+
							 "별도의 응시자격심사 없이 시험접수가 가능합니다.");
				return false;
			}
		}		
		
		// ①. 신청등급과 동일 등급의 자격을 보유한 경우 ( 메세지팝업 --> 접수불가 )
		ifn_ExamAcceptFirstSearch();
		/************************************************************************/
		if(ds_examaccept_first.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept_first.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_first.GetColumn(0, "LPERSONNM");
			gfn_Alert(""+PNM+"님은 "+TCCOURSENM+" 자격을 취득하셨습니다.");
			return false;
		}
		/************************************************************************/
		
		// ②. 접수자가 동일 or 상위등급의 시험접수 이력이 있는 경우
		lfn_ExamAcceptSearch(); 
		/***********************************************************************/
		if(ds_examaccept.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept.GetColumn(0, "CCOURSENM");
			TCCOURSENM2 = ds_examaccept.GetColumn(0, "CCOURSENM_CHECK");
			PNM = ds_examaccept.GetColumn(0, "EJPERSONNM");
									
			/// OOO님은 1급소방안전관리자 시험 응시이력이 있습니다.
			/// 별도의 응시자격심사 없이 시험접수가 가능합니다.
			gfn_Alert(""+PNM+"님은 "+TCCOURSENM+" 시험 응시이력이 있습니다. \n\n"+
					  "별도의 응시자격심사 없이 시험접수가 가능합니다.");
					  
			return false;
		}
		

		
		
		/***********************************************************************/
			
		// ③. 신청등급의 상위등급의 자격증을 보유한 경우가 있는지 Select
		lfn_ExamAcceptTwoSearch(); 
		/***********************************************************************/
		if(ds_examaccept_two.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept_two.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_two.GetColumn(0, "LPERSONNM");
		
			if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 자격을 보유중입니다.\n\n"+
					  "그래도 계속 접수하시겠습니까?"));
			return false;
		}
		
		/***********************************************************************/
		//④. 이미 동일한 직능으로 접수건이 존재하는 경우 저장 하지 못하게 한다. 
		lfn_ExamAcceptTreeSearch();
		/***********************************************************************/
		if(ds_examaccept_tree.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept_tree.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_tree.GetColumn(0, "LPERSONNM");
			var CCOURSECD = ds_examaccept_tree.GetColumn(0, "CCOURSECD");
			
			if(CCOURSECD == cbxcourse.Value)
			{
				if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 응시자격 심사 진행중입니다.\n\n"));
				return false;
			}
			else if(CCOURSECD < cbxcourse.Value)
			{
				if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 응시자격 심사 진행중입니다.\n\n"+
								"현재 신청 직능보다 상위 직능입니다. 그래도 신청하시겠습니까?."));
			}	
		}
		/***********************************************************************/
		lfn_ExamAcceptSWSearch();
		// 상급응시자격심사를 받은상태에서 --> 하위를 신청하려고 할때
		/***********************************************************************/
		if(ds_examaccept_SW.GetRowCount() > 0)
		{
			var HCCOURSECD = cbxCourse.Text;
			TCCOURSENM = ds_examaccept_SW.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_SW.GetColumn(0, "LPERSONNM");
			var EATCCOURSECD = ds_examaccept_SW.GetColumn(0, "EATCCOURSECD");
			EASTATUS = ds_examaccept_SW.GetColumn(0, "EASTATUS");
			
			if(eastatus == 3 and EATCCOURSECD == cbxcourse.Value )
			{
				gfn_Alert(""+PNM+"님은 이미 동일직능으로 심사승인 처리 되었습니다.");
				return false;
			}
			else {
			
				gfn_Alert(""+PNM+"님은 "+HCCOURSECD+" 보다 상위등급을 \n\n"+
						  "심사 승인 받았습니다, 신청하지 않으셔도 됩니다.");
				return false;
			}
		}

         // 기본정보, 실명 인증 하지 않고 저장시 개인정보 유무 체크 안하고 저장시 무결성 오류 발생 해결위함
         //  강습자관리번호 없을 경우 한번 체크하여 동일자가 있을 경우 값을 넣어줌  
        if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"))) {        
            //lfn_searchTraingPerson();      구버전.. 
            lfn_searchPerson(edPersonNm.Text, ls_DI, left(medBIRTHDAY.Value,7), replace(edHpTel.Text,"-","")); //  개인정보 조회  personinfo....
            ds_ioExamJubsu.SetColumn(0, "EATPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));
        }   
		
		if (!gfn_Confirm("저장 하시겠습니까?")) {
			return false;
		} 
			   
		if(cbxjibu.Value != gds_oUserInfo.GetColumn(0, "PDEPTCD"))
		{
			if (!gfn_Confirm("타지부 접수입니다. 접수 저장하시겠습니까?")) {
				return false;        
			}
		}		

		ls_ServiceName = "training:insertExamJubsuConfirm";
		ls_CallBackServiceName = "lfn_AfterInsertExamJubsuConfirm";
		sArg = "IsNewPictureYn=" + quote(iif(lb_FileUpload, "Y", "N"));    
	} 
	else 
	{
		if (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EAMGNO")) // 신규가 아니면서
					&& (ds_ioExamJubsu.GetOrgColumn(0, "PERSONNM") <> ds_ioExamJubsu.GetColumn(0, "PERSONNM"))
					&& (ds_ioExamJubsu.GetOrgColumn(0, "BIRTHDAY") <> ds_ioExamJubsu.GetColumn(0, "BIRTHDAY"))
				) {
			gfn_Alert("수강자(성명과 주민등록번호)를 변경하실 수 없습니다.");
			
			return false;
				
		}
		
		if(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(), "EASTATUS") <> 1 )
		{
			gfn_Alert(" 수정은 [신청단계]에서만 가능합니다. \n\n");
			      return false;
		}
		
		
		if (!gfn_Confirm("수정 하시겠습니까?")) {
			return false;
		}
		
		ls_ServiceName = "training:updateExamJubsuConfirm";
		ls_CallBackServiceName = "lfn_AfterInsertExamJubsuConfirm";
		
		lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.
		
		sArg = "IsChangedJubsuInfoYn=" + quote(ls_IsChangedJubsuInfoYn);
        sArg += " IsChangedSeatNoYn=" + quote(ls_IsChangedSeatNoYn);
        sArg += " IsChangedPictureYn=" + quote(ls_IsChangedPictureYn);
		
	}
	
	ds_ioExamJubsu.SetColumn(0, "DI", ls_DI);
	ds_ioExamJubsu.SetColumn(0, "CI", ls_CI);
	ds_ioExamJubsu.SetColumn(0, "CIVER", ls_CIVER);	
	ds_ioExamJubsu.SetColumn(0, "PERSONKEY", iif(length(ls_PERSONKEY)==10, ls_PERSONKEY, ""));
    ds_ioExamJubsu.SetColumn(0, "PRNO", medBIRTHDAY.Value);
    ds_ioExamJubsu.SetColumn(0, "BIRTHDAY7", iif(gfn_IsNull(ls_BIRTHDAY7), substr(medBIRTHDAY.Value,0,7), ls_BIRTHDAY7));
	
	ds_oExamJubsuResult.ClearData(); // 결과 데이타셋 초기화
    
    if (lb_FileUpload) { // 사진등록인 경우(파일 업로드일 경우)
        tit_FileWrite(
            hfImage
            , ls_FileUploadPath
            , fdImage.FilePath
            , fdImage.FileName
            , ls_UploadRealName
            , "U"
            , true
        );
        hfImage.CloseFile();
    }
    		
	tit_clearActionInfo();
	tit_addSingleActionInfo(ls_ServiceName, "", 0, "");
	// 서버 호출
	tit_callService(
		""
		,""
		,"ds_ioExamJubsu=ds_ioExamJubsu"    // inDs
		,"ds_oExamJubsuResult=ds_oExamJubsu"    // outDs
		,sArg    // args
		,ls_CallBackServiceName
		,false
		,false
		,true
	);	
}

function lfn_SaveModifyHistory(sGubun) {

	if (sGubun = "U") 
	{ // 수정
        var ln_TotalCount = ds_oModifyColumn.GetCount();
        var ls_ColumnCd = "";
        var ls_ColumnNm = "";
        for (var i = 0; i < ln_TotalCount; i++) 
        {
            ls_ColumnCd = ds_oModifyColumn.GetColumn(i, "COLUMNCD");
            ls_ColumnNm = ds_oModifyColumn.GetColumn(i, "COLUMNNM");

            if (ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd) <> ds_ioExamJubsu.GetColumn(0, ls_ColumnCd)) 
            {
                gds_iModifyHistory.InsertRow(0);
                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값
                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_ColumnNm); // 변경 컬럼명
                if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", substr(ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd),0,7)); // 변경 전 값
                } else {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ds_ioExamJubsu.GetOrgBuffColumn(0, ls_ColumnCd)); // 변경 전 값
				}
                if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", substr(ds_ioExamJubsu.GetColumn(0, ls_ColumnCd),0,7)); // 변경 후 값
                } else {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ds_ioExamJubsu.GetColumn(0, ls_ColumnCd)); // 변경 후 값
				}
                
                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            }
		}
	}
	
	// 사진 변경
	if (lb_FileUpload || ls_OldPictureNo <> ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ")) {
		gds_iModifyHistory.InsertRow(0);
		gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "시험접수"); // 업무구분
		gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
		gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioExamJubsu.GetColumn(0, "EJMGNO")); // KEY값
		gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "사진"); // 변경 컬럼명
		gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldPictureNo); // 변경 전 값
		gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", iif(lb_FileUpload, ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1, ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"))); // 변경 후 값

		if (lb_FileUpload) {
			ls_IsChangedPictureYn = "Y"; // 사진 변경여부
			ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
		} else {
			ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
		}
	}
}

// 저장시 실명인증
function lfn_AuthBIRTHDAY() {
    ls_PassSavePrintYN = "";	// 저장을 한것인지 응시원서를 출력한 것인지 구분하는 플래그 시험응시 가능기간 함수를 공통으로 사용위함
    ls_jubsuPossible = "N";		//접수가능여부 Y:가능 N:불가능
    
    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medBIRTHDAY.Value)) {
        gfn_Alert("성명과 주민번호를 입력해 주십시오.");
        return false;
    }
	
	// 실명인증 및 personkey 조회
	ls_PERSONKEY = gfn_SearchPERSONKEY(edPersonNm.Text, medBIRTHDAY.Value, replace(edHpTel.Text,"-",""));
	ls_DI = gds_ioSciCheck.GetColumn(0, "STRDUP");
	ls_CI = gds_ioSciCheck.GetColumn(0, "STRCI");
	ls_CIVER = gds_ioSciCheck.GetColumn(0, "STRVER");
	medPersonKey.Value = ls_PERSONKEY; // PERSONKEY값
	
	if (gds_ioSciCheck.GetColumn(0, "STRRESULT") == "1") {
        btnAuthBIRTHDAY.Text = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
        ds_ioExamJubsu.SetColumn(0, "AUTHYN", "Y");
       ///////////////////// 기본정보 클릭 않고 실명 인증시  인증 후 개인정보 조회 하여 상세 내용 나오게 함
        if(ls_PERSONKEY == "" || ls_PERSONKEY == null)
        {
			gfn_Alert("개인식별번호가 저장 후 자동 채번 됩니다.");
        }
        else if (gfn_Alert(ls_PERSONKEY)) 
        {
			lfn_searchPerson(edPersonNm.Text, ls_DI); //  개인정보 조회  personinfo....    
			ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // 개인식별번호            
			medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY"); // PERSONKEY 값
			ls_BIRTHDAY7 = ds_ioExamPerson.GetColumn(0, "BIRTHDAY7"); // 생년월일7
		}

        ds_ioExamJubsu.SetColumn(0, "EATPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));

    } else {
        
		ds_ioExamJubsu.SetColumn(0, "AUTHYN", "N");	
    
		if (length(ls_DI) > 0) {
			lfn_searchPerson(edPersonNm.Text, ls_DI); // 개인정보 조회
			ls_PERSONKEY = ds_ioExamPerson.GetColumn(0, "PERSONKEY");
			medPersonKey.Value = ds_ioExamPerson.GetColumn(0, "PERSONKEY");
			ls_BIRTHDAY7 = ds_ioExamPerson.GetColumn(0, "BIRTHDAY7"); // 생년월일7
		}
        
        btnAuthBIRTHDAY.Text = "실명인증";
        btnAuthBIRTHDAY.Enable = true;
        medBIRTHDAY.SetFocus();

    }
       
}


function lfn_ExamAcceptSearch()
{
	ds_examaccept.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamAccept", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,""
		,""											  // inDs
		,"ds_examaccept=ds_examaccept"				  // outDs
		,"PERSONKEY=" + quote(medPersonKey.Value)	  // personkey
		+ " CCOURSECD=" + quote(cbxCourse.Value)   	  // 직능
		+ " TPMGNO=" + quote(edImsiEATPMGNO.Text)     // TPMGNO 
		,""
		,false
		,""
		,true
	);
}

function ifn_ExamAcceptFirstSearch()
{	
	ds_examaccept_first.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamAccept_first", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,""
		,""											  // inDs
		,"ds_examaccept_first=ds_examaccept_first"	  // outDs
		,"TPMGNO=" + quote(edImsiEATPMGNO.Text)		  // 강습관리번호
		+ " COURSECD=" + quote(cbxCourse.Value)   	  // 직능
		+ " PERSONKEY=" + quote(medPersonKey.Value)   // personkey
		,""
		,false
		,""
		,true
	);
}

function lfn_ExamAcceptTwoSearch()
{	
	ds_examaccept_two.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamAccept_two", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,""
		,""											  // inDs
		,"ds_examaccept_two=ds_examaccept_two"	 	  // outDs
		,"TPMGNO=" + quote(edImsiEATPMGNO.Text)		  // 강습관리번호
		+ " COURSECD=" + quote(cbxCourse.Value)   	  // 직능
		+ " PERSONKEY=" + quote(medPersonKey.Value)   // personkey
		,""
		,false
		,""
		,true
	);
}

function lfn_ExamAcceptTreeSearch()
{	
	ds_examaccept_tree.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamAccept_tree", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,"" 
		,""											  // inDs
		,"ds_examaccept_tree=ds_examaccept_tree"	  // outDs
		,"TPMGNO=" + quote(edImsiEATPMGNO.Text)		  // 강습관리번호
		+ " COURSECD=" + quote(cbxCourse.Value)   	  // 직능
		,""
		,false
		,""
		,true
	);
}

function lfn_ExamAcceptSWSearch()
{
	ds_examaccept_sw.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamAccept_sw", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,""
		,""											  // inDs
		,"ds_examaccept_SW=ds_examaccept_SW"				  // outDs
		,"PERSONKEY=" + quote(medPersonKey.Value)	  // personkey
		+ " CCOURSECD=" + quote(cbxCourse.Value)   	  // 직능
		+ " TPMGNO=" + quote(edImsiEATPMGNO.Text)     // TPMGNO 
		,""
		,false
		,""
		,true
	);
}

function lfn_ExamAcceptFiveSearch()
{
	ds_examaccept_Five.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:serchExamAcceptFive", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,""
		,""											  // inDs
		,"ds_examaccept_Five=ds_examaccept_Five"	  // outDs
		,"PERSONKEY=" + quote(medPersonKey.Value)	  // personkey
		+" EAYEAR=" + quote(left(cldEADATE.Value,4))   	  // 직능
		,""
		,false
		,""
		,true
	);
	
	trace(left(cldEADATE.Value,4));
	trace(medPersonKey.Value);
	trace("!@!@!@!@!@");
}

function lfn_AfterInsertExamJubsuConfirm(nErrorCode, strErrorMsg) 
{
    if (nErrorCode != 0) 
    { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    gfn_SaveMessage(); // 저장 메세지를 처리한다.
    lb_FileUpload = false;
	ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부
    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부
    ls_IsChangedPictureYn = "N"; // 사진 변경여부
    lfn_Search();
}
    

//personkey 2017.12.11
function lfn_searchPERSON(sNM, sDI, sBirthday, sHP) {
/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면
/////////////////// 값을 미리 넣어주기 위해 강습자관리번호를 검색함
    ds_ioT_E_L_JubsuCheck.ClearData();
    
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchPersonInfo", false);
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioExamPerson=ds_oTrainingPerson"	// outDs
        , "TPNM=" + quote(sNM) // 성명 
        + " DI=" + quote(sDI) // DI값
        + " BIRTHDAY=" + quote(sBirthday) // DI값
        + " HP=" + quote(replace(replace(replace(replace(sHP,"-",""),".",""),",","")," ","")) // DI값
        // args
        ,""
        ,false
        ,false
        ,true
    );  
}

function lfn_confirm_check(nRow)
{
	ds_ConfirmCheck.ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchExamAccept_ConfirmCheck", false);  //personkey..    
	// 서버 호출 
	tit_callService(
		""
		,"" 
		,""									   // inDs
		,"ds_ConfirmCheck=ds_ConfirmCheck"	  // outDs
		,"PERSONKEY=" + quote(ds_ioProfessor.GetColumn(nRow, "PERSONKEY"))		// 강습관리번호
		+" CCOURSECD=" + quote(ds_ioProfessor.GetColumn(nRow, "EATCCOURSECD"))	// 직능
		,""
		,false
		,"lfn_AfterConfirmCheck"
		,true
	);	
}

function lfn_AfterConfirmCheck(nErrorCode, strErrorMsg)
{
	if(nErrorCode != 0)
	{
		//트랜젝션 에러를 처리한다.
		gfn_ErrorMsg(nErrorCode, strErrorMsg);
		return;
	}
}

function lfn_AfterDeleteExamConfirm(nErrorCode, strErrorMsg) 
{
    if (nErrorCode != 0) 
    { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
}

function save_mod(EAMGNO, EATPMGNO, REMARK, STATUS)
{
	tit_clearActionInfo();
	tit_addSingleActionInfo("training:updateExamJubsuConfirm_buttoncheck", "", 0, "");
	// 서버 호출
	tit_callService(
		""
		,""
		,""    // inDs
		,""    	// outDs
		,"EAMGNO=" + quote(EAMGNO)
		  + " EATPMGNO=" + quote(EATPMGNO)	// args
		  + " REMARK=" + quote(REMARK)
		  + " EASTATUS=" + quote(STATUS)
		,"lfn_AfterInsertExamJubsuConfirm_Mod"
		,false
		,false
		,true
	);	
}

function lfn_AfterInsertExamJubsuConfirm_Mod(nErrorCode, strErrorMsg) 
{
    if (nErrorCode != 0) 
    { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }    
}

function lfn_SMSCheck(EASTATUS, row)
{
	lfn_SMSSend(EASTATUS, row); 
}
// 문자발송
function lfn_SMSSend(aStatus, row)
{	
	var args = "";
 				
	if (gfn_isNull(edHpTel.Text)) {	// 휴대폰번호 확인 
		return false;
	}
				
	var sFcmgno = "";
	var sFcseq = "";
	var sMbccd = ""; // 업무구분코드 
	var sMsg = "";
	
	if(aStatus == "3"){ //승인완료 : 
		
	    sMbccd = "709"; // 업무구분코드 (709:응시자격-심사승인)
		sMsg = "[한국소방안전원]\n"+
				"신청하신 응시자격심사가 승인되었습니다.\n"+
				"한국소방안전원 홈페이지에서 시험신청이 가능합니다.";
	}
	if(aStatus == "4"){ //반려 :   
	    sMbccd = "710"; // 업무구분코드 (710:응시자격-심사반려)
		sMsg = "[한국소방안전원]\n"+
				"신청하신 응시자격심사가 반려 되었습니다.\n"+
				"반려사유 : " + ds_ioProfessor.GetColumn(row,"EAREASON") + "\n"+
				"한국소방안전원 홈페이지에서 확인하시기 바랍니다.";
	}
	if(aStatus == "5"){ //보완 :   
	    sMbccd = "711"; // 업무구분코드 (711:응시자격-심사보완)
		sMsg = "[한국소방안전원]\n"+
				"신청하신 응시자격심사가 보완요청 되었습니다.\n"+
				"보완요청 사유 : " + ds_ioProfessor.GetColumn(row,"EAMODREASON")+"\n"+
				"한국소방안전원 홈페이지에서 보완 후 재신청 바랍니다.";
	}
	
	args += " MTITLE=" + quote("한국소방안전원 응시자격 심사안내");		// 제목
	args += " MRECVTEL=" + quote(replace(edHpTel.Text, "-", ""));	// 휴대폰번호
	args += " MCALLBACK=" + quote(mid(replace(gds_oSameUserInfo.GetColumn(0, "TEL"), "-", ""), 0, 10));	// 회신번호 - 로그인한 사용자의 대표번호 
	args += " MMSG=" + quote(sMsg);  // 전문
	//args += " ETC1=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD"));		// 지부코드
	args += " MBCCD=" + quote(sMbccd);		// 업무구분코드
	args += " MPK1=" + quote(sFcmgno);		// 
	args += " MPK2=" + quote(sFcseq);		// 
	args += " MPK3=''";		// 
	args += " MRECVNM=" + quote(edPersonNm.Text);		// 수신자명
	args += " MSENDTYPE='0'";		// 발송구분(0:즉시,1:예약)
	args += " MSENDDATE=''";			// 발송시간 예약일 경우만
			 
	//MMS문자발송
	tit_clearActionInfo();
	tit_addSingleActionInfo("com:insertKTSMSSend", "", 0, "");
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_status=ds_status"	// outDs
		,args // args 
		,""
		,false
	);
}

function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면
        if (nChar == 13) {
            btnAuthBIRTHDAY.SetFocus();
            //lfn_SearchPersonNm();
            lfn_SearchPersonInfo();  //Person
        } else {
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"))) {
                //lfn_ResetPerson();
                medBIRTHDAY.Value = "";
            }
        }
    }
}

function medBIRTHDAY_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13)){ // (Ctrl + C)가 아니면
        if (nChar == 13) {
			if(ds_ioExamJubsu.GetColumn(0, "AUTHYN") != "Y"){  // 이미 실명인증 되었으면 실명인증 안함
				btnAuthBIRTHDAY.SetFocus();
			    if (!gfn_IsNull(edPersonNm.Text) && !gfn_IsNull(medBIRTHDAY.Value)) {	// 성명&주민번호 입력한 경우
					if (length(medBIRTHDAY.Value) < 13) {	// 주민번호가 13자리가 아니면
						lfn_SearchPersonInfo();		// 안전원고객정보 조회
					} else {
						ls_BIRTHDAY = medBIRTHDAY.Value;
						btnAuthBIRTHDAY_OnClick(); // 실명인증					
					}
				} else {
					lfn_SearchPersonInfo();		// 안전원고객정보 조회
				}
			} else {
				//lfn_SearchPersonNm();			
				lfn_SearchPersonInfo();
			}
        } else {
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"))) {
                //lfn_ResetPerson();
            }
        }

    }
}                       

// 주소1
function edAddr1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) 
{    
    if (nChar == 13) 
    {
		var row = ds_ioProfessor.GetCurrow();
		var arrAddrInfo = gfn_PostRoadListPopup_New();
		
		if (length(arrAddrInfo) > 0) 
		{
	
			ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "1");
			medZipCode.Value = arrAddrInfo[5];									// 우편번호
			edAddr1.Text = arrAddrInfo[0];										// 도로명주소
			edAddr2.Text = arrAddrInfo[3];										// 지번주소
			ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrAddrInfo[15]);		// 산여부(0:대지, 1:산)
			ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrAddrInfo[22]);		// 주번지(지번주번지)
			ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrAddrInfo[23]);		// 부번지(지번부번지, 부번지없을 경우 0)
			ds_ioExamJubsu.SetColumn(0, "EARPNUCD", "");						// PNU 코드 : 공백
			ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrAddrInfo[8]);	// 건물관리번호
			ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrAddrInfo[1]);		// 상세주소(도로명주소)
			ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", "");					// 부가주소
			ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", "1");
			ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", "01");
		}
	}
}
	
        /*btnSearchZipCode.SetFocus();
		// 지번주소/도로명주소 조회 팝업
		var arrAddrInfo = gfn_PostRoadListPopup(cbxJibu.Value		// 지부코드
												, ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")		// 구새주소 구분[0:구주소, 1:새주소]
												, ds_ioExamJubsu.GetColumn(0, "ZIPCD")			// 구:지번 우편번호
												, ds_ioExamJubsu.GetColumn(0, "ADDR1")		// 구:지번주소1
												, ds_ioExamJubsu.GetColumn(0, "ADDR2")		// 구:지번주소2
												, ds_ioExamJubsu.GetColumn(0, "EARSANGUBUN")		// 구:산여부
												, ds_ioExamJubsu.GetColumn(0, "EARMAINBUNJI")	// 구:주번지
												, ds_ioExamJubsu.GetColumn(0, "EARSUBBUNJI")		// 구:부번지
												, ds_ioExamJubsu.GetColumn(0, "EARBUILDNM")		// 구:아파트,건물명
												, ds_ioExamJubsu.GetColumn(0, "EARADDRETC")	// 구:상세주소
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새1:도로명 우편번호
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새1:도로명주소11
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새1:도로명주소12
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADBUILDMGNO"))	// 새1:건물관리번호1
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADDETAIL"))	// 새1:상세주소1
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADREMAIN"))		// 새1:부가주소1
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새2:도로명 우편번호
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새2:도로명주소21
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새2:도로명주소22
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADBUILDMGNO"))	// 새2:건물관리번호2
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADDETAIL"))	// 새2:상세주소2
												, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADREMAIN"))	// 새2:부가주소2
												); 
	
		if (length(arrAddrInfo) > 0) {
	
			if (arrAddrInfo[0] == 0) {

				// 구주소
				ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "0");
				
				medZipCode.Value = arrAddrInfo[1];
		
				edAddr1.Text = arrAddrInfo[2];
		
				edAddr2.Text = arrAddrInfo[3];
				
				if (arrAddrInfo[11] <> "") {
					
					// 새주소
					ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "1");
					
					medZipCode.Value = arrAddrInfo[10];
					
					edAddr1.Text = arrAddrInfo[11];
					
					edAddr2.Text = arrAddrInfo[12];
					
				}
			 
				ds_ioExamJubsu.SetColumn(0, "EARPNUCD", arrAddrInfo[9]);		// PNU 코드
				
				ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", arrAddrInfo[15]);		// 부가주소
					   
				ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrAddrInfo[4]);
				
				ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrAddrInfo[5]);
				
				ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrAddrInfo[6]);
				
				ds_ioExamJubsu.SetColumn(0, "EARBUILDNM", arrAddrInfo[7]);
				
				ds_ioExamJubsu.SetColumn(0, "EARADDRETC", arrAddrInfo[8]);
				
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", "1");
					
					ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", "01");
				
				};
				
			} else {
				
				ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "1");
			
				medZipCode.Value = arrAddrInfo[10];	// 우편번호
		
				edAddr1.Text = arrAddrInfo[11];		// 도로명주소1
		
				edAddr2.Text = arrAddrInfo[12];		// 도로명주소2
				
				ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrAddrInfo[4]);		// 산여부
				
				ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrAddrInfo[5]);		// 주번지
				
				ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrAddrInfo[6]);		// 부번지
				
				ds_ioExamJubsu.SetColumn(0, "EARPNUCD", arrAddrInfo[9]);			// PNU 코드
				
				ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", arrAddrInfo[15]);		// 부가주소
		
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", "1");
					
					ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", "01");
				
				};
		
			}
	
        } else {
        
            edAddr1.SetFocus();
        }
    }
}    */



function ds_ioProfessor_CanRowPosChange(obj,nOldRow,nRow)
{
	var EAMGNO = ds_ioProfessor.GetColumn(nRow, "EAMGNO");
	var EATPMGNO = ds_ioProfessor.GetColumn(nRow, "EATPMGNO");
	edfileNm.Text = "";
	edfilePath.Text = "";
	edScanFileName.Text = "";
	edfileNm.Text = obj.GetColumn(nRow, "EAFILENM");
	edfilePath.Text = obj.GetColumn(nRow, "EAFILEPATH");
	/****************************************************************/
	
	if (obj.GetRowType(nRow) <> "insert" && nRow <> -1) {
		medPersonKey.Text = obj.GetColumn(nRow, "PERSONKEY");
		edImsiEAMGNO.Text = obj.GetColumn(nRow, "EAMGNO");
		edImsiEATPMGNO.Text = obj.GetColumn(nRow, "EATPMGNO");
		cbx_jibu.Value = obj.GetColumn(nRow, "EAMGGTMGNO");
		cldEADATE.Value = obj.GetColumn(nRow, "EADATE");
		cbxCourse.Value = obj.GetColumn(nRow, "EATCCOURSECD");
		edPersonNm.Text = obj.GetColumn(nRow, "PERSONNM");
		medBIRTHDAY.Text = obj.GetColumn(nRow, "BIRTHDAY7");
		edHpTel.Text = obj.GetColumn(nRow, "HPTEL");
		edTel.Text = obj.GetColumn(nRow, "TEL");
		medZipCode.Text = obj.GetColumn(nRow, "ZIPCD");
		edAddr1.Text = obj.GetColumn(nRow, "ADDR1");
		edAddr2.Text = obj.GetColumn(nRow, "ADDR2");
		cbxJubsugubunCheck.Value = obj.GetColumn(nRow, "EAJUBSUGUBUN2");
		cbxJubsuGubun.Value = obj.GetColumn(nRow, "EAJUBSUGUBUN");	
		
		if(obj.GetColumn(nRow, "AUTHYN") == "Y"){  // 이미 실명인증 되었으면 비활성화
			
			btnAuthBIRTHDAY.Enable = false;
			btnAuthBIRTHDAY.Text = "실명인증완료";
			
		}else {        
			btnAuthBIRTHDAY.Enable = true;
			btnAuthBIRTHDAY.Text = "실명인증";
		}
					// 최근사진	
		if (gfn_IsNull(ds_ioProfessor.GetColumn(nRow, "IILASTREALNM"))) {
			imgLastestPicture.Text = "최근사진";
			imgLastestPicture.ImageID = "";
		} else {
			imgLastestPicture.Text = "";
			imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + obj.GetColumn(nRow, "IILASTDIRPATH") + "/" + obj.GetColumn(nRow, "IILASTREALNM");
		}
	
		if(ds_ioProfessor.GetColumn(nRow, "SITEGUBUN") == "I")
		{
			edFormResult.Text = "미대상";
		}
		
		else if (ds_ioProfessor.GetColumn(nRow, "ATC0048") == "0" or ds_ioProfessor.GetColumn(nRow, "ATC0048") == "X") 
		{
			edFormResult.Text = "미등록";
		} 
		else 
		{
			edFormResult.Text = "완료";
		}
		
		ls_DI = ds_ioProfessor.GetColumn(nRow, "DI"); // DI값	
		ls_CI = ds_ioProfessor.GetColumn(nRow, "CI"); // CI값
		ls_CIVER = ds_ioProfessor.GetColumn(nRow, "CIVER"); // CI버전  
	
		edStatus.Text = ds_ioProfessor.GetColumn(nRow, "STATUSNM");
		lbModetest.Text = "수정모드";
		lbModetest.BkColor = "skyblue";
		
		radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
		edPersonNm.SetFocus();
		
	////////////////////////////////////////
		if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
		////////////////////////////////
			edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
			medBIRTHDAY.Readonly = true;
			btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
			Button0.Enable = true;  // 접수자정보변경은 활성화 함
		  
		} else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
			edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
			medBIRTHDAY.Readonly = true;
			btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
			Button0.Enable = true;  // 접수자정보변경은 활성화 함
			
		////////////////////////////////	
		} else {
		////////////////////////////////
			edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
			medBIRTHDAY.Readonly = false;
			btnSearchPersonInfo.Enable = true;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
			Button0.Enable = false;  // 접수자정보변경은 활성화 함
		////////////////////////////////
		
		}
		   
		var course = cbxCourse.Value;
		Course_Change(course);
    	  
		imgPicture.Visible = false;
		
		cbx_jibu.Enable = false;
		cldEADATE.Enable = false;
		cbxCourse.Enable = false;
		edHpTel.Enable = false;
		edTel.Enable = false;
		edAddr1.Enable = false;
		cbxJubsuGubun.Enable = false;
	}
	
	//search_eamgno(EAMGNO, EATPMGNO);
	gdProfessor.SetFocus();
		
}

function search_eamgno(EAMGNO, EATPMGNO)
{
	ds_ioExamJubsu.ClearData(); // 데이타셋 초기화
	
	tit_clearActionInfo();

	tit_addCsvSearchActionInfo("training:searchExamConfirm_Master", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_ioExamJubsu=ds_ioExamJubsu"	// outDs

		,"EAMGNO=" + quote(EAMGNO)

		+ " EATPMGNO=" + quote(EATPMGNO)
	
		,"lfn_AftersearchExamConfirm_Master"

		,false

	);
	
}

function lfn_AftersearchExamConfirm_Master(nErrorCode, strErrorMsg) 
{
    if (nErrorCode != 0) 
    { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
	
     if(ds_ioExamJubsu.GetColumn(0, "AUTHYN") == "Y"){  // 이미 실명인증 되었으면 비활성화
        
        btnAuthBIRTHDAY.Enable = false;
        btnAuthBIRTHDAY.Text = "실명인증완료";
        
    }else {        
        btnAuthBIRTHDAY.Enable = true;
        btnAuthBIRTHDAY.Text = "실명인증";
    }
    
	// 최근사진	
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IILASTREALNM"))) {
		imgLastestPicture.Text = "최근사진";
		imgLastestPicture.ImageID = "";
	} else {
		imgLastestPicture.Text = "";
		imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioExamJubsu.GetColumn(0, "IILASTDIRPATH") + "/" + ds_ioExamJubsu.GetColumn(0, "IILASTREALNM");
	}
	
	if(ds_ioProfessor.GetColumn(ds_ioProfessor.currow, "SITEGUBUN") == "I")
	{
		edFormResult.Text = "미대상";
	}
	
	else if (ds_ioExamJubsu.GetColumn(0, "ATC0048") == "0" or ds_ioExamJubsu.GetColumn(0, "ATC0048") == "X") 
	{
		edFormResult.Text = "미등록";
	} 
	else 
	{
		edFormResult.Text = "완료";
	}
	
	ls_DI = ds_ioExamJubsu.GetColumn(0, "DI"); // DI값	
    ls_CI = ds_ioExamJubsu.GetColumn(0, "CI"); // CI값
    ls_CIVER = ds_ioExamJubsu.GetColumn(0, "CIVER"); // CI버전  

	edStatus.Text = ds_ioExamJubsu.GetColumn(ds_ioExamjubsu.currow, "STATUSNM");
	lbModetest.Text = "수정모드";
	lbModetest.BkColor = "skyblue";
	
	radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
    edPersonNm.SetFocus();
    
////////////////////////////////////////
    if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
    ////////////////////////////////
        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
        medBIRTHDAY.Readonly = true;
        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
        Button0.Enable = true;  // 접수자정보변경은 활성화 함
      
	} else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBIRTHDAY.Value))) {
        edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
        medBIRTHDAY.Readonly = true;
        btnSearchPersonInfo.Enable = false;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
        Button0.Enable = true;  // 접수자정보변경은 활성화 함
        
    ////////////////////////////////	
    } else {
    ////////////////////////////////
        edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
        medBIRTHDAY.Readonly = false;
        btnSearchPersonInfo.Enable = true;  // 신규를 하기 위해 조회를 하면 기본정보로는 변경 하게 함 
        Button0.Enable = false;  // 접수자정보변경은 활성화 함
    ////////////////////////////////
    
    }
       
    var course = cbxCourse.Value;
    Course_Change(course);
}

function Course_Change(course)
{
	if(course != "")
	{
		ds_oJubsugubun.Filter("DATA2='"+course+"'");
	}
}

function cbxCourse_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 직능에 따라 응시자격구분을 셋팅한다.
	if(nOldIndex <> nNewIndex)
	{
		ds_oJubsugubun.Filter("DATA2='"+cbxCourse.Value+"'");
		cbxJubsuGubun.Value = "";
		cbxJubsugubunCheck.Value = "";
	}
}

function cbxJubsuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	var row = ds_ioProfessor.GetCurrow();

	// 항목을 변경하면 응시자격구분을 기준정보로 통해서 자동으로 입력한다.
	var Jubsugubun2 = "";
	ds_oJubsuGubun_copy.ClearData();
	ds_oJubsuGubun_copy.Copy("ds_ojubsugubun");
	ds_oJubsuGubun_copy.Filter("CD='"+strCode+"'");
	ds_oJubsuGubun_copy.GetColumn(0, "DATA3");
	ds_oJubsuGubun_copy.GetColumn(0, "DATA4");
	cbxJubsugubunCheck.Value = ds_oJubsuGubun_copy.GetColumn(0, "DATA3");
}

function btnScan_OnClick(obj)
{
	ExecProc(gs_FormScanProgram);
}

function btnScanSearch_OnClick(obj)
{
    var ls_File = split(gs_FormScanFile,"\\");
    
    fdImage2.FilePath = left(gs_FormScanFile, length(gs_FormScanFile) - length(ls_File[length(ls_file) - 1]));

    fdImage2.FileName = ls_File[length(ls_file) - 1];

    fiImageFile2.FileName = gs_FormScanFile;

    if (fiImageFile2.Open()) {

        fiImageFile2.Open("rb");



        var ln_ImageSize = fiImageFile2.GetLength();

        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
/*
        if (ln_ImageSize > 300) {

            gfn_Alert("서류 스캔파일 사이즈가 300KB를 넘겼습니다.\n 사이즈 : " + NumFormat(ln_ImageSize) + "KB");

            return false;

        }
*/
        fiImageFile2.Close();

    } else {

        gfn_Alert("서류스캔 이미지가 없습니다.");

        return;

    }



    edScanFileName.Text = fdImage2.FileName;


    lb_FormFileUpload = true;	// 서류스캔파일 등록 여부


	// 파일명 형식 : 년월일시분초+ 랜덤(3자리)
    ls_UploadFormName = GetDate() + Random(100,999) + gfn_GetFileExtensionName(fdImage2.FileName);	
}

function btnScanSave_OnClick(obj)
{
	if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EAMGNO"))) {
	
        gfn_Alert("응시자격 심사자료가 없습니다..\n\n" +
                  "자격심사 자료 조회 후 저장하세요!.");
        return;
	}

	if (edScanFileName.Text == "") {

        gfn_Alert("스캔한 파일이 없습니다!");

        return;
	
	}
	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 저장하시겠습니까?")) {

		return false;

	}
	

	ds_iFormSave.ClearData();
	
	ds_iFormSave.AddRow();
                                        
	var vPROC = "";
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	
	// 민원서류
	if (cbxForm.Value == "0048") {
		if (gfn_isNull(ds_ioProfessor.GetColumn(ds_ioProfessor.currow, "EAFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioProfessor.GetColumn(ds_ioProfessor.currow, "EAMGNO");
			vPK2 = "";
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioProfessor.GetColumn(ds_ioProfessor.currow, "EAFAMGNO");
		}
	}   

	
	ds_iFormSave.SetColumn(0, "I_PROC", vPROC);					//신규(I), 화일변경(A)
    ds_iFormSave.SetColumn(0, "I_FCCD", cbxForm.Value);			//FORMCODE.FCCD 서식관리번호(신규/화일변경 공통]
    ds_iFormSave.SetColumn(0, "I_FAMGNO", vFAMGNO);				//FormAttach.FAmgno (화일변경만)
    ds_iFormSave.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값(신규만)
    ds_iFormSave.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록(신규만)
    ds_iFormSave.SetColumn(0, "I_FRDATE", left(getDate(),8));	//보관시작일(신규만)
    ds_iFormSave.SetColumn(0, "I_PATH", ls_FormUploadPath);		//저장위치(신규 /화일변경)
    ds_iFormSave.SetColumn(0, "I_FILENM", ls_UploadFormName);	//파일명(신규 /화일변경)
    
//    TRACE(ds_iFormSave.SaveXML());
						
    ds_oFormSave.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:insertFormSave", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormSave=ds_iFormSave"    // inDs

        ,"ds_oFormSave=ds_oFormSave"    // outDs

        ,""    // args

        ,"lfn_AfterFormSave"

        ,false

        ,false

        ,true

    );	
}

function lfn_AfterFormSave(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }    
    
    if (ds_oFormSave.GetColumn(0, "O_status") == "FAIL") {    
        gfn_ErrorMsg(ds_oFormSave.GetColumn(0, "O_status"), ds_oFormSave.GetColumn(0, "O_value"));
        return false;            
    } 
    else if (ds_oFormSave.GetColumn(0, "O_status") == "SUCCESS") {
		var UploadResult = tit_FileWrite(
						hfImage2				
						, ls_FormUploadPath				
						, fdImage2.FilePath				
						, fdImage2.FileName				
						, ls_UploadFormName				
						, "U"				
						, false				
					);						
		/* Array
			0 - 성공 : S / 실패 : E / 파일크기 초과 : O
			1 - 서버에 저장된 실제 경로
			2 - 서버에 저장된 실제 파일명
			3 - 서버에 저장된 파일 사이즈
		*/
		// 성공여부 체크 && 파일사이즈 체크
		if (UploadResult[0] == "S" && UploadResult[3] == fiImageFile2.GetLength()) {			
			gfn_Alert("서류스캔파일이 정상적으로 저장되었습니다.");			
			lfn_Search();		
		} 
		else {		
			gfn_Alert("서류스캔파일 저장 시 오류가 발생했습니다.");			
			return false;
		}							
		hfImage2.CloseFile();		
	}
}


function cbx_jibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{	
	var row = ds_ioProfessor.GetCurrow();
	
	if(edImsiEAMGNO <> "")
	{
		if(ds_ioProfessor.GetColumn(row, "EASTATUS") == 1)
		{
			if(ds_ioProfessor.GetColumn(row, "SEL") == 0)
			{
				gfn_Alert("수정하려는 대상자를 선택(체크)하여야 수정가능합니다.");
				cbx_jibu.Index = nOldIndex;
				return false;
			}
		}
	}
}

function lfn_Print(obj)
{
    if (ds_ioProfessor.GetRowCount() < 1) {
        gfn_Alert("출력할 데이터가 존재하지 않습니다.");
        return;
    }
    
	if (!gfn_Confirm("출력 하시겠습니까?")) {
		return false;
	}
    
	if(obj.id == 'btnPrintAll'){
		
		if (ds_ioProfessor.currow < 0) {
			gfn_Alert("출력할 데이터를 선택해 주십시오");
			return;
		}

		    ds_ioProfessor.Filter("SEL = '1'");

			ds_ioReport.copyf(ds_ioProfessor);
	}		
	
			
	/*
	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(		
				"P"				
				, gs_CallCenterUID	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")
				, this.ID	
				, global.mnuLeft.cbxOpenForm.Text+"(신청서)"	
				, ls_HistoryArg				
			);
	}  
	*/
	
	 
	// 미리보기 후 출력 	
	gfn_CallReportPopup("frmtraining1000EXamConfirm.rex"
				  , "ds_ioReport"
				  , true);		
	
	ds_ioProfessor.UnFilter();
}

function btnApplyPicture_OnClick(obj)
{
	if (gfn_IsNull(imgPicture.ImageID)) {
        gfn_Alert("최근사진 등록을 먼저 해주십시오.");
        return false;
	}
	
	imgPicture.ImageID = imgLastestPicture.ImageID;
	imgPicture.Text = "";
	lb_FileUpload = false;
	ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ"));	
	ls_IsChangedJubsuInfoYn = "Y";  // 접수자기본정보 변경여부
}

function btnDownload_OnClick(obj)
{
	var ls_FileUploadPath = edfilePath.Text;  // /IMGDATA/ARSON/LICENSE/2022/11/
    var ls_RealFileName = edfileNm.Text; // MANUAL_20130611163213796.pdf 
    var ls_SaveFileName = edfileNm.Text; //개인정보동의서 관리 사용자설명서.pdf
    /*
    //test
    ls_FileUploadPath = "/BBSDATA";
    ls_RealFileName = "MANUAL_20130611163213796.pdf";
    ls_SaveFileName = "개인정보동의서 관리 사용자설명서.pdf";
    */
    if (length(ls_RealFileName) <= 0 || ls_RealFileName == "") {
		gfn_Alert("다운로드할 파일이 없습니다.");		
	}   
	
	var vPath = "/IMGDATA" + ls_FileUploadPath ; // "/IMGDATA/ARSON/LICENSE/2022/11/" ; 
	var vFileName = ls_RealFileName; // "encFile_1F2A36D473B608B38D879F44DB8C3677.pdf";
	var vSaveName = ls_SaveFileName; // "복호화후파일.pdf";
	//var URL = "https://intrawork.kfsi.or.kr/kems/pos/UPlusPOS_Input.jsp";
    //var URL = "http://172.19.1.17:8090/survey/encFileDown.jsp";
	var URL = "https://intrawork.kfsi.or.kr/kems/encFileDown.jsp";
	URL = URL + "?pfilePath=" + vPath +"&pFileName=" + vFileName+"&pSaveFileName=" + vSaveName  ;
	ExecBrowser(URL) ;  	
}

function btnLoadPicture_OnClick(obj)
{
    fdImage.Type = "OPEN";
    if (fdImage.open()) {
        fiImageFile = fdImage.FilePath + "\\" + fdImage.FileName;
        fiImageFile.Open("rb");
        
        var ln_ImageSize = fiImageFile.GetLength();
        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
        if (ln_ImageSize > 300) {
            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");
            return false;
        }
        
        ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        
        imgPicture.ImageID = fdImage.FilePath + "\\" + fdImage.FileName;
        imgPicture.Text = "";
        lb_FileUpload = true;
        //alert(ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ"));
        ls_UploadRealName = left(medBIRTHDAY.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);
        ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1);
        ds_ioExamJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);
        ds_ioExamJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);
        ds_ioExamJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);
    }	
    
    imgPicture.Visible = true;
}

function btnPhotoScan_OnClick(obj)
{
	PhotoScanFlag = "2";	// 사진스캔 프로그램 (1:SVP-5300프로그램, 2:D400 프로그램)
	ExecProc(gs_PhotoScanProgram);	
}

function btnScanPicture_OnClick(obj)
{
	PhotoScanFlag = "1";	// 사진스캔 프로그램 (1:SVP-5300프로그램, 2:D400 프로그램)
	ExecProc(gs_ScanProgramName);	
}

function btnLoadScanPicture_OnClick(obj)
{
    imgPicture.ImageID = "";
	imgPicture.Text = "사진";
	imgPicture.Visible = true;
	
	var ls_ScanFileName = "";

	if (PhotoScanFlag == "1") {
		ls_ScanFileName = gs_ScanFileName;	// 기존 실물화상기 파일
	} else if (PhotoScanFlag == "1") {
		ls_ScanFileName = gs_PhotoScanFile;	// 신규 사진스캐너 파일
	} else {
		ls_ScanFileName = gs_PhotoScanFile;
	}
	
    var ls_File = split(ls_ScanFileName,"\\");

    fdImage.FilePath = left(ls_ScanFileName, length(ls_ScanFileName) - length(ls_File[length(ls_file) - 1]));
    fdImage.FileName = ls_File[length(ls_file) - 1];

    fiImageFile.FileName = ls_ScanFileName;
    if (fiImageFile.Open()) {
        
        fiImageFile.Open("rb");

        var ln_ImageSize = fiImageFile.GetLength();
        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
        if (ln_ImageSize > 300) {
            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");
            return false;
        }

        ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        fiImageFile.Close();
    } else {
        gfn_Alert("스캔 이미지가 없습니다.");
        return; 
    }

    imgPicture.ImageID = ls_ScanFileName;
    imgPicture.Text = "";
    lb_FileUpload = true;

    ls_UploadRealName = left(medBIRTHDAY.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);
    ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", ds_ioExamJubsu.GetColumn(0, "LASTIMGSEQ") + 1);
    ds_ioExamJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);
    ds_ioExamJubsu.SetColumn(0, "IIREALNM",  ls_UploadRealName);
    ds_ioExamJubsu.SetColumn(0, "IISAVENM",  ls_UploadRealName);	
}

// ①. 접수시작
function btnJubsu_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 2;
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
	
	msg = "선택된 응시자격심사 내역의 접수처리 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	
	// 다중 접수취소를 할 경우 우선 신청상태부터 확인한다.
	for (var i=0; i<row; i++)
	{
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			var menu = ds_ioProfessor.GetColumn(i, "SITEGUBUN");
			
			if(eastatus <> "1")
			{
				gfn_Alert(" 선택한 내역 중 신청단계가 아닌 건이 있습니다. \n\n"
						 +" 접수처리는 [신청]단계에서만 처리가 가능합니다.");
				return false;
			}
			
			lfn_confirm_check(i);
			if(ds_ConfirmCheck.GetRowCount() > 0)
			{
				gfn_Alert(" 이미 동일직능 혹은 상위직능의 응시자격 심사가 \n\n"+
						  " 승인되었습니다. 더이상 진행 할 수 없습니다.");
				return false;
			}
		
			var IITPMGNO = ds_ioProfessor.GetColumn(i, "IITPMGNO");
			if(gfn_IsNull(IITPMGNO))
			{
				gfn_Alert(" 선택한 내역 중 " + toInteger(i+1) + " 행의 사진이 등록되지 않았습니다.\n\n "+
				            " 사진등록 후 승인 해주세요!.");
				return false;
			}

			var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
			var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
			var REMARK = "";
			save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
		}
	}
	
	 gfn_Alert("처리되었습니다.");
	 lfn_Search();
}	


// ③. 보완
function btnMod_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 5; 
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
	
	msg = "선택된 응시자격심사 내역의 보완처리를 진행하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	
	// 다중 보완을 할 경우 우선 신청상태부터 확인한다.
	for (var i=0; i<row; i++)
	{
		var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
		var menu = ds_ioProfessor.GetColumn(i, "SITEGUBUN");
		
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			if(menu <> "I")  // 보완은 SITE에서 넘어온것만 처리할 수 있도록 함
			{
				gfn_Alert(" 보완처리는 처리자(iNet)건만 할 수 있습니다.\n\n"
						 +" 선택된 건 중 iNet 데이터가 아닌 건이 있습니다.");
				return false;
			}
		
			else if(ds_ioProfessor.GetColumn(i, "EAMODREASON") == "" or  ds_ioProfessor.GetColumn(i, "EAMODREASON") == null)
			{
				gfn_Alert(" 선택한 내역 중 " + toInteger(i+1) +"행의 보완사유를 입력 후 처리하세요!.");
				return false;
			}	
			
			lfn_confirm_check(i);
			if(ds_ConfirmCheck.GetRowCount() > 0)
			{
				gfn_Alert(" 이미 동일직능 혹은 상위직능의 응시자격 심사가 \n\n"+
						  " 승인되었습니다. 더이상 진행 할 수 없습니다.");
				return false;
			}
			
			var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
			var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
			var REMARK = ds_ioProfessor.GetColumn(i, "EAMODREASON");
			save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
			lfn_SMSCheck(STATUS, i);			
		}
	}
	
	 gfn_Alert("처리되었습니다.");
	 lfn_Search();
}

// ④. 삭제
function lfn_Delete(obj)
{
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
    
	msg = "응시자격 심사 데이터를 삭제하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	// 다중 삭제 시 KEMS에서 등록한 접수건만 삭제가 가능하므로 for문으로 체크 후 진행
	for(i=0; i<ds_ioProfessor.GetRowCount(); i++)
	{
		var menu = ds_ioProfessor.GetColumn(i, "SITEGUBUN");
		var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			
		if(ds_ioprofessor.GetColumn(i, "SEL") == 1)
		{
			if(menu == "I")
			{
				gfn_Alert("처리자[iNet]건은 삭제할 수 없습니다.");
				return false;
			}
			
			else if(eastatus <> 1)  // 신청취소일때 
			{
				gfn_Alert("신청상태가 [신청]인 경우만 삭제할 수 있습니다.");
				return false;
			}
			
			else 
			{
				tit_addSingleActionInfo("training:deleteExamConfirm", "", 0, "");
				//서버 호출 
				tit_callService(
					 ""
					,""
					,""	// inDs
					,""	// outDs
					,"EAMGNO=" + quote(ds_ioProfessor.GetColumn(i, "EAMGNO")) // args 
					+ " EATPMGNO=" + quote(ds_ioProfessor.GetColumn(i, "EATPMGNO"))
					+ " EAFAMGNO=" + quote(ds_ioProfessor.GetColumn(i, "EAFAMGNO"))
					,"lfn_AfterDeleteExamConfirm"
					,false
					,false
					,true
				);			
			}
		}
	}
    
	gfn_Alert("처리되었습니다.");
	lfn_Search();    	
}

// 승인
function btnApprove_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 3;
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
	
	msg = "선택된 응시자격심사 내역을 승인처리 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
		
	for(var i=0; i<row; i++)
	{
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			
			if(eastatus <> "2")
			{
				gfn_Alert(" 선택한 내역 중 접수단계가 아닌 건이 있습니다.\n\n"
						 +" 승인처리는 접수단계에서만 가능합니다.");
				return false;
			}
			
			else if(ds_ioProfessor.GetColumn(i, "EAREMARK") == "" or  ds_ioProfessor.GetColumn(i, "EAREMARK") == null)
			{
				gfn_Alert(" 선택한 내역 중 " + toInteger(i+1) +"행의 승인사유를 입력 후 처리하세요!.");
				return false;
			}
			
			lfn_confirm_check(i);
			if(ds_ConfirmCheck.GetRowCount() > 0)
			{
				gfn_Alert(" 이미 동일직능 혹은 상위직능의 응시자격 심사가 \n\n"+
						  " 승인되었습니다. 더이상 진행 할 수 없습니다.");
				return false;
			}
				
			var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
			var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
			var REMARK = ds_ioProfessor.GetColumn(i, "EAREMARK");
			save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
			lfn_SMSCheck(STATUS, i);	
		}
	}
	
	 gfn_Alert("처리되었습니다.");
	 lfn_Search();
}

// 반려
function btnReject_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 4; // 반려
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
		
	msg = "선택된 응시자격심사 내역을 반려처리 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
		
	for(var i=0; i<row; i++)
	{
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			var menu = ds_ioProfessor.GetColumn(i, "SITEGUBUN");
			
			if(menu == "K")  // 보완은 SITE에서 넘어온것만 처리할 수 있도록 함
			{
				gfn_Alert(" 반려처리는 처리자(iNet)건만 할 수 있습니다.\n\n"
						 +" 선택된 건중 iNet 데이터가 아닌 건이 있습니다.");
				return false;
			}
						
			else if(ds_ioProfessor.GetColumn(i, "EAREASON") == "" or  ds_ioProfessor.GetColumn(i, "EAREASON") == null)
			{
				gfn_Alert(" 선택한 내역 중 " + toInteger(i+1) +"행의 반려사유를 입력 후 처리하세요!.");
				return false;
			}			
			else 
			{
				var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
				var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
				var REMARK = ds_ioProfessor.GetColumn(i, "EAREASON");
				save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
				lfn_SMSCheck(STATUS, i);	
			}
		}
	}
	
	gfn_Alert("처리되었습니다.");
	lfn_Search();
}

function btnSeverFormView_OnClick(obj)	{

	if (edFormResult.Text == "완료") {

		var sFile = split(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(), "ATC" + cbxForm.Value), "|");
		
		sArg = "sURL=" + GF_FILE_SERVER_URL + "kems"+ sFile[1];
		
		//alert(sArg);
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}	
}

function btnLocalFormView_OnClick(obj)
{
	if (!gfn_isNull(edScanFileName.Text)) {
	
		sArg = "sURL="+"C:\\KFSA\\Form.pdf";
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}	
}

function btn_Cancell_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 1;
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
		
	msg = "접수취소 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	
	// 다중 접수취소를 할 경우 우선 신청상태부터 확인한다.
	for (var i=0; i<row; i++)
	{
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			var menu = ds_ioProfessor.GetColumn(i, "SITEGUBUN");
			
			if(eastatus <> "2")
			{
				gfn_Alert(" 선택한 내역 중 접수단계가 아닌 건이 있습니다.\n\n"
						 +" 접수취소는 [접수]단계 에서만 처리가 가능합니다.");
				return false;
			}			
			else {
				var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
				var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
				var REMARK = "";
				save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
			}
		}
	}	
	
	 gfn_Alert("처리되었습니다.");
	 lfn_Search();
}

function btCanCell_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 6;
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
		
	msg = "신청취소 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	
	// 다중 접수취소를 할 경우 우선 신청상태부터 확인한다.
	for (var i=0; i<row; i++)
	{
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			var menu = ds_ioProfessor.GetColumn(i, "SITEGUBUN");
			
			if(menu == "K")  // 보완은 SITE에서 넘어온것만 처리할 수 있도록 함
			{
				gfn_Alert(" 신청취소 처리는 처리자(iNet)건만 할 수 있습니다.\n\n"
						 +" 선택된 건중 iNet 데이터가 아닌 건이 있습니다.");
				return false;
			}
			
			if(eastatus <> 1)
			{
				gfn_Alert("신청취소 처리는 [신청]단계에서만 처리할 수 있습니다.");
				return false;
			}
			
			else if(ds_ioProfessor.GetColumn(i, "EACANCELL") == "" or  ds_ioProfessor.GetColumn(i, "EACANCELL") == null)
			{
				gfn_Alert(" 선택한 내역 중 " + toInteger(i+1) +"행의 신청취소사유를 입력 후 처리하세요!.");
				return false;
			}
			
			else {
				var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
				var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
				var REMARK = ds_ioProfessor.GetColumn(i, "EACANCELL");
				save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
			}
		}
	}	

	gfn_Alert("처리되었습니다.");
	lfn_Search();	
}

function btConfirmCancell_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 2;
	
	currow = ds_ioProfessor.GetCurrow();
	row = ds_ioProfessor.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
		
	msg = "승인취소 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	
	// 다중 접수취소를 할 경우 우선 신청상태부터 확인한다.
	for (var i=0; i<row; i++)
	{
		if(ds_ioProfessor.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioProfessor.GetColumn(i, "EASTATUS");
			
			if(eastatus <> "3")
			{
				gfn_Alert(" 선택한 내역중 승인상태가 아닌건이 있습니다.\n\n"
						 +" 승인취소는 [승인]상태 에서만 취소할 수 있습니다.");
				return false;
			}
			else {
				var EAMGNO = ds_ioProfessor.GetColumn(i, "EAMGNO");
				var EATPMGNO = ds_ioProfessor.GetColumn(i, "EATPMGNO");
				var REMARK = "";
				save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
			}
		}
	}
		
	gfn_Alert("처리되었습니다.");
	lfn_Search();	
}

function gdProfessor_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	var lobj_Dataset = object(obj.BindDataset);
	if (nCell == 0) { // 선택
        if (obj.GetCellProp("head", nCell, "text") == 1) { // 전체가 이미 선택된 경우
            obj.SetCellProp("head", nCell, "text", 0);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                lobj_Dataset.SetColumn(i, "SEL", "0");
            }
        } 
        else { // 전체가 이미 선택되지 않은 경우
            obj.SetCellProp("head", nCell, "text", 1);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                
                if(ds_ioProfessor.GetColumn(i, "EASTATUS") == 6)
                {
					lobj_Dataset.SetColumn(i, "SEL", "0");
				}else {
					lobj_Dataset.SetColumn(i, "SEL", "1");
				}		
            }
        }
	} 
	else { // 헤드 정렬
        lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex);
	}
}

function btnSearchZipCode_OnClick(obj)
{
	/*var row = ds_ioProfessor.GetCurrow();
	var arrAddrInfo = gfn_PostRoadListPopup_New();
	
	if (length(arrAddrInfo) > 0) {

		ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "1");
		
		medZipCode.Value = arrAddrInfo[5];									// 우편번호
		
		edAddr1.Text = arrAddrInfo[0];										// 도로명주소
		
		edAddr2.Text = arrAddrInfo[3];										// 지번주소
		
		ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrAddrInfo[15]);		// 산여부(0:대지, 1:산)
		
		ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrAddrInfo[22]);		// 주번지(지번주번지)
		
		ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrAddrInfo[23]);		// 부번지(지번부번지, 부번지없을 경우 0)
		
		ds_ioExamJubsu.SetColumn(0, "EARPNUCD", "");						// PNU 코드 : 공백

		ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrAddrInfo[8]);	// 건물관리번호
		
		ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrAddrInfo[1]);		// 상세주소(도로명주소)
		
		ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", "");					// 부가주소
		
		ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", "1");
		
		ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", "01");
	}*/
	

	var row = ds_ioProfessor.GetCurrow();
	
	var arrAddrInfo = gfn_PostRoadListPopup_New();
	
	if (length(arrAddrInfo) > 0) {

		ds_ioExamJubsu.SetColumn(0, "EJADDRGUBUN", "1");
		medZipCode.Value = arrAddrInfo[5];									// 우편번호
		edAddr1.Text = arrAddrInfo[1];										// 도로명주소
		edAddr2.Text = arrAddrInfo[29];										// 지번주소
		ds_ioExamJubsu.SetColumn(0, "EJRSANGUBUN", arrAddrInfo[15]);		// 산여부(0:대지, 1:산)
		ds_ioExamJubsu.SetColumn(0, "EJRMAINBUNJI", arrAddrInfo[22]);		// 주번지(지번주번지)
		ds_ioExamJubsu.SetColumn(0, "EJRSUBBUNJI", arrAddrInfo[23]);		// 부번지(지번부번지, 부번지없을 경우 0)
		ds_ioExamJubsu.SetColumn(0, "EJRPNUCD", "");						// PNU 코드 : 공백
		ds_ioExamJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrAddrInfo[8]);	// 건물관리번호
		ds_ioExamJubsu.SetColumn(0, "EJRROADDETAIL", arrAddrInfo[1]);		// 상세주소(도로명주소)
		ds_ioExamJubsu.SetColumn(0, "EJRROADREMAIN", "");					// 부가주소
		ds_ioExamJubsu.SetColumn(0, "EJRCONVPGM", "1");
		ds_ioExamJubsu.SetColumn(0, "EJRCONVSTATUS", "01");
	}	
	
	/*
	var arrAddrInfo = gfn_PostRoadListPopup(cbxJibu.Value		// 지부코드
					, ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")		// 구새주소 구분[0:구주소, 1:새주소]
					, ds_ioExamJubsu.GetColumn(0, "ZIPCD")			// 구:지번 우편번호
					, ds_ioExamJubsu.GetColumn(0, "ADDR1")		// 구:지번주소1
					, ds_ioExamJubsu.GetColumn(0, "ADDR2")		// 구:지번주소2
					, ds_ioExamJubsu.GetColumn(0, "EARSANGUBUN")		// 구:산여부
					, ds_ioExamJubsu.GetColumn(0, "EARMAINBUNJI")	// 구:주번지
					, ds_ioExamJubsu.GetColumn(0, "EARSUBBUNJI")		// 구:부번지
					, ds_ioExamJubsu.GetColumn(0, "EARBUILDNM")		// 구:아파트,건물명
					, ds_ioExamJubsu.GetColumn(0, "EARADDRETC")	// 구:상세주소
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새1:도로명 우편번호
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새1:도로명주소11
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새1:도로명주소12
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADBUILDMGNO"))	// 새1:건물관리번호1
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADDETAIL"))	// 새1:상세주소1
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADREMAIN"))		// 새1:부가주소1
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ZIPCD"))	// 새2:도로명 우편번호
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR1"))		// 새2:도로명주소21
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "ADDR2"))		// 새2:도로명주소22
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADBUILDMGNO"))	// 새2:건물관리번호2
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADDETAIL"))	// 새2:상세주소2
					, iif(ds_ioExamJubsu.GetColumn(0, "EAADDRGUBUN")=="0", "", ds_ioExamJubsu.GetColumn(0, "EARROADREMAIN"))	// 새2:부가주소2
					); 
	
		trace("@@@@@@@@@@@@@@@@@@"+length(arrAddrInfo));
		
		if (length(arrAddrInfo) > 0) {
	
			if (arrAddrInfo[0] == 0) {
				
				trace("!!!");
				// 구주소
				ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "0");
				
				medZipCode.Value = arrAddrInfo[1];
		
				edAddr1.Text = arrAddrInfo[2];
		
				edAddr2.Text = arrAddrInfo[3];
				
				if (arrAddrInfo[11] <> "") {
					
					// 새주소
					ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "1");
					
					medZipCode.Value = arrAddrInfo[10];
					
					edAddr1.Text = arrAddrInfo[11];
					
					edAddr2.Text = arrAddrInfo[12];
					
				}
			 
				ds_ioExamJubsu.SetColumn(0, "EARPNUCD", arrAddrInfo[9]);		// PNU 코드
				
				ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", arrAddrInfo[15]);		// 부가주소
					   
				ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrAddrInfo[4]);
				
				ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrAddrInfo[5]);
				
				ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrAddrInfo[6]);
				
				ds_ioExamJubsu.SetColumn(0, "EARBUILDNM", arrAddrInfo[7]);
				
				ds_ioExamJubsu.SetColumn(0, "EARADDRETC", arrAddrInfo[8]);
				
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", "1");
					
					ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", "01");
				
				};
				
			} else {
			
				trace("222");
				
				ds_ioExamJubsu.SetColumn(0, "EAADDRGUBUN", "1");
			
				medZipCode.Value = arrAddrInfo[10];	// 우편번호
		
				edAddr1.Text = arrAddrInfo[11];		// 도로명주소1
		
				edAddr2.Text = arrAddrInfo[12];		// 도로명주소2
				
				ds_ioExamJubsu.SetColumn(0, "EARSANGUBUN", arrAddrInfo[4]);		// 산여부
				
				ds_ioExamJubsu.SetColumn(0, "EARMAINBUNJI", arrAddrInfo[5]);		// 주번지
				
				ds_ioExamJubsu.SetColumn(0, "EARSUBBUNJI", arrAddrInfo[6]);		// 부번지
				
				ds_ioExamJubsu.SetColumn(0, "EARPNUCD", arrAddrInfo[9]);			// PNU 코드
				
				ds_ioExamJubsu.SetColumn(0, "EARROADBUILDMGNO", arrAddrInfo[13]);	// 건물관리번호
				
				ds_ioExamJubsu.SetColumn(0, "EARROADDETAIL", arrAddrInfo[14]);		// 상세주소
				
				ds_ioExamJubsu.SetColumn(0, "EARROADREMAIN", arrAddrInfo[15]);		// 부가주소
		
				trace(gfn_IsNull(arrAddrInfo[11]));
				if (!gfn_IsNull(arrAddrInfo[11])) {	// 도로명주소1
				
					ds_ioExamJubsu.SetColumn(0, "EARCONVPGM", "1");
					
					ds_ioExamJubsu.SetColumn(0, "EARCONVSTATUS", "01");
				
				};
		
			}
	
        } else {
        
            edAddr1.SetFocus();
        }
    }*/
    
}

function btnRemark_OnClick(obj)
{
	// 개인정보 다운로드 사유 등록
	var parValue = "EAMGNO=" + quote(edImsiEAMGNO.Text)
				 + " JIBU=" + quote(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(),"EAMGGTMGNO"))
				 + " PERSONNM=" + quote(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(),"PERSONNM"))
				 + " BIRTHDAY=" + quote(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(),"BIRTHDAY"))
				 + " EATCCOURSENM=" + quote(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(),"EATCCOURSENM"));
				 
	ls_IsRemark = Dialog("training::frmtraining1000EXamConfirmPopup.xml", parValue, "1000", "432", "", -1, -1);		
}

function cbxForm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	 if (cbxForm.Value == "0048") 
	 {				
		if (ds_ioExamJubsu.GetColumn(0, "ATC0048") == "0" ||
			ds_ioExamJubsu.GetColumn(0, "ATC0048") == "X") {
			edFormResult.Text = "미등록";
		} else {
			edFormResult.Text = "완료";
		}
	}
}

function btnSearchRegPicture_OnClick(obj)
{
	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"))) {
        gfn_Alert("이미지 정보가 없습니다.");
        return;
    }
    var sArg = "sTpMgno=" + quote(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"));
    sArg += " sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sBIRTHDAY=" + quote(medBIRTHDAY.Value);
       
    var arrImage = Dialog("training::frmtraining0255PTrainingPersonPicture.xml", sArg, 536, 440, "", -1, -1); // 고객 사진 조회
    
    if (length(arrImage) > 0) {
        if (ds_ioExamJubsu.GetColumn(0, "IIIMGSEQ") <> arrImage[0]) {
            ds_ioExamJubsu.SetColumn(0, "IIIMGSEQ", arrImage[0]);
            imgLastestPicture.Text = "";
            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"
                + arrImage[1]
                + "/" + arrImage[2];
        }
    }
    	
    imgPicture.Visible = true;
}

function lfn_Cancel(obj) 
{
	lfn_InitJubsuBaseInfo(); // 접수 기본 정보 초기화
}

function lfn_InitJubsuBaseInfo() 
{
	ds_ioExamJubsu.ClearData();
	ds_ioExamJubsu.AddRow();
	    // 사진
	    
	btnAuthBIRTHDAY.Text = "실명인증";
    btnAuthBIRTHDAY.Enable = true;
        
    edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 
	medBIRTHDAY.Readonly = false;    
    imgLastestPicture.ImageID = "";
    imgLastestPicture.Text = "최근사진";
    imgPicture.ImageID = "";
    imgPicture.Text = "사진";
    btnSearchPersonInfo.Enable = true;
    
    ls_DI = "";			// SCI DI 값
	ls_CI = "";			// SCI CI 값
	ls_CIVER = "";		// SCI CI버전
	ls_PERSONKEY = "";	// PERSONKEY 값
	ls_BIRTHDAY = "";	// 조회시 주민번호
	ls_BIRTHDAY7 = "";	// 생년월일7자리    
}

function lfn_AfterSearchExamConfirm_PersonKey(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;
    }           
}

function ds_ioProfessor_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var total = toNumber(edCheckCount.Value);
	
	if(strColumnID == "SEL")
	{
		if(ds_ioprofessor.GetColumn(nRow, "SEL") == 1)
		{	
			edCheckCount.Value = toNumber(total)+1;
			medCheckCnt.Value = toNumber(total)+1;
			cldEADATE.Enable = true;
			cbxCourse.Enable = true;
			edHpTel.Enable = true;
			edTel.Enable = true;
			edAddr1.Enable = true;
			cbxJubsuGubun.Enable = true;
		}else {
				
			edCheckCount.Value = toNumber(total)-1;
			medCheckCnt.Value = toNumber(total)-1;
			cldEADATE.Enable = false;
			cbxCourse.Enable = false;
			edHpTel.Enable = false;
			edTel.Enable = false;
			edAddr1.Enable = false;
			cbxJubsuGubun.Enable = false;
		}
	}
}

function btnSearchPersonInfoChange_OnClick(obj)
{
    if (gfn_IsNull(medBIRTHDAY.Value)) {
        //old gfn_Alert("주민번호가 비어있습니다.\n'기본정보조회' 후에 사용하여 주시기 바랍니다.");
        gfn_Alert("변경할 정보가 없습니다.\n'조회' 후에 사용하여 주시기 바랍니다.");
        return;
    }
    
    if(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(), "EASTATUS") <> "1")
    {
		gfn_Alert("접수자정보변경은 신청단계에서만 처리할 수 있습니다.");
		return false;
    }
    
    if (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EAMGNO")) // 접수된 자료이면서
                && (left(GetDAte(), 8) > cldeadate.Value)
            ) {
        gfn_Alert("신청일이 지나서 변경할 수 없습니다.");
		// 시스템관리자만 변경 허용
		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") 
		{
			return false;
		}
    }

    //////////////////////
    ds_ioT_E_L_JubsuCheck.ClearData();
    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.
    tit_addCsvSearchActionInfo("com:searchT_E_L_JubsuCheck_Accept", false);
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""	// inDs
        ,"ds_ioT_E_L_JubsuCheck=ds_oT_E_L_JubsuCheck"	// outDs
        ,"TPMGNO_A=" + quote(ds_ioExamJubsu.GetColumn(0, "EATPMGNO")) // args
        ,"lfn_AfterAllJubsuSearch"
        ,false
        ,""
        ,true
    );
    
    //   COM::frmCOM1010PTrainingPersonModify.xml
    var retArr = gfn_TrainingPersonModifyPopup(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"), 
                                               ds_ioT_E_L_JubsuCheck.GetRowCount(),
                                               "X",
                                               ds_ioExamJubsu.GetColumn(0, "EAMGNO"),
                                               left(cbxCourse.Value,2));  //팝업 호출
    if (length(retArr[0]) < 1) {
        return;
    }

                  
    if(retArr[3] == "Y") {
        btnAuthBIRTHDAY.Text  = "실명인증완료";
        btnAuthBIRTHDAY.Enable = false;
    } else {
        btnAuthBIRTHDAY.Text  = "실명인증";  
        btnAuthBIRTHDAY.Enable = true;
    }
    
    var row = ds_ioProfessor.GetCurrow();
    
    gfn_Alert("정상적으로 처리되었습니다.");
    // 재조회필요
    // ds_ioProfessor_CanRowPosChange(obj, row, row);
    lfn_Search();
}

function lfn_AfterAllJubsuSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    	
}

function btnToExcel_OnClick(obj) {

    if (ds_ioProfessor.GetRowCount() < 1) {
        gfn_Alert("출력할 데이터가 존재하지 않습니다.");
        return false;
    }
    
    ds_ioProfessor.Filter("SEL=1");
    
	// 개인정보 다운로드 사유 등록
	var parValue = "sCode=1109";	// COMMON.PERSONALDOWNLOADH
		parValue += " sRowCnt=" + ds_ioProfessor.GetRowCount();
		parValue += " sTitle=" + quote(ds_ioProfessor.UserData);
	ls_IsRemark = Dialog("COM::frmCOM2100PDownloadRemark.xml", parValue, "", "", "", -1, -1);	

	if (ls_IsRemark == "" || ls_IsRemark == null || ls_IsRemark == "FAIL") {
		return false;
	}
	lfn_Excel(obj);
}



function btnImageZoom_OnClick(obj)
{
	var nRow = ds_ioProfessor.currow; 
	
	if(nRow < 0) {
		return ;
	}
	
	var sFilePath = ds_ioProfessor.GetColumn(nRow,"IILASTDIRPATH") ;
	var sRealFileName = ds_ioProfessor.GetColumn(nRow,"IILASTREALNM");
	var sSaveFileName = ds_ioProfessor.GetColumn(nRow,"IILASTREALNM"); 
	
	if(sFilePath == "" || sRealFileName == "" ){
		return ;
	} 
		
	/*
	 * 기능 : 이미지 팝업을 호출한다.
	 * parameter : sFilePath - 이미지 URL(예:/minimap)
	 *           : sRealFileName - 서버에 저장된 실제 파일 명
	 *           : sSaveFileName - 저장할 파일 명
	 * return value : 없음
	 */
	gfn_ImageViewPopup(
		sFilePath
		, sRealFileName
		, sSaveFileName				, ""	// MAP 구분		
		, "Y"	// 다운로드 여부
	); 	
}


function gdProfessor_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	ds_ioProfessor_CanRowPosChange(ds_ioProfessor,nRow,nRow);
}

function btn_masterSave_OnClick(obj)
{
	var TCCOURSENM = "";
	var EASTATUSNM = "";
	var PNM = "";

	if (edImsiEAMGNO.Text <> "") 
	{
		if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      
        return false;
		}
	}
    
    if(edImsiEAMGNO.Text != "")
    {
		if(ds_ioProfessor.GetColumn(ds_ioProfessor.currow, "EASTATUS") <> 1)
		{
			gfn_Alert("신청단계에서만 수정이 가능합니다.");
			return false;
		}
	}
	
	if(cbxJubsuGubun.Value == "" || cbxJubsuGubun.Value == null)
	{
		gfn_Alert(" 응시자격을 반드시 선택해야 합니다.");
		return false;
	}
	
	// DI가 없는경우 실명확인 후 저장//  personkey가 없으면	
	if (gfn_IsNull(ls_DI) || gfn_IsNull(medPersonKey.Value) || medPersonKey.Value == "NON-MATCH") {
		lfn_AuthBIRTHDAY();
		
		if (gds_ioSciCheck.GetColumn(0, "STRRESULT") <> "1") {
		
			if (!gfn_Confirm("실명확인 오류 입니다. 강제로 저장 하시겠습니까?\n\n" +
							 "* 오류내용 : " + gds_ioSciCheck.GetColumn(0, "STRCI2"))) {
				medBIRTHDAY.SetFocus();
				return false;
			} else {
				// 실명확인 오류시 DI값에 오류코드 3자리 입력
				//ls_DI = gds_ioSciCheck.GetColumn(0, "STRRETUNCODE");
				ls_DI = "";
			}
		}
	}

	if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EAMGNO"))) // 신규
	{  
		if (gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "IIIMGBINARY"))) {  // 사진을 선택하지 않아 없을 경우 바이너리 값을 null로 하여 패키지 호출함(패키지 에러방지)  
			ds_ioExamJubsu.SetColumn(0, "IIIMGBINARY", "");    
		}
		
		if(cbxCourse.Value == "22" or cbxCourse.Value == "23")
		{
			/***********************************************************************/
			lfn_ExamAcceptFiveSearch(); 
			// 2급,3급 신청할때 ' 공공기관 ' 수료내역 있으면 응시자격 접수없이 시험접수가 가능하다. 
			// 그러므로, 별도로 응시자격을 안해도된다고 알림
			/***********************************************************************/	
			if(ds_examaccept_five.GetRowCount() > 0)
			{
				TCCOURSENM = ds_examaccept_Five.GetColumn(0, "TCCOURSENM");
				PNM = ds_examaccept_Five.GetColumn(0, "LPERSONNM");
				
				gfn_Alert(""+PNM+"님은 "+TCCOURSENM+" 수료 내역이 있습니다. \n\n"+
							 "별도의 응시자격심사 없이 시험접수가 가능합니다.");
				return false;
			}
		}		
		
		// ①. 신청등급과 동일 등급의 자격을 보유한 경우 ( 메세지팝업 --> 접수불가 )
		ifn_ExamAcceptFirstSearch();
		/************************************************************************/
		if(ds_examaccept_first.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept_first.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_first.GetColumn(0, "LPERSONNM");
			gfn_Alert(""+PNM+"님은 "+TCCOURSENM+" 자격을 취득하셨습니다.");
			return false;
		}
		/************************************************************************/
		
		// ②. 접수자가 동일 or 상위등급의 시험접수 이력이 있는 경우
		lfn_ExamAcceptSearch(); 
		/***********************************************************************/
		if(ds_examaccept.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept.GetColumn(0, "CCOURSENM");
			TCCOURSENM2 = ds_examaccept.GetColumn(0, "CCOURSENM_CHECK");
			PNM = ds_examaccept.GetColumn(0, "EJPERSONNM");
									
			/// OOO님은 1급소방안전관리자 시험 응시이력이 있습니다.
			/// 별도의 응시자격심사 없이 시험접수가 가능합니다.
			if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 시험 응시이력이 있습니다. \n\n"+
					  "관리자 권한으로 응시신청 하시겠습니까?."))
			{
				return false;
			}
		}
		
		/***********************************************************************/
			
		// ③. 신청등급의 상위등급의 자격증을 보유한 경우가 있는지 Select
		lfn_ExamAcceptTwoSearch(); 
		/***********************************************************************/
		if(ds_examaccept_two.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept_two.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_two.GetColumn(0, "LPERSONNM");
		
			if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 자격을 보유중입니다.\n\n"+
					  "그래도 계속 접수하시겠습니까?"));
			return false;
		}
		
		/***********************************************************************/
		//④. 이미 동일한 직능으로 접수건이 존재하는 경우 저장 하지 못하게 한다. 
		lfn_ExamAcceptTreeSearch();
		/***********************************************************************/
		if(ds_examaccept_tree.GetRowCount() > 0)
		{
			TCCOURSENM = ds_examaccept_tree.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_tree.GetColumn(0, "LPERSONNM");
			var CCOURSECD = ds_examaccept_tree.GetColumn(0, "CCOURSECD");
			
			if(CCOURSECD == cbxcourse.Value)
			{
				if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 응시자격 심사 진행중입니다.\n\n"));
				return false;
			}
			else if(CCOURSECD < cbxcourse.Value)
			{
				if(!gfn_Confirm(""+PNM+"님은 "+TCCOURSENM+" 응시자격 심사 진행중입니다.\n\n"+
								"현재 신청 직능보다 상위 직능입니다. 그래도 신청하시겠습니까?."));
			}	
		}
		/***********************************************************************/
		lfn_ExamAcceptSWSearch();
		// 상급응시자격심사를 받은상태에서 --> 하위를 신청하려고 할때
		/***********************************************************************/
		if(ds_examaccept_SW.GetRowCount() > 0)
		{
			var HCCOURSECD = cbxCourse.Text;
			TCCOURSENM = ds_examaccept_SW.GetColumn(0, "TCCOURSENM");
			PNM = ds_examaccept_SW.GetColumn(0, "LPERSONNM");
			var EATCCOURSECD = ds_examaccept_SW.GetColumn(0, "EATCCOURSECD");
			EASTATUS = ds_examaccept_SW.GetColumn(0, "EASTATUS");
			
			if(eastatus == 3 and EATCCOURSECD == cbxcourse.Value )
			{
				gfn_Alert(""+PNM+"님은 이미 동일직능으로 심사승인 처리 되었습니다.");
				return false;
			}
			else {
			
				gfn_Alert(""+PNM+"님은 "+HCCOURSECD+" 보다 상위등급을 \n\n"+
						  "심사 승인 받았습니다, 신청하지 않으셔도 됩니다.");
				return false;
			}
		}

         // 기본정보, 실명 인증 하지 않고 저장시 개인정보 유무 체크 안하고 저장시 무결성 오류 발생 해결위함
         //  강습자관리번호 없을 경우 한번 체크하여 동일자가 있을 경우 값을 넣어줌  
        if (gfn_isNull(ds_ioExamJubsu.GetColumn(0, "EATPMGNO"))) {        
            //lfn_searchTraingPerson();      구버전.. 
            lfn_searchPerson(edPersonNm.Text, ls_DI, left(medBIRTHDAY.Value,7), replace(edHpTel.Text,"-","")); //  개인정보 조회  personinfo....
            ds_ioExamJubsu.SetColumn(0, "EATPMGNO", ds_ioExamPerson.GetColumn(0, "TPMGNO"));
        }   
		
		if (!gfn_Confirm("저장 하시겠습니까?")) {
			return false;
		} 
			   
		if(cbxjibu.Value != gds_oUserInfo.GetColumn(0, "PDEPTCD"))
		{
			if (!gfn_Confirm("타지부 접수입니다. 접수 저장하시겠습니까?")) {
				return false;        
			}
		}		

		ls_ServiceName = "training:insertExamJubsuConfirm";
		ls_CallBackServiceName = "lfn_AfterInsertExamJubsuConfirm";
		sArg = "IsNewPictureYn=" + quote(iif(lb_FileUpload, "Y", "N"));    	
	}
	else 
	{
		if (!gfn_IsNull(ds_ioExamJubsu.GetColumn(0, "EAMGNO")) // 신규가 아니면서
					&& (ds_ioExamJubsu.GetOrgColumn(0, "PERSONNM") <> ds_ioExamJubsu.GetColumn(0, "PERSONNM"))
					&& (ds_ioExamJubsu.GetOrgColumn(0, "BIRTHDAY") <> ds_ioExamJubsu.GetColumn(0, "BIRTHDAY"))
				) {
			gfn_Alert("수강자(성명과 주민등록번호)를 변경하실 수 없습니다.");
			
			return false;
				
		}
		
		if(ds_ioProfessor.GetColumn(ds_ioProfessor.GetCurrow(), "EASTATUS") <> 1 )
		{
			gfn_Alert(" 수정은 [신청단계]에서만 가능합니다. \n\n");
			      return false;
		}
		
		
		if (!gfn_Confirm("수정 하시겠습니까?")) {
			return false;
		}
		
		ls_ServiceName = "training:updateExamJubsuConfirm";
		ls_CallBackServiceName = "lfn_AfterInsertExamJubsuConfirm";
		
		lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.
		
		sArg = "IsChangedJubsuInfoYn=" + quote(ls_IsChangedJubsuInfoYn);
        sArg += " IsChangedSeatNoYn=" + quote(ls_IsChangedSeatNoYn);
        sArg += " IsChangedPictureYn=" + quote(ls_IsChangedPictureYn);
		
	}
	
	ds_ioExamJubsu.SetColumn(0, "DI", ls_DI);
	ds_ioExamJubsu.SetColumn(0, "CI", ls_CI);
	ds_ioExamJubsu.SetColumn(0, "CIVER", ls_CIVER);	
	ds_ioExamJubsu.SetColumn(0, "PERSONKEY", iif(length(ls_PERSONKEY)==10, ls_PERSONKEY, ""));
    ds_ioExamJubsu.SetColumn(0, "BIRTHDAY7", iif(gfn_IsNull(ls_BIRTHDAY7), substr(medBIRTHDAY.Value,0,7), ls_BIRTHDAY7));
	
	ds_oExamJubsuResult.ClearData(); // 결과 데이타셋 초기화
    
    if (lb_FileUpload) { // 사진등록인 경우(파일 업로드일 경우)
        tit_FileWrite(
            hfImage
            , ls_FileUploadPath
            , fdImage.FilePath
            , fdImage.FileName
            , ls_UploadRealName
            , "U"
            , true
        );
        hfImage.CloseFile();
    }
    		
	tit_clearActionInfo();
	tit_addSingleActionInfo(ls_ServiceName, "", 0, "");
	// 서버 호출
	tit_callService(
		""
		,""
		,"ds_ioExamJubsu=ds_ioExamJubsu"    // inDs
		,"ds_oExamJubsuResult=ds_oExamJubsu"    // outDs
		,sArg    // args
		,ls_CallBackServiceName
		,false
		,false
		,true
	);	
}
]]></Script>
</Window>
<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="22" Id="frmtraining0280S01PassDiplomaPrint" Left="8" OnLoadCompleted="Form_OnLoadCompleted" PidAttrib="7" Style="sty_Form" Title="수료현황(수료증및참가증출력)" Top="8" Ver="1.0" Width="336" WorkArea="true">
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingOrder" ImeMode="native" Left="48" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="lfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="1" UserData="S:회차" Width="28"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuSeqStart" ImeMode="native" Left="160" LeftMargin="2" MaxLength="6" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="lfn2_ComponentOnKillFocus" Style="sty_Edit" TabOrder="2" UserData="S:접수번호" Width="56"></Edit>
		<Static Align="Center" Height="20" Id="lbDateWave1" Left="220" Style="sty_Text" TabOrder="4" Text="~" VAlign="Middle" Width="10"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuSeqEnd" ImeMode="native" Left="236" LeftMargin="2" MaxLength="6" Number="TRUE" OnChanged="lfn_SearchTrainingAbsent2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edJubsuSeqEnd_OnKeyDown" OnKillFocus="lfn2_ComponentOnKillFocus" Style="sty_Edit" TabOrder="3" UserData="S:접수번호" Width="56"></Edit>
		<Static Height="19" Id="Static0" Left="3" TabOrder="5" Text="(회차)" Top="4" Width="35"></Static>
		<Static Height="20" Id="Static1" Left="94" TabOrder="6" Text="(접수번호)" Top="4" Width="69"></Static>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmtraining0280S01PassDiplomaPrint.xml
 * 설명 : 수료현황(수료증및참가증출력)
 * 작성일 : 2009.08.24
 * 작성자 : 장성호   
 */

#include "LIB::COMMON.js"; // 공통 관련

function Form_OnLoadCompleted(obj) {
    edTrainingOrder.SetFocus();
}

function lfn_ComponentOnKillFocus(obj)
{
	gfn_ComponentOnKillFocus(obj);
	obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));  
}

function lfn2_ComponentOnKillFocus(obj)
{
	gfn_ComponentOnKillFocus(obj);
	obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 6));  
	
	if(edJubsuSeqEnd.text =="") {
        
    } else 
    {
      if(divSearchGubun.edJubsuSeqStart.text > divSearchGubun.edJubsuSeqEnd.text) {
        alert("접수번호가 앞의 수보다 작습니다.");
        edJubsuSeqEnd.text = "";
      }
    }
}

function edJubsuSeqEnd_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {  // 엔터시1 다음 컨트롤로 변경
	   edTrainingOrder.SetFocus();
	 //  edJubsuSeqEnd.SetFocus();
	   
	 
	}	
}

function lfn_SearchTrainingAbsent() {    
    if (gfn_IsNull(cbxJibu.Value)
            || gfn_IsNull(cbxCourse.Value)
            || gfn_IsNull(edTrainingYear.Text)
            || gfn_IsNull(edTrainingOrder.Text)) {
        return false;
    }
    edTrainingOrder.Text = iif(gfn_IsNull(edTrainingOrder.Text), "", lpad(edTrainingOrder.Text, "0", 3));    
    lfn_Search();
}

function lfn_SearchTrainingAbsent2(obj) {    
    if (gfn_IsNull(cbxJibu.Value)
            || gfn_IsNull(cbxCourse.Value)
            || gfn_IsNull(edTrainingYear.Text)
            || gfn_IsNull(edTrainingOrder.Text)) {
        return false;
    }
    edTrainingOrder.Text = iif(gfn_IsNull(edTrainingOrder.Text), "", lpad(edTrainingOrder.Text, "0", 3));    
   
    gfn_ComponentOnKillFocus(this);
	obj.Text = iif(gfn_IsNull(this.Text), "", lpad(obj.Text, "0", 6));  
     
    
    lfn_Search();
    
}
]]></Script>
</Window>
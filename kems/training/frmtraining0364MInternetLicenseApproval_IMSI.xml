<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="592" Id="frmtraining0364MInternetLicenseApproval_IMSI" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="[인터넷]자격발급심사의뢰" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="920" WorkArea="true">
		<Datasets>
			<Dataset CanRowPosChange="ds_ioApproveList_CanRowPosChange" DataSetType="Dataset" Id="ds_ioApproveList" OnColumnChanged="ds_ioApproveList_OnColumnChanged">
				<Contents>
					<colinfo id="AJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AJTJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AJGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="AJSTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="AJISSUEGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJISSUEGUBUNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="AJTCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="AJTCCOURSENM" size="256" summ="default" type="STRING"/>
					<colinfo id="AJJUBSUDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AJCONFIRMDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AJCONFIRMSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJRESON" size="256" summ="default" type="STRING"/>
					<colinfo id="AJFILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="AJFILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="AJREGDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AJREGSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJMODDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AJMODSABUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJGUBUNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="AJREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="TPMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TPBIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTHDAY" size="256" summ="default" type="STRING"/>
					<colinfo id="TPPERSONKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="TPTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TPHPTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TPLASTIMGSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TPADDR_1" size="256" summ="default" type="STRING"/>
					<colinfo id="TPADDR_2" size="256" summ="default" type="STRING"/>
					<colinfo id="TPZIPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="IILASTDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IILASTREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IILASTIMGSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="AJMODRESON" size="256" summ="default" type="STRING"/>
					<colinfo id="SEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>%</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>신청</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>접수</DATA>
					</record>
					<record>
						<CD>5</CD>
						<DATA>보완</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>승인</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>반려</DATA>
					</record>
					<record>
						<CD>9</CD>
						<DATA>신청취소</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iApproveLicense">
				<Contents>
					<colinfo id="AJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AJTJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AJSTATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="AJRESON" size="256" summ="default" type="STRING"/>
					<colinfo id="AJREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="LLCSNO_A" size="256" summ="default" type="STRING"/>
					<colinfo id="AJGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJISSUEGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJMODRESON" size="256" summ="default" type="STRING"/>
					<colinfo id="AJSAVE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oApproveLicenseResult">
				<Contents>
					<colinfo id="O_LLCSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="O_AJSTATUS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oImageInfo">
				<Contents>
					<colinfo id="IILASTDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IILASTREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IILASTIMGSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oStatus"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAjgubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA2" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA3" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oLicense">
				<Contents>
					<colinfo id="LICENSECNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LLCSNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAjgubunAll">
				<Contents>
					<colinfo id="AJTCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="AJTCCOURSECDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="AJISSUEGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJISSUEGUBUNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="AJGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AJGUBUNNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioApproveData">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Issuegubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA></DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>경력인정</DATA>
					</record>
					<record>
						<CD>6</CD>
						<DATA>자격인정</DATA>
					</record>
					<record>
						<CD>7</CD>
						<DATA>자격및경력인정</DATA>
					</record>
					<record>
						<CD>9</CD>
						<DATA>겸직인정</DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="582" Height="82" Id="Shape0" Left="3" LineColor="user15" Right="912" TabOrder="37" Top="500" Type="Rectangle" Width="909"></Shape>
		<Shape Bottom="496" Height="154" Id="shpGubunBox" Left="8" LineColor="user15" Right="912" TabOrder="3" Top="342" Type="Rectangle" Width="904"></Shape>
		<Shape Bottom="339" Height="27" Id="Shape3" Left="496" LineColor="darkgoldenrod" Right="912" TabOrder="33" Top="312" Type="Rectangle" Width="416"></Shape>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="483" LineColor="user14" Right="916" TabOrder="4" Top="1" Type="Rectangle" Width="433"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="3" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="300">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="486" OnClick="lfn_Search" Style="sty_Button" TabOrder="2" ToolTipText="조회" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="572" OnClick="lfn_Excel" Style="sty_Button" TabOrder="1" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="741" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="2" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="828" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Shape Bottom="85" Height="51" Id="Shape1" Left="4" LineColor="user15" Right="914" TabOrder="8" Top="34" Type="Rectangle" Width="910"></Shape>
		<Static Align="Center" Height="20" Id="Static6" Left="8" Style="sty_Label" TabOrder="9" Text="지부" Top="38" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" ImeMode="none" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="10" Top="37" UserData="I:" Width="88"></Combo>
		<Static Align="Center" Height="20" Id="lbDate" Left="192" Style="sty_Label" TabOrder="13" Text="신청일자" Top="38" VAlign="Middle" Width="88"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calDateStart" Left="284" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="11" Top="38" UserData="S" WeeksFont="돋음,9" Width="98"></Calendar>
		<Static Align="Center" Height="20" Id="lbDateWave1" Left="386" Style="sty_Text" TabOrder="14" Text="~" Top="39" VAlign="Middle" Width="10"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calDateEnd" Left="400" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="12" Top="38" UserData="S" WeeksFont="돋음,9" Width="98"></Calendar>
		<Static Align="Center" Height="20" Id="lbCourse" Left="502" Style="sty_Label" TabOrder="16" Text="신청상태" Top="38" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxStatus" INDEX="0" InnerDataset="ds_status" Left="591" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="15" Top="37" Width="84"></Combo>
		<Static Align="Center" Height="140" Id="lbSearch" Left="7" Style="sty_LabelGruopBox" TabOrder="18" Text="개인정보" Top="344" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="20" Id="lbPersonNm" Left="36" Style="sty_Label" TabOrder="19" Text="성명" Top="346" UserData="S" VAlign="Middle" Width="96"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPersonNm" ImeMode="native" Left="134" LeftMargin="2" Style="sty_Edit" TabOrder="17" Top="346" UserData="S:성명" Width="120"></Edit>
		<Static Align="Center" Height="20" Id="lbHpTel" Left="36" Style="sty_Label" TabOrder="20" Text="연락처(휴대폰)" Top="378" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Font="굴림,9" Height="20" Id="Static4" Left="260" Style="sty_Label" TabOrder="21" Text="개인식별번호" Top="378" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="76" Id="lbAddr" Left="36" Style="sty_Label" TabOrder="25" Text="주소" Top="409" VAlign="Middle" Width="96"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BKColor="user4" Border="Flat" Height="20" Id="medZipCode" Left="135" LeftMargin="2" Mask="######" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="22" Top="409" Type="STRING" UserData="S" Width="74"></MaskEdit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edAddr1" ImeMode="native" Left="135" LeftMargin="2" Readonly="TRUE" Style="sty_Edit" TabOrder="23" Top="437" UserData="S" Width="497"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edAddr2" ImeMode="native" Left="135" LeftMargin="2" MaxLength="50" Readonly="TRUE" Style="sty_Edit" TabOrder="24" Top="464" UserData="S" Width="497"></Edit>
		<Static Align="Center" Height="20" Id="Static0" Left="260" Style="sty_Label" TabOrder="26" Text="생년월일" Top="346" UserData="S" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="68" Id="Static1" Left="7" Style="sty_LabelGruopBox" TabOrder="27" Text="신청정보" Top="506" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="20" Id="Static3" Left="36" Style="sty_Label" TabOrder="29" Text="취득구분" Top="531" VAlign="Middle" Width="104"></Static>
		<Static Align="Center" Height="20" Id="Static5" Left="36" Style="sty_Label" TabOrder="30" Text="첨부파일" Top="555" VAlign="Middle" Width="103"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnDownload" ImageID="BTN_TEXT_04" Left="441" OnClick="btnDownload_OnClick" Style="sty_Button" TabOrder="31" Text="&#32;다운로드&#32;" ToolTipText="다운로드" Top="554" Width="69"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edfileNm" ImeMode="native" Left="143" LeftMargin="2" Style="sty_Edit" TabOrder="32" Top="555" UserData="S" Width="296"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnApprove" ImageID="BTN_TEXT_04" Left="774" OnClick="btnApprove_OnClick" Style="sty_Button" TabOrder="34" Text="승인" ToolTipText="승인" Top="315" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnReject" ImageID="BTN_TEXT_04" Left="842" OnClick="btnReject_OnClick" Style="sty_Button" TabOrder="35" Text="반려" ToolTipText="반려" Top="315" Transparent="TRUE" Width="66"></Button>
		<Image Border="Flat" FillType="STRETCH" Height="142" Id="imgLastestPicture" Left="799" Style="sty_Image" TabOrder="37" Text="최근사진" Top="348" Transparent="TRUE" Width="108"></Image>
		<File Bottom="334" Height="24" Id="fiAttachFile" Left="4" Right="28" TabOrder="49" Top="310" Width="24"></File>
		<FileDialog Bottom="334" Height="24" Id="fdAttachFile" Left="34" Right="58" TabOrder="48" Top="310" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfAttachFile" Left="64" Top="310" Width="24"></HttpFile>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edCourse" ImeMode="native" Left="143" LeftMargin="2" Style="sty_Edit" TabOrder="39" Top="507" Width="184"></Edit>
		<Static Align="Center" Height="20" Id="Static2" Left="36" Style="sty_Label" TabOrder="28" Text="직능" Top="507" VAlign="Middle" Width="103"></Static>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioApproveList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="303" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="216" Id="gdList" InputPanel="FALSE" Left="4" LineColor="default" OnHeadClick="gdList_OnHeadClick" Right="913" RowHeight="20" Style="sty_Grid" TabOrder="40" TabStop="true" Top="87" UseDBuff="true" UsePopupMenu="true" UserData="자격발급심사승인목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="909">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="50"/>
						<col fix="left" width="63"/>
						<col fix="left" width="70"/>
						<col fix="left" width="79"/>
						<col fix="left" width="66"/>
						<col fix="left" width="85"/>
						<col width="130"/>
						<col width="222"/>
						<col width="182"/>
						<col width="182"/>
						<col width="182"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox" edit="checkbox"/>
						<cell col="1" display="text" text="신청상태"/>
						<cell align="center" col="2" display="text" text="지부"/>
						<cell align="center" col="3" display="text" text="신청일"/>
						<cell col="4" display="text" text="성명"/>
						<cell col="5" display="text" text="생년월일"/>
						<cell col="6" display="text" text="직능"/>
						<cell col="7" display="text" text="취득구분"/>
						<cell col="8" display="text" text="승인사유"/>
						<cell col="9" display="text" text="보완사유"/>
						<cell col="10" display="text" text="반려사유"/>
					</head>
					<body>
						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="AJSTATUS" combocol="CD" combodataset="ds_status" combotext="DATA" display="combo"/>
						<cell align="center" col="2" colid="AJGTMGNO" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="3" colid="AJREGDATE" display="date"/>
						<cell align="center" col="4" colid="TPNM" display="text"/>
						<cell align="center" col="5" colid="BIRTHDAY" display="text"/>
						<cell col="6" colid="AJTCCOURSENM" display="text"/>
						<cell col="7" colid="AJGUBUNNM" display="text"/>
						<cell col="8" colid="AJREMARK" display="text" edit="normal"/>
						<cell col="9" colid="AJMODRESON" display="text" edit="normal"/>
						<cell col="10" colid="AJRESON" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medBirthday" ImeMode="native" Left="342" LeftMargin="2" Style="sty_Edit" TabOrder="41" Top="346" Width="120"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edHpTel" ImeMode="native" Left="134" LeftMargin="2" Style="sty_Edit" TabOrder="42" Top="378" Width="120"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user36" Enable="FALSE" Height="20" Id="edStatus" ImeMode="native" Left="216" LeftMargin="2" Style="sty_Edit" TabOrder="43" Top="409" Visible="FALSE" Width="24"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edfilePath" ImeMode="native" Left="702" LeftMargin="2" Style="sty_Edit" TabOrder="43" Top="554" UserData="S" Visible="FALSE" Width="200"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user36" Enable="FALSE" Height="20" Id="edLastImgSeq" ImeMode="native" Left="246" LeftMargin="2" Readonly="TRUE" Style="sty_Edit" TabOrder="44" Top="409" UserData="S" Visible="FALSE" Width="40"></Edit>
		<Static Align="Center" BKColor="user36" Height="20" Id="stfilePath" Left="620" Style="sty_Label" TabOrder="45" Text="파일경로" Top="555" VAlign="Middle" Visible="FALSE" Width="80"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnJubsu" ImageID="BTN_TEXT_04" Left="638" OnClick="btnJubsu_OnClick" Style="sty_Button" TabOrder="46" Text="접수시작" ToolTipText="접수시작" Top="315" Transparent="TRUE" Width="66"></Button>
		<Button Height="21" Id="btnSaveXml" Left="596" OnClick="btnSaveXml_OnClick" TabOrder="47" Text="saveXml" Top="509" Visible="FALSE" Width="104"></Button>
		<TextArea Height="40" Id="tx_xmlTest" Left="701" TabOrder="48" Top="508" Visible="FALSE" Width="201"></TextArea>
		<Button Height="21" Id="Button0" Left="596" OnClick="lfn_SMSSend" TabOrder="49" Text="sms" Top="530" Visible="FALSE" Width="104"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnImageZoom" ImageID="BTN_TEXT_05" Left="717" OnClick="btnImageZoom_OnClick" Style="sty_Button" TabOrder="50" Text="이미지확대" Top="348" Transparent="TRUE" Width="79"></Button>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbAjgubun" INDEX="0" InnerDataset="ds_oAjgubun" Left="142" OnChanged="cbAjgubun_OnChanged" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="51" Top="530" UserData="S" Width="299"></Combo>
		<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user36" Enable="FALSE" Height="20" Id="edAJTCCOURSECD" ImeMode="native" Left="504" LeftMargin="2" Readonly="TRUE" Style="sty_Edit" TabOrder="52" Top="380" UserData="S" Visible="FALSE" Width="40"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user36" Enable="FALSE" Height="20" Id="edAJISSUEGUBUN" ImeMode="native" Left="552" LeftMargin="2" Readonly="TRUE" Style="sty_Edit" TabOrder="53" Top="380" UserData="S" Visible="FALSE" Width="40"></Edit>
		<Edit AutoSelect="TRUE" BKColor="palegoldenrod" Border="Flat" Enable="FALSE" Height="20" Id="edPersonKey" ImeMode="native" Left="342" LeftMargin="2" Style="sty_Edit" TabOrder="54" Top="378" Width="120"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnMod" ImageID="BTN_TEXT_04" Left="706" OnClick="btnMod_OnClick" Style="sty_Button" TabOrder="55" Text="보완" ToolTipText="반려" Top="315" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintAll" ImageID="BTN_TEXT_05" Left="659" OnClick="lfn_Print" Style="sty_Button" TabOrder="56" Text="신청서출력" ToolTipText="응시원서출력" Top="4" Width="81"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_TEXT_05" Left="392" OnClick="lfn_Print" Style="sty_Button" TabOrder="57" Text="신청서출력" ToolTipText="응시원서출력" Top="3" Visible="FALSE" Width="81"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnCancel" ImageID="BTN_TEXT_04" Left="570" OnClick="btnCancel_OnClick" Style="sty_Button" TabOrder="58" Text="접수취소" ToolTipText="접수시작" Top="315" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9" Height="22" Id="btnImsiSave" ImageID="BTN_TEXT_04" Left="502" OnClick="btnImsiSave_OnClick" Style="sty_Button" TabOrder="59" Text="저장변경" ToolTipText="저장" Top="315" Transparent="TRUE" Width="66"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user36" Enable="FALSE" Height="20" Id="edAJMGNO" ImeMode="native" Left="504" LeftMargin="2" Readonly="TRUE" Style="sty_Edit" TabOrder="60" Top="348" UserData="S" Visible="FALSE" Width="40"></Edit>
		<Static Align="Center" Height="20" Id="Static7" Left="677" Style="sty_Label" TabOrder="61" Text="성명" Top="38" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edName" ImeMode="native" Left="766" LeftMargin="2" Style="sty_Edit" TabOrder="62" Top="38" Width="120"></Edit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medCheckCnt" Left="284" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="65" Top="61" UserData="S" Width="97"></MaskEdit>
		<Static Align="Center" Height="20" Id="Static15" Left="192" Style="sty_LabelStat" TabOrder="66" Text="선택건수" Top="61" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medSearchCnt" Left="100" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="63" Top="61" UserData="S" Width="88"></MaskEdit>
		<Static Align="Center" Height="20" Id="lbAbsentCnt" Left="8" Style="sty_LabelStat" TabOrder="64" Text="조회건수" Top="61" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btConfirmCancell" ImageID="BTN_TEXT_05" Left="832" OnClick="btConfirmCancell_OnClick" Style="sty_Button" TabOrder="67" Text="승인취소" ToolTipText="승인취소" Top="60" Width="80"></Button>
		<Static Color="red" Font="맑은&#32;고딕,10,Bold" Height="18" Id="Static11" Left="228" TabOrder="68" Text="◆&#32;저장변경은&#32;다중으로&#32;처리할&#32;수&#32;없습니다." Top="317" Width="264"></Static>
		<Static Align="Center" Height="20" Id="Static8" Left="329" Style="sty_Label" TabOrder="69" Text="발급구분" Top="507" VAlign="Middle" Width="103"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxISSuegubun" INDEX="0" InnerDataset="ds_Issuegubun" Left="433" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="70" Top="506" Width="124"></Combo>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmtraining0364MInternetLicenseApproval
 * 설명 : [인터넷]자격발급 심사의뢰관리
 * 작성일 : 2022.11.14
 * 작성자 : jjh
 */

#include "LIB::training.js"; // 공통업무 관련

var ls_FileDownloadPath = "/assets/images/edu/training/images/map/";

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {

    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
 
    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    //gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }
    
	// 시스템관리자만  보이도록 설정
	if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM") {
		stfilePath.Visible = true;
		edfilePath.Visible = true; 
		edfileNm.Enable = true;
		edfilePath.Enable = true;
		btnSaveXml.Visible = true;
		tx_xmlTest.Visible = true;
		edAJMGNO.Visible = true;
		edStatus.Visible = true;
		edAJTCCOURSECD.Visible = true;
		edAJISSUEGUBUN.Visible = true;
		edLastImgSeq.Visible = true;
		btConfirmCancell.Visible = true;
	}
	
	if(gds_oUserInfo.GetColumn(0, "PDEPTNM") == "평가관리과" || gds_oUserInfo.GetColumn(0, "PSABUN") == "20220952")
    {
		btConfirmCancell.Visible = true;
    }
    else {
		btConfirmCancell.Visible = false;
    }
   
    calDateStart.Value = AddDate(GetDate(), -30);
    calDateEnd.Value = GetDate();    
    
    cbxStatus.Value = "1";
    medCheckCnt.Value = 0;
    
    gfn_SearchJibu(cbxJibu,"Y","전체");
    gfn_SearchKCode(ds_oAjgubun, "L", ""); //발급구분 
	cbAjgubun.Value = "";
	
    //발급구분  23.01 구분별 발급구분 txt로 보여주기     
    ds_oAjgubunAll.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchLicenseIssueGubun", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oAjgubunAll=ds_oAjgubun"	// outDs
		,""	// args 
		,""
		,false
		,""
		,true
	);	
	
        
}


function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

function Form_OnSize(obj,nCx,nCy,nState) { 
}

/*
 * 기능 : 조회
 */
function lfn_Search(obj) {

    ds_ioApproveList.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("training:searchTraining0364MInternetLicenseApproval", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioApproveList=ds_ioApproveList"	// outDs
		,"AJGTMGNO=" + quote(cbxJibu.Value)
            + " AJJUBSUDATESTART=" + quote(substr(calDateStart.value,0,8))
            + " AJJUBSUDATEEND=" + quote(substr(calDateEnd.value,0,8))
            + " AJSTATUS=" + quote(cbxStatus.value)	// args 
            + " AJNAME=" + quote(edName.Text)
		,"lfn_AfterSearchList"
		,false
	);
}
 
/*
 * 기능 : 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchList(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
	medSearchCnt.Value = ds_ioApproveList.GetRowCount();
	medCheckCnt.Value = 0;
	
    gfn_SearchMessage(gdList); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
    
    var course = edAJTCCOURSECD.Text;
    //Course_Change(course);
    // 조회 후 상태에 따른 버튼 활성/비활성 
	//fnBtnEnable("");
	
	// 첫 ROW 선택되게 	
	//ds_ioApproveList_OnRowPosChanged(ds_ioApproveList,0,0);
    
}

function Course_Change(course)
{
	ds_oAjgubun.UnFilter();
	if(course != "")
	{
		ds_oAjgubun.Filter("DATA3='"+course+"'");
	}
}

/**
 * 엑셀 출력
 */
function lfn_Excel(obj) {
    if (ds_ioApproveList.GetRowCount() < 1) {
        gfn_Alert("출력할 데이터가 존재하지 않습니다.");
        return;
    }
	// 개인정보 다운로드 사유 등록
	var parValue = "sCode=1306";	// COMMON.PERSONALDOWNLOADH
		parValue += " sRowCnt=" + ds_ioApproveList.GetRowCount();
		parValue += " sTitle=" + quote(gdList.UserData);
	ls_IsRemark = Dialog("COM::frmCOM2100PDownloadRemark.xml", parValue, "", "", "", -1, -1);	

	if (ls_IsRemark == "" || ls_IsRemark == null || ls_IsRemark == "FAIL") {
		return false;
	}
	lfn_Excel(obj);
}
 

/*
 * 조회 그리드 선택 시 
*/
function gdList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	if(nCell <> 0)
	{
		ds_ioApproveList_OnRowPosChanged(ds_ioApproveList,nRow,nRow);
	}
}
/*
 * 조회 dataset 줄 선택 시 
*/
function ds_ioApproveList_CanRowPosChange(obj,nOldRow,nRow){

	// 초기화 
	edPersonNm.Text = "";
	medBirthday.Text = "";
	edHpTel.Text = "";
	edPersonKey.Text = "";
	medZipCode.Text = "";
	edAddr1.Text = "";
	edAddr2.Text = "";
	edCourse.Text = "";
	cbAjgubun.Value = "";
	edAJMGNO.Text = ""; 
	edStatus.Text = ""; 
	edfileNm.Text = "";
	edfilePath.Text = "";
	imgLastestPicture.Text = "최근사진";			
	imgLastestPicture.ImageID = "";
    edLastImgSeq = "";
	edAJTCCOURSECD.Text = "";
	edAJISSUEGUBUN.Text = "";
    ds_iApproveLicense.ClearData();
    ds_iApproveLicense.InsertRow(0);
	
	// 그리드이 값 복사
    if (nRow < 0 ) return false ;
    
    
    // 조회 후 상태에 따른 버튼 활성/비활성 
	fnBtnEnable(obj.GetColumn(nRow, "AJSTATUS"));
	
    ds_oImageInfo.ClearData();
    var vAJTJMGNO = obj.GetColumn(nRow, "AJTJMGNO");
    if(vAJTJMGNO <> ""){			
		tit_clearActionInfo();
		tit_addCsvSearchActionInfo("training:searchTraining0364ImageInfo", false);
		tit_callService(
			""
			,""
			,""	// inDs
			,"ds_oImageInfo=ds_oImageInfo"	// outDs
			,"AJTJMGNO=" + quote(vAJTJMGNO) // args 
			,""
			,false
			,false
			,true
		);	
		
		
    }
	edPersonNm.Text = obj.GetColumn(nRow, "TPNM");
	medBirthday.Text = obj.GetColumn(nRow, "BIRTHDAY");
	edHpTel.Text = obj.GetColumn(nRow, "TPHPTEL");
	edPersonKey.Text = obj.GetColumn(nRow, "TPPERSONKEY");
	medZipCode.Text = obj.GetColumn(nRow, "TPZIPCD");
	edAddr1.Text = obj.GetColumn(nRow, "TPADDR_1");
	edAddr2.Text = obj.GetColumn(nRow, "TPADDR_2");
	edCourse.Text = obj.GetColumn(nRow, "AJTCCOURSENM");
	cbAjgubun.Value = obj.GetColumn(nRow, "AJGUBUN");
	edAJMGNO.Text = obj.GetColumn(nRow, "AJMGNO");
	edStatus.Text = obj.GetColumn(nRow, "AJSTATUS");
	edfileNm.Text = obj.GetColumn(nRow, "AJFILENM");
	edfilePath.Text = obj.GetColumn(nRow, "AJFILEPATH");
	cbxISSuegubun.Value = obj.GetColumn(nRow, "AJISSUEGUBUN");
	//최근사진 (TRAININGPERSON.TPLASTIMGSEQ)
	imgLastestPicture.Text = "";			
	imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + obj.GetColumn(nRow, "IILASTDIRPATH") + "/" + obj.GetColumn(nRow, "IILASTREALNM");
    edLastImgSeq = obj.GetColumn(nRow, "IILASTIMGSEQ");
    
	//승인시 기수첩발급 체크를 위해
	edAJTCCOURSECD.Text = obj.GetColumn(nRow, "AJTCCOURSECD");
	edAJISSUEGUBUN.Text = obj.GetColumn(nRow, "AJISSUEGUBUN");
			   
	//update 
    ds_iApproveLicense.SetColumn(0,"AJTJMGNO" , obj.GetColumn(nRow, "AJTJMGNO"));
    ds_iApproveLicense.SetColumn(0,"AJSTATUS" , obj.GetColumn(nRow, "AJSTATUS"));
    ds_iApproveLicense.SetColumn(0,"AJMGNO"   , obj.GetColumn(nRow, "AJMGNO"));
	ds_iApproveLicense.SetColumn(0,"IIIMGSEQ" , obj.GetColumn(nRow, "IILASTIMGSEQ")); //최근사진으로 셋팅 
	/* 발급구분을 수정할 수 있어 승인 시 셋팅 
    var LLCSNO_A = substr(obj.GetColumn(nRow, "AJJUBSUDATE"),0,4) + "-" +   //날짜
			mid(obj.GetColumn(nRow, "AJGTMGNO"),1,2) + "-" +   //지부
			obj.GetColumn(nRow, "AJTCCOURSECD") + "-" +   //등급
			obj.GetColumn(nRow, "AJISSUEGUBUN") + "-" ;   //구분 
			
    ds_iApproveLicense.SetColumn(0,"LLCSNO_A",LLCSNO_A);
    */
     
    var course = edAJTCCOURSECD.Text;
    Course_Change(course);
    
}

/*
 * 기능 : 상태에 따른 버튼 활성/비활성	
*/
function fnBtnEnable(status){
	// 비활성 후 
	btnImsiSave.Enable = false;
	btnCancel.Enable = false;
	btnJubsu.Enable = false;
	btnApprove.Enable = false;
	btnReject.Enable = false; 
	btnMod.Enable = false;
	//btnDownload.Enable = false; 
	cbAjgubun.Enable = false;
	
	/* 1: 신청, 2: 접수시작, 3: 승인, 4: 반려 , 5:보완 */	
	if(status == '1'){
		btnJubsu.Enable = true;		
		btnMod.Enable = true;
		//btnDownload.Enable = true; 
	}
	if(status == '2'){ 	
		btnImsiSave.Enable = true;
		btnCancel.Enable = true;
		btnApprove.Enable = true;
		btnReject.Enable = true; 
		btnMod.Enable = true;
		//btnDownload.Enable = true; 
		cbAjgubun.Enable = true;
	}
	if(status == '3'){ 
		//btnDownload.Enable = true; 
	}
	if(status == '4'){ 	
	} 
	

}


/**
 * 임시저장 - 접수상태에서 저장 만 
 */
function btnImsiSave_OnClick(obj)
{
	
    if (!gfn_Confirm("임시저장 하시겠습니까?")) {
        return;
    }
	// 선택한 신청상태가 신청일때만 가능	
	if(edStatus.Text == ""){
        gfn_Alert("신청상태를 확인해주십시오.");
        return false;
	}
	if(edStatus.Text <>"2"){
        gfn_Alert("신청상태를 확인해주십시오.[접수]일때만 임시저장 처리가 가능합니다.");
        return false;
	} 
    
    ds_iApproveLicense.SetColumn(0,"AJSAVE","Y"); // 임시저장 (발급구분 변경 )
    ds_iApproveLicense.SetColumn(0,"AJGUBUN",cbAjgubun.Value); //발급구분 
	ds_iApproveLicense.SetColumn(0,"AJISSUEGUBUN",edAJISSUEGUBUN.Text); // 취득구분 : 발급구분이 변경될 수 있음 
	
    ds_oApproveLicenseResult.ClearData();        
    tit_clearActionInfo();
	tit_addSingleActionInfo("training:insertTrainingApprovalLicense", "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iApproveLicense=ds_iApproveLicense"/// inDs
        ,"ds_oApproveLicenseResult=ds_oApproveLicenseResult"	// outDs
        , ""
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );
	
}

/**
 * 접수취소 - 접수상태에서 신청상태로 변경 
 */
function btnCancel_OnClick(obj)
{/*
    if (!gfn_Confirm("접수취소 하시겠습니까?")) {
        return;
    }
	// 선택한 신청상태가 신청일때만 가능	
	if(edStatus.Text == ""){
        gfn_Alert("신청상태를 확인해주십시오.");
        return false;
	}
	if(edStatus.Text <>"2"){
        gfn_Alert("신청상태를 확인해주십시오.[접수]일때만 취소처리가 가능합니다.");
        return false;
	} 
    
    ds_iApproveLicense.SetColumn(0,"AJSTATUS","1"); // 신청 
    ds_oApproveLicenseResult.ClearData();        
    tit_clearActionInfo();
	tit_addSingleActionInfo("training:insertTrainingApprovalLicense", "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iApproveLicense=ds_iApproveLicense"/// inDs
        ,"ds_oApproveLicenseResult=ds_oApproveLicenseResult"	// outDs
        , ""
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );
	*/
	
	var row = ds_ioApproveList.GetRowCount();
	
    if (medCheckCnt.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
        
    if (!gfn_Confirm("접수취소 하시겠습니까?")) {
        return;
    }    
	
	for ( i = 0 ; i<row; i++ )
	{
		var AJSTATUS = ds_ioApproveList.GetColumn(i, "AJSTATUS");
		
		if(ds_ioApproveList.GetColumn(i, "SEL") == 1)
		{
			if(AJSTATUS <> "2")
			{
				gfn_Alert(" 선택한 내역 중 신청단계가 아닌 건이 있습니다. \n\n"
						 +" 접수취소는 [접수]단계에서만 처리가 가능합니다.");
				return false;
			}
	
			var AJMGNO = ds_ioApproveList.GetColumn(i, "AJMGNO");	  // KEY1
			var AJTJMGNO = ds_ioApproveList.GetColumn(i, "AJTJMGNO"); // KEY2
			var REMARK = "";
			var STATUS = 1; // 접수취소로 --> 신청단계로 되돌린다.
			save_mod(AJMGNO, AJTJMGNO, REMARK, STATUS);
		}
	}

	gfn_SaveMessage();
	lfn_Search();	
}

/**
 * 접수 
 */
function btnJubsu_OnClick(obj)
{
    /*if (!gfn_Confirm("접수시작 하시겠습니까?")) {
        return;
    }
	// 선택한 신청상태가 신청일때만 가능	
	if(edStatus.Text == ""){
        gfn_Alert("신청상태를 확인해주십시오.");
        return false;
	}
	if(edStatus.Text <>"1"){
        gfn_Alert("신청상태를 확인해주십시오.[신청]일때만 접수처리가 가능합니다.");
        return false;
	} 
    
    ds_iApproveLicense.SetColumn(0,"AJSTATUS","2"); // 접수 
    ds_oApproveLicenseResult.ClearData();        
    tit_clearActionInfo();
	tit_addSingleActionInfo("training:insertTrainingApprovalLicense", "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iApproveLicense=ds_iApproveLicense"/// inDs
        ,"ds_oApproveLicenseResult=ds_oApproveLicenseResult"	// outDs
        , ""
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );*/
    
	var row = ds_ioApproveList.GetRowCount();
	
    if (medCheckCnt.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
        
    if (!gfn_Confirm("접수시작 하시겠습니까?")) {
        return;
    }    
	
	for ( i = 0 ; i<row; i++ )
	{
		var AJSTATUS = ds_ioApproveList.GetColumn(i, "AJSTATUS");
		
		if(ds_ioApproveList.GetColumn(i, "SEL") == 1)
		{
			if(AJSTATUS <> "1")
			{
				gfn_Alert(" 선택한 내역 중 신청단계가 아닌 건이 있습니다. \n\n"
						 +" 접수시작은 [신청]단계에서만 처리가 가능합니다.");
				return false;
			}
	
			var AJMGNO = ds_ioApproveList.GetColumn(i, "AJMGNO");	  // KEY1
			var AJTJMGNO = ds_ioApproveList.GetColumn(i, "AJTJMGNO"); // KEY2
			var REMARK = ""; // 보완사유
			var STATUS = 2; // 보완
			save_mod(AJMGNO, AJTJMGNO, REMARK, STATUS);
		}
	}
	
		
	gfn_SaveMessage();
	lfn_Search();
}

/**
 * 승인 
 */
function btnApprove_OnClick(obj)
{
	
	var row = ds_ioApproveList.GetRowCount();
	
    if (medCheckCnt.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;
    }
    
    if (!gfn_Confirm("승인 처리 하시겠습니까?")) {
        return;
    }
    
    var row = ds_ioApproveList.GetRowCount();
    
	for (var i=0; i<row; i++)
	{
		if(ds_ioApproveList.GetColumn(i, "SEL") == 1)
		{
			var AJSTATUS = ds_ioApproveList.GetColumn(i, "AJSTATUS");
			
			if(AJSTATUS <> "2")
			{
				gfn_Alert(" 선택한 내역 중 신청단계가 아닌 건이 있습니다. \n\n"
						 +" 승인처리는 [접수]단계에서만 처리가 가능합니다.");
				return false;
			}
			
			if(ds_ioApproveList.GetColumn(i, "AJREMARK") == "" or ds_ioApproveList.GetColumn(i, "AJREMARK") == null)
			{
				gfn_Alert("선택한 내역 중 " + toInteger(i+1) +"행의 승인사유를 입력 후 처리하세요!.");
				return false;
			}
			
			//22.12 승인전 기수첩발급 체크 	
			ds_oLicense.ClearData(); // 데이타셋 초기화
			tit_clearActionInfo();
			tit_addCsvSearchActionInfo("training:searchTraining0364MLicenseCnt", false);
			// 서버 호출 
			tit_callService(
				""
				,""
				,""	// inDs
				,"ds_oLicense=ds_oLicense"	// outDs 
				,"LPERSONKEY=" 		+ quote(ds_ioApproveList.GetColumn(i,"TPPERSONKEY"))
				 +" AJISSUEGUBUN=" + quote(ds_ioApproveList.GetColumn(i, "AJISSUEGUBUN"))
				 +" AJTCCOURSECD=" + quote(ds_ioApproveList.GetColumn(i, "AJTCCOURSECD"))
				/*
				,"LPERSONKEY=" 		+ quote(edPersonKey.Text)
				+ " AJISSUEGUBUN=" 	+ quote(edAJISSUEGUBUN.Text)
				+ " AJTCCOURSECD=" 	+ quote(edAJTCCOURSECD.Text)	// args 
				*/
				,""
				,false
				,false
				,true
			);
			
			if(ds_oLicense.GetColumn(0,"LICENSECNT") > 0){
				gfn_Alert("이미 발급된 수첩이 있습니다. \r\n수첩번호 : " + ds_oLicense.GetColumn(0,"LLCSNO"));
				return false;
			}
			//22.12 승인전 기수첩발급 체크 
			ds_iApproveLicense.SetColumn(0,"AJREMARK",ds_ioApproveList.GetColumn(i, "AJREMARK")); //승인사유 
			ds_iApproveLicense.SetColumn(0,"AJSTATUS","3"); // 승인 
			ds_iApproveLicense.SetColumn(0,"AJGUBUN",ds_ioApproveList.GetColumn(i, "AJGUBUN")); //발급구분 
			ds_iApproveLicense.SetColumn(0,"AJISSUEGUBUN",ds_ioApproveList.GetColumn(i, "AJISSUEGUBUN"));  // 취득구분 : 발급구분이 변경될 수 있음 
			
			// 발급구분 변경에 따라 수첩번호 재 셋팅 
			var LLCSNO_A =  // substr(ds_ioApproveList.GetColumn(i, "AJJUBSUDATE"),0,4) + "-" +   //날짜
							// 승인일자를 기준으로 자격증이 발급되도록 한다.
							// 2023년에 요청해서 2024년에 승인한 경우 기존 접수일자로 되어있어서
							// 2024년도에 승인했을때 23년도로 발급이 되기때문
					left(today(),4)+ "-" + 
					mid(ds_ioApproveList.GetColumn(i, "AJGTMGNO"),1,2) + "-" +   //지부
					ds_ioApproveList.GetColumn(i, "AJTCCOURSECD") + "-" +   //등급
					ds_ioApproveList.GetColumn(i, "AJISSUEGUBUN") + "-" ;   //구분 
					
			ds_iApproveLicense.SetColumn(0,"LLCSNO_A",LLCSNO_A);	
		
			var AJMGNO = ds_ioApproveList.GetColumn(i, "AJMGNO");	  // KEY1
			var AJTJMGNO = ds_ioApproveList.GetColumn(i, "AJTJMGNO"); // KEY2
			var REMARK = ds_ioApproveList.GetColumn(i, "AJREMARK"); // 보완사유
			var STATUS = 3; // 승인 
			save_mod(AJMGNO, AJTJMGNO, REMARK, STATUS);
			lfn_SMSSend(STATUS,i);
		}
	}
	
	gfn_SaveMessage();
	lfn_Search();

    	
	/*
    if (!gfn_Confirm("승인 처리 하시겠습니까?")) {
        return;
    }
	// 선택한 신청상태가 신청일때만 가능	
	if(edStatus.Text == ""){
        gfn_Alert("신청상태를 확인해주십시오.");
        return false;
	}
	if(edStatus.Text <>"2"){
        gfn_Alert("신청상태를 확인해주십시오.[접수]일때만 승인처리가 가능합니다.");
        return false;
	} 	
	
	// 최근사진 체크 
    var arrLastestPicture = imgLastestPicture.GetImageSize();   
	if (arrLastestPicture[0] ==0 || arrLastestPicture[1] == 0) {
        gfn_Alert("사진이 등록되지 않았습니다.");
        return false;
	}
	
	if (gfn_isNull(ds_iApproveLicense.GetColumn(0, "IIIMGSEQ"))) {	
        gfn_Alert("사진이 등록되지 않았습니다.");
        return false;
	}
		
	//22.12 승인전 기수첩발급 체크 	
    ds_oLicense.ClearData(); // 데이타셋 초기화
    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("training:searchTraining0364MLicenseCnt", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oLicense=ds_oLicense"	// outDs 
		,"LPERSONKEY=" + quote(edPersonKey.Text)
            + " AJISSUEGUBUN=" + quote(edAJISSUEGUBUN.Text)
            + " AJTCCOURSECD=" + quote(edAJTCCOURSECD.Text)	// args 
        ,""
        ,false
        ,false
        ,true
	);
	
	if(ds_oLicense.GetColumn(0,"LICENSECNT") > 0){
        gfn_Alert("이미 발급된 수첩이 있습니다. \r\n수첩번호 : " + ds_oLicense.GetColumn(0,"LLCSNO"));
        return false;
	}
	//22.12 승인전 기수첩발급 체크 	
	
	
	// 사유 입력 팝업 호출 
	var vArg = "sAJSTATUS="+ "3" ;
	var ls_IsRemark = Dialog("training::frmtraining0364PLicenseRemark.xml", vArg, "", "", "", -1, -1);
	
	if (ls_IsRemark == "" || ls_IsRemark = null) {
		return;
	}
		
    ds_iApproveLicense.SetColumn(0,"AJREMARK",ls_IsRemark); //승인사유 
    ds_iApproveLicense.SetColumn(0,"AJSTATUS","3"); // 승인 
    ds_iApproveLicense.SetColumn(0,"AJGUBUN",cbAjgubun.Value); //발급구분 
	ds_iApproveLicense.SetColumn(0,"AJISSUEGUBUN",edAJISSUEGUBUN.Text); // 취득구분 : 발급구분이 변경될 수 있음 
    
    // 발급구분 변경에 따라 수첩번호 재 셋팅 
    var LLCSNO_A = substr(ds_ioApproveList.GetColumn(ds_ioApproveList.currow, "AJJUBSUDATE"),0,4) + "-" +   //날짜
			mid(ds_ioApproveList.GetColumn(ds_ioApproveList.currow, "AJGTMGNO"),1,2) + "-" +   //지부
			ds_ioApproveList.GetColumn(ds_ioApproveList.currow, "AJTCCOURSECD") + "-" +   //등급
			ds_ioApproveList.GetColumn(ds_ioApproveList.currow, "AJISSUEGUBUN") + "-" ;   //구분 
			
    ds_iApproveLicense.SetColumn(0,"LLCSNO_A",LLCSNO_A);
        
    ds_oApproveLicenseResult.ClearData();        
    tit_clearActionInfo();
	tit_addSingleActionInfo("training:insertTrainingApprovalLicense", "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iApproveLicense=ds_iApproveLicense"/// inDs
        ,"ds_oApproveLicenseResult=ds_oApproveLicenseResult"	// outDs
        , ""
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );
	*/
}

/**
 * 반려
 */
function btnReject_OnClick(obj)
{
/*
    if (!gfn_Confirm("반려 처리 하시겠습니까?")) {
        return;
    }
	// 선택한 신청상태가 신청일때만 가능
	if(edStatus.Text ==""){
        gfn_Alert("신청상태를 확인해주십시오.");
        return;		
	}
	if(edStatus.Text == "3"){
        gfn_Alert("신청상태를 확인해주십시오. 승인된 접수건입니다.");
        return;		
	}
	
	// 사유 입력 팝업 호출 
	var vArg = "sAJSTATUS="+ "4" ;
	var ls_IsRemark = Dialog("training::frmtraining0364PLicenseRemark.xml", vArg, "", "", "", -1, -1);
	
	if (ls_IsRemark == "" || ls_IsRemark = null) {
		return;
	}
		
    ds_iApproveLicense.SetColumn(0,"AJRESON",ls_IsRemark); //반려사유     
    
	//update 	
    ds_iApproveLicense.SetColumn(0,"AJSTATUS","4"); // 반려 
    ds_oApproveLicenseResult.ClearData();        
    
    tit_clearActionInfo();
	tit_addSingleActionInfo("training:insertTrainingApprovalLicense", "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iApproveLicense=ds_iApproveLicense"/// inDs
        ,"ds_oApproveLicenseResult=ds_oApproveLicenseResult"	// outDs
        , ""
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );
*/

	if (medCheckCnt.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
    
    if (!gfn_Confirm("반려 처리 하시겠습니까?")) {
        return;
    }

	// 다중선택으로 변경됨에 따라 위의 조건을 for문으로 변경합니다.
	for(i=0; i<ds_ioApproveList.GetRowCount(); i++)
	{
		if(ds_ioApproveList.GetColumn(i, "SEL") == 1)
		{
			if(ds_ioApproveList.GetColumn(i, "AJRESON") == "" or  ds_ioApproveList.GetColumn(i, "AJRESON") == null)
			{
				gfn_Alert("선택한 내역 중 " + toInteger(i+1) +"행의 반려사유를 입력 후 처리하세요!.");
				return false;
			}
			
			var AJMGNO = ds_ioApproveList.GetColumn(i, "AJMGNO");	  // KEY1
			var AJTJMGNO = ds_ioApproveList.GetColumn(i, "AJTJMGNO"); // KEY2
			var REMARK = ds_ioApproveList.GetColumn(i, "AJRESON"); // 보완사유
			var STATUS = 4; // 보완
			save_mod(AJMGNO, AJTJMGNO, REMARK, STATUS);
			lfn_SMSSend(STATUS,i);
		}	
	}
	
	gfn_SaveMessage();
	lfn_Search();
	
}


/**
 * 보완
 */
function btnMod_OnClick(obj)
{
    /*
	// 선택한 신청상태가 신청일때만 가능
	if(edStatus.Text ==""){
        gfn_Alert("신청상태를 확인해주십시오.");
        return;		
	}
	if(edStatus.Text == "3"){
        gfn_Alert("신청상태를 확인해주십시오. 승인된 접수건입니다.");
        return;		
	}
	if(edStatus.Text == "4"){
        gfn_Alert("신청상태를 확인해주십시오. 반려된 접수건입니다.");
        return;		
	}
	
	// 사유 입력 팝업 호출 
	var vArg = "sAJSTATUS="+ "5" ;
	var ls_IsRemark = Dialog("training::frmtraining0364PLicenseRemark.xml", vArg, "", "", "", -1, -1);
	
	if (ls_IsRemark == "" || ls_IsRemark = null) {
		return;
	}
    ds_iApproveLicense.SetColumn(0,"AJMODRESON",ls_IsRemark); //보완사유     
    
	*/
	
	if (medCheckCnt.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
    
    if (!gfn_Confirm("보완 처리 하시겠습니까?")) {
        return;
    }

	// 다중선택으로 변경됨에 따라 위의 조건을 for문으로 변경합니다.
	for(i=0; i<ds_ioApproveList.GetRowCount(); i++)
	{
		if(ds_ioApproveList.GetColumn(i, "SEL") == 1)
		{
			if(ds_ioApproveList.GetColumn(i, "AJMODRESON") == "" or  ds_ioApproveList.GetColumn(i, "AJMODRESON") == null)
			{
				gfn_Alert("선택한 내역 중 " + toInteger(i+1) +"행의 보완사유를 입력 후 처리하세요!.");
				return false;
			}
			
			var AJMGNO = ds_ioApproveList.GetColumn(i, "AJMGNO");	  // KEY1
			var AJTJMGNO = ds_ioApproveList.GetColumn(i, "AJTJMGNO"); // KEY2
			var REMARK = ds_ioApproveList.GetColumn(i, "AJMODRESON"); // 보완사유
			var STATUS = 5; // 보완
			save_mod(AJMGNO, AJTJMGNO, REMARK, STATUS);
			lfn_SMSSend(STATUS,i);
		}	
	}
	
	gfn_SaveMessage();
	lfn_Search();
}

function save_mod(AJMGNO, AJTJMGNO, REMARK, STATUS)
{	
	//update 	
    //ds_iApproveLicense.SetColumn(0,"AJSTATUS","5"); // 보완 
    ds_oApproveLicenseResult.ClearData();        
    tit_clearActionInfo();
	//tit_addSingleActionInfo("training:insertTrainingApprovalLicense", "", 0, "");
	tit_addSingleActionInfo("training:insertTrainingApprovalLicense_New", "", 0, "");
    // 서버 호출
    tit_callService(
         ""
        ,""
        ,"ds_iApproveLicense=ds_iApproveLicense"/// inDs
        ,"ds_oApproveLicenseResult=ds_oApproveLicenseResult"	// outDs
        ,"AJMGNO_NEW=" 		+ quote(AJMGNO)
        +" AJTJMGNO_NEW=" 	+ quote(AJTJMGNO)
        +" REMARK=" 		+ quote(REMARK)
        +" STATUS=" 		+ quote(STATUS)
        ,"lfn_AfterSave"
        ,false
        ,false
        ,true
    );
}


function lfn_AfterSave(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    //gfn_SaveMessage(); // 저장 메세지를 처리한다.
     
    if (ds_oApproveLicenseResult.GetColumn(0, "O_AJSTATUS") == "3") {
		if (ds_oApproveLicenseResult.GetColumn(0, "O_LLCSNO") <> "" &&
		    ds_oApproveLicenseResult.GetColumn(0, "O_LLCSNO") <> null  ) {			
			var msg = "";             		   
			msg += "승인처리되었습니다.\n\n"; 
			msg += "수첩발급번호 :  " + ds_oApproveLicenseResult.GetColumn(0, "O_LLCSNO");   				  
			gfn_Alert(msg);
			 
			// 문자발송
			//lfn_SMSSend("3");
		}   	
    }
    /*
    if (ds_oApproveLicenseResult.GetColumn(0, "O_AJSTATUS") == "4") {
			// 문자발송
			lfn_SMSSend("4");
    }
    if (ds_oApproveLicenseResult.GetColumn(0, "O_AJSTATUS") == "5") {
			// 문자발송
			lfn_SMSSend("5");
    }*/
    
   // lfn_Search();
}



function lfn_OnChanged(){
}

/**
 * 파일 다운로드
 */
function lfn_DownloadFile(obj) {

    if (length(ls_RealFileName) > 0) {

        fdImageFile.Type = "SAVE";
        fdImageFile.FileName = edImageFile.text + ".gif";

        if (fdImageFile.open()) {
            var arrRtn = tit_fileRead(
                hfImageFile
                , ls_FileDownloadPath
                , ls_RealFileName
                , fdImageFile.FilePath
                , fdImageFile.FileName
            );
            
            gfn_Alert(MSGI00060); //다운로드 완료 메시지
        }
    }
	
}
/**
 * 첨부파일 다운로드 
 */
function btnDownload_OnClick(obj)
{ 
	
	var ls_FileUploadPath = edfilePath.Text;  // /IMGDATA/ARSON/LICENSE/2022/11/
    var ls_RealFileName = edfileNm.Text; // MANUAL_20130611163213796.pdf 
    var ls_SaveFileName = edfileNm.Text; //개인정보동의서 관리 사용자설명서.pdf
    /*
    //test
    ls_FileUploadPath = "/BBSDATA";
    ls_RealFileName = "MANUAL_20130611163213796.pdf";
    ls_SaveFileName = "개인정보동의서 관리 사용자설명서.pdf";
    */
    if (length(ls_RealFileName) <= 0 || ls_RealFileName == "") {
		gfn_Alert("다운로드할 파일이 없습니다.");
	}   
	
	var vPath = "/IMGDATA" + ls_FileUploadPath ; // "/IMGDATA/ARSON/LICENSE/2022/11/" ; 
	var vFileName = ls_RealFileName; // "encFile_1F2A36D473B608B38D879F44DB8C3677.pdf";
	var vSaveName = ls_SaveFileName; // "복호화후파일.pdf";
	//var URL = "https://intrawork.kfsi.or.kr/kems/pos/UPlusPOS_Input.jsp";
    //var URL = "http://172.19.1.17:8090/survey/encFileDown.jsp";
	var URL = "https://intrawork.kfsi.or.kr/kems/encFileDown.jsp";
	URL = URL + "?pfilePath=" + vPath +"&pFileName=" + vFileName+"&pSaveFileName=" + vSaveName  ;
	ExecBrowser(URL);  
}

function btnImageZoom_OnClick(obj)
{	 
	var nRow = ds_ioApproveList.currow; 
	
	if(nRow < 0) {
		return ;
	}
	
	var sFilePath = ds_ioApproveList.GetColumn(nRow,"IILASTDIRPATH") ;
	var sRealFileName = ds_ioApproveList.GetColumn(nRow,"IILASTREALNM");
	var sSaveFileName = ds_ioApproveList.GetColumn(nRow,"IILASTREALNM"); 
	
	if(sFilePath == "" || sRealFileName == "" ){
		return ;
	} 
		
	/*
	 * 기능 : 이미지 팝업을 호출한다.
	 * parameter : sFilePath - 이미지 URL(예:/minimap)
	 *           : sRealFileName - 서버에 저장된 실제 파일 명
	 *           : sSaveFileName - 저장할 파일 명
	 * return value : 없음
	 */
	gfn_ImageViewPopup(
		sFilePath
		, sRealFileName
		, sSaveFileName				, ""	// MAP 구분		
		, "Y"	// 다운로드 여부
	); 
}


/****************************************************************************************
 * 기능 : 버튼 활성/비활성시킨다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 ****************************************************************************************/
function lfn_SetFormAuth(bStatus) {
    btnApprove.Enable = bStatus;  
    btnReject.Enable = bStatus;   
}


// 문자발송
function lfn_SMSSend(aStatus, i)
{
	var args = "";
 					
	if (gfn_isNull(edHpTel.Text)) {	// 휴대폰번호  확인 
		return false;
	}
	/*
	if (!gfn_Confirm("처리완료 문자를 보내시겠습니까?\n\n" +
					"⊙문자내용⊙\n"+
					"───────────────────────────────────\n"+
					"[한국소방안전원 "+gds_oUserInfo.GetColumn(0, "PDEPTNM")+"지부]\n"+
					"선임대상처 ["+ lbTitle.Text +"] 신청 건이 처리완료 되었습니다.\n\n"+
					"실무교육을 접수하시려는 분은 안전원 홈페이지(https://www.kfsi.or.kr/mobile/ojt/OjtApplyList.do)에서 실무교육일정 선택 후 접수를 진행하시기 바랍니다.\n"+
					"이용해 주셔서 감사합니다.\n"+
					"문의사항은 "+gds_oUserInfo.GetColumn(0, "PDEPTNM")+"지부("+mid(gds_oUserInfo.GetColumn(0, "TEL"), 0, 12)+")로 연락하시기 바랍니다.\n"+
					"───────────────────────────────────")) {
		return false ;
	}
	*/
				
	var sFcmgno = "";
	var sFcseq = "";
	var sMbccd = ""; // 업무구분코드 
	var sMsg = "";
	if(aStatus == "3"){ //승인완료 : 
	    sMbccd = "706"; // 업무구분코드 (706:수첩-심사승인)
		sMsg = "[한국소방안전원]\n"+
				"신청하신 자격심사가 승인되었습니다.\n"+
				"한국소방안전원 홈페이지에서 확인하시기 바랍니다.";
	}
	if(aStatus == "4"){ //반려 :   
	    sMbccd = "707"; // 업무구분코드 (707:수첩-심사반려)
		sMsg = "[한국소방안전원]\n"+
				"신청하신 자격심사가 반려되었습니다.\n"+
				"반려사유 : " + ds_ioApproveList.GetColumn(i,"AJRESON") + "\n"+
				"한국소방안전원 홈페이지에서 확인하시기 바랍니다.";
	}
	if(aStatus == "5"){ //보완 :   
	    sMbccd = "708"; // 업무구분코드 (708:수첩-심사보완)
		sMsg = "[한국소방안전원]\n"+
				"신청하신 자격심사가 보완요청되었습니다.\n"+
				"보완요청 사유 : " + ds_ioApproveList.GetColumn(i,"AJMODRESON")+"\n"+
				"한국소방안전원 홈페이지에서 확인하시기 바랍니다.";
	}
	
	args += " MTITLE=" + quote("한국소방안전원 자격수첩 발급안내");		// 제목
	args += " MRECVTEL=" + quote(replace(edHpTel.Text, "-", ""));				// 휴대폰번호
	args += " MCALLBACK=" + quote(mid(replace(gds_oSameUserInfo.GetColumn(0, "TEL"), "-", ""), 0, 10));		// 회신번호 - 로그인한 사용자의 대표번호 
	args += " MMSG=" + quote(sMsg);  // 전문
	//args += " ETC1=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD"));		// 지부코드
	args += " MBCCD=" + quote(sMbccd);		// 업무구분코드
	args += " MPK1=" + quote(sFcmgno);		// 
	args += " MPK2=" + quote(sFcseq);		// 
	args += " MPK3=''";		// 
	args += " MRECVNM=" + quote(edPersonNm.Text);		// 수신자명
	args += " MSENDTYPE='0'";		// 발송구분(0:즉시,1:예약)
	args += " MSENDDATE=''";			// 발송시간 예약일 경우만
			 
	//MMS문자발송
	tit_clearActionInfo();
	tit_addSingleActionInfo("com:insertKTSMSSend", "", 0, "");
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oStatus=ds_oStatus"	// outDs
		,args // args 
		,""
		,false
	);
	
}

function btnSaveXml_OnClick(obj)
{ 
	tx_xmlTest.Text = ds_ioApproveList.SaveXML() + ' ' + ds_iApproveLicense.SaveXML();
}



function Button1_OnClick(obj)
{

}

function cbAjgubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{	
	ds_ioApproveList.SetColumn(ds_ioApproveList.currow,"AJGUBUN",obj.Value);
    // 발급구분에 따라 취득구분 값 셋팅 필요 	
    ds_oAjgubunAll.UnFilter();
	ds_oAjgubunAll.Filter("AJGUBUN=='"+obj.Value + "'");	
	ds_ioApproveList.SetColumn(ds_ioApproveList.currow,"AJISSUEGUBUN",ds_oAjgubunAll.GetColumn(0,"AJISSUEGUBUN"));
	edAJISSUEGUBUN.Text = ds_oAjgubunAll.GetColumn(0,"AJISSUEGUBUN");
}

/*
신청서 출력 
*/
function lfn_Print(obj)
{
    /*if (ds_ioApproveList.GetRowCount() < 1) {
        gfn_Alert("출력할 데이터가 존재하지 않습니다.");
        return;
    }*/
    
	if (medCheckCnt.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("출력할 데이터를 선택해 주세요!.");      

        return false;

    }
    
    ds_ioApproveList.Filter("SEL = '1'");
    
    
	if(obj.id == 'btnPrint'){
		ds_ioApproveData.Clear();   
		ds_ioApproveData.copy(ds_ioApproveList);    
		ds_ioApproveData.ClearData();    
		var rIdx = ds_ioApproveData.InsertRow(0);
		ds_ioApproveData.copyrow(rIdx,ds_ioApproveList,ds_ioApproveList.currow);
	
	}		
	if(obj.id == 'btnPrintAll'){ 
		
		ds_ioApproveData.Clear();    
		ds_ioApproveData.CopyF(ds_ioApproveList);    
	}
			
    
    // 출력이력을 저장한다.     
    gfn_InsertSearchPrintHistory(
        "P"
        , this.ID
        , global.mnuLeft.cbxOpenForm.Text
        , ls_HistoryArg
    ); 


	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(		
				"P"				
				, gs_CallCenterUID	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")
				, this.ID	
				, global.mnuLeft.cbxOpenForm.Text+"(신청서)"	
				, ls_HistoryArg				
			);
	}  
	
	 
	// 미리보기 후 출력 	
	gfn_CallReportPopup("frmtraining0364R01LicenseJubsuPrint.rex"
				  , "ds_ioApproveData"
				  //, "JIBU=" + cbxJibu.Value + "^YEAR=" + substr(medYearMonth.Value,0,4) + "^MONTH=" +MONTH + "^DATE_FR=" + DATE_FR + "^DATE_TO=" + DATE_TO
				  , true);
				  
	lfn_Search();
}


function ds_ioApproveList_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var total = toNumber(medCheckCnt.Value);
	
	if(strColumnID == "SEL")
	{
		if(ds_ioApproveList.GetColumn(nRow, "SEL") == 1)
		{	
			medCheckCnt.Value = toNumber(total)+1;
			medCheckCnt.Value = toNumber(total)+1;
		}else {
				
			medCheckCnt.Value = toNumber(total)-1;
			medCheckCnt.Value = toNumber(total)-1;
		}
	}
}

function btConfirmCancell_OnClick(obj)
{
	var row = 0;
	var currow = 0;
	var msg = "";
	var STATUS = 9;
	
	currow = ds_ioApproveList.GetCurrow();
	row = ds_ioApproveList.GetRowCount();
	
    if (edCheckCount.Value <= 0) { //선택한것이 있는지 체크 메세지 보임

        gfn_Alert("대상자를 선택하세요!.");      

        return false;

    }
		
	msg = "승인취소 하시겠습니까?.";
	
	if(!gfn_Confirm(msg))
	{
		return false;
	}
	
	// 다중 접수취소를 할 경우 우선 신청상태부터 확인한다.
	for (var i=0; i<row; i++)
	{
		if(ds_ioApproveList.GetColumn(i, "SEL") == 1)
		{
			var eastatus = ds_ioApproveList.GetColumn(i, "AJSTATUS");
			
			if(eastatus <> "3")
			{
				gfn_Alert(" 선택한 내역중 승인상태가 아닌건이 있습니다.\n\n"
						 +" 승인취소는 [승인]상태 에서만 취소할 수 있습니다.");
				return false;
			}
			else {
				var AJMGNO = ds_ioApproveList.GetColumn(i, "AJMGNO");
				var AJTPMGNO = ds_ioApproveList.GetColumn(i, "AJTPMGNO");
				var REMARK = "";
				save_mod(EAMGNO, EATPMGNO, REMARK, STATUS);
			}
		}
	}
		
	gfn_Alert("처리되었습니다.");
	lfn_Search();	
}

function gdList_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	var lobj_Dataset = object(obj.BindDataset);
	if (nCell == 0) { // 선택
        if (obj.GetCellProp("head", nCell, "text") == 1) { // 전체가 이미 선택된 경우
            obj.SetCellProp("head", nCell, "text", 0);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                lobj_Dataset.SetColumn(i, "SEL", "0");
            }
        } 
        else { // 전체가 이미 선택되지 않은 경우
            obj.SetCellProp("head", nCell, "text", 1);
            for(i = 0; i < lobj_Dataset.RowCount(); i++) {
                
                if(ds_ioApproveList.GetColumn(i, "AJSTATUS") == 6)
                {
					lobj_Dataset.SetColumn(i, "SEL", "0");
				}else {
					lobj_Dataset.SetColumn(i, "SEL", "1");
				}		
            }
        }
	} 
	else { // 헤드 정렬
        lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex);
	}	
}
]]></Script>
</Window>
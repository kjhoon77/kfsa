<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="590" Id="frmspcledu0260MPrizeAwardManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="상장수혜자등록" Top="8" Ver="1.0" Width="800" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_ioTrainingExamPrize">				<Contents>					<colinfo id="TOMGGTMGNO" size="2" summ="default" type="STRING"/>					<colinfo id="TJADDR1" size="220" summ="default" type="STRING"/>					<colinfo id="PGUBUN" size="30" summ="default" type="STRING"/>					<colinfo id="PGUBUN2" size="30" summ="default" type="STRING"/>					<colinfo id="TOTCCOURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="TJADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="TJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TJPERSONNM" size="100" summ="default" type="STRING"/>					<colinfo id="TJRESIDENTNO_SANG" size="6" summ="default" type="STRING"/>					<colinfo id="TOHJUBSUNO" size="6" summ="default" type="STRING"/>					<colinfo id="TOMGNO" size="30" summ="default" type="STRING"/>					<colinfo id="TOTRAININGORDER" size="3" summ="default" type="STRING"/>					<colinfo id="TOYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="TJTPMGNO" size="22" summ="default" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oPrizeGubun">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oCourse">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJibu">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>		</Datasets>		<Shape Bottom="84" Height="52" Id="shpGubunBox" Left="4" LineColor="user15" Right="796" TabOrder="22" Top="32" Type="Rectangle" Width="792"></Shape>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="149" LineColor="user14" Right="796" TabOrder="61" Top="1" Type="Rectangle" Width="647"></Shape>		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="15" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="148">			<Contents></Contents>		</Div>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioTrainingExamPrize" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="584" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="472" Id="gdTraining" InputPanel="FALSE" Left="4" LineColor="default" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="796" RowHeight="20" Style="sty_Grid" TabOrder="14" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UserData="수료자목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">			<contents>				<format id="Default">					<columns>						<col width="78"/>						<col width="101"/>						<col width="86"/>						<col width="91"/>						<col width="289"/>						<col width="175"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="상장구분"/>						<cell align="center" col="1" display="text" text="교육접수번호"/>						<cell align="center" col="2" display="text" text="성명"/>						<cell align="center" col="3" display="text" text="생년월일"/>						<cell align="center" col="4" display="text" text="주소1"/>						<cell align="center" col="5" display="text" text="주소2"/>					</head>					<body>						<cell align="center" col="0" colid="PGUBUN" combocol="CD" combodataset="ds_oPrizeGubun" combotext="DATA" display="combo"/>						<cell align="center" col="1" colid="TOHJUBSUNO" display="combo"/>						<cell align="center" col="2" colid="TJPERSONNM" display="text"/>						<cell align="center" col="3" colid="TJRESIDENTNO_SANG" display="combo"/>						<cell align="left" col="4" colid="TJADDR1" display="text"/>						<cell align="left" col="5" colid="TJADDR2" display="text"/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="722" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="13" Top="88" Transparent="TRUE" Width="74"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_TEXT_08" Left="152" OnClick="lfn_Search" Style="sty_Button" TabOrder="1" Text="수료자&#32;조회(F2)" ToolTipText="수료자&#32;조회" Top="4" Width="118"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_TEXT_COM" Left="272" OnClick="lfn_Save" Style="sty_Button" TabOrder="2" Text="등록(F4)" ToolTipText="상장수혜자로&#32;등록" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="446" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="4" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="534" OnClick="lfn_localExcel" Style="sty_Button" TabOrder="5" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="621" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="6" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="708" OnClick="lfn_End" Style="sty_Button" TabOrder="7" ToolTipText="닫기" Top="4" Width="85"></Button>		<Static Align="Center" Height="20" Id="lbWorkGubun" Left="8" Style="sty_Label" TabOrder="16" Text="등록구분" Top="60" VAlign="Middle" Width="88"></Static>		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="20" Id="radPrizeGubun" INDEX="0" InnerDataset="ds_oPrizeGubun" Left="104" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="12" Top="60" Value="ALL" Width="200"></Radio>		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="20" Text="지부" Top="36" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="35" UserData="I:지부" Width="88"></Combo>		<Static Align="Center" Height="20" Id="lbCourse" Left="322" Style="sty_Label" TabOrder="17" Text="직능" Top="36" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxCourse" INDEX="0" InnerDataset="ds_oCourse" Left="413" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="10" Top="35" UserData="S:직능" Width="182"></Combo>		<Static Align="Center" Height="20" Id="lbYear" Left="192" Style="sty_Label" TabOrder="19" Text="년도" Top="36" UserData="S" VAlign="Middle" Width="88"></Static>		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Height="20" Id="edYear" ImeMode="native" Left="282" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="36" UserData="I:년도" Width="36"></Edit>		<Static Align="Center" Height="20" Id="lbTrainingOrder" Left="598" Style="sty_Label" TabOrder="18" Text="회차" Top="36" UserData="S" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingOrder" ImeMode="native" Left="690" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="lfn_EnterNextFocus" Style="sty_Edit" TabOrder="11" Top="36" UserData="S:회차" Width="28"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="359" OnClick="lfn_Delete" Style="sty_Button" TabOrder="3" ToolTipText="삭제&#32;저장" Top="4" Width="85"></Button>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu0260MPrizeAwardManagement.xml * 설명 : 상장수혜자등록 * 작성일 : 2009.09.20 * 작성자 : 이창희 */#include "LIB::training.js"; // 공통업무 관련/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    // 폼 환경설정    ls_SystemGubun = gs_SystemGubun;    ls_SystemMenuId = gs_SystemMenuId;    var ls_FormId = split(sFormUrl, "::");    ls_FormId = split(ls_FormId[1], ".");    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정        lfn_SetFormAuth(true); // 저장 권한    } else if (ms_FormAuth == "R") {        lfn_SetFormAuth(false); // 읽기 권한    } else {        gfn_Alert(MSGI00080);        close();    }    // 공통 코드 조회    gfn_SearchTrainingCourse("T", ds_oCourse, "Y", "선택"); // 직능 코드 조회    cbxCourse.Value = "60";    gfn_SearchJibu(cbxJibu, "Y", "선택"); // 지부 코드 조회    gfn_SearchCommonCode(ds_oPrizeGubun, "PRIZEGUBUN", "Y"); // 상장구분 코드 조회    radPrizeGubun.Value = "1";    edTrainingOrder.SetFocus();        edYear.Text = left(GetDate(), 4);}function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    // to do    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리}function Form_OnSize(obj,nCx,nCy,nState){    if (gs_IsResizingForm == "Y") {        gdTraining.Height = nCy - gdTraining.Top - 4;        gdTraining.Width = nCx - gdTraining.Left - 4;    }}/* * 기능 : 조회 */function lfn_Search(obj) {    if (!gfn_FormValidate(this)) { // 입력 Validation Check    return false;    }    ds_ioTrainingExamPrize.ClearData(); // 데이타셋 초기화    ////////////////    ls_HistoryArg = "지부=" + quote(cbxJibu.Text)            + ",직능=" + quote(cbxCourse.Text)            + ",년도=" + quote(edYear.Text)            + ",회차=" + quote(edTrainingOrder.Text)            + ",등록구분=" + quote(radPrizeGubun.Text);      gfn_InsertSearchPrintHistory(        "S"        , this.ID        , global.mnuLeft.cbxOpenForm.Text        , ls_HistoryArg    );     ////////////////    tit_clearActionInfo();	tit_addCsvSearchActionInfo("spcledu:searchTrainingExamPrize", false);	// 서버 호출 	tit_callService(		""		,""		,""	// inDs		,"ds_ioTrainingExamPrize=ds_oTrainingExamPrize"	// outDs		  ,"TOMGGTMGNO=" + quote(cbxJibu.value)   //-- 지부            +" TOYEAR=" + quote(edYear.text)  //-- 년도            +" TOTCCOURSECD=" + quote(cbxCourse.value) // -- 직능                        +" TOTRAININGORDER=" + quote(edTrainingOrder.text) // -- 수료회차                                +" PGUBUN=" + quote(radPrizeGubun.value)//  -- 등록구분       	// args 		,"lfn_AfterSearchTraining"		,false	);}/* * 기능 : 추가 */function lfn_Input(obj) {	if (!gfn_Confirm(MSGI00070)) { // 신규 추가 하시겠습니까?\n입력완료 후 저장 버튼을 누르세요.        return false;	}	mb_IsNewData = true; // 저장버튼이 클릭 설정    lfn_Cancel(); // 값 초기화    // 기본값 설정}/* * 기능 : 삭제  상장수혜 정보를 삭제함 */function lfn_Delete(obj) {    if (ds_ioTrainingExamPrize.currow < 0) {        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.        return false;    }    	if (!gfn_Confirm(MSGW00030)) { // 정말로 삭제 하시겠습니까?        return false;	}       var pgubun_before = ds_ioTrainingExamPrize.GetColumn(ds_ioTrainingExamPrize.currow, "PGUBUN"); //선택한 기존 상장종류    ds_ioTrainingExamPrize.SetColumn(ds_ioTrainingExamPrize.currow, "PGUBUN","");  //현재 지정한 row의 상장구분을 지운다.        if(pgubun_before =="")  //선택한것이 있는지 체크 메세지 보임        { alert("상장수여 인원을 선택하지 않았거나 변경할 내용이 없습니다.");              return false;    } else {           lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.      	tit_clearActionInfo();	tit_addSaveActionInfo(		""	// insert		, "spcledu:deleteTrainingExamPrize"	// update		, ""	// delete		, ""	// flag column 명		, ""	// key sql id		, 0	// key 증가 값		, "" 		, 0 		, "N"	// 실행타입	);	// 서버 호출 	tit_callService(		""		,""		,"ds_ideleteTrainingExamPrize=ds_ioTrainingExamPrize:U"	// inDs		,""	// outDs		,"pguBun_beFore=" + quote(pgubun_before)	// args  // 삭제전의 상장종류		,"lfn_AfterSaveTraining"		,false	  );	};}/* * 기능 : 저장 */function lfn_Save(obj) {    if (!gfn_FormValidate(this)) { // 입력 Validation Check        return false;    }    if (!gfn_Confirm(MSGW00020)) { // 정말로 추가 저장 하시겠습니까?        return false;    }        // 상장구분값을 현재row에 담는다.    ds_ioTrainingExamPrize.SetColumn(ds_ioTrainingExamPrize.currow, "PGUBUN",radPrizeGubun.Value);        //alert(ds_ioTrainingExamPrize.GetColumn(ds_ioTrainingExamPrize.currow, "PGUBUN"));        if(!gfn_CheckChangedGrid(this))  //선택한것이 있는지 체크 메세지 보임    { alert("상장수여 인원을 선택하지 않았거나 변경할 내용이 없습니다.");              return false;    } else {        lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.        tit_clearActionInfo();	tit_AddMultiActionInfo(			"spcledu:insertTrainingExamPrize"	// insert  				, ""	// update  		, ""	// delete		, ""	// flag column 명		, ""	// key sql id		, 0	// key 증가 값		, "" 		, 0 		, "N"	// 실행타입	);	// 서버 호출 	tit_callService(		""		,""		,"ds_iinsertTrainingExamPrize=ds_ioTrainingExamPrize:U"/// inDs					,""	// outDs		,"PSABUN=" + gds_oUserInfo.GetColumn(0, "PDEPTCD") // -- 사번 "  		//  +" PGUBUN2=" + quote(radPrizeGubun.value) // -- 상장구분  		// args 		,"lfn_AfterSaveTraining"		,false	);    }    }/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 시험자 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchTraining(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SearchMessage(gdTraining); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSaveTraining(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SaveMessage(); // 저장 메세지를 처리한다.    lfn_Search(); // 시험자 조회}/* * 기능 : 버튼 활성/비활성시킨다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetFormAuth(bStatus) {    btnSave.Enable = bStatus; // 저장 버튼    btnDelete.Enable = bStatus; // 삭제 버튼    gdTraining.Editable = bStatus;}/* 사용자 이벤트 함수 */function btnMutilSort_OnClick(obj){	gfn_GridMultiSort(gdTraining, 1); // 멀티 정렬을 실행한다.}function lfn_EnterNextFocus(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){	if (nChar == 13) {        gfn_ComponentOnKillFocus(obj);        obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));         lfn_Search();	}}function lfn_localExcel(obj){      if (ds_ioTrainingExamPrize.GetRowCount() < 1) {        gfn_Alert("출력할 데이터가 존재하지 않습니다.");        return false;    }	lfn_Excel(obj);}]]></Script></Window>
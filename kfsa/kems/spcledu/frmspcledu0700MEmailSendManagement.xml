<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="590" Id="frmspcledu0700MEmailSendManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="인터넷접수메일발송" Top="8" Ver="1.0" Width="800" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_ioInternetTrainingJubsu">				<Contents>					<colinfo id="EPNM" size="100" summ="default" type="STRING"/>					<colinfo id="EPPARKINGINFO" size="100" summ="default" type="STRING"/>					<colinfo id="ETCCOMMENT" size="0" summ="default" type="STRING"/>					<colinfo id="GTDEPTNM" size="20" summ="default" type="STRING"/>					<colinfo id="GTTEAMNM" size="70" summ="default" type="STRING"/>					<colinfo id="SEL" size="1" summ="default" type="STRING"/>					<colinfo id="TCCOURSENM" size="30" summ="default" type="STRING"/>					<colinfo id="TJADDR" size="201" summ="default" type="STRING"/>					<colinfo id="TJHPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="TJHSTATUSCD" size="50" summ="default" type="STRING"/>					<colinfo id="TJZIPCD" size="7" summ="default" type="STRING"/>					<colinfo id="TOEDUNM" size="30" summ="default" type="STRING"/>					<colinfo id="TOEUDDATE" size="36" summ="default" type="STRING"/>					<colinfo id="TOHPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="TOTRAININGORDER" size="3" summ="default" type="STRING"/>					<colinfo id="TOYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="TPEMAIL" size="81" summ="default" type="STRING"/>					<colinfo id="TJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TPNM" size="20" summ="default" type="STRING"/>					<colinfo id="TPRESIDENT" size="6" summ="default" type="STRING"/>					<colinfo id="TPTEL" size="16" summ="default" type="STRING"/>					<colinfo id="JUBSUNO" size="256" summ="default" type="STRING"/>					<colinfo id="TOHJUBSUNO" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oWorkGubun">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD>TRAINING</CD>						<DATA>인터넷강습접수</DATA>					</record>					<record>						<CD>EXAM</CD>						<DATA>인터넷시험접수</DATA>					</record>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oCourse">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oJibu">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioInternetExamJubsu">				<Contents>					<colinfo id="SEL" size="1" type="STRING"/>					<colinfo id="EJHPROCDATE" size="8" type="STRING"/>					<colinfo id="EJMGNO" size="22" type="DECIMAL"/>					<colinfo id="EOEXAMDATE" size="8" type="STRING"/>					<colinfo id="EOEXAMORDER" size="3" type="STRING"/>					<colinfo id="EOHJUBSUNO" size="6" type="STRING"/>					<colinfo id="EOYEAR" size="4" type="STRING"/>					<colinfo id="EREXAMROOM" size="30" type="STRING"/>					<colinfo id="ETCCOMMENT" size="0" type="STRING"/>					<colinfo id="GTDEPTNM" size="20" type="STRING"/>					<colinfo id="JIBUNM" size="70" type="STRING"/>					<colinfo id="JUBSUNO" size="50" type="STRING"/>					<colinfo id="TCCOURSENM" size="30" type="STRING"/>					<colinfo id="TJADDR" size="201" type="STRING"/>					<colinfo id="TJHSTATUSCD" size="50" type="STRING"/>					<colinfo id="TJZIPCD" size="7" type="STRING"/>					<colinfo id="TOEDUNM" size="30" type="STRING"/>					<colinfo id="TOEUDDATE" size="25" type="STRING"/>					<colinfo id="TPEMAIL" size="81" type="STRING"/>					<colinfo id="TPNM" size="20" type="STRING"/>					<colinfo id="TPRESIDENT" size="14" type="STRING"/>					<colinfo id="TPTEL" size="35" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oEmailSeq">				<Contents></Contents>			</Dataset>		</Datasets>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="270" LineColor="user14" Right="796" TabOrder="15" Top="1" Type="Rectangle" Width="526"></Shape>		<Shape Bottom="108" Height="76" Id="shpGubunBox" Left="4" LineColor="user15" Right="796" TabOrder="23" Top="32" Type="Rectangle" Width="792"></Shape>		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="15" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="268">			<Contents></Contents>		</Div>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioInternetTrainingJubsu" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="582" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" Format="Training" HeadBorder="Flat" HeadHeight="20" Height="446" Id="gdInternetJusu" InputPanel="FALSE" LineColor="default" OnHeadClick="gdInternetJusu_OnHeadClick" Right="792" RowHeight="20" Style="sty_Grid" TabOrder="14" TabStop="true" Top="136" UseDBuff="true" UsePopupMenu="true" UserData="인터넷접수목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">			<contents>				<format id="Training">					<columns>						<col width="29"/>						<col width="40"/>						<col width="40"/>						<col width="100"/>						<col width="40"/>						<col width="70"/>						<col width="70"/>						<col width="150"/>						<col width="80"/>						<col width="80"/>						<col width="85"/>					</columns>					<head>						<cell align="center" col="0" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" display="text" text="지부"/>						<cell align="center" col="2" display="text" text="년도"/>						<cell align="center" col="3" display="text" text="직능"/>						<cell align="center" col="4" display="text" text="회차"/>						<cell align="center" col="5" display="text" text="접수번호"/>						<cell align="center" col="6" display="text" text="접수자명"/>						<cell align="center" col="7" display="text" text="이메일"/>						<cell align="center" col="8" display="text" text="접수신청일"/>						<cell align="center" col="9" display="text" text="접수완료일"/>						<cell align="center" col="10" display="text" text="접수상태"/>					</head>					<body>						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" colid="GTDEPTNM" display="text"/>						<cell align="center" col="2" colid="TOYEAR" display="combo"/>						<cell align="left" col="3" colid="TCCOURSENM" display="text"/>						<cell align="center" col="4" colid="TOTRAININGORDER" display="combo"/>						<cell align="center" col="5" colid="TOHJUBSUNO" display="text"/>						<cell align="center" col="6" colid="TPNM" display="text"/>						<cell align="left" col="7" colid="TPEMAIL" display="text"/>						<cell align="left" col="8" colid="TOHPROCDATE" display="text" Mask="@@@@-@@-@@"/>						<cell align="left" col="9" colid="TJHPROCDATE" display="text" Mask="@@@@-@@-@@"/>						<cell align="left" col="10" colid="TJHSTATUSCD" display="text"/>					</body>				</format>				<format id="Exam">					<columns>						<col width="29"/>						<col width="40"/>						<col width="40"/>						<col width="100"/>						<col width="40"/>						<col width="70"/>						<col width="70"/>						<col width="150"/>						<col width="80"/>						<col width="80"/>						<col width="85"/>					</columns>					<head>						<cell align="center" col="0" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" display="text" text="지부"/>						<cell align="center" col="2" display="text" text="년도"/>						<cell align="center" col="3" display="text" text="직능"/>						<cell align="center" col="4" display="text" text="회차"/>						<cell align="center" col="5" display="text" text="접수번호"/>						<cell align="center" col="6" display="text" text="접수자명"/>						<cell align="center" col="7" display="text" text="이메일"/>						<cell align="center" col="8" display="text" text="접수일자"/>						<cell align="center" col="9" display="text" text="시험일자"/>						<cell align="center" col="10" display="text" text="접수상태"/>					</head>					<body>						<cell align="center" col="0" colid="SEL" display="checkbox" edit="checkbox"/>						<cell align="center" col="1" colid="GTDEPTNM" display="text"/>						<cell align="center" col="2" colid="EOYEAR" display="text"/>						<cell align="center" col="3" colid="TCCOURSENM" display="text"/>						<cell align="center" col="4" colid="EOEXAMORDER" display="text"/>						<cell align="center" col="5" colid="EJMGNO" display="text"/>						<cell align="center" col="6" colid="TPNM" display="text"/>						<cell align="left" col="7" colid="TPEMAIL" display="text"/>						<cell align="left" col="8" colid="EJHPROCDATE" display="text" Mask="@@@@-@@-@@"/>						<cell align="left" col="9" colid="EOEXAMDATE" display="text" Mask="@@@@-@@-@@"/>						<cell align="left" col="10" colid="TJHSTATUSCD" display="text"/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="722" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="13" Top="114" Transparent="TRUE" Width="74"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="273" OnClick="lfn_Search" Style="sty_Button" TabOrder="1" ToolTipText="조회" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="447" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="3" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="534" OnClick="lfn_Excel" Style="sty_Button" TabOrder="4" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="621" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="5" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="708" OnClick="lfn_End" Style="sty_Button" TabOrder="6" ToolTipText="닫기" Top="4" Width="85"></Button>		<Static Align="Center" Height="20" Id="lbTrainingOrder" Left="470" Style="sty_Label" TabOrder="18" Text="회차" Top="60" UserData="S" VAlign="Middle" Width="88"></Static>		<Static Align="Center" Height="20" Id="lbCourse" Left="191" Style="sty_Label" TabOrder="17" Text="직능" Top="60" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxCourse" INDEX="0" InnerDataset="ds_oCourse" Left="282" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="9" Top="59" UserData="S" Width="182"></Combo>		<Static Align="Center" Height="20" Id="lbJubsuDate" Left="8" Style="sty_Label" TabOrder="19" Text="접수일자" Top="84" UserData="S" VAlign="Middle" Width="88"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calJubsuDateEnd" Left="220" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="12" Top="84" UserData="S:접수일자" WeeksFont="돋음,9" Width="98"></Calendar>		<Static Align="Center" Height="20" Id="lbDateWave" Left="202" Style="sty_Text" TabOrder="20" Text="~" Top="84" VAlign="Middle" Width="10"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calJubsuDateStart" Left="100" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="11" Top="84" UserData="S:접수일자" WeeksFont="돋음,9" Width="98"></Calendar>		<Radio Border="None" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radWorkGubun" INDEX="0" InnerDataset="ds_oWorkGubun" Left="104" OnChanged="radWorkGubun_OnChanged" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="7" Top="36" Value="TRAINING" Width="260"></Radio>		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="21" Text="지부" Top="60" UserData="S" VAlign="Middle" Width="88"></Static>		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxJibu" ImeMode="none" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="58" UserData="I" Width="88"></Combo>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingOrder" ImeMode="native" Left="562" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="lfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="10" Top="60" UserData="S:회차" Width="28"></Edit>		<Static Align="Center" Height="20" Id="lbWorkGubun" Left="8" Style="sty_Label" TabOrder="22" Text="업무구분" Top="36" VAlign="Middle" Width="88"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSend" ImageID="BTN_TEXT_COM" Left="360" OnClick="lfn_Send" Style="sty_Button" TabOrder="2" Text="메일발송" ToolTipText="E-Mail&#32;발송" Top="4" Width="85"></Button>		<WebBrowser Height="20" Id="wbSendMail" Left="701" TabOrder="24" Top="114" Visible="FALSE" Width="20"></WebBrowser>		<Static Align="Center" Height="20" Id="lbEmailCnt" Left="4" Style="sty_LabelStat" TabOrder="26" Text="건수" Top="112" VAlign="Middle" Width="88"></Static>		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medEmailCnt" Left="96" Mask="#,###" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="25" Top="112" Width="88"></MaskEdit>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu0700MEmailSendManagement.xml * 설명 : 인터넷접수메일발송 * 작성일 : 2009.10.19 * 작성자 : 김은규 */#include "LIB::training.js"; // 공통업무 관련//공통 변수var md5_check_value = "12!@_kfsa";var MD5;	//MD5 HashValuevar checkCntFlag1;	//체크된 데이터 갯수var checkCntFlag2;	//발송된 데이터 갯수/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    // 폼 환경설정    ls_SystemGubun = gs_SystemGubun;    ls_SystemMenuId = gs_SystemMenuId;    var ls_FormId = split(sFormUrl, "::");    ls_FormId = split(ls_FormId[1], ".");    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정        lfn_SetFormAuth(true); // 저장 권한    } else if (ms_FormAuth == "R") {        lfn_SetFormAuth(false); // 읽기 권한    } else {        gfn_Alert(MSGI00080);        close();    }    // 공통 코드 조회    gfn_SearchTrainingCourse("T", ds_oCourse, "Y", "전체"); // 직능 코드 조회    cbxCourse.Value = "";    gfn_SearchJibu(cbxJibu, "Y", "전체"); // 지부 코드 조회    calJubsuDateStart.Value = GetDate();    calJubsuDateEnd.Value = GetDate();}function Form_OnKeyDown(obj,objJubsuerObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    // to do    gfn_Form_OnKeyDown(obj,objJubsuerObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리}function Form_OnSize(obj,nCx,nCy,nState){    if (gs_IsResizingForm == "Y") {        gdInternetJusu.Height = nCy - gdInternetJusu.Top - 4;        gdInternetJusu.Width = nCx - gdInternetJusu.Left - 4;    }}/* * 기능 : 조회 */function lfn_Search(obj) {    if (!gfn_FormValidate(this)) { // 입력 Validation Check        return false;    }        if (radWorkGubun.Value == "TRAINING") { // 인터넷 강습접수        ds_ioInternetTrainingJubsu.ClearData(); // 데이타셋 초기화                tit_clearActionInfo();        tit_AddSearchActionInfo("spcledu:searchInternetTrainingJusu", false);        // 서버 호출        tit_callService(            ""            ,""            ,""	// inDs            ,"ds_ioInternetTrainingJubsu=ds_oTrainingInternetJubsu"	// outDs            ,"TOMGGTMGNO=" + quote(cbxJibu.value)   //-- 지부              +" TOTRAININGORDER=" + quote(edTrainingOrder.text) // -- 회차              +" TOTCCOURSECD=" + quote(cbxCourse.value)   //-- 직능                            +" JUBSUDATE1=" + quote(replace(calJubsuDateStart.text,"-",""))  //-- 접수일자1              +" JUBSUDATE2=  " + quote(replace(calJubsuDateEnd.text,"-","")) // -- 접수일자2                              + " SEL='0'"   // args  체크여부 확인 위함            ,"lfn_AfterSearchInternetJusu"            ,false        );    } else { // 인터넷 시험접수        ds_ioInternetExamJubsu.ClearData(); // 데이타셋 초기화                 tit_clearActionInfo();        tit_AddCsvSearchActionInfo("spcledu:searchInternetExamJusu", false);        // 서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,"ds_ioInternetExamJubsu=ds_oTrainingExamJubsu"	// outDs            ,"EOMGGTMGNO=" + quote(cbxJibu.value)   //-- 지부              +" EOEXAMORDER=" + quote(edTrainingOrder.text) // -- 회차              +" EOTCCOURSECD=" + quote(cbxCourse.value)   //-- 직능                            +" JUBSUDATE1=" + quote(replace(calJubsuDateStart.text,"-",""))  //-- 접수일자1              +" JUBSUDATE2=  " + quote(replace(calJubsuDateEnd.text,"-","")) // -- 접수일자2              + " SEL='0'"   // args  체크여부 확인 위함            ,"lfn_AfterSearchInternetJusu"            ,false        );	    }}/* * 기능 : 메일발송 */function lfn_Send(obj) {	var lsConfirmStr = "";	if (radWorkGubun.Value == "TRAINING") { // 인터넷 강습접수		lsConfirmStr = "선택된 접수자에게 강습접수 안내메일을 발송 하시겠습니까?";	} else {		lsConfirmStr = "선택된 접수자에게 시험접수 안내메일을 발송 하시겠습니까?";	}		if (!gfn_Confirm(lsConfirmStr)) {        return false;    }    	var lnFlag = false;	//Condition Check Falg	checkCntFlag1 = 0;	//Check Count1 초기화	checkCntFlag2 = 0;	//Check Count2 초기화		if(radWorkGubun.Value == "TRAINING") {	//인터넷강습접수		for(var i=0; i<ds_ioInternetTrainingJubsu.GetRowCount(); i++) {			if(ds_ioInternetTrainingJubsu.GetColumn(i, "SEL") == 1) checkCntFlag1++;		}	} else {	//인터넷 시험접수		for(var i=0; i<ds_ioInternetExamJubsu.GetRowCount(); i++) {			if(ds_ioInternetExamJubsu.GetColumn(i, "SEL") == 1) checkCntFlag1++;		}	}		if(radWorkGubun.Value == "TRAINING") {	//인터넷강습접수		for(var i=0; i<ds_ioInternetTrainingJubsu.GetRowCount(); i++) {			if(ds_ioInternetTrainingJubsu.GetColumn(i, "SEL") == 1) lnFlag = true;		}	} else {	//인터넷 시험접수		for(var i=0; i<ds_ioInternetExamJubsu.GetRowCount(); i++) {			if(ds_ioInternetExamJubsu.GetColumn(i, "SEL") == 1) lnFlag = true;		}	}		if(lnFlag == false) {	//메일발송할 데이터가 없음		gfn_Alert("메일발송 대상을 선택하십시오.");		return;	}		lfn_CreateWaitMail("",this);	//진행 팝업 Open		if(radWorkGubun.Value == "TRAINING") {	//인터넷강습접수		for(var i=0; i<ds_ioInternetTrainingJubsu.GetRowCount(); i++) {			if(ds_ioInternetTrainingJubsu.GetColumn(i, "SEL") == 1) {				ds_oEmailSeq.ClearData();				tit_clearActionInfo();				tit_AddCsvSearchActionInfo("spcledu:searchEmailSendSeq", false);				// 서버 호출 				tit_callService(					""					,""					,""	// inDs					,"ds_oEmailSeq=ds_oEmailSeq"	// outDs					,""	// args 					,""					,false					,true					,true				);				lfn_SendMailContentTraining(ds_ioInternetTrainingJubsu, i, ds_oEmailSeq.GetColumn(0, "SEQ"));			}		}	} else {		for(var i=0; i<ds_ioInternetExamJubsu.GetRowCount(); i++) {			if(ds_ioInternetExamJubsu.GetColumn(i, "SEL") == 1) {				ds_oEmailSeq.ClearData();				tit_clearActionInfo();				tit_AddCsvSearchActionInfo("spcledu:searchEmailSendSeq", false);				// 서버 호출 				tit_callService(					""					,""					,""	// inDs					,"ds_oEmailSeq=ds_oEmailSeq"	// outDs					,""	// args 					,""					,false					,true					,true				);				lfn_SendMailContentExam(ds_ioInternetExamJubsu, i, ds_oEmailSeq.GetColumn(0, "SEQ"));			}		}	}}/* * 기능 : 메일발송 (강습) */function lfn_SendMailContentTraining(ds_source, i, seq) {	//MAIL PROCESS	var plainChkVal = ds_source.GetColumn(i, "TJMGNO") + md5_check_value;	//평문	gfn_Cryptograph("Generation", "MD5", plainChkVal, "lfn_AfterCryptograph");	//Get MD5 Hash Value		var tjmgno = ds_source.GetColumn(i, "TJMGNO");	var chkVal = MD5;	//MD5 Hash Value	if(chkVal == "FAIL") {		gfn_Alert(toName+" 접수자에 대한 MD5 Hash 생성에 실패하였습니다.");		return;	}		var application_print = "tjmgno="+tjmgno+"&chkVal="+chkVal;		//메일 내용 변수	var HTTP_HOST = "www.kfsi.or.kr";	//소방안전원HOST	var HTTP_SUB = "edu/dacom_training";	//SUB FOLDER	var TPNM = ds_source.GetColumn(i, "TPNM");	//성명	var TOHPROCDATE = left(ds_source.GetColumn(i, "TOHPROCDATE"),4)+"년 "+substr(ds_source.GetColumn(i, "TOHPROCDATE"),4,2)+" 월 "+substr(ds_source.GetColumn(i, "TOHPROCDATE"),6,2)+"일 ";	//접수일자	var TPRESIDENT = ds_source.GetColumn(i, "TPRESIDENT");	//주민번호(앞6자리)	var TOEDUNM = ds_source.GetColumn(i, "TOEDUNM");	//교육과정	var TOEUDDATE = ds_source.GetColumn(i, "TOEUDDATE");	//교육일자	var JIBUNM = ds_source.GetColumn(i, "JIBUNM");	//교육지부	var JUBSUNO = ds_source.GetColumn(i, "JUBSUNO");	//접수번호	var EPNM = ds_source.GetColumn(i, "EPNM");	//교육장소	var EPPARKINGINFO = ds_source.GetColumn(i, "EPPARKINGINFO");	//주차안내	var TJZIPCD = ds_source.GetColumn(i, "TJZIPCD");	//우편번호	var TJADDR = ds_source.GetColumn(i, "TJADDR");	//주소	var TPTEL = ds_source.GetColumn(i, "TPTEL");	//전화번호	var ETCCOMMENT = ds_source.GetColumn(i, "ETCCOMMENT");	//기타내용	var EMAILSEQ = seq;	//이메일관리번호		//메일 공통 변수	var toEmail = ds_source.GetColumn(i, "TPEMAIL");	var toName = ds_source.GetColumn(i, "TPNM");	var fromEmail = "helpdesk@kfsi.or.kr";	var title = "[한국소방안전원] "+toName+" 회원님의 강습접수 안내메일 입니다.";			//메일 본문	var content  = "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN''http://www.w3.org/TR/html4/loose.dtd'>";    content += " <html>";    content += " <head>";    content += " <meta http-equiv='Content-Type' content='text/html; charset=euc-kr'>";    content += " <title>한국소방안전원</title>";    content += " <basefont size=2>";    content += " </head>";    content += " <body>";    content += "   <table width='596' border='0' align='center' cellpadding='0' cellspacing='1' bgcolor='D8D8D8'>";    content += "     <tr>";    content += "       <td height='1' bgcolor='D8D8D8'></td>";    content += "     </tr>";    content += "     <tr>";    content += "       <td bgcolor='#FFFFFF'><table width='100%'  border='0' cellspacing='0' cellpadding='0'>";    content += "           <tr>";    content += "             <td height='45'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/maillogo.gif' width='173' height='25'></td>";    content += "             <td align='right'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailtitle.gif' width='132' height='26'></td>";    content += "           </tr>";    content += "       </table></td>";    content += "     </tr>";    content += "     <tr>";    content += "       <td height='189' valign='bottom' background='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/maillpic.gif' bgcolor='#FFFFFF'><table width='310' border='0' cellspacing='0' cellpadding='0'>";    content += "           <tr>";    content += "             <td width='75'>&nbsp;</td>";    content += "             <td width='235' height='60' valign='top'><font color='02FEFB'><b>"+TPNM+"</b></font>&nbsp;&nbsp;<font color='ffffff'>회원님!<br>";    content += "             강습접수 결과를 알려드립니다.</font> </td>";    content += "           </tr>";    content += "       </table></td>";    content += "     </tr>";    content += "     <tr>";    content += "       <td align='center' valign='top' bgcolor='#FFFFFF'><table width='100%'  border='0' cellspacing='0' cellpadding='0'>";    content += "           <tr>";    content += "             <td height='2' bgcolor='D8D8D8'></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td height='70' align='center'><table width='540' border='0' cellspacing='0' cellpadding='0'>";    content += "                 <tr>";    content += "                   <td width='9'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailleft.gif' width='9' height='35'></td>";    content += "                   <td width='522' align='center' bgcolor='DCDCDC'><font color='0056FF'><b>"+TPNM+"</b></font> 님께서 지난 "+TOHPROCDATE+"에 신청하신 <font color='0056FF'><b>강습접수결과</b></font>를 알려드립니다. </td>";    content += "                   <td width='9'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailright.gif' width='9' height='35'></td>";    content += "                 </tr>";    content += "             </table></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td height='15'></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td align='center'><table width='522' border='0' cellspacing='0' cellpadding='0'>";    content += "                 <tr>";    content += "                   <td valign='bottom'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox1.gif' width='522' height='29'></td>";    content += "                 </tr>";    content += "                 <tr style=padding:10,0>";    content += "                   <td align='center' background='images/mailbox2.gif'><table width='500' border='0' cellspacing='0' cellpadding='0'>";    content += "                       <tr>";    content += "                         <td height='35' align='left' valign='bottom' widht='50'><font size='-3' color='fe9602'>▶</font> <strong>강습원서</strong> : <a href='http://"+HTTP_HOST+"/"+HTTP_SUB+"/application_print.php?"+application_print+"' target='_print'> <img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/button_application.gif' width='111' height='19' border='0' align='absmiddle'> </a> </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='10'>  ";    content += "                         <td></td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td bgcolor='#69645A' height='1'>  ";    content += "                         <td></td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='5'>  ";    content += "                         <td></td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>교육과정</strong> : "+TOEDUNM+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>교육일자</strong> : "+TOEUDDATE+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>지&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;부</strong> : "+JIBUNM+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>접수번호</strong> : "+JUBSUNO+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>교육장소</strong> : "+EPNM+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>주차안내</strong> : "+EPPARKINGINFO+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td align='left'><table width='489'  border='0' cellspacing='0' cellpadding='0'>";    content += "                           <tr>";    content += "                             <td width='83' rowspan='5' valign='top'><font size='-3' color='fe9602'>▶</font> <strong>구비서류</strong> :</td>";    content += "                             <td height='22' valign='top'>1. 강습원서 출력물(교육장에서 별도 교부 가능) </td>";    content += "                           </tr>";    content += "                           <tr>";    content += "                             <td height='22' valign='top'>2. 사진(3.5 * 4.5cm) 1매 제출(교육 접수시 사진 미등록자에 한함)</td>";    content += "                           </tr>";    content += "                           <tr>";    content += "                             <td height='22' valign='top'>3. 주민등록증(반드시 지참)</td>";    content += "                           </tr>";    content += "                           <tr>";    content += "                             <td height='22' valign='top'>4. 2급방화관리업무 면제과정은 위험물 안전관리자 수첩사본 또는<br>&nbsp;&nbsp;&nbsp;&nbsp;원본 지참</td>";    content += "                           </tr>";    content += "                           <tr>";    content += "                             <td width='406' height='22'>5. 공공기관방화관리자는 재직증명서 1부 지참(교육당일 반드시 제출) </td>";    content += "                           </tr>";    content += "                         </table></td>";    content += "                       </tr>";    content += "                   </table></td>";    content += "                 </tr>";    content += "                 <tr>";    content += "                   <td height='4'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox3.gif' width='522'></td>";    content += "                 </tr>";    content += "             </table></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td height='25' align='center'>&nbsp;</td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td align='center'><table width='522' border='0' cellspacing='0' cellpadding='0'>";    content += "                 <tr>";    content += "                   <td valign='bottom'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox4.gif' width='522' height='31'></td>";    content += "                 </tr>";    content += "                 <tr style=padding:10,0>";    content += "                   <td align='center' background='images/mailbox2.gif'><table width='500' border='0' cellspacing='0' cellpadding='0'>";    content += "                       <tr>";    content += "                         <td height='5'></td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>성&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;명</strong> : "+TPNM+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>주민번호</strong> : "+TPRESIDENT+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소</strong> : ["+TJZIPCD+"] "+TJADDR+" </td>";    content += "                       </tr>";    content += "                       <tr>";    content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>전화번호</strong> : "+TPTEL+" </td>";    content += "                       </tr>";    content += "                   </table></td>";    content += "                 </tr>";    content += "                 <tr>";    content += "                   <td height='4'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox3.gif' width='522' height='5'></td>";    content += "                 </tr>";    content += "             </table></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td height='40' align='left' valign='bottom'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailattention.gif' width='153' height='21'></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td><table width='100%'  border='0' cellpadding='10' cellspacing='10' bgcolor='edefef'>";    content += "               <tr>";    content += "                 <td align='left' bgcolor='#FFFFFF'><table width='100%'  border='0' cellspacing='0' cellpadding='4'>";    content += "                   <tr>";    content += "                     <td height='25'>○ <font color='fe9602'>교육일정 및 교육비 전액환불</font>은 교육시작 전일 근무시간(오후6시) 이내 신청자에 한합니다</td>";    content += "                   </tr>";    content += "                   <tr>";    content += "                     <td height='25'>○ <font color='fe9602'>교육시작일 이후 환불신청</font>시 수강여부등에 따라 차등지급 됩니다.</td>";    content += "                   </tr>";    content += "                   <tr>";    content += "                     <td height='25'>○ 전화, 팩스, 인터넷으로 환불신청시 환불금액은 송금수수료를 제외한 금액입니다.<br>&nbsp;&nbsp;&nbsp;(※ 자세한 환불기준 및 금액은 홈페이지 <font color='fe9602'>강습교육신청</font> 참조) </td>";    content += "                   </tr>";    content += "                   <tr>";    content += "                     <td height='25'>○ 교육시작전 <font color='fe9602'>사진(3.5 * 4.5cm) 1매 제출(교육 접수시 사진 미등록자), 수강증 교부</font> </td>";    content += "                   </tr>";    content += "                 </table>";    content += "                 </td>";    content += "               </tr>";    content += "             </table></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td height='100' align='right' style=padding-right:30><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/stamp.gif' width='234' height='76'></td>";    content += "           </tr>";    content += "           <tr>";    content += "             <td height='30' align='center' bgcolor='D8D8D8'>Copyrightⓒ2001 Korea Fire Safety Association, All Rights Reserved. </td>";    content += "           </tr>";    content += "       </table></td>";    content += "     </tr>";    content += "   </table>";    content += "   <table width='100%' border='0' cellpadding='10' cellspacing='0' bgcolor='#CCCCCC'>";    content += "     <tr>";    content += "       <td align='left' bgcolor='#FFFFFF'><p>&nbsp; </p></td>";    content += "     </tr>";    content += "   </table>";    content += "   <img src='http://www.kfsi.or.kr/check/emailcheck.php?mgno="+EMAILSEQ+"' width=1 height=1>";	//수신확인    content += " </body>";    content += " </html>";    var contents = UrlEncode(content);	wbSendMail.PageUrl = "http://119.68.48.79/nara/servlet/simple.SimpleMailSendServ";	wbSendMail.PostData = "ToEmail="+toEmail+"&ToName="+toName+"&FromEmail="+fromEmail+"&MailTitle="+title+"&MailContent="+contents;	wbSendMail.Run();	lfn_SendMailLog(ds_source, i, title, content, EMAILSEQ);}/* * 기능 : 메일발송 (시험) */function lfn_SendMailContentExam(ds_source, i, seq) {	//MAIL PROCESS	var plainChkVal = ds_source.GetColumn(i, "EJMGNO") + md5_check_value;	//평문	gfn_Cryptograph("Generation", "MD5", plainChkVal, "lfn_AfterCryptograph");	//Get MD5 Hash Value		var tjmgno = ds_source.GetColumn(i, "EJMGNO");	var chkVal = MD5;	//MD5 Hash Value	if(chkVal == "FAIL") {		gfn_Alert(toName+" 접수자에 대한 MD5 Hash 생성에 실패하였습니다.");		return;	}		var application_print = "ejmgno="+tjmgno+"&chkVal="+chkVal;		//메일 내용 변수	var HTTP_HOST = "www.kfsi.or.kr";	//소방안전원HOST	var HTTP_SUB = "edu/dacom_exam";	//SUB FOLDER	var TPNM = ds_source.GetColumn(i, "TPNM");	//성명	var TOHPROCDATE = left(ds_source.GetColumn(i, "EJHPROCDATE"),4)+"년 "+substr(ds_source.GetColumn(i, "EJHPROCDATE"),4,2)+" 월 "+substr(ds_source.GetColumn(i, "EJHPROCDATE"),6,2)+"일 ";	//접수일자	var TPRESIDENT = ds_source.GetColumn(i, "TPRESIDENT");	//주민번호(앞6자리)	var TOEDUNM = ds_source.GetColumn(i, "TOEDUNM");	//교육과정	var TOEUDDATE = ds_source.GetColumn(i, "TOEUDDATE");	//교육일자	var JIBUNM = ds_source.GetColumn(i, "JIBUNM");	//교육지부	var JUBSUNO = ds_source.GetColumn(i, "JUBSUNO");	//접수번호	var EPNM = ds_source.GetColumn(i, "EPNM");	//교육장소	var TJZIPCD = ds_source.GetColumn(i, "TJZIPCD");	//우편번호	var TJADDR = ds_source.GetColumn(i, "TJADDR");	//주소	var TPTEL = ds_source.GetColumn(i, "TPTEL");	//전화번호	var ETCCOMMENT = ds_source.GetColumn(i, "ETCCOMMENT");	//기타내용	var EMAILSEQ = seq;	//이메일관리번호		//메일 공통 변수	var toEmail = ds_source.GetColumn(i, "TPEMAIL");	var toName = ds_source.GetColumn(i, "TPNM");	var fromEmail = "helpdesk@kfsi.or.kr";	var title = "[한국소방안전원] "+toName+" 회원님의 시험접수 안내메일 입니다.";			//메일 본문	var content  = "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN''http://www.w3.org/TR/html4/loose.dtd'>";		content += " <html>";		content += " <head>";		content += " <meta http-equiv='Content-Type' content='text/html; charset=euc-kr'>";		content += " <title>한국소방안전원</title>";		content += " <basefont size=2>";		content += " </head>";		content += " <body>";		content += "   <table width='596' border='0' align='center' cellpadding='0' cellspacing='1' bgcolor='D8D8D8'>";		content += "     <tr>";		content += "       <td height='1' bgcolor='D8D8D8'></td>";		content += "     </tr>";		content += "     <tr>";		content += "       <td bgcolor='#FFFFFF'><table width='100%'  border='0' cellspacing='0' cellpadding='0'>";		content += "           <tr>";		content += "             <td height='45'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/maillogo.gif' width='173' height='25'></td>";		content += "             <td align='right'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailtitle.gif' width='132' height='26'></td>";		content += "           </tr>";		content += "       </table></td>";		content += "     </tr>";		content += "     <tr>";		content += "       <td height='189' valign='bottom' background='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/maillpic.gif' bgcolor='#FFFFFF'><table width='310' border='0' cellspacing='0' cellpadding='0'>";		content += "           <tr>";		content += "             <td width='75'>&nbsp;</td>";		content += "             <td width='235' height='60' valign='top'><font color='02FEFB'><b>"+TPNM+"</b></font>&nbsp;&nbsp;<font color='ffffff'>회원님!<br>";		content += "             시험접수 결과를 알려드립니다.</font> </td>";		content += "           </tr>";		content += "       </table></td>";		content += "     </tr>";		content += "     <tr>";		content += "       <td align='center' valign='top' bgcolor='#FFFFFF'><table width='100%'  border='0' cellspacing='0' cellpadding='0'>";		content += "           <tr>";		content += "             <td height='2' bgcolor='D8D8D8'></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td height='70' align='center'><table width='540' border='0' cellspacing='0' cellpadding='0'>";		content += "                 <tr>";		content += "                   <td width='9'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailleft.gif' width='9' height='35'></td>";		content += "                   <td width='522' align='center' bgcolor='DCDCDC'><font color='0056FF'><b>"+TPNM+"</b></font> 님께서 지난 "+TOHPROCDATE+"에 신청하신 <font color='0056FF'><b>시험접수결과</b></font>를 알려드립니다. </td>";		content += "                   <td width='9'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailright.gif' width='9' height='35'></td>";		content += "                 </tr>";		content += "             </table></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td height='15'></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td align='center'><table width='522' border='0' cellspacing='0' cellpadding='0'>";		content += "                 <tr>";		content += "                   <td valign='bottom'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox1.gif' width='522' height='29'></td>";		content += "                 </tr>";		content += "                 <tr style=padding:10,0>";		content += "                   <td align='center' background='images/mailbox2.gif'><table width='500' border='0' cellspacing='0' cellpadding='0'>";		content += "                       <tr>";		content += "                         <td height='35' align='left' valign='bottom' widht='50'><font size='-3' color='fe9602'>▶</font> <strong>시험응시원서</strong> : <a href='http://"+HTTP_HOST+"/"+HTTP_SUB+"/application_print.php?"+application_print+"' target='_print'> <img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/button_application.gif' width='111' height='19' border='0' align='absmiddle'> </a> </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='10'>  ";		content += "                         <td></td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td bgcolor='#69645A' height='1'>  ";		content += "                         <td></td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='5'>  ";		content += "                         <td></td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>시험과정</strong> : "+TOEDUNM+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>시험일자</strong> : "+TOEUDDATE+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>지&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;부</strong> : "+JIBUNM+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>접수번호</strong> : "+JUBSUNO+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>시험장소</strong> : "+EPNM+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td align='left'><table width='489'  border='0' cellspacing='0' cellpadding='0'>";		content += "                           <tr>";		content += "                             <td width='83' rowspan='5' valign='top'><font size='-3' color='fe9602'>▶</font> <strong>준&nbsp;&nbsp;비&nbsp;&nbsp;물</strong> :</td>";		content += "                             <td height='22' valign='top'>1. 시험응시표 </td>";		content += "                           </tr>";		content += "                           <tr>";		content += "                             <td height='22' valign='top'>2. 신분증(주민등록증, 운전면허증 등)</td>";		content += "                           </tr>";		content += "                           <tr>";		content += "                             <td height='22' valign='top'>3. 필기도구(적색 및 연필 제외)</td>";		content += "                           </tr>";		content += "                         </table></td>";		content += "                       </tr>";		content += "                   </table></td>";		content += "                 </tr>";		content += "                 <tr>";		content += "                   <td height='4'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox3.gif' width='522'></td>";		content += "                 </tr>";		content += "             </table></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td height='25' align='center'>&nbsp;</td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td align='center'><table width='522' border='0' cellspacing='0' cellpadding='0'>";		content += "                 <tr>";		content += "                   <td valign='bottom'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox4.gif' width='522' height='31'></td>";		content += "                 </tr>";		content += "                 <tr style=padding:10,0>";		content += "                   <td align='center' background='images/mailbox2.gif'><table width='500' border='0' cellspacing='0' cellpadding='0'>";		content += "                       <tr>";		content += "                         <td height='5'></td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>성&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;명</strong> : "+TPNM+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>주민번호</strong> : "+TPRESIDENT+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소</strong> : ["+TJZIPCD+"] "+TJADDR+" </td>";		content += "                       </tr>";		content += "                       <tr>";		content += "                         <td height='23' align='left'><font size='-3' color='fe9602'>▶</font> <strong>전화번호</strong> : "+TPTEL+" </td>";		content += "                       </tr>";		content += "                   </table></td>";		content += "                 </tr>";		content += "                 <tr>";		content += "                   <td height='4'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailbox3.gif' width='522' height='5'></td>";		content += "                 </tr>";		content += "             </table></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td height='40' align='left' valign='bottom'><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/mailattention.gif' width='153' height='21'></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td><table width='100%'  border='0' cellpadding='10' cellspacing='10' bgcolor='edefef'>";		content += "               <tr>";		content += "                 <td align='left' bgcolor='#FFFFFF'><table width='100%'  border='0' cellspacing='0' cellpadding='4'>";		content += "                   <tr>";		content += "                     <td height='25'>○ <font color='fe9602'>시험시작 30분전까지</font> 입실하셔야 합니다.</td>";		content += "                   </tr>";		content += "                   <tr>";		content += "                     <td height='25'>○ 시험일정변경 또는 환불은 해당시험 <font color='fe9602'>전일 근무시간(18시)까지만</font> 가능합니다.</td>";		content += "                   </tr>";		content += "                   <tr>";		content += "                     <td height='25'>○ 전화, 팩스, 인터넷으로 환불신청시 환불금액은 <font color='fe9602'>송금수수료</font>를 제외한 금액입니다.<br>&nbsp;&nbsp;&nbsp;(※ 당해년도 시험일정에 한함)</td>";		content += "                   </tr>";		content += "                   <tr>";		content += "                     <td height='25'>○ 주차장이 협소하여 주차가 불가할 수 있습니다.</td>";		content += "                   </tr>";		content += "                 </table>";		content += "                 </td>";		content += "               </tr>";		content += "             </table></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td height='100' align='right' style=padding-right:30><img src='http://"+HTTP_HOST+"/"+HTTP_SUB+"/images/stamp.gif' width='234' height='76'></td>";		content += "           </tr>";		content += "           <tr>";		content += "             <td height='30' align='center' bgcolor='D8D8D8'>Copyrightⓒ2001 Korea Fire Safety Association, All Rights Reserved. </td>";		content += "           </tr>";		content += "       </table></td>";		content += "     </tr>";		content += "   </table>";		content += "   <table width='100%' border='0' cellpadding='10' cellspacing='0' bgcolor='#CCCCCC'>";		content += "     <tr>";		content += "       <td align='left' bgcolor='#FFFFFF'><p>&nbsp; </p></td>";		content += "     </tr>";		content += "   </table>";		content += "   <img src='http://www.kfsi.or.kr/check/emailcheck.php?mgno="+EMAILSEQ+"' width=1 height=1>";	//수신확인		content += " </body>";		content += " </html>";    var contents = UrlEncode(content);	wbSendMail.PageUrl = "http://119.68.48.79/nara/servlet/simple.SimpleMailSendServ";	wbSendMail.PostData = "ToEmail="+toEmail+"&ToName="+toName+"&FromEmail="+fromEmail+"&MailTitle="+title+"&MailContent="+contents;	wbSendMail.Run();	lfn_SendMailLog(ds_source, i, title, content, EMAILSEQ);}/* * 기능 : 메일 발송 이력 */function lfn_SendMailLog(ds_source, i, title, content, EMAILSEQ) {	if (radWorkGubun.Value == "TRAINING") { // 인터넷 강습접수        tit_clearActionInfo();        tit_addSingleActionInfo("spcledu:insertEmailContents", "", 0, "");        // 서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,""	// outDs             , "ESHGTMGNO=" + quote(gds_oUserInfo.GetColumn(0,"PDEPTCD"))	//-- 발송지부              +" ESHSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"))	//-- 사번              +" ESHEMAILADDR=" + quote(ds_source.GetColumn(i,"TPEMAIL"))   //-- 이메일주소              +" ESHSENDYN=" + quote("Y") // -- 발송여부              +" ESHRECEIVEYN=" + quote("N") // -- 수신상태              +" ESHBIZGUBUN=" + quote("T") // -- 업무구분              +" ESHBIZMGNO=" + quote(ds_source.GetColumn(i,"TJMGNO")) // -- 업무참조              +" ECTITLE=" + quote(title) // -- 제목              +" ECCONTENTS=" + quote(content) // -- 내용              +" ESHMGNO=" + quote(EMAILSEQ)	//-- 이메일관리번호            ,"lfn_AfterSaveSendMailLog"            ,false            ,true        );    }    else {	//인터넷 시험접수                tit_clearActionInfo();        tit_addSingleActionInfo("spcledu:insertEmailContents", "", 0, "");        // 서버 호출         tit_callService(            ""            ,""            ,""	// inDs            ,""	// outDs             , "ESHGTMGNO=" + quote(gds_oUserInfo.GetColumn(0,"PDEPTCD"))	//-- 발송지부              +" ESHSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"))	//-- 사번              +" ESHEMAILADDR=" + quote(ds_source.GetColumn(i,"TPEMAIL"))   //-- 이메일주소              +" ESHSENDYN=" + quote('Y') // -- 발송여부              +" ESHRECEIVEYN=" + quote('N') // -- 수신상태              +" ESHBIZGUBUN=" + quote('E') // -- 업무구분              +" ESHBIZMGNO=" + quote(ds_source.GetColumn(i,"EJMGNO")) // -- 업무참조              +" ECTITLE=" + quote(title) // -- 제목              +" ECCONTENTS=" + quote(content) // -- 내용			  +" ESHMGNO=" + quote(EMAILSEQ)	//-- 이메일관리번호            ,"lfn_AfterSaveSendMailLog"            ,false            ,true        );    }}/* * 기능 : 메일 발송 이력 저장 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSaveSendMailLog(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    if(checkCntFlag1 == ++checkCntFlag2) {		lfn_DestroyWaitMail();	//진행 팝업 Close		gfn_SaveMessage(); // 저장 메세지를 처리한다.    }}/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 결강자 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchInternetJusu(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }             gfn_SearchMessage(gdInternetJusu); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.        if(radWorkGubun.Value == "TRAINING") {	//인터넷 강습접수		medEmailCnt = ds_ioInternetTrainingJubsu.GetRowCount();	//건수	} else {	//인터넷 시험접수		medEmailCnt = ds_ioInternetExamJubsu.GetRowCount();	//건수	}}/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSaveInternetJusu(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SaveMessage(); // 저장 메세지를 처리한다.    lfn_Search(); // 결강자 조회}/* * 기능 : 버튼 활성/비활성시킨다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetFormAuth(bStatus) {    btnSend.Enable = bStatus; // 메일발송 버튼}/* 사용자 이벤트 함수 */function btnMutilSort_OnClick(obj){	gfn_GridMultiSort(gdInternetJusu, 1); // 멀티 정렬을 실행한다.}function radWorkGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex){	if (strCode == "TRAINING") { // 인터넷 강습접수        gdInternetJusu.Format = "Training";        gdInternetJusu.BindDataset = "ds_ioInternetTrainingJubsu";        	} else { // 인터넷 시험접수        gdInternetJusu.Format = "Exam";        gdInternetJusu.BindDataset = "ds_ioInternetExamJubsu";	}}function gdInternetJusu_OnHeadClick(obj,nCell,nX,nY,nPivotIndex){	var lobj_Dataset = object(obj.BindDataset);	if (nCell == 0) { // 선택        if (obj.GetCellProp("head", nCell, "text") == 1) { // 전체가 이미 선택된 경우            obj.SetCellProp("head", nCell, "text", 0);            for(i = 0; i < lobj_Dataset.RowCount(); i++) {                lobj_Dataset.SetColumn(i, "SEL", "0");            }        } else { // 전체가 이미 선택되지 않은 경우            obj.SetCellProp("head", nCell, "text", 1);            for(i = 0; i < lobj_Dataset.RowCount(); i++) {                lobj_Dataset.SetColumn(i, "SEL", "1");            }        }	} else { // 헤드 정렬        lfn_SortGrid_OnHeadClick(obj,nCell,nX,nY,nPivotIndex);	}}function lfn_ComponentOnKillFocus(obj){	gfn_ComponentOnKillFocus(obj);    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3)); } /* * 기능 : gfn_Cryptograph 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 *	           cRtnVal - 리턴값(암호문) * Return : 성공:"OK", 실패:"FAIL" */function lfn_AfterCryptograph(strSvcID, nErrorCode, strErrorMsg) {    if (strSvcID <> "Cryptograph") {        return "FAIL";    }    if (nErrorCode < 0) { // 트랜잭션 에러.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return "FAIL";    }    MD5 = cRtnVal; // POS 조회결과 코드값} /* * 기능 : 종료 * parameter : 없음 * Return : 없음 */function lfn_End(obj){	ds_ioInternetTrainingJubsu.ApplyChange();	ds_ioInternetExamJubsu.ApplyChange();}/***************************************************************** 처리 중 입니다 메시지 보여주기* 내부적으로 Division 을 생성하여 해당 정보를 보여준다.* @param strMsg 보여줄 메시지* @param topObj 위치할 최상위 객체* @param errMsg  에러 메시지* @return 없음******************************************************************/var _f_cnt_mail = 0;function lfn_CreateWaitMail(strMsg, topObj) {    _f_cnt_mail++;    if ( tit_findObj("_Div_wait", this) == false ) {        var w = 300;        var h = 124;        var nLeft = (this.width /2) - (w/2);        var nTop = (this.Height /2) - h + 20;        // 생성하기        Create("Div", "_Div_wait_mail", "left='" + nLeft + "' border='none' top='"            + nTop + "' width='" + w + "' height='" + h + "' url='COM::frmCOM0031PProgressBar.xml' syncContents='true'");    } else {        _Div_wait_mail.visible = true;    }}/****************************************************************** 처리 중 입니다 메시지 창 삭제하기* @return 없음******************************************************************/function lfn_DestroyWaitMail(){    if ( tit_findObj("_Div_wait_mail", this) ) { //find("_Div_wait") != null ) {        _f_cnt_mail--;        if ( _f_cnt <= 0 ) {            SetWaitCursor(false);            ReleaseCapture();            _Div_wait_mail.visible = false;        }    } else {        SetWaitCursor(false);        ReleaseCapture();    }}]]></Script></Window>
<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="352" Id="frmspcledu0091PInternetJubsuStatistics" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="[인터넷]시험접수상세내역" Top="8" Ver="1.0" Width="732" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_oJubsu"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oSunap"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oChange"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oRepay"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oInternetReport">				<Contents></Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_JubsuH">				<Contents>					<colinfo id="EJHEJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EJHSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EJHSTATUSCD" size="256" summ="default" type="STRING"/>					<colinfo id="EJHESSEQREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EJHEOHSEQREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="EJHMGGTMGNO" size="256" summ="default" type="STRING"/>					<colinfo id="EJHPROCREASON" size="1000" summ="default" type="STRING"/>					<colinfo id="PPAPMYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="PPAPMMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PPAFINISHAMOUNT" size="22" summ="default" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioSettlement">				<Contents>					<colinfo id="ESEJMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="ESGUBUNCD" size="2" summ="default" type="STRING"/>					<colinfo id="ESGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="ESPROCAMOUNT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="ESPONYGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="ESMGGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="ESPROCGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="ESREPAYCD" size="1" summ="default" type="STRING"/>					<colinfo id="ESSUNAPACTIONREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="ESREPAYREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="ESSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="ESSETLMTYN" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oPosData">				<Contents>					<colinfo id="PMYEAR" size="256" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="22" summ="default" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_iPosData">				<Contents>					<colinfo id="PMYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="PMMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PMINPUT" size="1" summ="default" type="STRING"/>					<colinfo id="PMPCGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="PMPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="PMPIID" size="12" summ="default" type="STRING"/>					<colinfo id="PMPGMID" size="2" summ="default" type="STRING"/>					<colinfo id="PMPGMPK" size="100" summ="default" type="STRING"/>					<colinfo id="PMBUYER" size="50" summ="default" type="STRING"/>					<colinfo id="PMCLAS" size="2" summ="default" type="STRING"/>					<colinfo id="PMPGMGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="PMITEM1" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM2" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM3" size="100" summ="default" type="STRING"/>					<colinfo id="PMITEM4" size="100" summ="default" type="STRING"/>					<colinfo id="PMAMT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PMVAT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PMPAYMENTFLAG" size="1" summ="default" type="STRING"/>					<colinfo id="PMRESULT" size="1" summ="default" type="STRING"/>					<colinfo id="PMREGDATE" size="7" summ="default" type="STRING"/>					<colinfo id="PMREGSABUN" size="8" summ="default" type="STRING"/>					<colinfo id="PPNM" size="256" summ="default" type="STRING"/>					<colinfo id="PMPCORDERNO" size="256" summ="default" type="STRING"/>					<colinfo id="PCGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="PCORDERNO" size="20" summ="default" type="STRING"/>					<colinfo id="PCUSERTYPE" size="1" summ="default" type="STRING"/>					<colinfo id="PCTRANSACTIONDATE" size="8" summ="default" type="STRING"/>					<colinfo id="PCTRANSACTIONTIME" size="6" summ="default" type="STRING"/>					<colinfo id="PCSERIALNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PCAMT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PCVAT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="PCSOCIALBUSINESSNO" size="18" summ="default" type="STRING"/>					<colinfo id="PCAUTHNO" size="10" summ="default" type="STRING"/>					<colinfo id="PCRESPONSECODE" size="4" summ="default" type="STRING"/>					<colinfo id="PCRESPONSEDATE" size="14" summ="default" type="STRING"/>					<colinfo id="PCTRANSACTIONCODE" size="24" summ="default" type="STRING"/>				</Contents>			</Dataset>		</Datasets>		<Shape Bottom="28" Height="28" Id="shpBtnBox" Left="636" LineColor="user14" Right="728" TabOrder="2" Top="0" Type="Rectangle" Width="92"></Shape>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="640" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="3" Width="85"></Button>		<Div BKColor="user0" Height="128" Id="divRepay" Left="1" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="3" TabStop="FALSE" Text="Div0" Top="436" Url="spcledu::frmspcledu0095SInternetJubsuRepayInfo.xml" Visible="FALSE" Width="727">			<Contents></Contents>		</Div>		<Shape Bottom="132" Height="88" Id="Shape0" Left="2" LineColor="user15" Right="725" TabOrder="7" Top="44" Type="Rectangle" Width="723"></Shape>		<Static Align="Center" Height="20" Id="lbYear" Left="245" Style="sty_Label" TabOrder="6" Text="시험년도" Top="60" VAlign="Middle" Width="84"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edOrderNo" ImeMode="native" Left="109" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="5" Top="84" Width="132"></Edit>		<Static Align="Center" Height="20" Id="Static2" Left="13" Style="sty_LabelGruopBox" TabOrder="8" Text="접수내역" Top="36" VAlign="Middle" Width="96"></Static>		<Static Align="Center" Height="20" Id="lbJibu" Left="5" Style="sty_Label" TabOrder="9" Text="접수지부" Top="60" VAlign="Middle" Width="100"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edJibu" ImeMode="native" Left="109" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="4" Top="60" Width="132"></Edit>		<Static Align="Center" Height="20" Id="lbEmail" Left="500" Style="sty_Label" TabOrder="10" Text="메일수신" Top="84" VAlign="Middle" Width="84"></Static>		<Static Align="Center" Height="20" Id="lbEducationTerm" Left="245" Style="sty_Label" TabOrder="11" Text="시험일시" Top="84" VAlign="Middle" Width="84"></Static>		<Static Align="Center" Height="20" Id="lbOrderNo" Left="5" Style="sty_Label" TabOrder="12" Text="회차+접수번호" Top="84" VAlign="Middle" Width="100"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edEducaitonPlace" ImeMode="native" Left="109" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="13" Top="108" Width="388"></Edit>		<Static Align="Center" Height="20" Id="lbJubsuDate" Left="501" Style="sty_Label" TabOrder="15" Text="접수일시" Top="108" VAlign="Middle" Width="84"></Static>		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="meJubsuDate" Left="588" LeftMargin="2" Mask="####-##-##&#32;##:##:##" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="14" Top="108" Type="STRING" Width="132"></MaskEdit>		<Static Align="Center" Height="20" Id="lbEducationPlace" Left="5" Style="sty_Label" TabOrder="16" Text="시험장소" Top="108" VAlign="Middle" Width="100"></Static>		<Static Align="Center" Height="20" Id="lbCourse" Left="468" Style="sty_Label" TabOrder="17" Text="시험분야" Top="60" VAlign="Middle" Width="84"></Static>		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="meEducationTerm" Left="333" LeftMargin="2" Mask="####-##-##&#32;&#32;##:##~##:##" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Time" TabOrder="18" Top="84" Type="STRING" Width="163"></MaskEdit>		<Div BKColor="user0" Height="104" Id="divChange" Left="1" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="19" TabStop="FALSE" Text="Div0" Top="136" Url="spcledu::frmspcledu0096SInternetJubsuChangeInfo.xml" Visible="FALSE" Width="727">			<Contents></Contents>		</Div>		<Div BKColor="user0" Height="80" Id="divSunap" Left="1" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" Style="sty_Form" TabOrder="20" TabStop="FALSE" Text="Div0" Top="352" Url="spcledu::frmspcledu0094SInternetJubsuSunapInfo.xml" Visible="FALSE" Width="727">			<Contents></Contents>		</Div>		<Div BKColor="user0" Height="104" Id="divJubsu" Left="1" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" Style="sty_Form" TabOrder="21" TabStop="FALSE" Text="Div0" Top="244" Url="spcledu::frmspcledu0093SInternetJubsuJubsuInfo.xml" Visible="FALSE" Width="727">			<Contents></Contents>		</Div>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edCourse" ImeMode="native" Left="556" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="22" Top="60" Width="164"></Edit>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edYear" ImeMode="native" Left="333" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="23" Top="60" Width="131"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnProc" ImageID="BTN_TEXT_07" Left="527" OnClick="btnProc_OnClick" Style="sty_Button" TabOrder="24" Top="3" Transparent="TRUE" Visible="FALSE" Width="105"></Button>		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edEmail" ImeMode="native" Left="588" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="25" Top="84" Width="132"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnRepay" ImageID="BTN_TEXT_06" Left="229" OnClick="btnRepay_OnClick" Style="sty_Button" TabOrder="26" Text="환불접수처리" Top="3" Transparent="TRUE" Visible="FALSE" Width="92"></Button>		<Div BKColor="user0" Height="24" Id="divPos" Left="600" OnLoadCompleted="Form_OnLoadCompleted" OnTimer="frmCOM3010SPOS_OnTimer" OnUnloadCompleted="frmCOM3010SPOS_OnUnloadCompleted" Style="sty_Form" TabOrder="27" TabStop="FALSE" Text="Div0" Top="32" Url="COM::frmCOM3010SPOS.xml" Visible="FALSE" Width="124">			<Contents></Contents>		</Div>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnChange" ImageID="BTN_TEXT_07" Left="419" OnClick="btnChange_OnClick" Style="sty_Button" TabOrder="28" Text="변경신청서&#32;출력" Top="3" Transparent="TRUE" Visible="FALSE" Width="105"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnRepayCancel" ImageID="BTN_TEXT_06" Left="324" OnClick="btnRepayCancel_OnClick" Style="sty_Button" TabOrder="29" Text="환불취소" Top="3" Transparent="TRUE" Visible="FALSE" Width="92"></Button>		<Image Height="10" Id="imgImage" ImageID="IMG_BULLET" Left="8" Style="sty_Image" TabOrder="31" Top="9" Transparent="TRUE" Width="12"></Image>		<Static Font="굴림,12,Bold" Height="20" Id="lbWorkFormTitle" Left="28" TabOrder="30" Text="[인터넷]접수&#32;상세&#32;내역" Top="4" VAlign="Middle" Width="200"></Static>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu0091PInternetJubsuStatistics.xml * 설명 : 인터넷시험접수상세내역팝업 * 작성일 : 2009.10.10 * 작성자 : 김동현 */#include "LIB::COMMON.js"; // 공통 관련var ls_ResultPrintPosMsg = ""; // Pos 처리결과 메세지var ls_ResultPrintLgdMsg = ""; // LG데이콤결과메세지var ls_ResultPrintKemsMsg = ""; // 안전원결과메세지var ls_ResultPrintReTransYn = "N"; // 재전송 여부/* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    window.Height = sFormHeight;    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    if (sTohSeq > 1) {        lfn_SearchChange();        divChange.Visible = true;    } else {        divJubsu.Top = divChange.Top;        divSunap.Top = divJubsu.Bottom;        divRepay.Top = divSunap.Bottom;    }    divJubsu.Visible = true;    divSunap.Visible = true;    lfn_SearchJubsuInfo();    lfn_SearchSunap();    switch (sJubsuStatus) {        case "4":            btnChange.Visible = true;        case "2":            divSunap.btnPrintReRct.Enable = true;            btnProc.Value = "응시원서 출력";            btnProc.Visible = true;            break;                                case "1":            break;        case "3":            break;        case "5":            btnRepay.Text = "환불접수처리";            btnRepay.Visible = true;            btnProc.Value = "환불신청서 출력";            btnProc.Visible = true;            btnRepayCancel.Visible = true;            divRepay.Visible = true;            divRepay.edChangeReason.SetFocus();                        lfn_SearchRepay();                        divRepay.medAmount.Value = ds_oRepay.GetColumn(0, "PPAPLANAMOUNT");            break;                    case "6":            divRepay.edChangeReason.Enable = false;            btnRepay.Text = "환불완료처리";            btnRepay.Visible = true;            btnProc.Value = "환불신청서 출력";            btnProc.Visible = true;            btnRepayCancel.Visible = true;            divRepay.Visible = true;                        lfn_SearchRepay();            divRepay.edProcReason.Enable = false;            divRepay.medAmount.Value = ds_oRepay.GetColumn(0, "PPAFINISHAMOUNT");                        break;        case "7":            btnProc.Value = "환불신청서 출력";            btnProc.Visible = true;            divRepay.Visible = true;            lfn_SearchRepay();            divRepay.edProcReason.Enable = false;            divRepay.medAmount.Value = ds_oRepay.GetColumn(0, "PPAFINISHAMOUNT");            break;        default :            lfn_SearchJubsuInfo();    }}function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    switch (nChar) {        case 27 : // 종료(Esc)            lfn_End();            break;    }}function Form_OnUnloadCompleted(obj) {    Close("END");}/* * 기능 : 종료 */function lfn_End(obj) {    Close();}/* 공통 필수 종료 *//* 사용자 함수 */function lfn_SearchJubsuInfo() {    var sArg = "EJMGNO=" + quote(sJubsuNo)        + " EJHSTATUSCD=" + quote(sJubsuStatus);    ds_oJubsu.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchInternetExamJubsuInfo", false);    tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oJubsu=ds_oInternetExamJubsu"	// outDs        ,sArg // args        ,""        ,false        ,""        ,true    );    edJibu.Text = ds_oJubsu.GetColumn(0, "GTDEPTNM");    edYear.Text = ds_oJubsu.GetColumn(0, "EOYEAR");    edCourse.Text = ds_oJubsu.GetColumn(0, "TCCOURSENM");    edOrderNo.Text = ds_oJubsu.GetColumn(0, "EOEXAMORDER") + " - " + right(ds_oJubsu.GetColumn(0, "EOHJUBSUNO"), 3);    meEducationTerm.Value = ds_oJubsu.GetColumn(0, "EOEXAMDATE");    edEmail.Text = ds_oJubsu.GetColumn(0, "EMAILCHECK");    edEducaitonPlace.Text = ds_oJubsu.GetColumn(0, "EPNM");    meJubsuDate.Value = ds_oJubsu.GetColumn(0, "EJHREGDATE");    divJubsu.edPersonNm.Text = ds_oJubsu.GetColumn(0, "TPNM");    divJubsu.meResidentNo.Text = ds_oJubsu.GetColumn(0, "TPRESIDENTNO");    divJubsu.edHpTel.Text = ds_oJubsu.GetColumn(0, "TPHPTEL");    divJubsu.edEmail.Text = iif(ds_oJubsu.GetColumn(0, "EMAIL")=="@","",ds_oJubsu.GetColumn(0, "EMAIL"));    divJubsu.edAddr.Text = "(" + left(ds_oJubsu.GetColumn(0, "EJZZIPCD"),3)        + "-" + right(ds_oJubsu.GetColumn(0, "EJZZIPCD"),3) + ") "        + ds_oJubsu.GetColumn(0, "ADDR");    divJubsu.edTel.Text = ds_oJubsu.GetColumn(0, "TPTEL");}function lfn_SearchSunap() {    var sArg = "EJMGNO=" + quote(sJubsuNo)        + " EJHSTATUSCD=" + quote(sJubsuStatus);    ds_oSunap.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchInternetExamJubsuSunapInfo", false);    tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oSunap=ds_oInternetExamJubsu"	// outDs        ,sArg // args        ,""        ,false        ,""        ,true    );    divSunap.edSetlmYn.Text = ds_oSunap.GetColumn(0, "ESSETLMT");    divSunap.meAmount.Text = ds_oSunap.GetColumn(0, "ESPROCAMOUNT");    if (ds_oSunap.GetColumn(0, "ESSETLMTYN") == "Y") {        divSunap.edSetlmGubun.Text = ds_oSunap.GetColumn(0, "ESGUBUNNM");        divSunap.edPersonNm.Text = ds_oSunap.GetColumn(0, "EJPERSONNM");        divSunap.meProcDate.Value = ds_oSunap.GetColumn(0, "ESPROCDATE");    }    if (ds_oSunap.GetColumn(0, "ESGUBUN") == "13"        || ds_oSunap.GetColumn(0, "ESGUBUN") == "15"        || ds_oSunap.GetColumn(0, "ESGUBUN") == "23"        || ds_oSunap.GetColumn(0, "ESGUBUN") == "25") {        divSunap.btnShowVirtualAccount.Enable = true;    }}function lfn_SearchChange() {    var sArg = "EJMGNO=" + quote(sJubsuNo)        + " EJHSEQ=" + quote(sTjhSeq);    ds_oChange.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchInternetExamJubsuChangeInfo", false);    tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oChange=ds_oInternetExamJubsu"	// outDs        ,sArg // args        ,""        ,false        ,""        ,true    );    divChange.edOrder.Text = ds_oChange.GetColumn(0, "EOAFTERDEPTNM")        + " " + ds_oChange.GetColumn(0, "EOAFTERORDER")        + " - " + right(ds_oChange.GetColumn(0, "EOAFTEREJNO"),3);    divChange.edBeforeOrder.Text = ds_oChange.GetColumn(0, "EOBEFOREDEPTNM")        + " " + ds_oChange.GetColumn(0, "EOBEFOREORDER")        + " - " + right(ds_oChange.GetColumn(0, "EOBEFOREEJNO"),3);    divChange.meEduTerm.Value = ds_oChange.GetColumn(0, "EOEXAMDATE");    divChange.edEduNm.Text = ds_oChange.GetColumn(0, "EPNM");    divChange.edReason.Text = ds_oChange.GetColumn(0, "EJHPROCREASON");    divChange.meProcDate.Value = ds_oChange.GetColumn(0, "EJHREGDATE");}function lfn_SearchRepay() {    var sArg = "EJMGNO=" + quote(sJubsuNo)        + " EJHSEQ=" + quote(sTjhSeq)        + " EJHSTATUSCD=" + quote(sJubsuStatus);    ds_oRepay.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchInternetExamJubsuRepayInfo", false);    tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oRepay=ds_oInternetExamJubsu"	// outDs        ,sArg // args        ,""        ,false        ,""        ,true    );    divRepay.edPersonNm.Text = ds_oRepay.GetColumn(0, "PPAOWNER");    divRepay.edBank.Text = ds_oRepay.GetColumn(0, "PPABANKNM");	divRepay.meRepayDate.Value = ds_oRepay.GetColumn(0, "PMREGDATE");	divRepay.edAccount.Text = ds_oRepay.GetColumn(0, "PPACCOUNT");	divRepay.edReason.Text = ds_oRepay.GetColumn(0, "EJHPROCREASON");	divRepay.edProcReason.Text = ds_oRepay.GetColumn(0, "EJHREMARK");    divRepay.medAmount.Visible = true;    divRepay.lbProcReason.Visible = true;    divRepay.edProcReason.Visible = true;    	divRepay.lbAttendance.Visible = false;	divRepay.ebAttendance.Visible = false;	divRepay.lbChangeReason.Visible = false;	divRepay.edChangeReason.Visible = false;		divRepay.cbxTrainingAmount.Visible = false;	divRepay.lbOtherAmount.Visible = false;}/** * 시험 일정 변경 신청서 */function btnChange_OnClick(obj) {    ds_oInternetReport.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchInternetExamChangeReport", false);        tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oInternetReport=ds_oExamJubsuPrint"	// outDs        ,"EJMGNO=" + quote(sJubsuNo) // args        ,""        ,false        ,""        ,true    );    gfn_CallReportPopup("frmspcledu0091R02ExamChangeAppl.rex"        , "ds_oInternetReport"        , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"        , true    );}/** * 원서 출력 버튼 */function btnProc_OnClick(obj) {    var ls_RexFile = "";    ds_oInternetReport.ClearData();    tit_clearActionInfo();    switch (sJubsuStatus) {        case "1":        case "2":        case "3":        case "4":            tit_addCsvSearchActionInfo("spcledu:searchExamJubsuPrint", false);            ls_RexFile = "frmspcledu0400R01ExamJubsu.rex";            break;        case "5":        case "6":        case "7":            tit_addCsvSearchActionInfo("spcledu:searchInternetExamRepayReport", false);            ls_RexFile = "frmspcledu0091R01ExamRepayAppl.rex";            break;        case "8":            break;    }    tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oInternetReport=ds_oExamJubsuPrint"	// outDs        ,"EJMGNO=" + quote(sJubsuNo) // args        ,""        ,false        ,""        ,true    );    gfn_CallReportPopup(ls_RexFile        , "ds_oInternetReport"        , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"        , true    );}function btnRepay_OnClick(obj) {    var ls_PosResult = "5";    var ls_RetResultPopup = "RETRANS";    switch (sJubsuStatus) {        case "5":            if (!gfn_Confirm("환불신청을 접수 하시겠습니까?")) {                return false;            }            ds_JubsuH.ClearData();            ds_JubsuH.InsertRow(0);            ds_JubsuH.SetColumn(0, "EJHEJMGNO", ds_oRepay.GetColumn(0, "EJHEJMGNO"));            ds_JubsuH.SetColumn(0, "EJHSTATUSCD", toNumber(sJubsuStatus)+1);            ds_JubsuH.SetColumn(0, "EJHPROCREASON", divRepay.edProcReason.Text);            ds_JubsuH.SetColumn(0, "PPAPMYEAR", ds_oRepay.GetColumn(0, "ESPMYEAR"));            ds_JubsuH.SetColumn(0, "PPAPMMGNO", ds_oRepay.GetColumn(0, "ESPMMGNO"));            ds_JubsuH.SetColumn(0, "PPAFINISHAMOUNT", divRepay.medAmount.Value);            tit_clearActionInfo();            tit_addSingleActionInfo("spcledu:insertInternetExamJubsuRepayBefore", "", 0, "");            tit_callService(                ""                ,""                ,"ds_iInternetExamJubsuRepay=ds_JubsuH:U" // inDs                ,""	// outDs                ,"" // args                ,""                ,false                ,""                ,true            );            break;        case "6":            if (!gfn_Confirm("환불완료를 하시겠습니까?")) {                return false;            }            lfn_InsertSettlement();            lfn_SearchMgno();            lfn_CreatePosData();            if (ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "22"                || ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "25"                || ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "26"                || ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "12"                || ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "15"                || ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "16"                ) { //현금 영수증 일 때                                while(ls_RetResultPopup == "RETRANS") {                    ls_ResultPrintReTransYn = "N";                                            //POS 실행                    ls_PosResult = lfn_PosProc(ds_oPosData.GetColumn(0, "PMYEAR"), ds_oPosData.GetColumn(0, "PMMGNO"));                                        switch (ls_PosResult) { // POS 결과                                            case "0" : // 데이콤 성공, 안전원 성공                            ls_ResultPrintLgdMsg = "성공"; // LG데이콤결과메세지                            ls_ResultPrintKemsMsg = "성공"; // 안전원결과메세지                            break;                        case "1" : // 데이콤 성공, 안전원 실패                            // 안전원 성공으로 수정                            divPos.ds_ioPosInput.SetColumn(0, "STATUS", "1"); // 초기저장시 4                                                        var ls_RetRetry = "";                            var ln_Cnt = 0; // 시도회수                            while (true) {                                ls_RetRetry = divPos.lfn_POS(); // POS 호출                                if (ls_RetRetry == "0") { // 성공                                    ls_ResultPrintLgdMsg = "성공"; // LG데이콤결과메세지                                    ls_ResultPrintKemsMsg = "성공"; // 안전원결과메세지                                    break;                                }                                if (ln_Cnt == 10) { // 안전원 성공으로 수정하기 실패                                    gfn_Alert("데이콤 처리는 성공했으나, 안전원 저장 처리는 실패했습니다.\n정보지원과로 문의하시기 바랍니다.");                                    Close("KFSA-FAIL");                                }                                ln_Cnt++;                            }                            break;                                        case "3" : // 데이콤 실패, 안전원 실패                        case "4" : // 초기 신청 상태                            ls_ResultPrintLgdMsg = "실패"; // LG데이콤결과메세지                            ls_ResultPrintKemsMsg = "실패"; // 안전원결과메세지                            ls_ResultPrintReTransYn = "Y";                            break;                        default : // 결과를 알 수 없는 상태                            gfn_Alert("처리 결과를 알 수가 없습니다.\n정보지원과로 문의하시기 바랍니다.");                            ls_ResultPrintReTransYn = "Y";                            Close("UNKNOWN-FAIL");                            break;                    }                                        //POS 결과 팝업                    ls_RetResultPopup = lfn_PopupResultPos(ds_oPosData.GetColumn(0, "PMYEAR"), ds_oPosData.GetColumn(0, "PMMGNO"));                    if (ls_RetResultPopup == "OK") { // 전체 성공 시                        lfn_UpdateSettlement(); // Settlement 업데이트                        gfn_Alert("환불이 정상적으로 처리되었습니다.");                        break;                    } else if (ls_RetResultPopup <> "RETRANS") { // 실패시 실패 된 것 만 삭제                        lfn_SearchMgno();                        lfn_DeletePos();                        gfn_Alert("환불 처리가 완료되지 않았습니다.");                    }                }                        } else {                lfn_UpdateSettlement(); // 현금영수증이 아닐 때 바로 완료                gfn_Alert("환불이 정상적으로 처리되었습니다.");            }                        break;    }    close(true);}/** * 환불취소 */function btnRepayCancel_OnClick(obj) {    if (!gfn_Confirm("환불취소를 하시겠습니까?")) {        return false;    }        ds_JubsuH.ClearData();    ds_JubsuH.InsertRow(0);    ds_JubsuH.SetColumn(0, "EJHEJMGNO", ds_oRepay.GetColumn(0, "EJHEJMGNO"));    ds_JubsuH.SetColumn(0, "EJHSTATUSCD", "8");    ds_JubsuH.SetColumn(0, "EJHPROCREASON", "환불취소");    ds_JubsuH.SetColumn(0, "PPAPMYEAR", ds_oRepay.GetColumn(0, "ESPMYEAR"));    ds_JubsuH.SetColumn(0, "PPAPMMGNO", ds_oRepay.GetColumn(0, "ESPMMGNO"));    tit_clearActionInfo();    tit_addSingleActionInfo("spcledu:insertInternetExamJubsuRepayCancel", "", 0, "");    tit_callService(        ""        ,""        ,"ds_iInternetExamJubsuRepay=ds_JubsuH:U" // inDs        ,""	// outDs        ,"" // args        ,""        ,false        ,""        ,true    );        close(true);}/* * POS처리 */function lfn_PosProc(sYear, sMgno) {    divPos.ds_ioPosInput.ClearData();    divPos.ds_ioPosInput.InsertRow(0);    divPos.ds_ioPosInput.SetColumn(0, "PMYEAR", sYear);    divPos.ds_ioPosInput.SetColumn(0, "PMMGNO", sMgno);    divPos.ds_ioPosInput.SetColumn(0, "STATUS", "4");                    var sArg = "";    var ls_PosResultCode = ""; // POS 결과코드    var ls_RetPos = Dialog("COM::frmCOM3001PPOSProgressBar.xml", sArg, 300, 123, "TitleBar=false", -1, -1);    if (ls_RetPos == "OK") {        ls_ResultPrintPosMsg = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSMSG"); // 결과메세지        ls_PosResultCode = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSCODE"); // 결과코드    } else if (ls_RetPos == "FAIL"){ // 실패        ls_ResultPrintPosMsg = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSMSG"); // 결과메세지        if ("OK" == divPos.lfn_POSSearch()) { // 실시간 POS 결과를 조회한다.            ls_PosResultCode = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSCODE"); // 결과코드        } else {            ls_PosResultCode = "5"; // 결과코드        }    } else { // 10초 이후(실패)        ls_ResultPrintPosMsg = "10초 - 시간 초과입니다.";        if ("OK" == divPos.lfn_POSSearch()) { // 실시간 POS 결과를 조회한다.            ls_PosResultCode = divPos.ds_ioPosOutput.GetColumn(0, "MI_RSCODE"); // 결과코드        } else {            ls_PosResultCode = "5"; // 결과코드        }    }    return ls_PosResultCode;}/** * POS결과 조회 */function lfn_PopupResultPos(sMgno, sYear, sHpTel) {    gfn_SearchPosResult(sMgno        , sYear        , gds_oPosResult); // POS 결과 정보를 조회한다.    var sArg = ""; // 팝업파라메터    sArg = "sResultPrintSunapGubun=" + quote("환불"); // 수납환불구분(수납0,환불1)    sArg += " sResultPrintBuyerNm=" + quote(gds_oPosResult.GetColumn(0, "BUYER")); // 구매자    sArg += " sResultPrintProgramNm=" + quote(gds_oPosResult.GetColumn(0, "PGMNM")); // 상품정보    sArg += " sResultPrintJumunNo=" + quote(gds_oPosResult.GetColumn(0, "JUMUNNO")); // 주문번호    sArg += " sResultPrintPaymentGubun=" + quote(gds_oPosResult.GetColumn(0, "PAYMENT")); // 납부방법    sArg += " sResultPrintProcAmount=" + quote(divRepay.medAmount.Value); // 처리금액    sArg += " sResultPrintCardNo=" + quote(gds_oPosResult.GetColumn(0, "CARDNO")); // 카드번호    sArg += " sResultPrintCardInstall=" + quote(gds_oPosResult.GetColumn(0, "CARDINSTALL")); // 할부개월수    sArg += " sResultPrintCashReceiptUse=" + quote(gds_oPosResult.GetColumn(0, "CASHRECEIPTUSE")); // 현금영수증발급용도    sArg += " sResultPrintCashCardNo=" + quote(gds_oPosResult.GetColumn(0, "CASHCARDNO")); // 현금영수증번호    sArg += " sResultPrintVirtCashReceiptYn=" + quote(iif(gfn_IsNull(gds_oPosResult.GetColumn(0, "CASHCARDNO")), '아니오', '예')); // 현금영수증여부    sArg += " sResultPrintVirtHpTel=" + quote(divJubsu.edHpTel.Text); // 휴대폰번호    sArg += " sResultPrintVirtBankCd=" + quote(gds_oPosResult.GetColumn(0, "VIRTBANKCD")); // 입금계좌은행    sArg += " sResultPrintVirtBankNm=" + quote(gds_oPosResult.GetColumn(0, "VIRTBANKNM")); // 입금계좌은행명    sArg += " sResultPrintVirtCloseDate=" + quote(gds_oPosResult.GetColumn(0, "VIRTCLOSEDATE")); // 입금마감일    var ls_RetReult = ""; // 결제처리결과팝업 리턴값용    ls_RetReult = Dialog("COM::frmCOM3203PSettlementPOSResult.xml", sArg, 500, 316, "", -1, -1);    return ls_RetReult;}/** * 포스 처리 전 Settlement insert - 환불 * 1. ds_ioSettlement, ds_JubsuH 데이터 셋 필요 * 2. 각 필드 데이터 입력 값 수정 */function lfn_InsertSettlement() {    ds_ioSettlement.ClearData();    ds_ioSettlement.InsertRow(0);    ds_ioSettlement.SetColumn(0, "ESEJMGNO", ds_oRepay.GetColumn(0, "EJHEJMGNO"));    ds_ioSettlement.SetColumn(0, "ESGUBUNCD", "02"); //환불    ds_ioSettlement.SetColumn(0, "ESGUBUN", ds_oSunap.GetColumn(0, "ESGUBUN"));    ds_ioSettlement.SetColumn(0, "ESPROCAMOUNT", toNumber(ds_oSunap.GetColumn(0, "ESPROCAMOUNT")) * (-1));    ds_ioSettlement.SetColumn(0, "ESMGGTMGNO", ds_oJubsu.GetColumn(0, "EOMGGTMGNO"));    ds_ioSettlement.SetColumn(0, "ESREPAYCD", "B"); //환불처리코드:전액    ds_ioSettlement.SetColumn(0, "ESSUNAPACTIONREF", toNumber(ds_oRepay.GetColumn(0, "ESSUNAPACTIONREF")) + 2);    ds_ioSettlement.SetColumn(0, "ESSEQ", ds_oSunap.GetColumn(0, "ESSEQ"));    ds_ioSettlement.SetColumn(0, "ESREPAYREF", "0");    tit_clearActionInfo();    tit_addMultiActionInfo("spcledu:insertExamSettlement", "", 0, "", "N");    tit_callService(        ""        ,""        ,"ds_iExamSettlement=ds_ioSettlement:U" // inDs        ,""	// outDs        ,"" // args        ,""        ,false        ,""        ,true    );}/** * 관리번호 검색 */function lfn_SearchMgno() {    var sArg = "EJHEJMGNO=" + quote(sJubsuNo)        + " EJHSEQ=" + quote(sTjhSeq)        + " EJHSTATUSCD=" + quote(sJubsuStatus);    ds_oPosData.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchExamPosMgno", false);    tit_callService(        ""        ,""        ,"" // inDs        ,"ds_oPosData=ds_oPosMgno"	// outDs        ,sArg // args        ,""        ,false        ,""        ,true    );}/** * POS 데이터 생성 */function lfn_CreatePosData() {    var ls_Gubun = "";    var ls_OrderNo = "";    ds_iPosData.ClearData();        ls_Gubun = iif(right(ds_oPosData.GetColumn(0, "PMPCGUBUN"),1) == "1", "0", "1");    ls_OrderNo = iif(ls_Gubun == "0"        , ds_oPosData.GetColumn(0, "PMYEAR") + "-" + lpad(ds_oPosData.GetColumn(0, "PMMGNO"),"0",8)        , ds_oSunap.GetColumn(0, "PMYEAR") + "-" + lpad(ds_oSunap.GetColumn(0, "PMMGNO"),"0",8));    ls_DeletePosOrderNo[i] = ls_OrderNo;    ds_iPosData.InsertRow(0);    ds_iPosData.SetColumn(0, "PMYEAR", ds_oPosData.GetColumn(0, "PMYEAR"));    ds_iPosData.SetColumn(0, "PMMGNO", ds_oPosData.GetColumn(0, "PMMGNO"));    ds_iPosData.SetColumn(0, "PMPCORDERNO", ls_OrderNo);    ds_iPosData.SetColumn(0, "PMINPUT", "1"); //인터넷    ds_iPosData.SetColumn(0, "PMPCGUBUN", iif(right(ds_oPosData.GetColumn(0, "PMPCGUBUN"),1) == "1", "0", "1"));    ds_iPosData.SetColumn(0, "PMPROCDATE", left(getDate(),8));    ds_iPosData.SetColumn(0, "PMPIID", ds_oRepay.GetColumn(0, "PMPIID"));    ds_iPosData.SetColumn(0, "PMPGMID", "22"); //시험    ds_iPosData.SetColumn(0, "PMPGMPK", ds_oPosData.GetColumn(0, "PMPGMPK"));    ds_iPosData.SetColumn(0, "PMBUYER", ds_oRepay.GetColumn(0, "PMBUYER"));    ds_iPosData.SetColumn(0, "PMCLAS", ds_oJubsu.GetColumn(0, "EOTCCOURSECD"));        ds_iPosData.SetColumn(0, "PMITEM1", "구    분 : " + ds_oJubsu.GetColumn(0, "TCCOURSENM"));    ds_iPosData.SetColumn(0, "PMITEM2", "응시자명 : " + ds_oJubsu.GetColumn(0, "TPNM"));        ds_iPosData.SetColumn(0, "PMITEM3", "응시번호 : "        + iif(ds_oChange.GetColumn(0, "EOAFTERORDER")            , right(divChange.edOrder.Text,9)            , edOrderNo.Text        )    );        ds_iPosData.SetColumn(0, "PMITEM4", "환불일자 : " + left(getDate(),4) + "-" + substr(getDate(),4,2) + "-" + substr(getDate(),6,2));    ds_iPosData.SetColumn(0, "PMPGMGUBUN", ds_oPosData.GetColumn(0, "PMPGMGUBUN"));    ds_iPosData.SetColumn(0, "PMPAYMENTFLAG", ds_oPosData.GetColumn(0, "PMPAMENTFLAG"));    ds_iPosData.SetColumn(0, "PMAMT", ds_oPosData.GetColumn(0, "PMAMT"));    ds_iPosData.SetColumn(0, "PMVAT", 0);            if (ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "22"            || ds_oRepay.GetColumn(0, "PMPGMGUBUN") == "25"            ) { //현금 영수증 일 때        ds_iPosData.SetColumn(0, "PMRESULT", "0");    } else { //현금 일 때        ds_iPosData.SetColumn(0, "PMRESULT", "1");    }        ds_iPosData.SetColumn(0, "PMREGSABUN", gds_oUserInfo.GetColumn(0, "PSABUN") );    ds_iPosData.SetColumn(0, "PPNM", ds_oJubsu.GetColumn(0, "TCCOURSENM"));    ds_iPosData.SetColumn(0, "PCGUBUN", ls_Gubun);    ds_iPosData.SetColumn(0, "PCORDERNO", ls_OrderNo);    ds_iPosData.SetColumn(0, "PCAMT", ds_oPosData.GetColumn(0, "PMAMT"));    ds_iPosData.SetColumn(0, "PCVAT", "0");    ds_iPosData.SetColumn(0, "PCUSERTYPE", ds_oRepay.GetColumn(0, "PCUSERTYPE"));    tit_clearActionInfo();    tit_addMultiActionInfo("spcledu:insertInternetExamJubsuRepayPos", "", 0, "", "N");    tit_callService(        ""        ,""        ,"ds_iInternetExamJubsuRepay=ds_iPosData:U" // inDs        ,""	// outDs        ,"" // args        ,""        ,false        ,""        ,true    );}/** * 포스 처리 후 Settlement update */function lfn_UpdateSettlement() {    ds_JubsuH.ClearData();    ds_JubsuH.InsertRow(0);    ds_JubsuH.SetColumn(0, "EJHEJMGNO", ds_oRepay.GetColumn(0, "EJHEJMGNO"));    ds_JubsuH.SetColumn(0, "EJHSTATUSCD", toNumber(sJubsuStatus)+1);    ds_JubsuH.SetColumn(0, "EJHESSEQREF", ds_oRepay.GetColumn(0, "EJHESSEQREF"));    ds_JubsuH.SetColumn(0, "EJHEOHSEQREF", ds_oRepay.GetColumn(0, "EJHEOHSEQREF"));    ds_JubsuH.SetColumn(0, "EJHMGGTMGNO", gds_oUserInfo.GetColumn(0, "PDEPTCD"));    ds_JubsuH.SetColumn(0, "ESPROCAMOUNT", divRepay.medAmount.Value);    ds_JubsuH.SetColumn(0, "EJHREASON", divRepay.edChangeReason.Text);// POS 정상 처리 & 실패 처리    tit_clearActionInfo();    tit_addSingleActionInfo("spcledu:insertInternetExamJubsuRepayAfter", "", 0, "");    tit_callService(        ""        ,""        ,"ds_iInternetExamJubsuRepay=ds_JubsuH:U" // inDs        ,""	// outDs        ,"" // args        ,""        ,false        ,""        ,true    );}/** * 포스 실패 처리 후 Pos delete */function lfn_DeletePos() {    ds_iPosData.ClearData();    for(var i=ds_oPosData.GetRowCount()-1; i>=0; i--) {        ds_iPosData.InsertRow(0);        ds_iPosData.SetColumn(0, "PMYEAR", ds_oPosData.GetColumn(i, "PMYEAR"));        ds_iPosData.SetColumn(0, "PMMGNO", ds_oPosData.GetColumn(i, "PMMGNO"));        ds_iPosData.SetColumn(0, "PMPCORDERNO", ds_oSunap.GetColumn(0, "PMYEAR") + "-" + lpad(ds_oSunap.GetColumn(0, "PMMGNO"),"0",8));        ds_iPosData.SetColumn(0, "PMPAYMENTFLAG", ds_oPosData.GetColumn(i, "PMPAMENTFLAG"));        ds_iPosData.SetColumn(0, "PMPCGUBUN", iif(right(ds_oPosData.GetColumn(i, "PMPCGUBUN"),1) == "1", "0", "1"));        ds_iPosData.SetColumn(0, "PMITEM1", ds_oPosData.GetColumn(i, "ESEJMGNO"));        ds_iPosData.SetColumn(0, "PMITEM2", ds_oPosData.GetColumn(i, "ESSEQ"));    }    tit_clearActionInfo();    tit_addMultiActionInfo("spcledu:deleteInternetExamJubsuRepayPos", "", 0, "", "N");    tit_callService(        ""        ,""        ,"ds_iInternetExamJubsuRepay=ds_iPosData:U" // inDs        ,""	// outDs        ,"" // args        ,""        ,false        ,""        ,true    );}]]></Script></Window>
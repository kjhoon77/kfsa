<?xml version="1.0" encoding="utf-8"?><Window>	<Form BKColor="user0" Height="590" Id="frmspcledu0250MLicenseIssueManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="수첩발급정보관리" Top="8" Ver="1.0" Width="800" WorkArea="true">		<Datasets>			<Dataset DataSetType="Dataset" Id="ds_iLicense">				<Contents>					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>					<colinfo id="LADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="LADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="LBARCODE" size="12" summ="default" type="STRING"/>					<colinfo id="LCANCELDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LCANCELPSABUN" size="8" summ="default" type="STRING"/>					<colinfo id="LCANCELREASON" size="100" summ="default" type="STRING"/>					<colinfo id="LCOMPNM" size="50" summ="default" type="STRING"/>					<colinfo id="LDATAAPPROVAL" size="1" summ="default" type="STRING"/>					<colinfo id="LHIIIMGSEQ" size="9" summ="default" type="STRING"/>					<colinfo id="LHISSUEREASON" size="50" summ="default" type="STRING"/>					<colinfo id="LHPROCGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="LHPRTDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LHPTEL" size="16" summ="default" type="STRING"/>					<colinfo id="LISSUEDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LISSUEGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="LISSUEGUBUNNM" size="50" summ="default" type="STRING"/>					<colinfo id="LLASTHISTORYSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LHLLCSNO" size="256" summ="default" type="STRING"/>					<colinfo id="LLCSNO" size="19" summ="default" type="STRING"/>					<colinfo id="LPERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="LRESIDENTNO" size="13" summ="default" type="STRING"/>					<colinfo id="LSTATUSGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="LTCCOURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="LTEL" size="16" summ="default" type="STRING"/>					<colinfo id="LTPMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LTRAININGENDDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LTRAININGSTARTDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LZIPCD" size="6" summ="default" type="STRING"/>					<colinfo id="TCCOURSENM" size="30" summ="default" type="STRING"/>					<colinfo id="TPAUTHYN" size="1" summ="default" type="STRING"/>					<colinfo id="TPCHECK" size="1" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oPrintGubun">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>					<record>						<CD>01</CD>						<DATA>신규발급</DATA>					</record>					<record>						<CD>02</CD>						<DATA>재발급(조회/수정/환불)</DATA>					</record>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oCourse">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oIssueGubun">				<Contents>					<colinfo id="CD" size="256" summ="default" type="STRING"/>					<colinfo id="DATA" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oLicenseReport">				<Contents>					<colinfo id="BIRTHDAY" size="10" summ="default" type="STRING"/>					<colinfo id="IIFILENM" size="513" summ="default" type="STRING"/>					<colinfo id="LADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="LADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="LBARCODE" size="12" summ="default" type="STRING"/>					<colinfo id="LHPRTDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LISSUEDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LISSUEGUBUNNM" size="50" summ="default" type="STRING"/>					<colinfo id="LLCSNO" size="19" summ="default" type="STRING"/>					<colinfo id="LPERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="LTCCOURSENM" size="30" summ="default" type="STRING"/>					<colinfo id="LLASTHISTORYSEQ" size="22" summ="default" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioImageInfo">				<Contents>					<colinfo id="BIRTHDAY" size="11" summ="default" type="STRING"/>					<colinfo id="IIAPPROVAL" size="1" summ="default" type="STRING"/>					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>					<colinfo encrypt="base64" id="IIIMGBINARY" size="4000" summ="default" type="BLOB"/>					<colinfo id="IIIMGSEQ" size="40" summ="default" type="STRING"/>					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>					<colinfo id="IIREGDATE" size="19" summ="default" type="STRING"/>					<colinfo id="IIREGGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="IIREGGUBUNNM" size="50" summ="default" type="STRING"/>					<colinfo id="IIREGSABUN" size="20" summ="default" type="STRING"/>					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>					<colinfo id="TPLASTIMGSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TPMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="TPNM" size="20" summ="default" type="STRING"/>					<colinfo id="TPRESIDENTNO" size="13" summ="default" type="STRING"/>					<colinfo id="TPAUTHYN" size="1" summ="default" type="STRING"/>					<colinfo id="TPZIPCD" size="256" summ="default" type="STRING"/>					<colinfo id="TPADDR1" size="256" summ="default" type="STRING"/>					<colinfo id="TPADDR2" size="256" summ="default" type="STRING"/>					<colinfo id="TPBULDNM" size="256" summ="default" type="STRING"/>					<colinfo id="TPTEL" size="256" summ="default" type="STRING"/>					<colinfo id="TPHPTEL" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oSetlmentHist">				<Contents>					<colinfo id="LSACTIVEYN" size="1" summ="default" type="STRING"/>					<colinfo id="LSGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="LSGUBUNCD" size="2" summ="default" type="STRING"/>					<colinfo id="LSGUBUNCDNM" size="50" summ="default" type="STRING"/>					<colinfo id="LSGUBUNNM" size="50" summ="default" type="STRING"/>					<colinfo id="LSLHSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LSLLCSNO" size="19" summ="default" type="STRING"/>					<colinfo id="LSPMMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LSPMYEAR" size="4" summ="default" type="STRING"/>					<colinfo id="LSPONYDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LSPONYGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="LSPROCAMOUNT" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LSPROCDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LSPROCGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="LSREGSABUN" size="8" summ="default" type="STRING"/>					<colinfo id="LSREGSABUNNM" size="20" summ="default" type="STRING"/>					<colinfo id="LSREPAYREF" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LSSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LSSETLMTYN" size="1" summ="default" type="STRING"/>					<colinfo id="PMPAYMENTFLAG" size="1" summ="default" type="STRING"/>					<colinfo id="TSJUMUNNO" size="13" summ="default" type="STRING"/>					<colinfo id="LSSUNAPGUBUN" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oLicense" OnRowPosChanged="ds_oLicense_OnRowPosChanged">				<Contents>					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>					<colinfo id="LADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="LADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="LBARCODE" size="12" summ="default" type="STRING"/>					<colinfo id="LCANCELDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LCANCELPSABUN" size="8" summ="default" type="STRING"/>					<colinfo id="LCANCELREASON" size="100" summ="default" type="STRING"/>					<colinfo id="LCOMPNM" size="50" summ="default" type="STRING"/>					<colinfo id="LDATAAPPROVAL" size="1" summ="default" type="STRING"/>					<colinfo id="LHIIIMGSEQ" size="10" summ="default" type="STRING"/>					<colinfo id="LHISSUEREASON" size="50" summ="default" type="STRING"/>					<colinfo id="LHPROCGTMGNO" size="4" summ="default" type="STRING"/>					<colinfo id="LHPRTDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LHPTEL" size="16" summ="default" type="STRING"/>					<colinfo id="LISSUEDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LISSUEGUBUN" size="2" summ="default" type="STRING"/>					<colinfo id="LISSUEGUBUNNM" size="50" summ="default" type="STRING"/>					<colinfo id="LLASTHISTORYSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LHLLCSNO" size="256" summ="default" type="STRING"/>					<colinfo id="LLCSNO" size="19" summ="default" type="STRING"/>					<colinfo id="LPERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="LRESIDENTNO" size="13" summ="default" type="STRING"/>					<colinfo id="LSTATUSGUBUN" size="1" summ="default" type="STRING"/>					<colinfo id="LTCCOURSECD" size="2" summ="default" type="STRING"/>					<colinfo id="LTEL" size="16" summ="default" type="STRING"/>					<colinfo id="LTPMGNO" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LTRAININGENDDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LTRAININGSTARTDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LZIPCD" size="6" summ="default" type="STRING"/>					<colinfo id="TCCOURSENM" size="30" summ="default" type="STRING"/>					<colinfo id="TPAUTHYN" size="1" summ="default" type="STRING"/>					<colinfo id="TPCHECK" size="1" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_iTrainingPerson">				<Contents>					<colinfo id="TPAUTHYN" size="1" summ="default" type="STRING"/>					<colinfo id="TPNM" size="20" summ="default" type="STRING"/>					<colinfo id="TPRESIDENTNO" size="13" summ="default" type="STRING"/>					<colinfo id="TPMGNO" size="22" summ="default" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_iLicenseImage">				<Contents>					<colinfo id="LILLCSNO" size="19" summ="default" type="STRING"/>					<colinfo id="LISEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LIDIRPATH" size="256" summ="default" type="STRING"/>					<colinfo id="LIREALNM" size="256" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_ioModifyHistory"></Dataset>			<Dataset DataSetType="Dataset" Id="ds_oLicenseReportEdu">				<Contents>					<colinfo id="EDUDATE" size="8" summ="default" type="STRING"/>					<colinfo id="GTDEPTNM" size="8" summ="default" type="STRING"/>					<colinfo id="TARGET" size="2" summ="default" type="STRING"/>					<colinfo id="TCCOURSENM" size="2" summ="default" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oTrainingPerson">				<Contents>					<colinfo id="IIDIRPATH" size="256" type="STRING"/>					<colinfo id="IIREALNM" size="256" type="STRING"/>					<colinfo id="TPAUTHYN" size="1" type="STRING"/>					<colinfo id="TPCUSTGUBUN" size="2" type="STRING"/>					<colinfo id="TPEMAILDOMAIN" size="40" type="STRING"/>					<colinfo id="TPEMAILID" size="40" type="STRING"/>					<colinfo id="TPHPTEL" size="16" type="STRING"/>					<colinfo id="TPLASTIMGSEQ" size="22" type="DECIMAL"/>					<colinfo id="TPMGNO" size="22" type="DECIMAL"/>					<colinfo id="TPNM" size="20" type="STRING"/>					<colinfo id="TPRESIDENTNO" size="13" type="STRING"/>					<colinfo id="TPTEL" size="16" type="STRING"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oLicenseH" OnRowPosChanged="ds_oLicenseH_OnRowPosChanged">				<Contents>					<colinfo id="BIRTHDAY" size="11" summ="default" type="STRING"/>					<colinfo id="LHADDR1" size="100" summ="default" type="STRING"/>					<colinfo id="LHADDR2" size="100" summ="default" type="STRING"/>					<colinfo id="LHISSUEREASON" size="50" summ="default" type="STRING"/>					<colinfo id="LHLLCSNO" size="19" summ="default" type="STRING"/>					<colinfo id="LHPERSONNM" size="20" summ="default" type="STRING"/>					<colinfo id="LHPRTDATE" size="8" summ="default" type="STRING"/>					<colinfo id="LHTEL" size="16" summ="default" type="STRING"/>					<colinfo id="LIDIRPATH" size="256" summ="default" type="STRING"/>					<colinfo id="LIREALNM" size="256" summ="default" type="STRING"/>					<colinfo id="LHSEQ" size="22" summ="default" type="DECIMAL"/>					<colinfo id="LHTJMGNO" size="256" summ="default" type="STRING"/>					<colinfo id="LHISSUEMGNO" size="22" summ="default" type="DECIMAL"/>				</Contents>			</Dataset>			<Dataset DataSetType="Dataset" Id="ds_oYearbizlink"></Dataset>		</Datasets>		<Shape Bottom="448" Height="120" Id="Shape1" Left="570" LineColor="user15" Right="795" TabOrder="74" Top="328" Type="Rectangle" Width="225"></Shape>		<Shape Bottom="140" Height="76" Id="shpGubunBox3" Left="3" LineColor="user15" Right="573" TabOrder="21" Top="64" Type="Rectangle" Width="570"></Shape>		<Shape Bottom="324" Height="76" Id="shpGubunBox5" Left="3" LineColor="user15" Right="795" TabOrder="52" Top="248" Type="Rectangle" Width="792"></Shape>		<Shape Bottom="60" Height="28" Id="shpGubunBox1" Left="3" LineColor="user15" Right="573" TabOrder="51" Top="32" Type="Rectangle" Width="570"></Shape>		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="444" LineColor="user14" Right="796" TabOrder="66" Top="1" Type="Rectangle" Width="352"></Shape>		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="47" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="260">			<Contents></Contents>		</Div>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="24" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="534" OnClick="lfn_Excel" Style="sty_Button" TabOrder="2" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="621" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="3" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="708" OnClick="lfn_End" Style="sty_Button" TabOrder="4" ToolTipText="닫기" Top="4" Width="85"></Button>		<Static Align="Center" Height="20" Id="lbPrintGubun" Left="7" Style="sty_Label" TabOrder="48" Text="발급구분" Top="36" VAlign="Middle" Width="88"></Static>		<Radio Border="None" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Font="굴림,12,Bold" Height="20" Id="radPrintGubun" INDEX="0" InnerDataset="ds_oPrintGubun" Left="103" OnChanged="radPrintGubun_OnChanged" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="6" Top="36" Value="02" Width="350"></Radio>		<Shape Bottom="584" Height="132" Id="shpGubunBox6" Left="3" LineColor="user15" Right="795" TabOrder="50" Top="452" Type="Rectangle" Width="792"></Shape>		<Shape Bottom="244" Height="100" Id="shpGubunBox4" Left="3" LineColor="user15" Right="573" TabOrder="53" Top="144" Type="Rectangle" Width="570"></Shape>		<Shape Bottom="448" Height="120" Id="shpGubunBox2" Left="3" LineColor="user15" Right="567" TabOrder="54" Top="328" Type="Rectangle" Width="564"></Shape>		<Static Align="Center" Height="112" Id="lbLcsHistInfo" Left="7" Style="sty_LabelGruopBox" TabOrder="55" Text="수첩보유현황" Top="332" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchLcsIssueHist" ImageID="BTN_TEXT_06" Left="699" OnClick="btnLcsImage_OnClick" Style="sty_Button" TabOrder="44" Text="이미지보기" Top="331" Transparent="TRUE" Width="94"></Button>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oLicense" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="444" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="112" Id="gdLcsInfo" InputPanel="FALSE" Left="35" LineColor="default" Right="563" RowHeight="20" Style="sty_Grid" TabOrder="17" TabStop="true" Top="332" UseDBuff="true" UsePopupMenu="true" UserData="수첩정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="528">			<contents>				<format id="Default">					<columns>						<col width="34"/>						<col width="112"/>						<col width="139"/>						<col width="72"/>						<col width="72"/>						<col width="95"/>						<col width="207"/>					</columns>					<head>						<cell col="0" display="text" text="순번"/>						<cell align="center" col="1" display="text" text="직능"/>						<cell align="center" col="2" display="text" text="수첩번호"/>						<cell align="center" col="3" display="text" text="취득일"/>						<cell align="center" col="4" display="text" text="폐기일"/>						<cell align="center" col="5" display="text" text="취득구분"/>						<cell align="center" col="6" display="text" text="폐기사유"/>					</head>					<body>						<cell align="center" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' col="0" display="text" expr="currow&#32;+&#32;1" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>						<cell align="center" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' bkimageid='expr:iif(LSTATUSGUBUN==&quot;03&quot;,&#32;&apos;#EA9455&apos;,&apos;&apos;)' col="1" colid="TCCOURSENM" display="combo" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>						<cell align="center" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' col="2" colid="LLCSNO" display="text" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)' Mask="####-##-##-#-######"/>						<cell align="center" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' col="3" colid="LISSUEDATE" display="text" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)' Mask="####.##.##"/>						<cell align="center" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' col="4" colid="LCANCELDATE" display="text" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)' Mask="####.##.##"/>						<cell align="center" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' col="5" colid="LISSUEGUBUNNM" display="combo" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>						<cell align="left" bkcolor='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;User8&quot;)' col="6" colid="LCANCELREASON" display="text" font='expr:iif(LSTATUSGUBUN&#32;==&#32;&quot;N&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>					</body>				</format>			</contents>		</Grid>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadPicture" ImageID="BTN_TEXT_08" Left="675" OnClick="btnLoadPicture_OnClick" Style="sty_Button" TabOrder="30" Text="사진찾기" Top="222" Transparent="TRUE" Width="119"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadScanPicture" ImageID="BTN_TEXT_08" Left="675" OnClick="btnLoadScanPicture_OnClick" Style="sty_Button" TabOrder="29" Text="스캔사진불러오기" Top="198" Transparent="TRUE" Width="119"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnScanPicture" ImageID="BTN_TEXT_08" Left="675" OnClick="btnScanPicture_OnClick" Style="sty_Button" TabOrder="28" Text="사진스캔실행" Top="174" Transparent="TRUE" Width="119"></Button>		<Image Border="Flat" FillType="STRETCH" Height="140" Id="imgPicture" Left="680" Style="sty_Image" TabOrder="46" Text="사진" Top="32" Transparent="TRUE" Width="108"></Image>		<Image Border="Flat" FillType="STRETCH" Height="120" Id="imgLastestPicture" Left="578" Style="sty_Image" TabOrder="45" Text="최근사진" Top="32" Transparent="TRUE" Width="94"></Image>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPictureManagement" ImageID="BTN_TEXT_06" Left="579" OnClick="btnPictureManagement_OnClick" Style="sty_Button" TabOrder="27" Text="사진관리" Top="222" Transparent="TRUE" Width="93"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnApplyPicture" ImageID="BTN_TEXT_06" Left="579" OnClick="btnApplyPicture_OnClick" Style="sty_Button" TabOrder="25" Text="최근사진반영" Top="174" Transparent="TRUE" Width="93"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchRegPicture" ImageID="BTN_TEXT_06" Left="579" OnClick="btnSearchRegPicture_OnClick" Style="sty_Button" TabOrder="26" Text="등록사진조회" Top="198" Transparent="TRUE" Width="93"></Button>		<Static Align="Center" Height="68" Id="lbSearch" Left="7" Style="sty_LabelGruopBox" TabOrder="56" Text="조회" Top="68" UserData="S" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>		<Static Align="Center" Height="20" Id="lbResidentNo" Left="35" Style="sty_Label" TabOrder="58" Text="주민번호" Top="92" UserData="S" VAlign="Middle" Width="88"></Static>		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medResidentNo" Left="127" LeftMargin="2" Mask="######-#######" OnCharChanged="lfn_TrainingPersonOnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="8" Top="92" Type="STRING" UserData="S:주민번호" Width="106"></MaskEdit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAuthResidentNo" ImageID="BTN_TEXT_06" Left="236" OnClick="btnAuthResidentNo_OnClick" Style="sty_Button" TabOrder="20" Text="실명인증" Top="91" Transparent="TRUE" Width="93"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfo" ImageID="BTN_TEXT_06" Left="236" OnClick="btnSearchPersonInfo_OnClick" Style="sty_Button" TabOrder="19" Text="기본정보조회" Top="67" Transparent="TRUE" Width="93"></Button>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edPersonNm" ImeMode="native" Left="127" LeftMargin="2" MaxLength="10" OnCharChanged="lfn_TrainingPersonOnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="7" Top="68" UserData="S:성명" Width="106"></Edit>		<Static Align="Center" Height="20" Id="lbPersonNm" Left="35" Style="sty_Label" TabOrder="57" Text="성명" Top="68" UserData="S" VAlign="Middle" Width="88"></Static>		<Static Align="Center" Height="20" Id="lbAddr" Left="35" Style="sty_Label" TabOrder="61" Text="주소" Top="148" VAlign="Middle" Width="88"></Static>		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BKColor="user4" Border="Flat" Height="20" Id="medZipCode" Left="127" LeftMargin="2" Mask="###-###" OnCharChanged="lfn_TrainingPersonOnChanged" OnFocus="edZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="40" Top="148" Type="STRING" UserData="S" Width="58"></MaskEdit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchZipCode" ImageID="BTN_SEARCH" Left="188" OnClick="btnSearchZipCode_OnClick" Style="sty_Button" TabOrder="24" Top="148" Transparent="TRUE" Width="22"></Button>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edAddr2" ImeMode="native" Left="127" LeftMargin="2" MaxLength="50" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="10" Top="172" UserData="S" Width="442"></Edit>		<Static Align="Center" Height="20" Id="lbTel" Left="35" Style="sty_Label" TabOrder="59" Text="전화번호" Top="196" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTel" ImeMode="native" Left="127" LeftMargin="2" MaxLength="16" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="11" Top="196" UserData="S" Width="128"></Edit>		<Static Align="Center" Height="20" Id="lbHpTel" Left="259" Style="sty_Label" TabOrder="60" Text="휴대폰" Top="196" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edHpTel" ImeMode="native" Left="351" LeftMargin="2" MaxLength="16" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="12" Top="196" UserData="S" Width="128"></Edit>		<Static Align="Center" Height="92" Id="lbPersonInfo" Left="7" Style="sty_LabelGruopBox" TabOrder="62" Text="개인정보" Top="148" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>		<Static Align="Center" Height="20" Id="lbLcsNo" Left="35" Style="sty_Label" TabOrder="63" Text="수첩번호" Top="116" UserData="S" VAlign="Middle" Width="88"></Static>		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medLcsNo" Left="127" LeftMargin="2" Mask="####-##-##-#-######" OnFocus="medLcsNo_OnFocus" OnKeyDown="medLcsNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="15" Top="116" Type="STRING" UserData="S" Width="142"></MaskEdit>		<Static Align="Center" Height="20" Id="lbIssueRemark" Left="35" Style="sty_Label" TabOrder="65" Text="근무처" Top="220" VAlign="Middle" Width="88"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edCompNm" ImeMode="native" Left="127" LeftMargin="2" MaxLength="50" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="13" Top="220" UserData="S" Width="442"></Edit>		<Static Align="Center" Height="20" Id="lbFirstIssueDate" Left="35" Style="sty_Label" TabOrder="64" Text="최초취득일자" Top="252" VAlign="Middle" Width="88"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" Enable="FALSE" HeaderFont="돋음,10,Bold" Height="20" Id="calFirstIssueDate" Left="127" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="41" Top="252" WeeksFont="돋음,9" Width="98"></Calendar>		<Radio Border="Flat" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="44" Id="radIssueGubun" INDEX="0" InnerDataset="ds_oIssueGubun" Left="443" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="23" Top="276" Value="ALL" Width="252"></Radio>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnChangeProcDate" ImageID="BTN_TEXT_06" Left="472" OnClick="btnSeqList_OnClick" Style="sty_Button" TabOrder="37" Text="처리일자변경" Top="456" Transparent="TRUE" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnProcRct" ImageID="BTN_TEXT_09" Left="566" OnClick="btnProcRct_OnClick" Style="sty_Button" TabOrder="38" Text="현금영수증처리/취소" Top="456" Transparent="TRUE" Width="131"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRct" ImageID="BTN_TEXT_06" Left="699" OnClick="btnPrintReRct_OnClick" Style="sty_Button" TabOrder="39" Text="영수증재발행" Top="456" Transparent="TRUE" Width="92"></Button>		<Button BKColor="user17" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Font="굴림,10,Bold" Height="124" Id="btnSetlmt" Left="35" OnClick="btnSetlmt_OnClick" Style="sty_Button" TabOrder="35" Text="결제(POS)" Top="456" Width="92"></Button>		<Static Align="Center" Height="124" Id="lbSetlmt" Left="7" Style="sty_LabelGruopBox" TabOrder="66" Text="결제내역" Top="456" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>		<Radio Border="Flat" CodeColumn="CD" ColumnCount="3" DataColumn="DATA" Height="44" Id="radCourse" INDEX="0" InnerDataset="ds_oCourse" Left="59" OnChanged="radCourse_OnChanged" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="22" Top="276" Width="356"></Radio>		<Static Align="Center" Height="20" Id="lbIssueDate" Left="521" Style="sty_Label" TabOrder="67" Text="발급일자" Top="252" VAlign="Middle" Width="72"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calIssueDate" Left="597" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="16" Top="252" WeeksFont="돋음,9" Width="98"></Calendar>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrint" ImageID="BTN_TEXT_06" Left="699" OnClick="lfn_Print" Style="sty_Button" TabOrder="33" Text="수첩&#32;출력" ToolTipText="수첩&#32;출력" Top="275" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_TEXT_06" Left="699" OnClick="lfn_Delete" Style="sty_Button" TabOrder="34" Text="수첩&#32;폐기" ToolTipText="수첩&#32;폐기" Top="299" Width="92"></Button>		<Static Align="Center" Height="20" Id="lbEduDate" Left="228" Style="sty_Label" TabOrder="68" Text="교육기간" Top="252" VAlign="Middle" Width="72"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" Enable="FALSE" HeaderFont="돋음,10,Bold" Height="20" Id="calEduDateStart1" Left="304" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="42" Top="252" UserData="S" WeeksFont="돋음,9" Width="98"></Calendar>		<Static Align="Center" Height="20" Id="lbDateWave" Left="406" Style="sty_Text" TabOrder="69" Text="~" Top="252" VAlign="Middle" Width="10"></Static>		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" Enable="FALSE" HeaderFont="돋음,10,Bold" Height="20" Id="calEduDateEnd2" Left="420" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="43" Top="252" UserData="S" WeeksFont="돋음,9" Width="98"></Calendar>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="448" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="1" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>		<Static Align="Center" Height="20" Id="lbBarCode" Left="340" Style="sty_Label" TabOrder="70" Text="바코드" Top="116" UserData="S" VAlign="Middle" Width="46"></Static>		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="medBarCode" ImeMode="native" Left="389" LeftMargin="2" MaxLength="12" Number="TRUE" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medBarCode_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="14" Top="116" UserData="S" Width="100"></Edit>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnBarCodeSearch" ImageID="BTN_TEXT_05" Left="491" OnClick="btnBarCodeSearch_OnClick" Style="sty_Button" TabOrder="31" Text="바코드조회" Top="115" Transparent="TRUE" Width="80"></Button>		<FileDialog Bottom="59" Filter="All(*.*)|*.*|JPG&#32;File(*.jpg)|*.jpg|" Height="24" Id="fdImageFile" Left="516" Right="540" TabOrder="77" Top="35" Width="24"></FileDialog>		<HttpFile Height="24" Id="hfImageFile" Left="540" Top="35" Width="24"></HttpFile>		<Edit AutoSelect="TRUE" Border="Flat" Column="ADDR1" Height="20" Id="edAddr1" ImeMode="native" Left="211" LeftMargin="2" OnCharChanged="lfn_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="148" UserData="S" Width="358"></Edit>		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oSetlmentHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="580" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="98" Id="gdSetlmt" InputPanel="FALSE" Left="131" LineColor="default" Right="791" RowHeight="20" Style="sty_Grid" TabOrder="18" TabStop="true" Top="482" UseDBuff="true" UsePopupMenu="true" UserData="결제내역" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="660">			<contents>				<format id="Default">					<columns>						<col width="41"/>						<col width="65"/>						<col width="82"/>						<col width="55"/>						<col width="96"/>						<col width="158"/>						<col width="64"/>						<col width="58"/>						<col width="73"/>						<col width="106"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="순번"/>						<cell col="1" display="text" text="발급구분"/>						<cell align="center" col="2" display="text" text="처리일자"/>						<cell col="3" display="text" text="선수납"/>						<cell align="center" col="4" display="text" text="결제구분"/>						<cell align="center" col="5" display="text" text="결제방법"/>						<cell align="center" col="6" display="text" text="금액(원)"/>						<cell align="center" col="7" display="text" text="환불No"/>						<cell align="center" col="8" display="text" text="처리자"/>						<cell align="center" col="9" display="text" text="주문번호"/>					</head>					<body>						<cell align="center" col="0" display="text" expr="ds_oSetlmentHist.GetRowCount()&#32;-&#32;currow"/>						<cell col="1" colid="LSLHSEQ" display="text" expr='iif(LSLHSEQ==1,&#32;&quot;신규발급&quot;,&quot;재발급&quot;)'/>						<cell align="center" col="2" colid="LSPROCDATE" display="text" Mask="####-##-##"/>						<cell align="center" col="3" colid="LSSUNAPGUBUN" display="text"/>						<cell align="center" col="4" colid="LSGUBUNCDNM" display="text"/>						<cell align="left" col="5" colid="LSGUBUNNM" display="text"/>						<cell align="right" col="6" colid="LSPROCAMOUNT" display="number" Mask="#,###"/>						<cell align="center" col="7" colid="LSREPAYREF" display="text"/>						<cell align="center" col="8" colid="LSREGSABUNNM" display="text"/>						<cell align="left" col="9" colid="TSJUMUNNO" display="text"/>					</body>				</format>			</contents>		</Grid>		<File Bottom="59" Height="24" Id="fiImageFile" Left="492" Right="516" TabOrder="75" Top="35" Width="24"></File>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_TEXT_06" Left="699" OnClick="lfn_Save" Style="sty_Button" TabOrder="32" Text="수첩&#32;재발급" ToolTipText="수첩&#32;출력" Top="251" Width="92"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSaveInfo" ImageID="BTN_TEXT_11" Left="276" OnClick="lfn_InfoSave" Style="sty_Button" TabOrder="5" Text="수첩정보&#32;및&#32;바코드&#32;저장" Top="4" Transparent="TRUE" Width="158"></Button>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPosResultList" ImageID="BTN_TEXT_08" Left="352" OnClick="btnPosResultList_OnClick" Style="sty_Button" TabOrder="36" Text="결제처리결과조회" Top="456" Transparent="TRUE" Width="118"></Button>		<Static Align="Center" Height="68" Id="lbLcsInfo" Left="7" Style="sty_LabelGruopBox" TabOrder="71" Text="수첩정보" Top="252" UserData="S" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_TEXT_04" Left="272" OnClick="lfn_Search" Style="sty_Button" TabOrder="72" Text="번호조회" Top="115" Transparent="TRUE" Width="66"></Button>		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="ds_oLicenseH" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="444" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="88" Id="gdLcsHistory" InputPanel="FALSE" Left="602" LineColor="default" MinWidth="100" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="792" RowHeight="20" Style="sty_Grid" TabOrder="73" TabStop="true" Top="356" UseDBuff="true" UsePopupMenu="true" UserData="교육접수목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="190">			<contents>				<format id="Default">					<columns>						<col width="32"/>						<col width="68"/>						<col width="76"/>					</columns>					<head>						<cell align="center" col="0" display="text" text="순번"/>						<cell align="center" col="1" display="text" text="발급구분"/>						<cell align="center" col="2" display="text" text="발급일자"/>					</head>					<body>						<cell align="center" col="0" display="text" expr="ds_oLicenseH.GetRowCount()&#32;-&#32;currow"/>						<cell align="center" col="1" colid="LHISSUEREASON" display="text"/>						<cell align="center" col="2" colid="LHPRTDATE" display="text" Mask="####.##.##"/>					</body>				</format>			</contents>		</Grid>		<Static Align="Center" Height="111" Id="Static0" Left="574" Style="sty_LabelGruopBox" TabOrder="75" Text="수첩발급이력" Top="332" VAlign="Middle" Width="24" WordWrap="TRUE"></Static>		<Static Align="Center" Height="44" Id="lbCourse" Left="35" Style="sty_Label" TabOrder="76" Text="직능" Top="276" VAlign="Middle" Width="20" WordWrap="TRUE"></Static>		<Static Align="Center" Height="44" Id="lbIssueGubun" Left="419" Style="sty_Label" TabOrder="77" Text="구분" Top="276" VAlign="Middle" Width="20" WordWrap="TRUE"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnTPModify" ImageID="BTN_TEXT_09" Left="331" OnClick="btnTPModify_OnClick" Style="sty_Button" TabOrder="78" Text="접수자&#32;정보&#32;변경" Top="67" Transparent="TRUE" Width="131"></Button>		<Static Align="Center" Height="20" Id="lbImgDate" Left="580" Style="sty_TextBlue" TabOrder="79" Top="152" VAlign="Middle" Width="91"></Static>		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPosReport" ImageID="BTN_TEXT_07" Left="245" OnClick="btnPosReport_OnClick" Style="sty_Button" TabOrder="80" Text="통합영수증조회" Top="456" Transparent="TRUE" Width="105"></Button>	</Form>	<Script><![CDATA[/* * 프로그램명 : frmspcledu0250MLicenseIssueManagement.xml * 설명 : 수첩발급정보관리 * 작성일 : 2009.08.25 * 작성자 : 김동현 */#include "LIB::training.js"; // 공통업무 관련var lb_FileUpload = false;var ls_FileUploadPath = "/IMGDATA/" + left(getDate(),4) + "/" + SubStr(getDate(),4,2);var ls_RealFileName = "";var lb_FileDelete = false;var li_LicenseCurrentNo = 0;var ls_ImageSeq;var ls_LastImageSeq;var ls_TrainingPersonMgno;var ls_IsNiceCheckOk = "N"; //실명인증 체크var lb_BarcodeCheck = false;var ls_AllModifyCheck = ""; //데이터 변경 체크var ls_TpModifyCheck = ""; //사용자 정보 변경 체크    /* 공통 필수 시작 */function Form_OnLoadCompleted(obj) {    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리    // 폼 환경설정    ls_SystemGubun = gs_SystemGubun;    ls_SystemMenuId = gs_SystemMenuId;    var ls_FormId = split(sFormUrl, "::");    ls_FormId = split(ls_FormId[1], ".");    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정        lfn_SetFormAuth(true); // 저장 권한    } else if (ms_FormAuth == "R") {        lfn_SetFormAuth(false); // 읽기 권한    } else {        gfn_Alert(MSGI00080);        close();    }    // 공통 코드 조회    gfn_SearchTrainingCourse("L", ds_oCourse, "Y"); // 직능 코드 조회    gfn_SearchCommonCode(ds_oIssueGubun, "PASSGUBUN", "Y"); // 취득구분 코드 조회        radIssueGubun.Value = "3";    radCourse.Value = "60";        ls_TrainingPersonMgno = "";    calIssueDate.Value = left(GetDate(), 8);        radCourse.Enable = false;    radIssueGubun.Enable = false;    edPersonNm.SetFocus();    }function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {    // to do    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리    }function Form_OnSize(obj,nCx,nCy,nState) {    if (gs_IsResizingForm == "Y") {        gdSetlmt.Height = nCy - gdSetlmt.Top - 8;        lbSetlmt.Height = nCy - lbSetlmt.Top - 8;        btnSetlmt.Height = nCy - btnSetlmt.Top - 8;        shpGubunBox6.Height = nCy - shpGubunBox6.Top - 4;    }    }/* * 기능 : 조회 */function lfn_Search(obj) {    li_LicenseCurrentNo = 0;    var args = "";    var ls_HistoryArg;            if (lb_BarcodeCheck) {        if (gfn_IsNull(medBarCode.Text)) {            gfn_Alert("바코드를 입력해 주십시오.");            return;        }        args = "LBARCODE=" + quote(medBarCode.Text);            } else {        if (gfn_IsNull(medLcsNo.Value) && gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medResidentNo.Value)) {            gfn_Alert("성명, 주민번호, 수첩번호 중 하나 이상을 입력해 주십시오.");            return;        }        args = "LLCSNO=" + quote(iif(gfn_isNull(medLcsNo.Value),"",medLcsNo.Text))            + " LTPMGNO=" + quote(ls_TrainingPersonMgno);    }        // 데이타셋 초기화    ds_oLicense.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchLicense");        // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_oLicense=ds_oLicense"	// outDs        ,args // args         ,"lfn_AfterSearchLicense"        ,false        ,""        ,true    );        lfn_TrainingPersonCheck();    if (lb_BarcodeCheck) {        ls_HistoryArg = "바코드=" + medBarCode.Text;            } else {        if (gfn_IsNull(medLcsNo.Value)) {            ls_HistoryArg = "성명=" + edPersonNm.Text + ",주민번호=" + medResidentNo.Text;        } else {            ls_HistoryArg = "수첩번호=" + medLcsNo.Text;        }    }    // 조회이력을 저장한다.    gfn_InsertSearchPrintHistory(        "S"        , this.ID        , global.mnuLeft.cbxOpenForm.Text        , ls_HistoryArg    );}/* * 기능 : 삭제 */function lfn_Delete(obj) {    if (ds_oLicense.GetRowCount()<1) {         gfn_Alert("수첩을 선택 해주십시오.");        return false;    }        var sArg = "sLicenseNo=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO"))        + " sLicenseHNo=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LLASTHISTORYSEQ"))        + " sPersonNm=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LPERSONNM"))        + " sResidentNo=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LRESIDENTNO"))        + " sCourse=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LISSUEGUBUNNM"))        + " sReason=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LCANCELREASON"));        return Dialog("spcledu::frmspcledu0252PLicenseCancel.xml", sArg, 500, 160, "", -1, -1);}/* * 기능 : 저장 */function lfn_Save(obj) {    var nRow = 0; //추가인지 수정인지 구분    var ls_RealFileName = ""; //서버에 저장될 파일 명    var ls_FileUploadCheck = "";    var ls_UploadRealName = "";    var ls_InsertCheck = "";    var i = 0;    if (radPrintGubun.Value == "01") { //신규발급 일 때            var returnCheck = true;        lfn_TrainingPersonCheck(); //사람이 이미 있는지 검색한다.            if (ds_oTrainingPerson.GetRowCount() == 1) {            ls_TrainingPersonMgno = ds_oTrainingPerson.GetColumn(0, "TPMGNO");            // 이미지 백업            var ls_ImageSeqBack = ls_ImageSeq;            var imgPictureImageBack = imgPicture.ImageID;            var imgPictureTextBack = imgPicture.Text;            var lb_FileUploadBack = lb_FileUpload;            lfn_Search();                        ls_ImageSeq = ls_ImageSeqBack;            imgPicture.ImageID = imgPictureImageBack;            imgPicture.Text = imgPictureTextBack;            lb_FileUpload = lb_FileUploadBack;                    } else {            ls_TrainingPersonMgno = "";        }        var returnCurrRow = -1;        for (i=0; i<ds_oLicense.GetRowCount(); i++) {            if (substr(ds_oLicense.GetColumn(i, "LLCSNO"),6,3) == radCourse.Value + radIssueGubun.Value                && ds_oLicense.GetColumn(i, "LSTATUSGUBUN") == "Y"            ) {                gfn_Alert("이미 취득한 수첩입니다.");                return false;            }                        if (substr(ds_oLicense.GetColumn(i, "LLCSNO"),6,2) == "24"                && ds_oLicense.GetColumn(i, "LISSUEDATE") <= "20040930"                && ds_oLicense.GetColumn(i, "LSTATUSGUBUN") == "Y"            ) {                returnCheck = false; // 발급 가능                returnCurrRow = i;            }                    }        if (radCourse.Value == "28") {            if (returnCheck) {                gfn_Alert("[발급 불가]위험물 안전관리자 수첩이 없습니다."                    + "\n\n자격인정으로 수첩발급이 불가능합니다."                    + "\n\n(2004년 9월 30일 이전에 위험물안전관리자[24]를 취득한 자에"                    + "\n한하여 자격 인정으로 위험물운송자 자격증을 교부할 수 있습니다."                    + "\n위험물 안전관리자 수첩이 없으므로 자격인정으로 수첩발급이 불가능합니다.)"                );                return false;            } else {                gfn_Alert("[발급 가능] 위험물 안전관리자 수첩을 소지하고 있습니다."                    + "\n\n 수첩번호 : " + ds_oLicense.GetColumn(i, "LHLLCSNO")                    + "\n\n 발급일자 : " + left(ds_oLicense.GetColumn(i, "LISSUEDATE"), 4) + "-" + substr(ds_oLicense.GetColumn(i, "LISSUEDATE"), 4, 2) + "-" + right(ds_oLicense.GetColumn(i, "LISSUEDATE"), 2)                    + "\n\n 자격인정으로 수첩발급이 가능합니다."                );            }        }        } else {            if (ls_TpModifyCheck == "Y") {            gfn_Alert("접수자 정보가 새로 입력 되었습니다.\n\n'기본정보조회'를 해주시기 바랍니다.\n\n접수자 성명 및 주민번호 수정 시, '접수자정보변경'을 해주시기 바랍니다.");            return false;        }    }        if (radPrintGubun.Value != "01" && ds_oLicense.RowCount() < 1) {        gfn_Alert("신규 발급은 발급구분을 \"신규발급\"으로 선택해 주시기 바랍니다.");        return false;    }        if (!gfn_FormValidate(this)) { // 입력 Validation Check        return false;    }    if (radPrintGubun.Value == "01") { // 신규 저장        li_LicenseCurrentNo = 0;        if (!gfn_Confirm(radCourse.Text + " 수첩을 신규발급을 하시겠습니까?")) {            return false;        }                ds_iLicense.InsertRow(0);        ls_InsertCheck = "spcledu:insertLicense";    } else { // 수정, 재발급, 폐기        ls_TrainingPersonMgno = ds_oLicense.GetColumn(ds_oLicense.currow,"LTPMGNO");                if (ds_oLicense.GetColumn(ds_oLicense.currow, "LSTATUSGUBUN") == "N") {            gfn_Alert(radCourse.Text + " 수첩은 폐기된 수첩입니다.");            return false;        }                li_LicenseCurrentNo = ds_oLicense.currow;        if (ds_oLicense.GetColumn(ds_oLicense.currow,"LHPRTDATE") == left(getDate(),8)) {            gfn_Alert(radCourse.Text + " 수첩은 금일 이미 발급된 수첩입니다.");            return;        }            if (ls_AllModifyCheck == "Y") {            gfn_Alert("정보가 변경 되었습니다. '수첩정보 및 바코드 저장'을 해주십시오.");            return false;        }        if (!gfn_Confirm(radCourse.Text + " 수첩을 재발급 하시겠습니까?")) {            return false;        }                ds_iLicense.Copy(ds_oLicense);        nRow = ds_iLicense.currow;        ls_InsertCheck = "spcledu:updateLicense";    }        tit_clearActionInfo();    //사진 변경 및 추가    if(lb_FileUpload) { //파일 업로드일 경우            ls_UploadRealName = left(medResidentNo.Value,7)+ "_" + getDate() + right(timem(),3) + gfn_GetFileExtensionName(fdImageFile.FileName);        fiImageFile = fdImageFile.FilePath + "\\" + fdImageFile.FileName;        fiImageFile.Open("rb");        ds_ioImageInfo.InsertRow(0);        ds_ioImageInfo.SetColumn(0, "TPMGNO", ls_TrainingPersonMgno);        ds_ioImageInfo.SetColumn(0, "TPNM", edPersonNm.Text);        ds_ioImageInfo.SetColumn(0, "TPRESIDENTNO", medResidentNo.Value);        ds_ioImageInfo.SetColumn(0, "TPTEL", edTel.Text);        ds_ioImageInfo.SetColumn(0, "TPHPTEL", edHpTel.Text);        ds_ioImageInfo.SetColumn(0, "TPZIPCD", medZipCode.Value);        ds_ioImageInfo.SetColumn(0, "TPADDR1", edAddr1.Text);        ds_ioImageInfo.SetColumn(0, "TPADDR2", edAddr2.Text);        ds_ioImageInfo.SetColumn(0, "TPBULDNM", edCompNm.Text);        ds_ioImageInfo.SetColumn(0, "TPAUTHYN", ls_IsNiceCheckOk);        ds_ioImageInfo.SetColumn(0, "IIREGGUBUN", "L");        ds_ioImageInfo.SetColumn(0, "IIAPPROVAL", "Y");        ds_ioImageInfo.SetColumn(0, "IISAVENM", fdImageFile.FileName);        ds_ioImageInfo.SetColumn(0, "IIREALNM", ls_UploadRealName);        ds_ioImageInfo.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);        ds_ioImageInfo.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());        ds_ioImageInfo.SetColumn(0, "IIIMGSEQ", "0"); //이미지 새로 등록        tit_addSingleActionInfo("spcledu:insertImageInfo", "", 0, "");                ls_FileUploadCheck = "ds_iImageInfo=ds_ioImageInfo:U ";        fiImageFile.Close();    }    //수첩정보    if (radPrintGubun.Value == "01") {        ds_iLicense.SetColumn(nRow, "LLCSNO", left(getDate(),4)            + "-" + substr(gds_oUserInfo.GetColumn(0,"PDEPTCD"),1,2)            + "-" + radCourse.Value            + "-" + radIssueGubun.Value            + "-");    } else {        ds_iLicense.SetColumn(nRow, "LLCSNO", ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO"));    }    ds_iLicense.SetColumn(nRow, "LTPMGNO", ls_TrainingPersonMgno);    ds_iLicense.SetColumn(nRow, "LSTATUSGUBUN","Y");    ds_iLicense.SetColumn(nRow, "LISSUEGUBUN", radIssueGubun.Value); //취득구분    ds_iLicense.SetColumn(nRow, "LDATAAPPROVAL","N");    ds_iLicense.SetColumn(nRow, "LTCCOURSECD", radCourse.Value);    ds_iLicense.SetColumn(nRow, "LPERSONNM", edPersonNm.Text);    ds_iLicense.SetColumn(nRow, "LRESIDENTNO", medResidentNo.Value);    ds_iLicense.SetColumn(nRow, "LZIPCD", medZipCode.Value);    ds_iLicense.SetColumn(nRow, "LADDR1", edAddr1.Text);    ds_iLicense.SetColumn(nRow, "LADDR2", edAddr2.Text);    ds_iLicense.SetColumn(nRow, "LTEL", edTel.Text);    ds_iLicense.SetColumn(nRow, "LHPTEL", edHpTel.Text);    ds_iLicense.SetColumn(nRow, "LCOMPNM", edCompNm.Text);    ds_iLicense.SetColumn(nRow, "LTRAININGSTARTDATE", calEduDateStart1.Value);    ds_iLicense.SetColumn(nRow, "LTRAININGENDDATE", calEduDateEnd2.Value);    ds_iLicense.SetColumn(nRow, "LBARCODE", medBarCode.Text);    if(lb_FileUpload) {        ds_iLicense.SetColumn(nRow, "LHIIIMGSEQ", "0");    } else {        if(!gfn_isNull(ls_TrainingPersonMgno)) {            ds_iLicense.SetColumn(nRow, "LHIIIMGSEQ", ls_ImageSeq);        }    }        ds_iLicense.SetColumn(nRow, "LHPROCGTMGNO", gds_oUserInfo.GetColumn(0,"PDEPTCD"));    ds_iLicense.SetColumn(nRow, "TPCHECK", ls_TpModifyCheck);    if (radPrintGubun.Value == "01") {        ds_iLicense.SetColumn(nRow, "LHISSUEREASON", radIssueGubun.Text);        ds_iLicense.SetColumn(nRow, "LISSUEDATE", calIssueDate.Value); //최초발급일        ds_iLicense.SetColumn(nRow, "LHPRTDATE", calIssueDate.Value); //발급일자    } else {        ds_iLicense.SetColumn(nRow, "LHISSUEREASON", "재발급");        ds_iLicense.SetColumn(nRow, "LISSUEDATE", calFirstIssueDate.Value); //최초발급일        ds_iLicense.SetColumn(nRow, "LHPRTDATE", calIssueDate.Value); //발급일자    }    tit_addSingleActionInfo(ls_InsertCheck, "", 0, "");    // 서버 호출    tit_callService(        ""        ,""        ,ls_FileUploadCheck + "ds_iLicense=ds_iLicense:U" // inDs        ,""	// outDs        ,""	// args        ,"lfn_AfterSaveLicense"        ,false    );    if(lb_FileUpload) { //파일 업로드일 경우            tit_FileWrite(            hfImageFile            , ls_FileUploadPath            , fdImageFile.FilePath            , fdImageFile.FileName            , ls_UploadRealName            , "U"            , true        );                hfImageFile.CloseFile();    }        ds_oLicense.Copy(ds_iLicense);    ls_TpModifyCheck = "";    ls_AllModifyCheck = "";    //파일지우기    if (lb_FileDelete) {        ExecProc("cmd", ' /c "del ' + replace(gs_ScanFileName,'\\\\','\\') + '" ');        lb_FileDelete = false;    }    lfn_SaveModifyHistory(radPrintGubun.Value);}/* 공통 필수 종료 *//* 사용자 함수 *//* * 기능 : 직능별교육자접수 조회 후 처리해야 할 내용 * parameter : nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSearchLicense(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    gfn_SearchMessage(gdLcsInfo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.}/* * 기능 : Transaction 서비스 호출 후 처리해야 할 내용 * parameter : strSvcID - 서비스ID *             nErrorCode - 에러코드 *             strErrorMsg - 에러메시지 * Return : 없음 */function lfn_AfterSaveLicense(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        if (radPrintGubun.Value == "01") { //신규발급 일 때            ds_oLicense.DeleteRow(0);        }        return;    }        ds_oLicense.row = li_LicenseCurrentNo;        gfn_SaveMessage(); // 저장 메세지를 처리한다.    medLcsNo.Value = "";        lfn_TrainingPersonCheck(); //사람이 이미 있는지 검색한다.    if (ds_oTrainingPerson.GetRowCount() == 1) {        ls_TrainingPersonMgno = ds_oTrainingPerson.GetColumn(0, "TPMGNO");        lfn_Search();    } else {        ls_TrainingPersonMgno = "";    }    lb_FileUpload = false;}/* * 기능 : 버튼 활성/비활성시킨다. * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성) * return : 없음 */function lfn_SetFormAuth(bStatus) {    btnDelete.Enable = bStatus; // 수첩폐기 버튼    btnSave.Enable = bStatus; // 저장 버튼    btnPrint.Enable = bStatus; // 수첩출력 버튼    btnSaveInfo.Enable = bStatus; //내용 저장 버튼    btnSetlmt.Enable = bStatus; // 수납 버튼    btnPosResultList.Enable = bStatus;    btnChangeProcDate.Enable = bStatus;    btnProcRct.Enable = bStatus;    btnPrintReRct.Enable = bStatus;    btnTPModify.Enable = bStatus; // 접수자 정보 변경    btnPosReport.Enable = bStatus;//통합영수증조회 버튼}function lfn_Cancel(obj) {    gfn_FormInit(this);        ds_ioImageInfo.ClearData();    ds_iLicense.ClearData();    ds_oLicense.ClearData();    ds_oLicenseH.ClearData();    ds_oSetlmentHist.ClearData();    	imgLastestPicture.ImageID = "";	imgLastestPicture.Text = "최근사진";	imgPicture.ImageID = "";	imgPicture.Text = "사진";    if (radPrintGubun.Value != "01") {        medBarCode.Enable = true;    }        medLcsNo.Value = "";        lb_FileUpload = false;    ls_ImageSeq = "";    ls_LastImageSeq = "";    ls_RealFileName = "";    ls_TrainingPersonMgno = "";    ls_IsNiceCheckOk = "N";    ls_TpModifyCheck = "";    ls_AllModifyCheck = "";    lfn_ResidentCheck();    lbImgDate.Text = "";        calFirstIssueDate.Value = left(GetDate(),8);    calIssueDate.Value = left(GetDate(),8);}/** * 엑셀 출력 */function lfn_Excel(obj) {    if (ds_oLicense.GetRowCount() < 1) {        gfn_Alert("출력할 데이터가 존재하지 않습니다.");        return;    }}/* 사용자 이벤트 함수 */function btnMutilSort_OnClick(obj) {	gfn_GridMultiSort(gdLcsInfo, 0); // 멀티 정렬을 실행한다.}function ds_oLicense_OnRowPosChanged(obj,nOldRow,nRow) {    // 그리드의 값을 입력란에 복사한다. 추가상태인 경우 복사 후 저장을 하기 위해 제외한다.    if (obj.GetColumn(nRow, "LSTATUSGUBUN") == "N") {        gdLcsInfo.BkSelColor = "User37";    } else {        gdLcsInfo.BkSelColor = "User3";    }    if (obj.GetRowType(nRow) <> "insert" && nRow != -1) {        edPersonNm.Text = obj.GetColumn(nRow, "LPERSONNM");        medResidentNo.Text = obj.GetColumn(nRow, "LRESIDENTNO");        edTel.Text = obj.GetColumn(nRow, "LTEL");        edHpTel.Text = obj.GetColumn(nRow, "LHPTEL");        medZipCode.value = obj.GetColumn(nRow, "LZIPCD");        edAddr1.Text = obj.GetColumn(nRow, "LADDR1");        edAddr2.Text = obj.GetColumn(nRow, "LADDR2");        edCompNm.Text = obj.GetColumn(nRow, "LCOMPNM");        ls_IsNiceCheckOk = obj.GetColumn(nRow, "TPAUTHYN");        calFirstIssueDate.Value = left(GetDate(),8);        if (radPrintGubun.Value != "01") {            calEduDateStart1.Value = obj.GetColumn(nRow, "LTRAININGSTARTDATE");            calEduDateEnd2.Value = obj.GetColumn(nRow, "LTRAININGENDDATE");            calFirstIssueDate.Value = obj.GetColumn(nRow, "LISSUEDATE");            medLcsNo.Value = obj.GetColumn(nRow, "LLCSNO");            radCourse.Value = obj.GetColumn(nRow, "LTCCOURSECD");            radIssueGubun.Value = obj.GetColumn(nRow, "LISSUEGUBUN");        }                calIssueDate.Value = left(GetDate(),8);                medBarCode.Text = obj.GetColumn(nRow, "LBARCODE");        ls_TrainingPersonMgno = obj.GetColumn(nRow, "LTPMGNO");        ls_ImageSeq = obj.GetColumn(nRow, "LHIIIMGSEQ");        if (length(obj.GetColumn(nRow, "IIREALNM")) > 0) {            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"                + obj.GetColumn(nRow, "IIDIRPATH")                + "/" + obj.GetColumn(nRow, "IIREALNM");            imgPicture.Text = "";        } else {            imgPicture.ImageID = "";            imgPicture.Text = "사진";        }                gfn_MakeKeyMark(this); // 키값 수정 금지 설정                lb_FileUpload = false;                lfn_ResidentCheck();                lfn_SearchHistory(obj.getColumn(nRow, "LHLLCSNO"));        if(obj.GetColumn(nRow, "LISSUEGUBUN") <= "2" //강습수료 or 시험합격 경우            && obj.GetColumn(nRow, "LLASTHISTORYSEQ") == 1 // 신규일 경우            && left(obj.GetColumn(nRow, "LISSUEDATE"),6) <= "2009") { // 2009년 까지만            btnSetlmt.Enable = false;        } else {            btnSetlmt.Enable = true;        }	}	mb_IsNewData = false; // 저장버튼이 클릭 초기화	ls_TpModifyCheck = "";	ls_AllModifyCheck = "";}function ds_oLicenseH_OnRowPosChanged(obj,nOldRow,nRow) {	if (obj.GetRowType(nRow) <> "insert" && nRow != -1) {        lfn_SearchSettlement(obj.getColumn(nRow, "LHLLCSNO"), obj.getColumn(nRow, "LHSEQ"));	}}function edZipCode_OnFocus(obj) {    btnSearchZipCode.SetFocus();}function radCourse_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {	if (radCourse.Value = "28") {        ds_oIssueGubun.Filter("CD=='6'");        radIssueGubun.Value = "6";	} else {        ds_oIssueGubun.Filter("CD>='3' && CD<'6'");        radIssueGubun.Value = "3";	}}/** * 버튼 이벤트 */function btnSearchZipCode_OnClick(obj) {    var arrZipCode = gfn_ZipCodeListPopup(); // 우편번호 조회 팝업    if (length(arrZipCode) > 0) {        medZipCode.Value = arrZipCode[0];        edAddr1.Text = arrZipCode[1];        edAddr2.SetFocus();    }}function btnSearchLcsIssueHist_OnClick(obj) {    var sArg = "sLicenseNo=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO"));    return Dialog("spcledu::frmspcledu0251PLicenseIssueHist.xml", sArg, 800, 400, "", -1, -1);}function btnSearchPersonInfo_OnClick(obj) {    lfn_searchPersonNm();}/** * 키다운 이벤트 */function medLcsNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {    if (nChar == 13) {        var ls_lcs = split(medLcsNo.Text,"-");        medLcsNo.Text = left(medLcsNo.Text,13) + lpad(replace(ls_lcs[4],"_",""),"0",6);        lfn_search();    }    	gfn_EnterNextFocus(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam);}function medLcsNo_OnFocus(obj) {    var tmp = medLcsNo.Value;    lfn_Cancel(obj);    medLcsNo.Value = tmp;	gfn_ComponentOnFocus(obj);}function medBarCode_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {    if (nChar == 13) {        btnBarCodeSearch_OnClick(obj);    }    	gfn_EnterNextFocus(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam);}function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {    if (nChar == 13) {        lfn_searchPersonNm();    }        gfn_EnterNextFocus(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam);}function medResidentNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {    if (nChar == 13) {        lfn_searchPersonNm();        if (ls_IsNiceCheckOk <> "Y") {            btnAuthResidentNo_OnClick(obj);        }            }    gfn_EnterNextFocus(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam);}function edAddr1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam){    if (nChar == 13) {        btnSearchZipCode.SetFocus();        var arrZipCode = gfn_ZipCodeListPopup(edAddr1.Text); // 우편번호 조회 팝업        if (length(arrZipCode) > 0) {            medZipCode.Value = arrZipCode[0];            edAddr1.Text = arrZipCode[1];            edAddr2.SetFocus();        } else {            edAddr1.SetFocus();        }    }}/** * 변경 체크 */function lfn_TrainingPersonOnChanged(obj,strPreText,strPostText) {    ls_TpModifyCheck = "Y";    lfn_OnChanged();}function lfn_OnChanged() {    ls_AllModifyCheck = "Y";}/** * 신규/재발급 구분 */function radPrintGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {    lfn_cancel();    // 데이타셋 초기화    ds_ioImageInfo.ClearData();    ds_iLicense.ClearData();        imgLastestPicture.ImageID = "";    imgLastestPicture.Text = "최근사진";    imgPicture.ImageID = "";    imgPicture.Text = "사진";    li_LicenseCurrentNo = 0;	if (radPrintGubun.Value == "01") { //신규        ds_oIssueGubun.Filter("CD>='3' && CD<'6'");        ds_oCourse.Filter("CD<>'20'");        radIssueGubun.Value = "3";        calFirstIssueDate.Value = left(getDate(), 8);        calIssueDate.Value = left(getDate(), 8);        btnSearch.Enable = false;        btnBarCodeSearch.Enable = false;        medBarCode.Enable = false;        radCourse.Enable = true;        radIssueGubun.Enable = true;        btnSave.Value = "수첩 신규발급";        btnSaveInfo.Visible = false;        medLcsNo.Enable = false;        lbFirstIssueDate.Visible = false;        calFirstIssueDate.Visible = false;        lbEduDate.Visible = false;        calEduDateStart1.Visible = false;        lbDateWave.Visible = false;        calEduDateEnd2.Visible = false;        	} else { //재발급        ds_oIssueGubun.UnFilter();        ds_oCourse.UnFilter();        btnSearch.Enable = true;        btnBarCodeSearch.Enable = true;        medBarCode.Enable = true;        radCourse.Enable = false;        radIssueGubun.Enable = false;        btnSave.Value = "수첩 재발급";        btnSaveInfo.Visible = true;        medLcsNo.Enable = true;        lbFirstIssueDate.Visible = true;        calFirstIssueDate.Visible = true;        calFirstIssueDate.Value = "";        lbEduDate.Visible = true;        calEduDateStart1.Visible = true;        lbDateWave.Visible = true;        calEduDateEnd2.Visible = true;        if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정            lfn_SetFormAuth(true);        } else if (ms_FormAuth == "R") {            lfn_SetFormAuth(false);        }    }        edPersonNm.SetFocus();	}/** * 강습자 조회 & 사진 조회 */function lfn_searchPersonNm() {    var ls_PersonNm = edPersonNm.text;    var ls_ResidentNo = medResidentNo.Value;    var arrTrainingPerson = "";    ds_oTrainingPerson.ClearData(); // 데이타셋 초기화        arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medResidentNo.Value); // 고객 조회 팝업    lfn_cancel();    if (length(arrTrainingPerson) > 0) {        edAddr1.SetFocus();        edPersonNm.text = arrTrainingPerson[0];        medResidentNo.Value = arrTrainingPerson[1];        ls_TrainingPersonMgno = arrTrainingPerson[2];        edTel.Text = arrTrainingPerson[3];        edHpTel.Text = arrTrainingPerson[4];        ls_LastImageSeq = arrTrainingPerson[8];        ls_IsNiceCheckOk = arrTrainingPerson[9];        medZipCode.Value = arrTrainingPerson[12];        edAddr1.Text = arrTrainingPerson[13];        edAddr2.Text = arrTrainingPerson[14];        edCompNm.Text = arrTrainingPerson[15];        if (!gfn_IsNull(arrTrainingPerson[11])) {            imgLastestPicture.Text = "";            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems"                + arrTrainingPerson[10]                + "/" + arrTrainingPerson[11];            lbImgDate.Text = left(arrTrainingPerson[16], 10);        }                if (!gfn_IsNull(ls_TrainingPersonMgno)) {            lfn_Search();        }    } else {        edPersonNm.SetFocus();        edPersonNm.text = ls_PersonNm;        medResidentNo.Value = ls_ResidentNo;    }        if (radPrintGubun.Value == "01") {        calFirstIssueDate.Value = left(getDate(), 8);        calIssueDate.Value = left(getDate(), 8);    }        lfn_ResidentCheck();}/** * 등록사진목록 */function btnSearchRegPicture_OnClick(obj) {    if (length(edPersonNm.Text) < 1 && length(medResidentNo.Value) < 1) {        gfn_Alert("사진을 조회할 수 없습니다.");        return;    }    var sArg = "sPersonNm=" + quote(edPersonNm.Text)        + " sResidentNo=" + quote(medResidentNo.Value);    var arrImage = Dialog("spcledu::frmspcledu0255PTrainingPersonPicture.xml", sArg, 536, 440, "", -1, -1); // 고객 사진 조회        if (length(arrImage) > 0) {        ls_ImageSeq = arrImage[0];        imgPicture.Text = "";        imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"            + arrImage[1]            + "/" + arrImage[2];        ls_RealFileName = arrImage[2];        lb_FileUpload = false;        lfn_OnChanged();    }}/** * 사진관리 링크 */function btnPictureManagement_OnClick(obj) {	var ArrMenuInfo = gfn_SearchMenuInfo("training", "spcledu::frmspcledu9100MPictureManagement.xml");	//메뉴정보조회	if(length(ArrMenuInfo) > 0 ) {        var sArg = "sPersonNm=" + quote(edPersonNm.Text)            + " sResidentNo=" + quote(medResidentNo.Value);				gs_SystemGubun = arrMenuInfo[7];						//"cust";		gs_SystemMenuId = arrMenuInfo[5];						//"0000000254";		global.mnuLeft.tabMenu.tabpgMenu.Text = arrMenuInfo[6];	//"고객관리";		var ls_MenuId = arrMenuInfo[0];							//"0000000273";		var ls_MenuTitle = arrMenuInfo[1];						//"고객정보관리";		var ls_MenuUrl = arrMenuInfo[2];						//"cust::frmcust0010MCustomerManagement.xml";				global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);		gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sArg); 	} else {		gfn_Alert("해당 메뉴를 찾을 수 없습니다.");	}}/** * 스캔실행 */function btnScanPicture_OnClick(obj) {	ExecProc(gs_ScanProgramName);}/** * 스캔사진불러오기 */function btnLoadScanPicture_OnClick(obj) {	imgPicture.ImageID = "";	imgPicture.Text = "사진";	var ls_File = split(gs_ScanFileName,"\\");	    fdImageFile.FilePath = left(gs_ScanFileName,length(gs_ScanFileName)-length(ls_File[length(ls_file)-1]));	fdImageFile.FileName = ls_File[length(ls_file)-1];		fiImageFile.FileName = gs_ScanFileName;	if (fiImageFile.Open()) {        if (fiImageFile.GetLength() > 300*1024) {            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.");            fiImageFile.Close();            return false;        }        fiImageFile.Close();	} else {        gfn_Alert("스캔 이미지가 없습니다.");        return false;	}		imgPicture.ImageID = gs_ScanFileName;	imgPicture.Text = "";		lb_FileUpload = true;	lb_FileDelete = true;		lfn_OnChanged();}/** * 사진찾기 */function btnLoadPicture_OnClick(obj) {    fdImageFile.Type = "OPEN";        if (fdImageFile.open()) {                fiImageFile.FileName = fdImageFile.FilePath + "\\" + fdImageFile.FileName;        if (fiImageFile.GetLength() > 300*1024) {            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.");            fiImageFile.Close();            return false;        }        fiImageFile.Close();                imgPicture.ImageID = fdImageFile.FilePath + "\\" + fdImageFile.FileName;        imgPicture.Text = "";        lb_FileUpload = true;        lfn_OnChanged();    }    }/** * 최근사진 적용 */function btnApplyPicture_OnClick(obj) {	if (gfn_IsNull(imgLastestPicture.ImageID)) {        gfn_Alert("최근사진 등록을 먼저 해주십시오.");        return;	}		ls_ImageSeq = ls_LastImageSeq;		imgPicture.ImageID = imgLastestPicture.ImageID;	imgPicture.Text = "";	lb_FileUpload = false;	lfn_OnChanged();}/** * 수첩 출력 */function lfn_Print(obj) {    var ls_LicenseImageDir = "/PRTDATA/" + left(getDate(),4) + "/" + SubStr(getDate(),4,2);    if (ds_oLicense.GetRowCount()<1) {         gfn_Alert("수첩을 선택 해주십시오.");        return false;    }    if (ds_oLicense.GetColumn(ds_oLicense.currow, "LSTATUSGUBUN") == "N") {        gfn_Alert("폐기된 수첩입니다.");        return false;    }    if (ls_AllModifyCheck == "Y") {         gfn_Alert("정보가 변경 되었습니다. 저장을 해주십시오.");        return false;    }/*    if (ls_IsNiceCheckOk != "Y") {         gfn_Alert("실명인증이 되지 않았습니다.");        return false;    }*/    if (radPrintGubun.Value == "01" && ds_oLicense.GetColumn(ds_oLicense.currow, "LLASTHISTORYSEQ") > 1){        gfn_Alert("이미 신규 발급이 완료된 수첩입니다. 재발급을 해주시기 바랍니다.");        return;    }    if (ds_oLicense.GetColumn(ds_oLicense.currow, "LISSUEGUBUN") > "2") {        if ( ds_oSetlmentHist.GetColumn(0, "LSLHSEQ") != ds_oLicense.GetColumn(ds_oLicense.currow, "LLASTHISTORYSEQ")            || ds_oSetlmentHist.GetColumn(0, "LSGUBUNCD") != "01"            || ds_oSetlmentHist.GetColumn(0, "LSSETLMTYN") != "Y") {            gfn_Alert("결제 처리가 되지 않았습니다.");            return false;        }    }        if (!gfn_Confirm("수첩을 출력 하시겠습니까?")) {        return false;    }    ds_oLicenseReport.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();    tit_addSearchActionInfo("spcledu:searchLicenseReport", false);        var vArg = "";    var vArg2 = "";        if (ds_oLicenseH.GetRowCount() > 1) { //신규가 아닐 때        tit_addSearchActionInfo("spcledu:searchLicenseReportEdu", false);        vArg += " ds_oLicenseReportEdu=ds_oLicenseReportEdu";        vArg2 += "||ds_oLicenseReportEdu";    }        // 서버 호출    tit_callService(        ""        ,""        ,""	// inDs        ,"ds_oLicenseReport=ds_oLicenseReport"            + vArg	// outDs        ,"LLCSNO=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO"))            + " LRESIDENTNO=" + quote(ds_oLicense.getColumn(ds_oLicense.currow, "LRESIDENTNO"))            + " TCCOURSECD=" + quote(ds_oLicense.GetColumn(ds_oLicense.currow, "LTCCOURSECD")) // args        ,""        ,false        ,""        ,true    );    var ls_RexFile = "";    switch (ds_oLicense.GetColumn(ds_oLicense.currow, "LTCCOURSECD")) {        case 20: case 21: case 22:        ls_RexFile = "frmspcledu0250R01License.rex";        break;            case 24:        ls_RexFile = "frmspcledu0250R02License.rex";        break;            case 28:        ls_RexFile = "frmspcledu0250R03License.rex";        break;    }    gfn_PrintReport(ls_RexFile        , "ds_oLicenseReport" + vArg2        , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"        , ""        , "수첩"        , true    );    //수첩정보    ds_iLicenseImage.InsertRow(0);    ds_iLicenseImage.SetColumn(0, "LILLCSNO", ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO"));    ds_iLicenseImage.SetColumn(0, "LISEQ", ds_oLicense.GetColumn(ds_oLicense.currow, "LHSEQ"));    ds_iLicenseImage.SetColumn(0, "LIDIRPATH", ls_LicenseImageDir);    ds_iLicenseImage.SetColumn(0, "LIREALNM", ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO")        + "_" + ds_oLicense.GetColumn(ds_oLicense.currow, "LHSEQ") + ".jpg");    tit_clearActionInfo();    tit_addSingleActionInfo("spcledu:insertLicenseImage", "", 0, "");    // 서버 호출    tit_callService(        ""        ,""        ,"ds_iLicenseImage=ds_iLicenseImage:U" // inDs        ,""	// outDs        ,""	// args        ,""        ,false    );        var arr = tit_FileWrite(        hfImageFile        , ls_LicenseImageDir        , "C:\\"        , "LCS.jpg"        , ds_iLicenseImage.GetColumn(0, "LIREALNM")        , "U"        , false    );        hfImageFile.CloseFile();    if (arr[0] == "S") {        gfn_FooterMessage("수첩이미지 저장을 성공하였습니다.");        ExecProc("cmd", ' /c "del ' + replace("C:\\LCS.jpg",'\\\\','\\') + '" ');    } else {        gfn_FooterMessage("수첩이미지 저장을 실패하였습니다.");    }    }/** * 바코드 검색 */function btnBarCodeSearch_OnClick(obj) {	lb_BarcodeCheck = true;	lfn_Search(obj);    lb_BarcodeCheck = false;}/** * 실명인증 */function lfn_ResidentCheck() {	if (ls_IsNiceCheckOk == "Y") {        btnAuthResidentNo.Text = "실명인증완료";        btnAuthResidentNo.Enable = false;        edAddr1.SetFocus();    } else {        btnAuthResidentNo.Text = "실명인증";        btnAuthResidentNo.Enable = true;    }    }function btnAuthResidentNo_OnClick(obj) {	if (gfn_CheckNice(edPersonNm.Text, medResidentNo.Value)) {        ls_IsNiceCheckOk = "Y";        lfn_TrainingPersonCheck(); //사람이 이미 있는지 검색한다.        if (ds_oTrainingPerson.GetRowCount() == 1) {            ls_TrainingPersonMgno = ds_oTrainingPerson.GetColumn(0, "TPMGNO");            lfn_Search();        } else {            ls_TrainingPersonMgno = "";        }    } else {        ls_IsNiceCheckOk = "N";        medResidentNo.SetFocus();    }    lfn_ResidentCheck();	}/** * 이력 정보 조회 */function lfn_SearchHistory(sLicenseNo) {    ds_oLicenseH.ClearData(); // 데이타셋 초기화    tit_clearActionInfo();	tit_addCsvSearchActionInfo("spcledu:searchLicenseH", false);	// 서버 호출 	tit_callService(		""		,""		,""	// inDs		,"ds_oLicenseH=ds_oLicenseH"	// outDs		,"LHLLCSNO=" + quote(sLicenseNo)	// args 		,""		,false		,""		,true	);}/** * 결제 정보 조회 */function lfn_SearchSettlement(sLicenseNo, sSeq) {    // 데이타셋 초기화    ds_oSetlmentHist.ClearData();    tit_clearActionInfo();    tit_addCsvSearchActionInfo("spcledu:searchLicenseSettlement", false);        // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_oSetlmentHist=ds_oLicenseSettlement"	// outDs        ,"LSLLCSNO=" + quote(sLicenseNo)            + " LSLHSEQ=" + quote(sSeq)            + " LHTJMGNO=" + quote(ds_oLicenseH.GetColumn(ds_oLicenseH.currow, "LHTJMGNO"))// args         ,""        ,false        ,false        ,true    );        if (ds_oSetlmentHist.GetRowCount() > 0 && ms_FormAuth == "W") {        btnPosResultList.Enable = true;        btnChangeProcDate.Enable = true;        btnProcRct.Enable = true;        btnPrintReRct.Enable = true;    } else {        btnPosResultList.Enable = false;        btnChangeProcDate.Enable = false;        btnProcRct.Enable = false;        btnPrintReRct.Enable = false;    }    }/** * 결제 정보 순번 */function lfn_GetRowCount(nErrorCode, strErrorMsg) {    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.        gfn_ErrorMsg(nErrorCode, strErrorMsg);        return;    }    ln_SettlementRowCount = ds_oSetlmentHist.GetCount();}/** * 정보저장 */function lfn_InfoSave(obj) {    if (ds_oLicense.GetRowCount()<1) {        gfn_Alert("보유한 수첩이 없습니다.");        return false;    }    if (ls_TpModifyCheck == "Y") {        gfn_Alert("접수자 정보가 새로 입력 되었습니다.\n\n'기본정보조회'를 해주시기 바랍니다.\n\n접수자 성명 및 주민번호 수정 시, '접수자정보변경'을 해주시기 바랍니다.");        return false;    }    if (!gfn_Confirm("수첩정보 및 바코드 정보를 변경 하시겠습니까?")) {        return;    }    lfn_SaveModifyHistory("U");        var ls_FileUploadCheck = "";    var ls_UploadRealName = "";    li_LicenseCurrentNo = ds_oLicense.currow;        tit_clearActionInfo();    //사진 변경 및 추가    if(lb_FileUpload) { //파일 업로드일 경우            ls_UploadRealName = left(medResidentNo.Value,7)+ "_" + getDate() + right(timem(),3) + gfn_GetFileExtensionName(fdImageFile.FileName);        fiImageFile = fdImageFile.FilePath + "\\" + fdImageFile.FileName;        fiImageFile.Open("rb");        ds_ioImageInfo.InsertRow(0);        ds_ioImageInfo.SetColumn(0, "TPMGNO", ls_TrainingPersonMgno);        ds_ioImageInfo.SetColumn(0, "TPNM", edPersonNm.Text);        ds_ioImageInfo.SetColumn(0, "TPRESIDENTNO", medResidentNo.Value);        ds_ioImageInfo.SetColumn(0, "TPTEL", edTel.Text);        ds_ioImageInfo.SetColumn(0, "TPHPTEL", edHpTel.Text);        ds_ioImageInfo.SetColumn(0, "TPZIPCD", medZipCode.Value);        ds_ioImageInfo.SetColumn(0, "TPADDR1", edAddr1.Text);        ds_ioImageInfo.SetColumn(0, "TPADDR2", edAddr2.Text);        ds_ioImageInfo.SetColumn(0, "TPBULDNM", edCompNm.Text);        ds_ioImageInfo.SetColumn(0, "TPAUTHYN", ls_IsNiceCheckOk);        ds_ioImageInfo.SetColumn(0, "IIREGGUBUN", "L");        ds_ioImageInfo.SetColumn(0, "IIAPPROVAL", "Y");        ds_ioImageInfo.SetColumn(0, "IISAVENM", fdImageFile.FileName);        ds_ioImageInfo.SetColumn(0, "IIREALNM", ls_UploadRealName);        ds_ioImageInfo.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());        ds_ioImageInfo.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);        ds_ioImageInfo.SetColumn(0, "IIIMGSEQ", "0"); //이미지 새로 등록        tit_addSingleActionInfo("spcledu:insertImageInfo", "", 0, "");                ls_FileUploadCheck = "ds_iImageInfo=ds_ioImageInfo:U ";        fiImageFile.Close();    }    if(lb_FileUpload) {        ds_oLicense.SetColumn(ds_oLicense.currow, "LHIIIMGSEQ", "0");    } else {        ds_oLicense.SetColumn(ds_oLicense.currow, "LHIIIMGSEQ", ls_ImageSeq);    }    	ds_oLicense.SetColumn(ds_oLicense.currow, "LPERSONNM", edPersonNm.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LRESIDENTNO", medResidentNo.Value);	ds_oLicense.SetColumn(ds_oLicense.currow, "LZIPCD", medZipCode.Value);	ds_oLicense.SetColumn(ds_oLicense.currow, "LADDR1", edAddr1.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LADDR2", edAddr2.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LTEL", edTel.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LHPTEL", edHpTel.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LCOMPNM", edCompNm.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LBARCODE", medBarCode.Text);	ds_oLicense.SetColumn(ds_oLicense.currow, "LLCSNO", medLcsNo.Text);            tit_addSingleActionInfo("spcledu:updateLicenseInfo", "", 0, "");    tit_callService(        ""        ,""        ,ls_FileUploadCheck + "ds_iLicenseInfo=ds_oLicense:U"	// inDs        ,""	// outDs        ,""	// args        ,"lfn_AfterSaveLicense"        ,false    );        ls_TpModifyCheck = "";    ls_AllModifyCheck = "";        if(lb_FileUpload) { //파일 업로드일 경우        tit_FileWrite(            hfImageFile            , ls_FileUploadPath            , fdImageFile.FilePath            , fdImageFile.FileName            , ls_UploadRealName            , "U"            , true        );                hfImageFile.CloseFile();    }    }/** * 결제POS */function btnSetlmt_OnClick(obj) {    if (ds_oLicense.GetRowCount()<1) {        gfn_Alert("수첩을 선택 해주십시오.");        return false;    }    if (ds_oSetlmentHist.GetColumn(0, "LSGUBUNCD") == "02" && ds_oLicense.GetColumn(ds_oLicense.currow, "LSTATUSGUBUN") == "N") {        gfn_Alert("폐기된 수첩입니다.");        return false;    }    if (!gfn_IsNull(ds_oLicenseH.GetColumn(ds_oLicenseH.currow, "LHTJMGNO"))) {        gfn_Alert("선수납 결제이므로 [강습접수관리]에서 처리하여 주시기 바랍니다.");        return false;    }    if (ds_oSetlmentHist.GetColumn(0, "LSGUBUNCD") == "01" && ds_oLicenseH.GetColumn(ds_oLicenseH.currow, "LHISSUEMGNO") > "0") {        gfn_Alert("인터넷 결제이므로 환불이 불가능합니다.\n\n'[인터넷]수첩발급관리'에서 환불하시기 바랍니다.");        return false;    }    var ls_ProcAmount = "10000"; // 처리금액    var ls_PosYear = ""; // 영수증년도    var ls_PosMgno = ""; // 영수증관리번호    var ls_RepayPayment = ""; // 환불용 수납 결제방법(납부방법 현금0, 신용카드1, 현금영수증2, 가상계좌3)    var ls_RepayAmount = ""; // 환불 금액    var ls_Key1 = ds_oLicense.GetColumn(ds_oLicense.currow, "LHLLCSNO"); // KEY값1    var ls_Key2 = ds_oLicense.GetColumn(ds_oLicense.currow, "LLASTHISTORYSEQ"); // KEY값2    var ls_Lsseq = "";    var ls_SunapGubun = "0";    if (ls_Key2 == ds_oSetlmentHist.GetColumn(0, "LSLHSEQ")        && ds_oSetlmentHist.GetColumn(0, "LSGUBUNCD") == "01") { //이미 수납이 있을 때        ls_PosYear = ds_oSetlmentHist.GetColumn(0, "LSPMYEAR");        ls_PosMgno = ds_oSetlmentHist.GetColumn(0, "LSPMMGNO");        ls_RepayPayment = ds_oSetlmentHist.GetColumn(0, "PMPAYMENTFLAG");        ls_RepayAmount = toNumber(ds_oSetlmentHist.GetColumn(0, "LSPROCAMOUNT")) * (-1);        ls_Lsseq = ds_oSetlmentHist.GetColumn(0, "LSSEQ");        ls_SunapGubun = "1"; //환불    } else {        ls_SunapGubun = "0"; //수납    }    // 통합영수증발급(POS)시스템 팝업을 호출한다.    var arrPos = gfn_POSPopup("23", ls_SunapGubun, ls_ProcAmount, ls_PosYear, ls_PosMgno, ls_Key1, ls_Key2, edHpTel.Text, ls_RepayPayment, ls_RepayAmount, ls_Lsseq);    lfn_SearchSettlement(ls_Key1, ls_Key2);}/** * 처리일자 변경 */function btnSeqList_OnClick(obj) {    if (ds_oSetlmentHist.GetRowCount()<1) {        gfn_Alert("결제를 선택 해주십시오.");        return false;    }    tit_clearActionInfo();	tit_addCsvSearchActionInfo("com:searchYearbizlink", 0);    tit_callService(        ""        ,""        ,""	// inDs        ,"ds_oYearbizlink=ds_oYearbizlink"	// outDs        ,"PMPCORDERNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSJUMUNNO"))            + " LRESIDENTNO=" + quote(medResidentNo.Value)            + " LLCSNO=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSLLCSNO"))// args        ,""        ,false        ,""        ,true    );    if (ds_oYearbizlink.GetRowCount() >= 1) {        var msg = "           <수수료관리번호 및 수납일자 변경 불가>             \n";        msg += "\n\n";        msg += "해당 자료는 회계시스템에서 시스템연동을 통해 결의서를\n";        msg += "생성하였습니다. 생성정보는 아래와 같습니다.\n";        msg += "\n\n";        msg += "         - 결의서 번호 : "+ds_oYearbizlink.GetColumn(0,"KEYNO")+"\n";        msg += "\n";        msg += "         - 성          명 : "+ds_oYearbizlink.GetColumn(0,"YBLNM")+"\n";        msg += "\n";        msg += "         - 금          액 : "+NumFormat(ds_oYearbizlink.GetColumn(0,"YBLAMT"))+"\n";        msg += "\n";        msg += "         - 처 리  일 자 : "+left(ds_oYearbizlink.GetColumn(0,"YBLPROCDATE"),4)            + "-" + substr(ds_oYearbizlink.GetColumn(0,"YBLPROCDATE"),4,2)            + "-" + right(ds_oYearbizlink.GetColumn(0,"YBLPROCDATE"),2) + "\n";        msg += "\n\n";        msg += "해당 자료를 변경하고자 하는 경우,\n";        msg += "위의 결의서의 삭제를 회계담당에게 요청하세요.\n";        msg += "회계시스템에 결의서를 삭제한 후 해당 자료를 변경할 수 있습니다.\n";        gfn_Alert(msg);        return false;	}	    var sArg = "sLicenseNo=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSLLCSNO"))        + " sHistorySeq=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSLHSEQ"))        + " sSetlmtSeq=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSSEQ"))        + " sProcDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPROCDATE"))        + " sPonyDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPONYDATE"))        + " sGubun=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSGUBUN"))        + " sPmYear=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMYEAR"))        + " sPmMgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMMGNO"));	var procCheck = Dialog("spcledu::frmspcledu0256PLicenseProcessDate.xml", sArg, 276, 108, "", -1, -1);		if (procCheck) {        lfn_SearchSettlement(ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO")            , ds_oLicense.GetColumn(ds_oLicense.currow, "LLASTHISTORYSEQ"));	}	}/** *결제처리결과조회 */function btnPosResultList_OnClick(obj) {    if (ds_oSetlmentHist.GetRowCount() < 1) {        gfn_Alert("결과를 조회할 결제를 선택 해주십시오.");        return false;    }        // 안전원와 LGD 결과 내용 조회	var ls_Regfn_Check = gfn_CheckPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMYEAR")                        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMMGNO"));}/** * 영수증 재발행 */function btnPrintReRct_OnClick(obj) {    if (ds_oSetlmentHist.GetRowCount() < 1) {        gfn_Alert("영수증을 발행할 결제를 선택 해주십시오.");        return false;    }    var ls_Gubun = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSGUBUNCDNM");    var msg = "            --------------------------                 \n";    msg += "                "+ls_Gubun+" 영수증 재발급                      \n";    msg += "            --------------------------                 \n";    msg += "\n\n";    msg += "     =========================================         \n";    msg += "\n";    msg += "         성    명 : " + ds_oLicense.GetColumn(ds_oLicense.currow, "LPERSONNM") + "\n";    msg += "\n";    msg += "         주민번호 : " + left(ds_oLicense.GetColumn(ds_oLicense.currow, "LRESIDENTNO"),6)+"-"+right(ds_oLicense.GetColumn(ds_oLicense.currow, "LRESIDENTNO"),7) + "\n";    msg += "\n";    msg += "         주문번호 : " + ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSJUMUNNO") + "\n";    msg += "\n";    msg += "         결재구분 : " + ls_Gubun + "\n";    msg += "\n";    msg += "         "+ls_Gubun+"일자 : " + ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPROCDATE") + "\n";    msg += "\n";    msg += "         "+ls_Gubun+"금액 : 10,000\n";    msg += "\n";    msg += "     =========================================         \n";    msg += "\n";    msg += "     위와 같은 내용으로 영수증을 재발급 하시겠습니까?  \n";    msg += "\n";    if (!gfn_Confirm(msg)) {        return false;	}    gfn_PrintReceipt(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMYEAR")        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMMGNO")); // 영수증을 출력한다.}/** * 현금영수증 처리/취소 */function btnProcRct_OnClick(obj) {	    if (ds_oSetlmentHist.GetRowCount()<1) {        gfn_Alert("결제를 선택 해주십시오.");        return false;    }    if (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSGUBUNCD") == "02"        || ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSREPAYREF") > 0        ) {        gfn_Alert("환불된 결제입니다.");        return false;    }    if (left(GetDate(), 8) >= left(AddDate(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPROCDATE"), 365), 8)) {        gfn_Alert("결제일로부터 1년이 지났습니다.");        return false;    }    var ls_Key1 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSLLCSNO");    var ls_Key2 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSLHSEQ");    var ls_Key3 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSSEQ");    var ls_RepayPosYear = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMYEAR"); // POS년도    var ls_RepayPosMgno = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "LSPMMGNO"); // POS관리번호    var ls_RepayPayment = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG"); // 결과출력용 납입방법(0,1,2,3)    // 통합영수증발급(POS)시스템 현금영수증처리 팝업을 호출한다.    var arrPos = gfn_TrainingCashChangePOSPopup("23", ls_Key1, ls_Key2, ls_RepayPosYear, ls_RepayPosMgno, ls_RepayPayment);    lfn_SearchSettlement(ls_Key1, ls_Key2);}/** * 강습자 검색 */function lfn_TrainingPersonCheck(){  //사람이 이미 있는지 검색한다.    tit_clearActionInfo();    tit_addCsvSearchActionInfo("com:searchTrainingPerson", false);    // 서버 호출     tit_callService(        ""        ,""        ,""	// inDs        ,"ds_oTrainingPerson=ds_oTrainingPerson"	// outDs        ,"TPNM=" + quote(edPersonNm.Text)            + " TPRESIDENTNO=" + quote(medResidentNo.Value) // args        ,""        ,false        ,""        ,true    );        if (!gfn_IsNull(ds_oTrainingPerson.GetColumn(0, "IIREALNM"))) {        imgLastestPicture.Text = "";        imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems"            + ds_oTrainingPerson.GetColumn(0, "IIDIRPATH")            + "/" + ds_oTrainingPerson.GetColumn(0, "IIREALNM");    };}/** * 이력 수첩 이미지 보기 */function btnLcsImage_OnClick(obj) {    gfn_ImageViewPopup(        ds_oLicenseH.GetColumn(ds_oLicenseH.currow,"LIDIRPATH")        , ds_oLicenseH.GetColumn(ds_oLicenseH.currow,"LIREALNM")        , ds_oLicenseH.GetColumn(ds_oLicenseH.currow,"LHLLCSNO")    );}/** * 변경이력 저장 */function lfn_SaveModifyHistory(sGubun) {    gds_iModifyHistory.ClearData();        if (sGubun == "01") {            gds_iModifyHistory.InsertRow(0);        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "수첩발급정보관리"); // 업무구분        gds_iModifyHistory.SetColumn(0, "MHGUBUN", "I"); // 변경구분        gds_iModifyHistory.SetColumn(0, "MHKEY", ms_TrainingPersonMgno); // KEY값        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "신규발급"); // 변경 컬럼명        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값            } else if (sGubun == "02") {            gds_iModifyHistory.InsertRow(0);        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "수첩발급정보관리"); // 업무구분        gds_iModifyHistory.SetColumn(0, "MHGUBUN", "I"); // 변경구분        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO")); // KEY값        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "재발급"); // 변경 컬럼명        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값            } else if (sGubun == "U") {            var ls_HColumn = array(9);        var ls_HBefore = array(9);        var ls_HAfter = array(9);        ls_HColumn[0] = "LPERSONNM";        ls_HColumn[1] = "LRESIDENTNO";	    ls_HColumn[2] = "LZIPCD";	    ls_HColumn[3] = "LADDR1";	    ls_HColumn[4] = "LADDR2";	    ls_HColumn[5] = "LTEL";	    ls_HColumn[6] = "LHPTEL";	    ls_HColumn[7] = "LCOMPNM";	    ls_HColumn[8] = "LBARCODE";        ls_HBefore[0] = ds_oLicense.GetColumn(ds_oLicense.currow, "LPERSONNM");        ls_HBefore[1] = ds_oLicense.GetColumn(ds_oLicense.currow, "LRESIDENTNO");	    ls_HBefore[2] = ds_oLicense.GetColumn(ds_oLicense.currow, "LZIPCD");	    ls_HBefore[3] = ds_oLicense.GetColumn(ds_oLicense.currow, "LADDR1");	    ls_HBefore[4] = ds_oLicense.GetColumn(ds_oLicense.currow, "LADDR2");	    ls_HBefore[5] = ds_oLicense.GetColumn(ds_oLicense.currow, "LTEL");	    ls_HBefore[6] = ds_oLicense.GetColumn(ds_oLicense.currow, "LHPTEL");	    ls_HBefore[7] = ds_oLicense.GetColumn(ds_oLicense.currow, "LCOMPNM");	    ls_HBefore[8] = ds_oLicense.GetColumn(ds_oLicense.currow, "LBARCODE");	    ls_HAfter[0] = edPersonNm.Text;        ls_HAfter[1] = medResidentNo.Value;	    ls_HAfter[2] = medZipCode.Value;	    ls_HAfter[3] = edAddr1.Text;	    ls_HAfter[4] = edAddr2.Text;	    ls_HAfter[5] = edTel.Text;	    ls_HAfter[6] = edHpTel.Text;	    ls_HAfter[7] = edCompNm.Text;	    ls_HAfter[8] = medBarCode.Text;        for (var i=0; i<=length(ls_HColumn); i++) {            if (ls_HBefore[i] <> ls_HAfter[i]) {                gds_iModifyHistory.InsertRow(0);                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "수첩발급정보관리"); // 업무구분                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oLicense.getColumn(ds_oLicense.currow, "LHLLCSNO")); // KEY값                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_HColumn[i]); // 변경 컬럼명                gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_HBefore[i]); // 변경 전 값                gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ls_HAfter[i]); // 변경 후 값            }        }    }	    gfn_InsertModifyHistory();    }/** * 접수자 정보 변경 */function btnTPModify_OnClick(obj) {    if (gfn_IsNull(edPersonNm.Text) || gfn_IsNull(medResidentNo.Value)) {        gfn_Alert("성명 및 주민번호가 비어있습니다.\n'기본정보조회' 후에 사용하여 주시기 바랍니다.");        edPersonNm.SetFocus();        return;    }    if (gfn_IsNull(ls_TrainingPersonMgno)) {        lfn_TrainingPersonCheck(); //사람이 이미 있는지 검색한다.            if (ds_oTrainingPerson.GetRowCount() == 1) {            ls_TrainingPersonMgno = ds_oTrainingPerson.GetColumn(0, "TPMGNO");        } else {            ls_TrainingPersonMgno = "";            gfn_Alert("신규 접수자 입니다.");            return;        }    }    var retArr = gfn_TrainingPersonModifyPopup(ls_TrainingPersonMgno, "L");    if (length(retArr[0]) < 1) {        return;    }        if (ds_oLicense.GetColumn(ds_oLicense.currow, "LPERSONNM") != retArr[0]        || ds_oLicense.GetColumn(ds_oLicense.currow, "LRESIDENTNO") != retArr[1]        || ds_oLicense.GetColumn(ds_oLicense.currow, "LTPMGNO") != retArr[2]    ) {        tit_clearActionInfo();                if (ds_oLicense.GetColumn(ds_oLicense.currow, "LTPMGNO") != retArr[2]) { //강습자가 변경된 경우            ds_oLicense.SetColumn(ds_oLicense.currow, "LPERSONNM", retArr[0]);            ds_oLicense.SetColumn(ds_oLicense.currow, "LRESIDENTNO", retArr[1]);            ds_oLicense.SetColumn(ds_oLicense.currow, "LTPMGNO", retArr[2]);                        tit_addSingleActionInfo("spcledu:updateLicenseTrainingPersonNew", "", 0, "");                } else {            for (var i=0; i<ds_oLicense.GetRowCount(); i++) {                ds_oLicense.SetColumn(i, "LPERSONNM", retArr[0]);                ds_oLicense.SetColumn(i, "LRESIDENTNO", retArr[1]);            }                        tit_addMultiActionInfo("spcledu:updateLicenseTrainingPerson", "", 0, "", "N");        }        tit_callService(            ""            ,""            ,"ds_iLicense=ds_oLicense:U"	// inDs            ,""	// outDs            ,"" // args            ,""            ,false            ,false            ,true        );                edPersonNm.Text = retArr[0];        medResidentNo.Value = retArr[1];        ls_TrainingPersonMgno = retArr[2];        ls_IsNiceCheckOk = retArr[3];        medLcsNo.Value = "";        lb_BarcodeCheck = false;        lfn_Search();        lfn_ResidentCheck();    }}// 통합영수증조회 팝업function btnPosReport_OnClick(obj){    var sArg = "sProgramId=" + quote(gds_oUserInfo.GetColumn(0, "PDEPTCD"));    var retDlg = Dialog("posetc::frmposetc0020PPosReport.xml", sArg, 480, 320, "", -1, -1);	}]]></Script></Window>
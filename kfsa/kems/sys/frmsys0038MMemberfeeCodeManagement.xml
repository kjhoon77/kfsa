<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="590" Id="frmsys0038MMemberfeeCodeManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="(2차)회비코드관리" Top="8" Ver="1.0" Width="800" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioMemberfeeCode" OnRowPosChanged="ds_ioMemberfeeCode_OnRowPosChanged">
				<Contents>
					<colinfo id="CREATE_DATE" size="7" summ="default" type="DATE"/>
					<colinfo id="CREATE_ID" size="20" summ="default" type="STRING"/>
					<colinfo id="MFCOURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="MFCOURSESEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="MFMONTH01" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH02" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH03" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH04" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH05" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH06" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH07" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH08" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH09" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH10" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH11" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFMONTH12" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MFPAYMENTGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="MFREMARK" size="1000" summ="default" type="STRING"/>
					<colinfo id="MFYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="MODIFY_DATE" size="7" summ="default" type="DATE"/>
					<colinfo id="MODIFY_ID" size="20" summ="default" type="STRING"/>
					<colinfo id="TOT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="USE_YN" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oPaymentMethod">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMemberfeeGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="204" Height="148" Id="shpGubunBox" Left="4" LineColor="user15" Right="796" TabOrder="53" Top="56" Type="Rectangle" Width="792"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="30" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="300">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_ioMemberfeeCode" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="584" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="352" Id="gdMemberfeeCode" InputPanel="FALSE" Left="4" LineColor="default" OnCellClick="gdMemberfeeCode_OnCellClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="796" RowHeight="20" Style="sty_Grid" TabOrder="29" TabStop="true" Top="232" UseDBuff="true" UsePopupMenu="true" UserData="회비코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">
			<contents>
				<format id="Default">
					<columns>
						<col width="70"/>
						<col width="80"/>
						<col width="65"/>
						<col width="150"/>
						<col width="65"/>
						<col width="65"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="150"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="사용유무"/>
						<cell align="center" col="1" display="text" text="년도(회비)"/>
						<cell align="center" col="2" display="text" text="구분코드"/>
						<cell align="center" col="3" display="text" text="직능"/>
						<cell align="center" col="4" display="text" text="일련번호"/>
						<cell align="center" col="5" display="text" text="납입방식"/>
						<cell align="center" col="6" display="text" text="총액"/>
						<cell align="center" col="7" display="text" text="금액01"/>
						<cell align="center" col="8" display="text" text="금액02"/>
						<cell align="center" col="9" display="text" text="금액03"/>
						<cell align="center" col="10" display="text" text="금액04"/>
						<cell align="center" col="11" display="text" text="금액05"/>
						<cell align="center" col="12" display="text" text="금액06"/>
						<cell align="center" col="13" display="text" text="금액07"/>
						<cell align="center" col="14" display="text" text="금액08"/>
						<cell align="center" col="15" display="text" text="금액09"/>
						<cell align="center" col="16" display="text" text="금액10"/>
						<cell align="center" col="17" display="text" text="금액11"/>
						<cell align="center" col="18" display="text" text="금액12"/>
						<cell align="center" col="19" display="text" text="등록일자"/>
						<cell align="center" col="20" display="text" text="등록사번"/>
						<cell align="center" col="21" display="text" text="수정일자"/>
						<cell align="center" col="22" display="text" text="수정사번"/>
						<cell align="center" col="23" display="text" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" colid="USE_YN" display="checkbox" expr="iif(USE_YN&#32;=&#32;&apos;Y&apos;,&#32;&apos;1&apos;,&#32;&apos;0&apos;)"/>
						<cell align="center" col="1" colid="MFYEAR" display="text"/>
						<cell align="center" col="2" colid="MFEGUBUN" combocol="CD" combodataset="ds_oMemberfeeGubun" combotext="DATA" display="combo"/>
						<cell align="left" col="3" colid="MFCOURSECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>
						<cell align="center" col="4" colid="MFCOURSESEQ" display="number"/>
						<cell align="center" col="5" colid="MFPAYMENTGUBUN" combocol="CD" combodataset="ds_oPaymentMethod" combotext="DATA" display="combo"/>
						<cell align="right" col="6" colid="TOT" display="number"/>
						<cell align="right" col="7" colid="MFMONTH01" display="number"/>
						<cell align="right" col="8" colid="MFMONTH02" display="number"/>
						<cell align="right" col="9" colid="MFMONTH03" display="number"/>
						<cell align="right" col="10" colid="MFMONTH04" display="number"/>
						<cell align="right" col="11" colid="MFMONTH05" display="number"/>
						<cell align="right" col="12" colid="MFMONTH06" display="number"/>
						<cell align="right" col="13" colid="MFMONTH07" display="number"/>
						<cell align="right" col="14" colid="MFMONTH08" display="number"/>
						<cell align="right" col="15" colid="MFMONTH09" display="number"/>
						<cell align="right" col="16" colid="MFMONTH10" display="number"/>
						<cell align="right" col="17" colid="MFMONTH11" display="number"/>
						<cell align="right" col="18" colid="MFMONTH12" display="number"/>
						<cell align="center" col="19" colid="CREATE_DATE" display="text"/>
						<cell align="center" col="20" colid="CREATE_ID" display="text"/>
						<cell align="center" col="21" colid="MODIFY_DATE" display="text"/>
						<cell align="center" col="22" colid="MODIFY_ID" display="text"/>
						<cell align="left" col="23" colid="MFREMARK" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbMemberfeeYear" Left="216" Style="sty_Label" TabOrder="31" Text="년도" Top="84" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbRemark" Left="8" Style="sty_Label" TabOrder="32" Text="비고" Top="180" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbPaymentMethod" Left="8" Style="sty_Label" TabOrder="33" Text="납입방식" Top="108" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="722" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="28" Top="208" Transparent="TRUE" Width="74"></Button>
		<Static Align="Center" Height="20" Id="lbMemberfeeGubun" Left="8" Style="sty_Label" TabOrder="34" Text="구분" Top="84" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbCourse" Left="344" Style="sty_Label" TabOrder="35" Text="직능" Top="84" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbMemberfeeSeq" Style="sty_Label" TabOrder="36" Text="일련번호" Top="596" VAlign="Middle" Visible="FALSE" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medMemberfeeSeq" Left="92" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="14" Top="596" Visible="FALSE" Width="88"></MaskEdit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edRemark" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="27" Top="180" UserData="S" Width="692"></Edit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt01" Left="139" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="15" Top="132" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt02" Left="255" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="16" Top="132" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt03" Left="371" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="17" Top="132" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt04" Left="487" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="18" Top="132" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt07" Left="139" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="21" Top="156" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt08" Left="255" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="22" Top="156" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt09" Left="371" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="23" Top="156" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt10" Left="487" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="24" Top="156" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt11" Left="604" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="25" Top="156" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt12" Left="721" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="26" Top="156" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt05" Left="604" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="19" Top="132" UserData="S:금액" Width="70"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medAmt06" Left="721" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medPaymentFee_OnkillFocus" Style="sty_Maskedit" TabOrder="20" Top="132" UserData="S:금액" Width="70"></MaskEdit>
		<Static Align="Center" Height="20" Id="lbPaymentAmt" Left="8" Style="sty_Label" TabOrder="37" Text="납입금액" Top="132" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbAmt09" Left="332" Style="sty_Label" TabOrder="38" Text="09" Top="156" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt08" Left="216" Style="sty_Label" TabOrder="39" Text="08" Top="156" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt02" Left="216" Style="sty_Label" TabOrder="40" Text="02" Top="132" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt03" Left="332" Style="sty_Label" TabOrder="41" Text="03" Top="132" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt04" Left="448" Style="sty_Label" TabOrder="42" Text="04" Top="132" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt10" Left="448" Style="sty_Label" TabOrder="43" Text="10" Top="156" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt11" Left="565" Style="sty_Label" TabOrder="44" Text="11" Top="156" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt12" Left="682" Style="sty_Label" TabOrder="45" Text="12" Top="156" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt05" Left="565" Style="sty_Label" TabOrder="46" Text="05" Top="132" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt06" Left="682" Style="sty_Label" TabOrder="47" Text="06" Top="132" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt07" Left="100" Style="sty_Label" TabOrder="48" Text="07" Top="156" VAlign="Middle" Width="35"></Static>
		<Static Align="Center" Height="20" Id="lbAmt01" Left="100" Style="sty_Label" TabOrder="49" Text="01" Top="132" VAlign="Middle" Width="35"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMemberfeeGubun" INDEX="0" InnerDataset="ds_oMemberfeeGubun" Left="99" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="10" Top="83" UserData="S:구분:K" Width="112"></Combo>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxCourse" INDEX="0" InnerDataset="ds_oCourse" Left="435" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="12" Top="83" UserData="S:직능:K" Width="182"></Combo>
		<Radio Border="None" CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radPaymentMethod" INDEX="0" InnerDataset="ds_oPaymentMethod" Left="100" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="13" Top="108" Value="12" Width="300"></Radio>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edMemberfeeYear" ImeMode="native" Left="308" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="11" Top="84" UserData="S:년도:K" Width="32"></Edit>
		<Static Align="Center" Height="20" Id="lbUseYn" Left="8" Style="sty_Label" TabOrder="50" Text="사용유무" Top="60" VAlign="Middle" Width="88"></Static>
		<Checkbox FalseValue="N" Height="20" Id="chkUseYn" Left="100" OnKeyDown="gfn_EnterNextFocus" Style="sty_Checkbox" TabOrder="9" Text="사용유무" Top="60" TrueValue="Y" Width="88"></Checkbox>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Height="20" Id="medPaymentFee" Left="8" NullValue="0" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_MaskeditReadOnly" TabOrder="51" Top="156" UserData="S:금액" Width="86"></MaskEdit>
		<Shape Bottom="53" Height="52" Id="shpBtnBox" Left="443" LineColor="user14" Right="796" TabOrder="52" Top="1" Type="Rectangle" Width="353"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="446" OnClick="lfn_Search" Style="sty_Button" TabOrder="5" ToolTipText="조회" Top="28" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnInput" ImageID="BTN_COM_ADD" Left="534" OnClick="lfn_Input" Style="sty_Button" TabOrder="6" ToolTipText="추가&#32;저장" Top="28" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="708" OnClick="lfn_Delete" Style="sty_Button" TabOrder="8" ToolTipText="삭제&#32;저장" Top="28" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="621" OnClick="lfn_Save" Style="sty_Button" TabOrder="7" ToolTipText="수정&#32;저장" Top="28" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="446" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="1" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="534" OnClick="lfn_Excel" Style="sty_Button" TabOrder="2" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="621" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="3" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="708" OnClick="lfn_End" Style="sty_Button" TabOrder="4" ToolTipText="닫기" Top="4" Width="85"></Button>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmsys0038MMemberfeeCodeManagement.xml
 * 설명 : 회비코드관리
 * 작성일 : 2009.07.20
 * 작성자 : 이규희
 */

#include "LIB::sys.js"; // 공통업무 관련

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }

    // 공통 코드 조회
    gfn_SearchCommonCode(ds_oMemberfeeGubun, "MFGUBUN", "Y", "전체");
    gfn_SearchTrainingCourse("T", ds_oCourse, "Y", "전체"); // 직능 코드 조회
    gfn_SearchCommonCode(ds_oPaymentMethod, "PAYMENTGUBUN", "Y", "");
    cbxMemberfeeGubun.Value = "";
    cbxCourse.Value = "";
    radPaymentMethod.Value = "12";
    edMemberfeeYear.Text = left(GetDate(), 4);
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    // to do

    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

function Form_OnSize(obj,nCx,nCy,nState)
{
    if (gs_IsResizingForm == "Y") {
        gdMemberfeeCode.Height = nCy - gdMemberfeeCode.Top - 4;
        gdMemberfeeCode.Width = nCx - gdMemberfeeCode.Left - 4;
    }
}

/*
 * 기능 : 조회
 */
function lfn_Search(obj) {
    ds_ioMemberfeeCode.ClearData(); // 데이타셋 초기화
    
    // 조회이력을 저장한다.  
    ls_HistoryArg = "년도=" + quote(edMemberfeeYear.Text)
            + ",구분=" + quote(cbxMemberfeeGubun.Text)	// args 
            + ",직능=" + quote(cbxCourse.Text);
    gfn_InsertSearchPrintHistory(
        "S"
        , this.ID
        , global.mnuLeft.cbxOpenForm.Text
        , ls_HistoryArg
    );

    tit_clearActionInfo();
	tit_addSearchActionInfo("sys:searchMemberfeeCode", false);
	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMemberfeeCode=ds_oMemberfeeCode"	// outDs
		,"MFYEAR=" + quote(edMemberfeeYear.Text)
            + " MFGUBUN=" + quote(cbxMemberfeeGubun.Value)	// args 
            + " MFCOURSECD=" + quote(cbxCourse.Value) // args 
		,"lfn_AfterSearchMemberfeeCode"
		,false
	);
}

/*
 * 기능 : 추가
 */
function lfn_Input(obj) {
	if (!gfn_Confirm(MSGI00070)) { // 신규 추가 하시겠습니까?\n입력완료 후 저장 버튼을 누르세요.
        return false;
	}

	mb_IsNewData = true; // 저장버튼이 클릭 설정
    lfn_Cancel(); // 값 초기화

    // 기본값 설정
}

/*
 * 기능 : 삭제
 */
function lfn_Delete(obj) {
    if (ds_ioMemberfeeCode.currow < 0) {
        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.
        return false;
    }

	if (!gfn_Confirm(MSGW00030)) { // 정말로 삭제 하시겠습니까?
        return false;
	}

    ds_ioMemberfeeCode.DeleteRow(ds_ioMemberfeeCode.currow); // 선택된 ROW를 삭제한다.

    gfn_FormInit(this); // 입력란 초기화

	tit_clearActionInfo();
	tit_addSaveActionInfo(
		""	// insert
		, ""	// update
		, "sys:deleteMemberfeeCode"	// delete
		, ""	// flag column 명
		, ""	// key sql id
		, 0	// key 증가 값
		, "" 
		, 0 
		, "N"	// 실행타입
	);
	// 서버 호출 
	tit_callService(
		""
		,""
		,"ds_iMemberfeeCode=ds_ioMemberfeeCode:U"	// inDs
		,""	// outDs
		,""	// args 
		,"lfn_AfterSaveMemberfeeCode"
		,false
	);
}

/*
 * 기능 : 저장
 */
function lfn_Save(obj) {
	if (!gfn_FormValidate(this)) { // 입력 Validation Check
		return false;
	}

	if (mb_IsNewData || ds_ioMemberfeeCode.GetCount() == 0) { // 신규 저장
        // 키 중복 체크
    
        if (!gfn_Confirm(MSGW00020)) { // 정말로 추가 저장 하시겠습니까?
			return false;
		}
	
        // 입력된 값을 그리드로 복사한다.
        ds_ioMemberfeeCode.InsertRow(0);
        ds_ioMemberfeeCode.SetColumn(0, "USE_YN", chkUseYn.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFYEAR", edMemberfeeYear.Text);
        ds_ioMemberfeeCode.SetColumn(0, "MFGUBUN", cbxMemberfeeGubun.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFCOURSECD", cbxCourse.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFCOURSESEQ", medMemberfeeSeq.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFPAYMENTGUBUN", radPaymentMethod.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH01", medAmt01.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH02", medAmt02.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH03", medAmt03.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH04", medAmt04.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH05", medAmt05.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH06", medAmt06.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH07", medAmt07.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH08", medAmt08.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH09", medAmt09.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH10", medAmt10.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH11", medAmt11.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFMONTH12", medAmt12.Value);
        ds_ioMemberfeeCode.SetColumn(0, "MFREMARK", edRemark.Text);
    } else { // 수정 저장
        if (!gfn_Confirm(MSGW00040)) { // 정말로 수정 저장 하시겠습니까?
			return false;
		}
	
        // 입력된 값을 그리드로 복사한다.
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "USE_YN", chkUseYn.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFYEAR", edMemberfeeYear.Text);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFGUBUN", cbxMemberfeeGubun.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFCOURSECD", cbxCourse.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFCOURSESEQ", medMemberfeeSeq.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFPAYMENTGUBUN", radPaymentMethod.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH01", medAmt01.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH02", medAmt02.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH03", medAmt03.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH04", medAmt04.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH05", medAmt05.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH06", medAmt06.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH07", medAmt07.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH08", medAmt08.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH09", medAmt09.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH10", medAmt10.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH11", medAmt11.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFMONTH12", medAmt12.Value);
        ds_ioMemberfeeCode.SetColumn(ds_ioMemberfeeCode.currow, "MFREMARK", edRemark.Text);
    }

    gfn_FormInit(this); // 입력란 초기화

	tit_clearActionInfo();
	tit_addSaveActionInfo(
		"sys:insertMemberfeeCode"	// insert
		, "sys:updateMemberfeeCode"	// update
		, ""	// delete
		, ""	// flag column 명
		, ""	// key sql id
		, 0	// key 증가 값
		, "" 
		, 0 
		, "N"	// 실행타입
	);
	// 서버 호출 
	tit_callService(
		""
		,""
		,"ds_iMemberfeeCode=ds_ioMemberfeeCode:U"	// inDs
		,""	// outDs
		,""	// args 
		,"lfn_AfterSaveMemberfeeCode"
		,false
	);
}
/* 공통 필수 종료 */

/* 사용자 함수 */
/*
 * 기능 : 회비코드 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchMemberfeeCode(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    gfn_SearchMessage(gdMemberfeeCode); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSaveMemberfeeCode(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    gfn_SaveMessage(); // 저장 메세지를 처리한다.
    lfn_Search(); // 회비코드 조회
}

/*
 * 기능 : 버튼 활성/비활성시킨다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetFormAuth(bStatus) {
    btnInput.Enable = bStatus; // 추가 버튼
    btnDelete.Enable = bStatus; // 삭제 버튼
    btnSave.Enable = bStatus; // 수정&저장 버튼
}

/* 사용자 이벤트 함수 */
function btnMutilSort_OnClick(obj)
{
	gfn_GridMultiSort(gdMemberfeeCode, 0); // 멀티 정렬을 실행한다.
}

function ds_ioMemberfeeCode_OnRowPosChanged(obj,nOldRow,nRow)
{
    // 그리드의 값을 입력란에 복사한다. 추가상태인 경우 복사 후 저장을 하기 위해 제외한다.
    if (obj.GetRowType(nRow) <> "insert" && nRow <> -1) {
        chkUseYn.Value = obj.GetColumn(nRow, "USE_YN");
        edMemberfeeYear.Text = obj.GetColumn(nRow, "MFYEAR");
        cbxMemberfeeGubun.Value = obj.GetColumn(nRow, "MFGUBUN");
        cbxCourse.Value = obj.GetColumn(nRow, "MFCOURSECD");
        medMemberfeeSeq.Value = obj.GetColumn(nRow, "MFCOURSESEQ");
        radPaymentMethod.Value = obj.GetColumn(nRow, "MFPAYMENTGUBUN");
        medAmt01.Value = obj.GetColumn(nRow, "MFMONTH01");
        medAmt02.Value = obj.GetColumn(nRow, "MFMONTH02");
        medAmt03.Value = obj.GetColumn(nRow, "MFMONTH03");
        medAmt04.Value = obj.GetColumn(nRow, "MFMONTH04");
        medAmt05.Value = obj.GetColumn(nRow, "MFMONTH05");
        medAmt06.Value = obj.GetColumn(nRow, "MFMONTH06");
        medAmt07.Value = obj.GetColumn(nRow, "MFMONTH07");
        medAmt08.Value = obj.GetColumn(nRow, "MFMONTH08");
        medAmt09.Value = obj.GetColumn(nRow, "MFMONTH09");
        medAmt10.Value = obj.GetColumn(nRow, "MFMONTH10");
        medAmt11.Value = obj.GetColumn(nRow, "MFMONTH11");
        medAmt12.Value = obj.GetColumn(nRow, "MFMONTH12");
        edRemark.Text = obj.GetColumn(nRow, "MFREMARK");
        medPaymentFee.Value = obj.GetColumn(nRow, "TOT");
        
        // 키값 수정 금지
        gfn_MakeKeyMark(this); // 키값 수정 금지 설정
	}
	mb_IsNewData = false; // 저장버튼이 클릭 초기화
}

function medPaymentFee_OnkillFocus(obj)
{
    gfn_ComponentOnKillFocus(obj);
    
    medPaymentFee.value = ParseInt(medAmt01.Value)  
                        + ParseInt(medAmt02.Value)
                        + ParseInt(medAmt03.Value)
                        + ParseInt(medAmt04.Value)
                        + ParseInt(medAmt05.Value)
                        + ParseInt(medAmt06.Value)
                        + ParseInt(medAmt07.Value)
                        + ParseInt(medAmt08.Value)
                        + ParseInt(medAmt09.Value)
                        + ParseInt(medAmt10.Value)
                        + ParseInt(medAmt11.Value)
                        + ParseInt(medAmt12.Value);
}

function gdMemberfeeCode_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    var lobj_Dataset = object(obj.BindDataset);
	ds_ioMemberfeeCode_OnRowPosChanged(lobj_Dataset,nRow,nRow);
}

]]></Script>
</Window>
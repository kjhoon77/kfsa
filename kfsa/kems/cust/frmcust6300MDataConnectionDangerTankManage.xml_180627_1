<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="720" Id="frmcust6300MDataConnectionDangerTankManage" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="위험물운송자&#32;일치화관리(frmcust6300MDataConnectionDangerTankManage)" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1050" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireCd">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireCenterCd">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="UPCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireHead">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMNFCTRETCGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioSelectGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>일치완료</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>미처리</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>연계제외</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObj">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioKFFireObj">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFKeyfield">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>대상명</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>주소(번지)</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>전화번호</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>허가번호</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRegion">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="GTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioCourseD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFire">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioPBLINSTT">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>Y</CD>
						<DATA>Y</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>N</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObjD">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMNFCTRETCGubunD">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioDangerInfo">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObj2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioKFFireObj2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioFireManagerInfo2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMFFireObjD2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioDangerInfo2">
				<Contents>
					<colinfo id="DBMGNO" size="22" type="DECIMAL"/>
					<colinfo id="DGATEWAYDAN" size="18" type="STRING"/>
					<colinfo id="DPERMISSIONNO" size="20" type="STRING"/>
					<colinfo id="DREMARK" size="200" type="STRING"/>
					<colinfo id="DSEQ" size="22" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>기존&#32;대상&#32;일치화</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioJibu2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRegion2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="GTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireCd2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireCenterCd2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="UPCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFireHead2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBUCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioObjGubun2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioSelectGubun2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>전체</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>일치완료</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>미처리</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>연계제외</DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="28" Height="28" Id="shpBtnBox" Left="761" LineColor="user14" Right="1045" TabOrder="3" Top="0" Type="Rectangle" Width="284"></Shape>
		<Tab BKSelColor="lightskyblue" Height="696" Id="tab" OnChanged="tab_OnChanged" TabOrder="4" Top="24" Width="1056">
			<Contents>
				<TabPage BorderColor="black" Height="672" Id="page1" Left="2" TabOrder="121" Text="&#32;청기준&#32;" Top="22" Width="1052">
					<Shape Bottom="672" Height="84" Id="Shape5" Left="0" LineColor="user1" Right="519" TabOrder="122" Top="588" Type="Rectangle" Width="519"></Shape>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchCancel" ImageID="BTN_연계제외취소" Left="868" OnClick="lfn_KFMatchExceptCancel" Style="sty_Button" TabOrder="86" Top="139" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchCancel" ImageID="BTN_연계제외취소" Left="345" OnClick="lfn_MFMatchExceptCancel" Style="sty_Button" TabOrder="85" Top="139" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExcept" ImageID="BTN_연계제외처리" Left="345" OnClick="lfn_MFMatchExcept" Style="sty_Button" TabOrder="21" Top="139" Visible="FALSE" Width="98"></Button>
					<Shape Bottom="137" Height="118" Id="Shape1" Left="523" LineColor="user1" Right="1042" TabOrder="10" Top="19" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="664" Height="96" Id="Shape3" Left="523" LineColor="user1" Right="1042" TabOrder="65" Top="568" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="558" Height="165" Id="Shape2" Left="523" LineColor="user1" Right="1042" TabOrder="40" Top="393" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="580" Height="187" Id="Shape4" Left="0" LineColor="user1" Right="519" TabOrder="38" Top="393" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="137" Height="118" Id="Shape0" Left="0" LineColor="user1" Right="519" TabOrder="4" Top="19" Type="Rectangle" Width="519"></Shape>
					<Static Align="Center" BKColor="user36" Height="20" Id="lbJubsu" Left="117" Style="sty_LabelGruopBox" TabOrder="5" Text="소방청(소방민원정보시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFHead" ImeMode="none" INDEX="0" InnerDataset="ds_oFireHead" Left="97" OnChanged="cbxMFHead_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="1" Top="48" UserData="S" Value="B" Width="122"></Combo>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFStation" INDEX="0" InnerDataset="ds_oFireCd" Left="222" OnChanged="cbxMFStation_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="2" Top="49" UserData="S" Width="134"></Combo>
					<Static Align="Center" Height="20" Id="Static3" Left="4" Style="sty_Label" TabOrder="6" Text="소방관서" Top="49" VAlign="Middle" Width="90"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate1" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="8" Top="70" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" Height="20" Id="Static12" Left="217" Style="sty_Text" TabOrder="7" Text="~" Top="70" VAlign="Middle" Width="20"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate2" Left="236" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="9" Top="70" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static5" Left="640" Style="sty_LabelGruopBox" TabOrder="11" Text="안전원(교육종합관리시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Static Align="Center" Height="20" Id="lbMFDate" Left="4" Style="sty_Label" TabOrder="12" Text="안전원수신일자" Top="70" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static8" Left="4" Style="sty_Label" TabOrder="13" Text="검색조건" Top="91" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static9" Left="4" Style="sty_Label" TabOrder="14" Text="검색어" Top="112" VAlign="Middle" Width="90"></Static>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFCenter" INDEX="0" InnerDataset="ds_oFireCenterCd" Left="358" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="3" Top="48" UserData="S" Width="157"></Combo>
					<Static Align="Center" Height="20" Id="Static10" Left="359" Style="sty_Label" TabOrder="15" Text="조회건수" Top="70" VAlign="Middle" Width="59"></Static>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radMFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun" Left="98" OnChanged="tab_page1_radMFSelectGubun_OnChanged" TabOrder="16" Top="91" Width="417"></Radio>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edMFKeyword" ImeMode="native" Left="166" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page1_edMFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="17" Top="112" UserData="S:구주소2" Width="176"></Edit>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="97" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="18" Top="111" UserData="S" Value="B" Width="69"></Combo>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFSearch" Left="429" OnClick="lfn_MFSearch" Style="sty_Button" TabOrder="19" Text="처자료조회" ToolTipText="조회" Top="111" Width="85"></Button>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioKFFireObj" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="357" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="196" Id="gdKFOBJList" InputPanel="FALSE" Left="523" LineColor="default" OnCellClick="tab_page1_gdKFOBJList_OnCellClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="1042" RowHeight="20" Style="sty_Grid" TabOrder="20" TabStop="true" Top="161" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="50"/>
									<col width="36"/>
									<col width="79"/>
									<col width="97"/>
									<col width="67"/>
									<col width="80"/>
									<col width="51"/>
									<col width="46"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="매칭율"/>
									<cell bkcolor="user7" col="2" display="text" text="연계"/>
									<cell bkcolor="user7" col="3" display="text" text="대상물명"/>
									<cell bkcolor="user7" col="4" display="text" text="차량번호"/>
									<cell bkcolor="user7" col="5" display="text" text="허가번호"/>
									<cell bkcolor="user7" col="6" display="text" text="동명"/>
									<cell bkcolor="user7" col="7" display="text" text="주번지"/>
									<cell bkcolor="user7" col="8" display="text" text="부번지"/>
									<cell bkcolor="user7" col="9" display="text" text="상치장소"/>
									<cell bkcolor="user7" col="10" display="text" text="지역"/>
									<cell bkcolor="user7" col="11" display="text" text="삭제여부"/>
								</head>
								<body>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="0" display="text" expr="currow&#32;+&#32;1" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)' text="0"/>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="1" colid="TOTSUM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="2" display="text" expr="DECODE(RFLAGEE,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,&apos;○&apos;)" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="3" colid="BNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="4" colid="TCARNO" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="5" colid="TPERMISSIONNO" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="6" colid="TADDRDONGFNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="7" colid="TADDRMAINNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="8" colid="TADDRSUBNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="9" colid="TPARKPLACEADDR" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="left" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="10" colid="RCCDNM" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
									<cell align="center" bkcolor='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;User8&quot;)' col="11" colid="DELGUBUN" display="text" font='expr:iif(DELGUBUN&#32;==&#32;&quot;삭제&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchExcept" ImageID="BTN_연계제외처리" Left="868" OnClick="lfn_KFMatchExcept" Style="sty_Button" TabOrder="22" Top="139" Visible="FALSE" Width="98"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnKFExcel" ImageID="엑셀" Left="967" OnClick="tab_page1_btnKFExcel_OnClick" Style="sty_Button" TabOrder="24" Top="139" Transparent="TRUE" Width="74"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFExcel" ImageID="엑셀" Left="444" OnClick="tab_page1_btnMFExcel_OnClick" Style="sty_Button" TabOrder="23" Top="139" Transparent="TRUE" Width="74"></Button>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static0" Left="527" Style="sty_Label" TabOrder="25" Text="지부명" Top="27" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static2" Left="527" Style="sty_Label" TabOrder="26" Text="검색조건" Top="69" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static4" Left="527" Style="sty_Label" TabOrder="27" Text="검색어" Top="90" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static13" Left="527" Style="sty_Label" TabOrder="28" Text="지역" Top="48" VAlign="Middle" Width="90"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFJibu" INDEX="0" InnerDataset="ds_ioJibu" Left="621" OnChanged="tab_page1_cbxKFJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="29" Top="26" UserData="S" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion1" INDEX="0" InnerDataset="ds_oRegion" Left="621" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="30" Top="47" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion2" INDEX="0" InnerDataset="ds_oRegion" Left="764" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="31" Top="47" Value="B" Width="122"></Combo>
					<Static Align="Center" Height="20" Id="Static14" Left="744" Style="sty_Text" TabOrder="32" Text="~" Top="48" VAlign="Middle" Width="20"></Static>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radKFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun" Left="622" TabOrder="34" Top="69" Width="415"></Radio>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static11" Left="890" Style="sty_Label" TabOrder="33" Text="조회건수" Top="48" VAlign="Middle" Width="56"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="621" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="36" Top="89" UserData="S" Value="B" Width="106"></Combo>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edKFKeyword" ImeMode="native" Left="730" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page1_edKFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="35" Top="90" UserData="S:구주소2" Width="219"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnKFSearch" ImageID="안전원자료조회" Left="953" OnClick="tab_page1_btnKFSearch_OnClick" Style="sty_Button" TabOrder="37" ToolTipText="조회" Top="90" Width="85"></Button>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static15" Left="4" Style="sty_LabelGruopBox" TabOrder="39" Text="제조소등&#32;정보" Top="385" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static16" Left="527" Style="sty_LabelGruopBox" TabOrder="41" Text="고객&#32;정보" Top="384" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" Height="20" Id="Static17" Left="4" Style="sty_Label" TabOrder="42" Text="대상명" Top="407" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static18" Left="4" Style="sty_Label" TabOrder="43" Text="설치장소" Top="428" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="44" Id="Static19" Left="4" Style="sty_Label" TabOrder="44" Text="매칭주소" Top="449" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static20" Left="4" Style="sty_Label" TabOrder="45" Text="소방관서" Top="494" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static23" Left="263" Style="sty_Label" TabOrder="46" Text="완공일자" Top="557" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="OBJ_NM" DisableBKColor="user0" Height="20" Id="edMFOBJ_NM" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="47" Top="407" Width="275"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="ADDR1" DisableBKColor="user0" Height="20" Id="edMFADDR1" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="48" Top="428" Width="421"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="COMPET_DE" DisableBKColor="user0" Height="20" Id="edMFCOMPET_DE" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="49" Top="557" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="CMPN119SC_ID" DisableBKColor="user0" Height="20" Id="edMFCMPN119SC_ID" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="50" Top="494" Width="421"></Edit>
					<Static Align="Center" Height="20" Id="Static32" Left="4" Style="sty_Label" TabOrder="51" Text="전화번호" Top="557" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="INSTLR_TELNO" DisableBKColor="user0" Height="20" Id="edMFINSTLR_TELNO" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="52" Top="557" Width="167"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static25" Left="527" Style="sty_Label" TabOrder="53" Text="업체명" Top="407" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static29" Left="527" Style="sty_Label" TabOrder="56" Text="지역" Top="494" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="44" Id="Static30" Left="527" Style="sty_Label" TabOrder="55" Text="매칭주소" Top="449" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static33" Left="527" Style="sty_Label" TabOrder="54" Text="상치장소" Top="428" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TPARKPLACEADDR" DisableBKColor="user0" Height="20" Id="edKFTPARKPLACEADDR" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="57" Top="428" Width="420"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BNM" DisableBKColor="user0" Height="20" Id="edKFBNM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="58" Top="407" Width="274"></Edit>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Enable="FALSE" Height="20" Id="edKFMatch" ImeMode="native" Left="954" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="59" Top="407" Width="86"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static34" Left="896" Style="sty_Label" TabOrder="60" Text="연계구분" Top="407" VAlign="Middle" Width="57"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RCCDNM" DisableBKColor="user0" Height="20" Id="edKFRCCDNM" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="61" Top="494" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="BTEL" DisableBKColor="user0" Height="20" Id="edKFBTEL" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="62" Top="515" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="DELGUBUN" DisableBKColor="user0" Height="20" Id="edKFDELGUBUN" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="64" Top="515" Width="161"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static39" Left="785" Style="sty_Label" TabOrder="63" Text="상태" Top="515" VAlign="Middle" Width="92"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static40" Left="527" Style="sty_LabelGruopBox" TabOrder="66" Text="차량&#32;정보" Top="571" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static41" Left="527" Style="sty_Label" TabOrder="67" Text="차량번호" Top="594" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TCARNO" DisableBKColor="user0" Height="20" Id="edKFTCARNO" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="69" Top="594" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static42" Left="785" Style="sty_Label" TabOrder="68" Text="년식" Top="594" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TCARYEAR" DisableBKColor="user0" Height="20" Id="edKFTCARYEAR" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="70" Top="594" Width="161"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static43" Left="527" Style="sty_Label" TabOrder="71" Text="허가번호" Top="617" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TPERMISSIONNO" DisableBKColor="user0" Height="20" Id="edKFTPERMISSIONNO" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="73" Top="617" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static44" Left="527" Style="sty_Label" TabOrder="72" Text="기타사항" Top="640" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TREMARK" DisableBKColor="user0" Height="20" Id="edKFTREMARK" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="74" Top="640" Width="420"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFPISInfo" ImageID="BTN_TEXT_09" Left="388" OnClick="tab_page1_btnFPISInfo_OnClick" Style="sty_Button" TabOrder="75" Text="청시스템상세보기" Top="383" Transparent="TRUE" Width="132"></Button>
					<Checkbox Height="12" Id="chkMFPerson" Left="343" Style="sty_Checkbox" TabOrder="76" Text="문자열포함" Top="117" TrueValue="1" Value="FALSE" Width="84"></Checkbox>
					<Checkbox Height="12" Id="chkKFPerson" Left="863" Style="sty_Checkbox" TabOrder="77" Text="문자열&#32;포함" Top="111" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edMFCount" ImeMode="native" Left="55" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="78" Text="0" Top="139" UserData="S:구주소2" Width="41"></Edit>
					<Static Align="Center" Height="20" Id="Static45" Left="-2" Style="sty_LabelStat" TabOrder="79" Text="총건수" Top="139" VAlign="Middle" Width="56"></Static>
					<Static Align="Center" Height="20" Id="Static46" Left="523" Style="sty_LabelStat" TabOrder="81" Text="총건수" Top="139" VAlign="Middle" Width="56"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edKFCount" ImeMode="native" Left="580" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="80" Text="0" Top="139" UserData="S:구주소2" Width="41"></Edit>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatch" ImageID="BTN_TEXT_08" Left="738" OnClick="lfn_NowMatch" TabOrder="82" Text="수정없이연계처리" Top="358" Transparent="TRUE" Width="119"></Button>
					<Button ButtonStyle="TRUE" Height="22" Id="btnNewMatch" ImageID="BTN_TEXT_06" Left="857" OnClick="btnNewMatch_OnClick" TabOrder="83" Text="신규연계등록" Top="358" Transparent="TRUE" Width="92"></Button>
					<Button ButtonStyle="TRUE" Height="22" Id="btnModMatch" ImageID="BTN_TEXT_06" Left="950" OnClick="btnModMatch_OnClick" TabOrder="84" Text="수정연계처리" Top="358" Transparent="TRUE" Width="92"></Button>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="INSTLR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_NM" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="87" Top="515" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static48" Left="263" Style="sty_Label" TabOrder="88" Text="설치자명" Top="515" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static56" Left="527" Style="sty_Label" TabOrder="89" Text="전화번호&#32;" Top="515" VAlign="Middle" Width="90"></Static>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatchCancel" ImageID="BTN_TEXT_06" Left="645" OnClick="lfn_CancelMatch" TabOrder="90" Text="연계해지처리" Top="358" Transparent="TRUE" Width="92"></Button>
					<Checkbox Height="12" Id="chkKFDelUser" Left="759" Style="sty_Checkbox" TabOrder="91" Text="삭제자포함" Top="111" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Static Height="20" Id="Static60" Left="1" TabOrder="92" Text="※&#32;대상물&#32;또는&#32;선임자&#32;정보를&#32;더블클릭&#32;시&#32;우측&#32;안전원자료&#32;자동조회" Top="358" VAlign="Middle" Width="514"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static61" Left="785" Style="sty_Label" TabOrder="93" Text="직능" Top="494" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="COURSENM" DisableBKColor="user0" Height="20" Id="edKFCOURSENM" ImeMode="native" Left="879" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="94" Top="494" Width="161"></Edit>
					<Static Align="Center" Height="20" Id="Static49" Left="98" TabOrder="98" Text="동명" Top="449" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="DMADDRDONGFNM" DisableBKColor="user0" Height="20" Id="edMFFDong" ImeMode="native" Left="132" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="95" Top="449" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="DMADDRDONGNM" DisableBKColor="user0" Height="20" Id="edMFDong" ImeMode="native" Left="229" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="101" Top="449" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static50" Left="322" TabOrder="99" Text="주번지" Top="449" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="DMADDMAINNM" DisableBKColor="user0" Height="20" Id="edMFMainAddr" ImeMode="native" Left="366" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="96" Top="449" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static51" Left="420" TabOrder="100" Text="부번지" Top="449" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="DMADDSUBNM" DisableBKColor="user0" Height="20" Id="edMFSubAddr" ImeMode="native" Left="463" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="97" Top="449" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static62" Left="4" Style="sty_Label" TabOrder="103" Text="설치법인명" Top="515" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="INSTLR_CPR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_CPR_NM" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="102" Top="515" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static53" Left="622" TabOrder="107" Text="동명" Top="449" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TADDRDONGFNM" DisableBKColor="user0" Height="20" Id="edKFFDong" ImeMode="native" Left="656" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="104" Top="449" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TADDRDONGNM" DisableBKColor="user0" Height="20" Id="edKFDong" ImeMode="native" Left="752" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="110" Top="449" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static54" Left="846" TabOrder="108" Text="주번지" Top="449" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TADDRMAINNM" DisableBKColor="user0" Height="20" Id="edKFMainAddr" ImeMode="native" Left="890" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="105" Top="449" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static55" Left="941" TabOrder="109" Text="부번지" Top="449" VAlign="Middle" Width="46"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TADDRSUBNM" DisableBKColor="user0" Height="20" Id="edKFSubAddr" ImeMode="native" Left="987" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="106" Top="449" Width="53"></Edit>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioMFFireObj" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="357" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="196" Id="gdMFOBJList" InputPanel="FALSE" Left="1" LineColor="default" OnCellClick="tab_page1_gdMFOBJList_OnCellClick" OnCellDBLClick="tab_page1_gdMFOBJList_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="520" RowHeight="20" Style="sty_Grid" TabOrder="111" TabStop="true" Top="161" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="45"/>
									<col width="97"/>
									<col width="97"/>
									<col width="60"/>
									<col width="80"/>
									<col width="40"/>
									<col width="40"/>
									<col width="151"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="연계"/>
									<cell bkcolor="user7" col="2" display="text" text="대상명"/>
									<cell bkcolor="user7" col="3" display="text" text="차량번호"/>
									<cell bkcolor="user7" col="4" display="text" text="허가번호"/>
									<cell bkcolor="user7" col="5" display="text" text="동주소"/>
									<cell bkcolor="user7" col="6" display="text" text="주번지"/>
									<cell bkcolor="user7" col="7" display="text" text="부번지"/>
									<cell bkcolor="user7" col="8" display="text" text="주소"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" display="text" expr="DECODE(MSTATUS,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,&apos;○&apos;)"/>
									<cell align="left" col="2" colid="OBJ_NM" display="text"/>
									<cell align="left" col="3" colid="VHCLE_NO" display="text"/>
									<cell align="left" col="4" colid="PRMISN_NO" display="text"/>
									<cell align="left" col="5" colid="DMADDRDONGFNM" display="text"/>
									<cell align="left" col="6" colid="DMADDMAINNM" display="text"/>
									<cell align="left" col="7" colid="DMADDSUBNM" display="text"/>
									<cell align="left" col="8" colid="ADDR" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" Height="20" Id="Static63" Left="372" Style="sty_Label" TabOrder="113" Text="연계구분" Top="407" VAlign="Middle" Width="57"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Height="20" Id="edMFMatch" ImeMode="native" Left="430" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="112" Top="407" Width="86"></Edit>
					<Static Align="Center" Height="20" Id="Static65" Left="4" Style="sty_Label" TabOrder="114" Text="처리구분" Top="27" VAlign="Middle" Width="90"></Static>
					<Radio CodeColumn="CD" DataColumn="DATA" Height="20" Id="radMFGubun" INDEX="0" InnerDataset="ds_ioGubun" Left="98" OnChanged="tab_page1_radMFGubun_OnChanged" TabOrder="115" Top="28" Width="132"></Radio>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spMFRowNum" Left="419" Max="1000000" TabOrder="116" Text="500" Top="70" Width="94"></Spin>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spKFRowNum" Left="948" Max="1000000" TabOrder="117" Text="500" Top="47" Width="89"></Spin>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="PRMISN_NO" DisableBKColor="user0" Height="20" Id="edMFPRMISN_NO" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="118" Top="626" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static52" Left="4" Style="sty_Label" TabOrder="119" Text="허가번호" Top="626" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static1" Left="4" Style="sty_Label" TabOrder="120" Text="설치자주소" Top="536" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="ADDR2" DisableBKColor="user0" Height="20" Id="edMFADDR2" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="121" Top="536" Width="421"></Edit>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static6" Left="2" Style="sty_LabelGruopBox" TabOrder="123" Text="차량&#32;정보&#32;" Top="581" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" Height="20" Id="Static7" Left="4" Style="sty_Label" TabOrder="124" Text="차량번호" Top="603" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="VHCLE_NO" DisableBKColor="user0" Height="20" Id="edMFVHCLE_NO" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="126" Top="603" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static21" Left="263" Style="sty_Label" TabOrder="131" Text="년식" Top="603" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="CARNM" DisableBKColor="user0" Height="20" Id="edMFCARNM" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="130" Top="626" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static31" Left="263" Style="sty_Label" TabOrder="129" Text="차종" Top="626" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static47" Left="4" Style="sty_Label" TabOrder="128" Text="최초등록일" Top="649" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static57" Left="263" Style="sty_Label" TabOrder="125" Text="최종수정일" Top="649" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="UPDT_DE_14" DisableBKColor="user0" Height="20" Id="edMFUPDT_DE_14" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="127" Top="649" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="VHCLE_YEAR" DisableBKColor="user0" Height="20" Id="edMFVHCLE_YEAR" ImeMode="native" Left="354" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="132" Top="603" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="REGIST_DE_14" DisableBKColor="user0" Height="20" Id="edMFREGIST_DE_14" ImeMode="native" Left="95" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="133" Top="649" Width="167"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static28" Left="527" Style="sty_Label" TabOrder="134" Text="설치자주소" Top="536" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="TINSTLRADDR" DisableBKColor="user0" Height="20" Id="edKFTINSTLRADDR" ImeMode="native" Left="620" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="135" Top="536" Width="420"></Edit>
					<Static Align="Center" Height="20" Id="Static66" Left="95" TabOrder="136" Text="도로명" Top="471" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="ROAD_NM" DisableBKColor="user0" Height="20" Id="edMFRoadNM" ImeMode="native" Left="132" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="137" Top="472" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static67" Left="336" TabOrder="138" Text="건물번호" Top="472" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="MAIN_BDNBR" DisableBKColor="user0" Height="20" Id="edMFMainNO" ImeMode="native" Left="396" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="139" Top="472" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static68" Left="448" TabOrder="141" Text="-" Top="472" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD" Border="Flat" Column="SEC_BDNBR" DisableBKColor="user0" Height="20" Id="edMFSubNO" ImeMode="native" Left="463" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="140" Top="472" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static69" Left="619" TabOrder="142" Text="도로명" Top="470" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RROADNM" DisableBKColor="user0" Height="20" Id="edKFRoadNM" ImeMode="native" Left="656" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="143" Top="471" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static70" Left="860" TabOrder="144" Text="건물번호" Top="471" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RBUILDMAINNO" DisableBKColor="user0" Height="20" Id="edKFMainNO" ImeMode="native" Left="920" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="145" Top="471" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static71" Left="973" TabOrder="147" Text="-" Top="471" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj" Border="Flat" Column="RBUILDSUBNO" DisableBKColor="user0" Height="20" Id="edKFSubNO" ImeMode="native" Left="987" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="146" Top="471" Width="53"></Edit>
				</TabPage>
				<TabPage BorderColor="black" Height="672" Id="page2" Left="2" TabOrder="2" Text="안전원기준" Top="22" Width="1052">
					<Shape Bottom="670" Height="82" Id="Shape5" Left="522" LineColor="user1" Right="1041" TabOrder="119" Top="588" Type="Rectangle" Width="519"></Shape>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchCancel" ImageID="BTN_연계제외취소" Left="345" OnClick="lfn_KFMatchExceptCancel2" Style="sty_Button" TabOrder="85" Top="139" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchCancel" ImageID="BTN_연계제외취소" Left="867" OnClick="lfn_MFMatchExceptCancel2" Style="sty_Button" TabOrder="84" Top="139" Visible="FALSE" Width="98"></Button>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnMFMatchExcept" ImageID="BTN_연계제외처리" Left="867" OnClick="lfn_MFMatchExcept2" Style="sty_Button" TabOrder="21" Top="139" Visible="FALSE" Width="98"></Button>
					<Shape Bottom="137" Height="118" Id="Shape1" Left="0" LineColor="user1" Right="519" TabOrder="10" Top="19" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="670" Height="82" Id="Shape3" Left="0" LineColor="user1" Right="519" TabOrder="65" Top="588" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="561" Height="168" Id="Shape2" Left="0" LineColor="user1" Right="519" TabOrder="40" Top="393" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="578" Height="185" Id="Shape4" Left="522" LineColor="user1" Right="1041" TabOrder="38" Top="393" Type="Rectangle" Width="519"></Shape>
					<Shape Bottom="137" Height="118" Id="Shape0" Left="522" LineColor="user1" Right="1041" TabOrder="4" Top="19" Type="Rectangle" Width="519"></Shape>
					<Static Align="Center" BKColor="user36" Height="20" Id="lbJubsu" Left="639" Style="sty_LabelGruopBox" TabOrder="5" Text="소방청(소방민원정보시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFHead" ImeMode="none" INDEX="0" InnerDataset="ds_oFireHead2" Left="619" OnChanged="cbxMFHead_OnChanged2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="1" Top="26" UserData="S" Value="B" Width="122"></Combo>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFStation" INDEX="0" InnerDataset="ds_oFireCd2" Left="744" OnChanged="cbxMFStation_OnChanged2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="2" Top="27" UserData="S" Width="134"></Combo>
					<Static Align="Center" Height="20" Id="Static3" Left="526" Style="sty_Label" TabOrder="6" Text="소방관서" Top="27" VAlign="Middle" Width="90"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate1" Left="620" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="8" Top="48" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" Height="20" Id="Static12" Left="739" Style="sty_Text" TabOrder="7" Text="~" Top="48" VAlign="Middle" Width="20"></Static>
					<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="medMFModDate2" Left="758" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="9" Top="49" WeeksFont="돋음,9" Width="120"></Calendar>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static5" Left="117" Style="sty_LabelGruopBox" TabOrder="11" Text="안전원(교육종합관리시스템)&#32;정보" Top="3" VAlign="Middle" Width="284"></Static>
					<Static Align="Center" Height="20" Id="lbMFDate" Left="526" Style="sty_Label" TabOrder="12" Text="안전원수신일자" Top="48" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static8" Left="526" Style="sty_Label" TabOrder="13" Text="검색조건" Top="69" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static9" Left="526" Style="sty_Label" TabOrder="14" Text="검색어" Top="90" VAlign="Middle" Width="90"></Static>
					<Combo BindDataset="ds_ioCourse" Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFCenter" INDEX="0" InnerDataset="ds_oFireCenterCd2" Left="880" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="3" Top="26" UserData="S" Width="157"></Combo>
					<Static Align="Center" Height="20" Id="Static10" Left="881" Style="sty_Label" TabOrder="15" Text="조회건수" Top="48" VAlign="Middle" Width="59"></Static>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radMFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun2" Left="620" OnChanged="tab_page1_radMFSelectGubun_OnChanged" TabOrder="16" Top="69" Width="417"></Radio>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edMFKeyword" ImeMode="native" Left="688" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page2_edMFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="17" Top="90" UserData="S:구주소2" Width="262"></Edit>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxMFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="619" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="18" Top="89" UserData="S" Value="B" Width="69"></Combo>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFSearch" ImageID="청자료조회" Left="951" OnClick="tab_page2_btnMFSearch_OnClick" Style="sty_Button" TabOrder="19" ToolTipText="조회" Top="90" Width="85"></Button>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioKFFireObj2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="357" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="196" Id="gdKFOBJList" InputPanel="FALSE" LineColor="default" OnCellClick="tab_page2_gdKFOBJList_OnCellClick" OnCellDBLClick="tab_page2_gdKFOBJList_OnCellDblClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="519" RowHeight="20" Style="sty_Grid" TabOrder="20" TabStop="true" Top="161" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="36"/>
									<col width="71"/>
									<col width="84"/>
									<col width="67"/>
									<col width="80"/>
									<col width="51"/>
									<col width="46"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="연계"/>
									<cell bkcolor="user7" col="2" display="text" text="대상물명"/>
									<cell bkcolor="user7" col="3" display="text" text="차량번호"/>
									<cell bkcolor="user7" col="4" display="text" text="허가번호"/>
									<cell bkcolor="user7" col="5" display="text" text="동명"/>
									<cell bkcolor="user7" col="6" display="text" text="주번지"/>
									<cell bkcolor="user7" col="7" display="text" text="부번지"/>
									<cell bkcolor="user7" col="8" display="text" text="상치장소"/>
									<cell bkcolor="user7" col="9" display="text" text="지역"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" display="text" expr="DECODE(RFLAGEE,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,&apos;○&apos;)"/>
									<cell align="left" col="2" colid="BNM" display="text"/>
									<cell align="left" col="3" colid="TCARNO" display="text"/>
									<cell align="left" col="4" colid="TPERMISSIONNO" display="text"/>
									<cell align="left" col="5" colid="TADDRDONGFNM" display="text"/>
									<cell align="left" col="6" colid="TADDRMAINNM" display="text"/>
									<cell align="left" col="7" colid="TADDRSUBNM" display="text"/>
									<cell align="left" col="8" colid="TPARKPLACEADDR" display="text"/>
									<cell align="left" col="9" colid="RCCDNM" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button BKColor="user7" ButtonStyle="TRUE" Height="20" Id="btnKFMatchExcept" ImageID="BTN_연계제외처리" Left="345" OnClick="lfn_KFMatchExcept2" Style="sty_Button" TabOrder="22" Top="139" Visible="FALSE" Width="98"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnKFExcel" ImageID="엑셀" Left="444" OnClick="tab_page2_btnKFExcel_OnClick" Style="sty_Button" TabOrder="24" Top="139" Transparent="TRUE" Width="74"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMFExcel" ImageID="엑셀" Left="966" OnClick="tab_page2_btnMFExcel_OnClick" Style="sty_Button" TabOrder="23" Top="139" Transparent="TRUE" Width="74"></Button>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static0" Left="4" Style="sty_Label" TabOrder="25" Text="지부명" Top="27" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static2" Left="4" Style="sty_Label" TabOrder="26" Text="검색조건" Top="69" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static4" Left="4" Style="sty_Label" TabOrder="27" Text="검색어" Top="90" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static13" Left="4" Style="sty_Label" TabOrder="28" Text="지역" Top="48" VAlign="Middle" Width="90"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFJibu" INDEX="0" InnerDataset="ds_ioJibu2" Left="98" OnChanged="tab_page2_cbxKFJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="29" Top="26" UserData="S" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion1" INDEX="0" InnerDataset="ds_oRegion2" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="30" Top="47" Value="B" Width="122"></Combo>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFRegion2" INDEX="0" InnerDataset="ds_oRegion2" Left="241" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="31" Top="47" Value="B" Width="122"></Combo>
					<Static Align="Center" Height="20" Id="Static14" Left="221" Style="sty_Text" TabOrder="32" Text="~" Top="48" VAlign="Middle" Width="20"></Static>
					<Radio CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radKFSelectGubun" INDEX="0" InnerDataset="ds_ioSelectGubun2" Left="99" OnChanged="tab_page2_radKFSelectGubun_OnChanged" TabOrder="34" Top="69" Width="415"></Radio>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static11" Left="367" Style="sty_Label" TabOrder="33" Text="조회건수" Top="48" VAlign="Middle" Width="56"></Static>
					<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxKFKeyfield" INDEX="0" InnerDataset="ds_ioMFKeyfield" Left="98" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="36" Top="89" UserData="S" Value="B" Width="106"></Combo>
					<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edKFKeyword" ImeMode="native" Left="207" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="tab_page2_edKFKeyword_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="35" Top="90" UserData="S:구주소2" Width="219"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnKFSearch" ImageID="안전원자료조회" Left="430" OnClick="lfn_KFSearch2" Style="sty_Button" TabOrder="37" ToolTipText="조회" Top="90" Width="85"></Button>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static15" Left="526" Style="sty_LabelGruopBox" TabOrder="39" Text="제조소등&#32;정보" Top="385" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static16" Left="4" Style="sty_LabelGruopBox" TabOrder="41" Text="고객&#32;정보" Top="384" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" Height="20" Id="Static17" Left="526" Style="sty_Label" TabOrder="42" Text="대상명" Top="407" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static18" Left="526" Style="sty_Label" TabOrder="43" Text="설치장소" Top="428" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="43" Id="Static19" Left="526" Style="sty_Label" TabOrder="44" Text="매칭주소" Top="449" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static20" Left="526" Style="sty_Label" TabOrder="45" Text="소방관서" Top="493" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static23" Left="785" Style="sty_Label" TabOrder="46" Text="완공일자" Top="556" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="OBJ_NM" DisableBKColor="user0" Height="20" Id="edMFOBJ_NM" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="47" Top="407" Width="275"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="ADDR1" DisableBKColor="user0" Height="20" Id="edMFADDR1" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="48" Top="428" Width="421"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="COMPET_DE" DisableBKColor="user0" Height="20" Id="edMFCOMPET_DE" ImeMode="native" Left="876" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="49" Top="556" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="CMPN119SC_ID" DisableBKColor="user0" Height="20" Id="edMFCMPN119SC_ID" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="50" Top="493" Width="421"></Edit>
					<Static Align="Center" Height="20" Id="Static32" Left="526" Style="sty_Label" TabOrder="51" Text="전화번호" Top="556" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="INSTLR_TELNO" DisableBKColor="user0" Height="20" Id="edMFINSTLR_TELNO" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="52" Top="556" Width="167"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static25" Left="4" Style="sty_Label" TabOrder="53" Text="업체명" Top="407" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static29" Left="4" Style="sty_Label" TabOrder="56" Text="지역" Top="493" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="43" Id="Static30" Left="4" Style="sty_Label" TabOrder="55" Text="매칭주소" Top="449" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static33" Left="4" Style="sty_Label" TabOrder="54" Text="상치장소" Top="428" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TPARKPLACEADDR" DisableBKColor="user0" Height="20" Id="edKFTPARKPLACEADDR" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="57" Top="428" Width="420"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BNM" DisableBKColor="user0" Height="20" Id="edKFBNM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="58" Top="407" Width="274"></Edit>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Enable="FALSE" Height="20" Id="edKFMatch" ImeMode="native" Left="431" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="59" Top="407" Width="86"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static34" Left="373" Style="sty_Label" TabOrder="60" Text="연계구분" Top="407" VAlign="Middle" Width="57"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RCCDNM" DisableBKColor="user0" Height="20" Id="edKFRCCDNM" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="61" Top="493" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="BTEL" DisableBKColor="user0" Height="20" Id="edKFBTEL" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="62" Top="514" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="DELGUBUN" DisableBKColor="user0" Height="20" Id="edKFDELGUBUN" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="64" Top="514" Width="161"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static39" Left="262" Style="sty_Label" TabOrder="63" Text="상태" Top="514" VAlign="Middle" Width="92"></Static>
					<Static Align="Center" BKColor="user39" Height="20" Id="Static40" Left="4" Style="sty_LabelGruopBox" TabOrder="66" Text="차량&#32;정보" Top="579" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static41" Left="4" Style="sty_Label" TabOrder="67" Text="차량번호" Top="602" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TCARNO" DisableBKColor="user0" Height="20" Id="edKFTCARNO" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="69" Top="602" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static42" Left="262" Style="sty_Label" TabOrder="68" Text="년식" Top="602" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TCARYEAR" DisableBKColor="user0" Height="20" Id="edKFTCARYEAR" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="70" Top="602" Width="161"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static43" Left="4" Style="sty_Label" TabOrder="71" Text="허가번호" Top="625" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TPERMISSIONNO" DisableBKColor="user0" Height="20" Id="edKFTPERMISSIONNO" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="73" Top="625" Width="162"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static44" Left="4" Style="sty_Label" TabOrder="72" Text="기타사항" Top="648" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TREMARK" DisableBKColor="user0" Height="20" Id="edKFTREMARK" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="74" Top="648" Width="420"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnFPISInfo" ImageID="BTN_TEXT_09" Left="910" OnClick="tab_page2_btnFPISInfo_OnClick" Style="sty_Button" TabOrder="75" Text="청시스템상세보기" Top="383" Transparent="TRUE" Width="132"></Button>
					<Checkbox Height="12" Id="chkMFPerson" Left="865" Style="sty_Checkbox" TabOrder="76" Text="문자열포함" Top="111" TrueValue="1" Value="FALSE" Width="84"></Checkbox>
					<Checkbox Height="12" Id="chkKFPerson" Left="340" Style="sty_Checkbox" TabOrder="77" Text="문자열&#32;포함" Top="111" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edMFCount" ImeMode="native" Left="580" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="78" Text="0" Top="139" UserData="S:구주소2" Width="41"></Edit>
					<Static Align="Center" Height="20" Id="Static45" Left="523" Style="sty_LabelStat" TabOrder="79" Text="총건수" Top="139" VAlign="Middle" Width="56"></Static>
					<Static Align="Center" Height="20" Id="Static46" Style="sty_LabelStat" TabOrder="81" Text="총건수" Top="139" VAlign="Middle" Width="56"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edKFCount" ImeMode="native" Left="57" LeftMargin="2" Number="TRUE" OnChanged="tab_page1_Edit0_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="80" Text="0" Top="139" UserData="S:구주소2" Width="41"></Edit>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatch" ImageID="BTN_TEXT_08" Left="830" OnClick="lfn_NowMatch2" TabOrder="82" Text="수정없이연계처리" Top="358" Transparent="TRUE" Width="119"></Button>
					<Button ButtonStyle="TRUE" Height="22" Id="btnModMatch" ImageID="BTN_TEXT_06" Left="949" OnClick="btnModMatch_OnClick2" TabOrder="83" Text="수정연계처리" Top="358" Transparent="TRUE" Width="92"></Button>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="INSTLR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_NM" ImeMode="native" Left="876" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="86" Top="514" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static48" Left="785" Style="sty_Label" TabOrder="87" Text="설치자명" Top="514" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static56" Left="4" Style="sty_Label" TabOrder="88" Text="전화번호&#32;" Top="514" VAlign="Middle" Width="90"></Static>
					<Button ButtonStyle="TRUE" Height="22" Id="btnMatchCancel" ImageID="BTN_TEXT_06" Left="737" OnClick="lfn_CancelMatch2" TabOrder="89" Text="연계해지처리" Top="358" Transparent="TRUE" Width="92"></Button>
					<Checkbox Height="12" Id="chkKFDelUser" Left="236" Style="sty_Checkbox" TabOrder="90" Text="삭제자포함" Top="111" TrueValue="1" Value="FALSE" Width="92"></Checkbox>
					<Static Height="20" Id="lbsearchNotice" Left="4" TabOrder="91" Text="※&#32;대상물&#32;또는&#32;선임자&#32;정보를&#32;더블클릭&#32;시&#32;우측&#32;소방청&#32;자료&#32;자동조회" Top="358" VAlign="Middle" Width="514"></Static>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static61" Left="262" Style="sty_Label" TabOrder="92" Text="직능" Top="493" VAlign="Middle" Width="92"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="COURSENM" DisableBKColor="user0" Height="20" Id="edKFCOURSENM" ImeMode="native" Left="356" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="93" Top="493" Width="161"></Edit>
					<Static Align="Center" Height="20" Id="Static49" Left="620" TabOrder="97" Text="동명" Top="449" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="DMADDRDONGFNM" DisableBKColor="user0" Height="20" Id="edMFFDong" ImeMode="native" Left="654" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="94" Top="449" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="DMADDRDONGNM" DisableBKColor="user0" Height="20" Id="edMFDong" ImeMode="native" Left="751" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="100" Top="449" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static50" Left="844" TabOrder="98" Text="주번지" Top="449" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="DMADDMAINNM" DisableBKColor="user0" Height="20" Id="edMFMainAddr" ImeMode="native" Left="888" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="95" Top="449" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static51" Left="942" TabOrder="99" Text="부번지" Top="449" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="DMADDSUBNM" DisableBKColor="user0" Height="20" Id="edMFSubAddr" ImeMode="native" Left="985" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="96" Top="449" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static62" Left="526" Style="sty_Label" TabOrder="102" Text="설치법인명" Top="514" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="INSTLR_CPR_NM" DisableBKColor="user0" Height="20" Id="edMFINSTLR_CPR_NM" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="101" Top="514" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static53" Left="99" TabOrder="106" Text="동명" Top="449" VAlign="Middle" Width="34"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TADDRDONGFNM" DisableBKColor="user0" Height="20" Id="edKFFDong" ImeMode="native" Left="133" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="103" Top="449" Width="95"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TADDRDONGNM" DisableBKColor="user0" Height="20" Id="edKFDong" ImeMode="native" Left="229" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="109" Top="449" Width="87"></Edit>
					<Static Align="Center" Height="20" Id="Static54" Left="323" TabOrder="107" Text="주번지" Top="449" VAlign="Middle" Width="42"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TADDRMAINNM" DisableBKColor="user0" Height="20" Id="edKFMainAddr" ImeMode="native" Left="367" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="104" Top="449" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static55" Left="418" TabOrder="108" Text="부번지" Top="449" VAlign="Middle" Width="46"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TADDRSUBNM" DisableBKColor="user0" Height="20" Id="edKFSubAddr" ImeMode="native" Left="464" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="105" Top="449" Width="53"></Edit>
					<Grid AutoEnter="TRUE" BindDataset="ds_ioMFFireObj2" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="357" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="196" Id="gdMFOBJList" InputPanel="FALSE" Left="523" LineColor="default" OnCellClick="tab_page2_gdMFOBJList_OnCellClick" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="1042" RowHeight="20" Style="sty_Grid" TabOrder="110" TabStop="true" Top="161" UseDBuff="true" UsePopupMenu="true" UserData="공통코드목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="519">
						<contents>
							<format id="Default">
								<columns>
									<col width="33"/>
									<col width="56"/>
									<col width="45"/>
									<col width="94"/>
									<col width="111"/>
									<col width="60"/>
									<col width="80"/>
									<col width="40"/>
									<col width="40"/>
									<col width="151"/>
								</columns>
								<head>
									<cell bkcolor="user7" col="0" display="text" text="순번"/>
									<cell bkcolor="user7" col="1" display="text" text="매칭율"/>
									<cell bkcolor="user7" col="2" display="text" text="연계"/>
									<cell bkcolor="user7" col="3" display="text" text="대상명"/>
									<cell bkcolor="user7" col="4" display="text" text="차량번호"/>
									<cell bkcolor="user7" col="5" display="text" text="허가번호"/>
									<cell bkcolor="user7" col="6" display="text" text="동주소"/>
									<cell bkcolor="user7" col="7" display="text" text="주번지"/>
									<cell bkcolor="user7" col="8" display="text" text="부번지"/>
									<cell bkcolor="user7" col="9" display="text" text="주소"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1" text="0"/>
									<cell align="center" col="1" colid="TOTSUM" display="text"/>
									<cell align="center" col="2" display="text" expr="DECODE(MSTATUS,&apos;-1&apos;,&apos;제외&apos;,&apos;0&apos;,&apos;X&apos;,&apos;○&apos;)"/>
									<cell align="left" col="3" colid="OBJ_NM" display="text"/>
									<cell align="left" col="4" colid="VHCLE_NO" display="text"/>
									<cell align="left" col="5" colid="PRMISN_NO" display="text"/>
									<cell align="left" col="6" colid="DMADDRDONGFNM" display="text"/>
									<cell align="left" col="7" colid="DMADDMAINNM" display="text"/>
									<cell align="left" col="8" colid="DMADDSUBNM" display="text"/>
									<cell align="left" col="9" colid="ADDR" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" Height="20" Id="Static63" Left="894" Style="sty_Label" TabOrder="112" Text="연계구분" Top="407" VAlign="Middle" Width="57"></Static>
					<Edit AutoSelect="TRUE" Border="Flat" DisableBKColor="user0" Height="20" Id="edMFMatch" ImeMode="native" Left="952" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="111" Top="407" Width="86"></Edit>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spMFRowNum" Left="941" Max="1000000" TabOrder="113" Text="500" Top="48" Width="94"></Spin>
					<Spin Border="Flat" BorderColor="user14" Height="20" Id="spKFRowNum" Left="425" Max="1000000" TabOrder="114" Text="500" Top="47" Width="89"></Spin>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="PRMISN_NO" DisableBKColor="user0" Height="20" Id="edMFPRMISN_NO" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="115" Top="625" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static52" Left="526" Style="sty_Label" TabOrder="116" Text="허가번호" Top="625" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static1" Left="526" Style="sty_Label" TabOrder="117" Text="설치장소" Top="535" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="ADDR2" DisableBKColor="user0" Height="20" Id="edMFADDR2" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="118" Top="535" Width="421"></Edit>
					<Static Align="Center" BKColor="user36" Height="20" Id="Static6" Left="524" Style="sty_LabelGruopBox" TabOrder="120" Text="차량&#32;정보&#32;" Top="579" VAlign="Middle" Width="125"></Static>
					<Static Align="Center" Height="20" Id="Static7" Left="526" Style="sty_Label" TabOrder="121" Text="차량번호" Top="602" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="VHCLE_NO" DisableBKColor="user0" Height="20" Id="edMFVHCLE_NO" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="123" Top="602" Width="167"></Edit>
					<Static Align="Center" Height="20" Id="Static21" Left="785" Style="sty_Label" TabOrder="128" Text="년식" Top="602" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="CARNM" DisableBKColor="user0" Height="20" Id="edMFCARNM" ImeMode="native" Left="876" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="127" Top="625" Width="162"></Edit>
					<Static Align="Center" Height="20" Id="Static31" Left="785" Style="sty_Label" TabOrder="126" Text="차종" Top="625" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static47" Left="526" Style="sty_Label" TabOrder="125" Text="최초등록일" Top="648" VAlign="Middle" Width="90"></Static>
					<Static Align="Center" Height="20" Id="Static57" Left="785" Style="sty_Label" TabOrder="122" Text="최종수정일" Top="648" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="UPDT_DE_14" DisableBKColor="user0" Height="20" Id="edMFUPDT_DE_14" ImeMode="native" Left="876" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="124" Top="648" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="VHCLE_YEAR" DisableBKColor="user0" Height="20" Id="edMFVHCLE_YEAR" ImeMode="native" Left="876" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="129" Top="602" Width="162"></Edit>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="REGIST_DE_14" DisableBKColor="user0" Height="20" Id="edMFREGIST_DE_14" ImeMode="native" Left="617" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="130" Top="648" Width="167"></Edit>
					<Static Align="Center" BKColor="user31" Height="20" Id="Static28" Left="4" Style="sty_Label" TabOrder="131" Text="설치자주소" Top="535" VAlign="Middle" Width="90"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="TINSTLRADDR" DisableBKColor="user0" Height="20" Id="edKFTINSTLRADDR" ImeMode="native" Left="97" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="132" Top="535" Width="420"></Edit>
					<Static Align="Center" Height="20" Id="Static68" Left="96" TabOrder="133" Text="도로명" Top="470" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RROADNM" DisableBKColor="user0" Height="20" Id="edKFRoadNM" ImeMode="native" Left="133" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="134" Top="471" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static69" Left="337" TabOrder="135" Text="건물번호" Top="471" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RBUILDMAINNO" DisableBKColor="user0" Height="20" Id="edKFMainNO" ImeMode="native" Left="397" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="136" Top="471" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static70" Left="450" TabOrder="138" Text="-" Top="471" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioKFFireObj2" Border="Flat" Column="RBUILDSUBNO" DisableBKColor="user0" Height="20" Id="edKFSubNO" ImeMode="native" Left="464" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="137" Top="471" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static60" Left="617" TabOrder="139" Text="도로명" Top="470" VAlign="Middle" Width="36"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="ROAD_NM" DisableBKColor="user0" Height="20" Id="edMFRoadNM" ImeMode="native" Left="654" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="140" Top="471" Width="202"></Edit>
					<Static Align="Center" Height="20" Id="Static66" Left="858" TabOrder="141" Text="건물번호" Top="471" VAlign="Middle" Width="60"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="MAIN_BDNBR" DisableBKColor="user0" Height="20" Id="edMFMainNO" ImeMode="native" Left="918" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="142" Top="471" Width="53"></Edit>
					<Static Align="Center" Height="20" Id="Static67" Left="970" TabOrder="144" Text="-" Top="471" VAlign="Middle" Width="14"></Static>
					<Edit AutoSelect="TRUE" BindDataset="ds_ioMFFireObjD2" Border="Flat" Column="SEC_BDNBR" DisableBKColor="user0" Height="20" Id="edMFSubNO" ImeMode="native" Left="985" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="143" Top="471" Width="53"></Edit>
				</TabPage>
			</Contents>
		</Tab>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="870" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="1" ToolTipText="화면&#32;출력" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="957" OnClick="lfn_End" Style="sty_Button" TabOrder="2" ToolTipText="닫기" Top="3" Width="85"></Button>
		<Static Color="user11" Font="굴림,12,Bold" Height="20" Id="Static25" Left="4" Style="sty_Text" TabOrder="5" Text="위험물운송자&#32;일치화관리" Top="4" VAlign="Middle" VClip="Both" Width="436"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnDataHistory" ImageID="BTN_TEXT_07" Left="764" OnClick="btnDataHistory_OnClick" Style="sty_Button" TabOrder="6" Text="데이터조회이력" ToolTipText="조회" Top="3" Width="106"></Button>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust6300MDataConnectionDangerTankManage.xml
 * 설명 : 데이타 연계 위험물 운송자
 * 작성일 : 2010.08.10
 * 작성자 : 김민호
 */

#include "LIB::cust.js"; // 공통업무 관련

var menuId = "";	// 메뉴 아이디 
var setRow = "";	// 로우값 셋팅
var ORGNM = "";		// 기관명
/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
   gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    //폼 환경설정
  //  ls_SystemGubun = gs_SystemGubun;
  //  ls_SystemMenuId = gs_SystemMenuId;
    
    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
     //   lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
     //   lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }
    
    // 메뉴 아이디 
	menuId = gds_oLeftMenu.GetColumn(gds_oLeftMenu.currow,"MMENUID");

    // 소방서 
    ds_oFireHead.Copy("gds_oFireBonbuCode");		 				//소방본부 콤보세팅(청)
	ds_oFireCd.Copy("gds_oFireCode");  				 				//소방서 콤보세팅(청)
	ds_oFireCenterCd.Copy("gds_oFireCenterCode");    				//소방센터 콤보세팅(청)
	ds_oFireHead2.Copy("gds_oFireBonbuCode");		 				//소방본부 콤보세팅(안전원)
	ds_oFireCd2.Copy("gds_oFireCode");  				 			//소방서 콤보세팅(안전원)
	ds_oFireCenterCd2.Copy("gds_oFireCenterCode");    				//소방센터 콤보세팅(안전원)
	
	// 지부 
    gfn_SearchAllJibu(tab.page1.cbxKFJibu, "Y");           			// 지부 코드 조회(청)
    gfn_SearchAllJibu(tab.page2.cbxKFJibu, "Y");           			// 지부 코드 조회(안전원)
    tab.page2.cbxKFJibu.Value = tab.page1.cbxKFJibu.Value;

    // 콤보박스-지역
	tab_page1_cbxKFJibu_OnChanged("",tab.page1.cbxKFJibu.Value);//지역 코드 조회
    tab.page1.cbxKFRegion1.Index = 0;
    tab.page1.cbxKFRegion2.index = ds_oRegion.rowcount-1; 
    tab_page2_cbxKFJibu_OnChanged("",tab.page2.cbxKFJibu.Value);//지역 코드 조회
    tab.page2.cbxKFRegion1.Index = 0;
    tab.page2.cbxKFRegion2.index = ds_oRegion2.rowcount-1;
    
    
    // 소속지부 셋팅
    if (gds_oUserInfo.GetColumn(0, "PDEPTCD") > 1000) {
		var PDEPTCD = gds_oUserInfo.GetColumn(0, "PDEPTCD");
		if (ds_ioJibu.FindRow("CD", PDEPTCD) <> -1) {
			if(PDEPTCD <> tab.page1.cbxKFJibu.Value) {	
				tab.page1.cbxKFJibu.Value = PDEPTCD;	
				tab.page2.cbxKFJibu.Value = PDEPTCD;	
				lfn_JibuChange(tab.page1.cbxKFJibu.Value);	//지부변경	
			}
		}
		
		// 경기 북부는 경기로 .. 나머진 그대
		var chkPDEPTCD = "";      // 경기북부 경우 체크 
//		if (PDEPTCD == "1141") {
//			chkPDEPTCD = "1081";
//		} else {
			chkPDEPTCD = PDEPTCD;
//		}
		
		if(ds_oFireHead.FindRow("JIBUCD", chkPDEPTCD) <> -1) {
			ds_oFireHead.Filter("JIBUCD="+quote(chkPDEPTCD));
		} 
		
		if(ds_ioJibu.FindRow("CD", PDEPTCD) <> -1) {
			ds_ioJibu.Filter("CD="+quote(PDEPTCD));
		}
	}

	if (tab.page1.cbxMFHead.value == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}	
	
	//소방서 필터링
    var ctcd = ds_oFireHead.GetColumn(0,"CD"); 						// 기본값 인덱스 0번값 지정
    tab.page1.cbxMFHead.Value = ctcd;
    tab.page2.cbxMFHead.Value = ctcd;
    lfn_FilterFireStation(ctcd);

	// 청기준 연계관련버튼 처리
	tab.page1.btnMatch.Enable = false;
	tab.page1.btnMatchCancel.Enable = false;
	tab.page1.btnNewMatch.Enable = false;
	tab.page1.btnModMatch.Enable = false;
	
	// 안전원기준 연계관련버튼 처리
	tab.page2.btnMatch.Enable = false;
	tab.page2.btnMatchCancel.Enable = false;
	tab.page2.btnModMatch.Enable = false;
}


/*************************************************************************************************************
													청기준
**************************************************************************************************************/

/*============================================	소방청 정보=================================*/

/*
 * 기능 : 구분 기존, 신규 (기존 : 0, 신규 : 1)
*/
function tab_page1_radMFGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == 0) {
		tab.page1.lbMFDate.Text = "안전원수신일자";
		tab.page1.cbxMFStation.Index = 1;
		tab.page1.radMFGubun.BkColor = default;
	} else if (strCode == 1) {
		tab.page1.lbMFDate.Text = "신규등록일자";
		tab.page1.cbxMFStation.Index = 0;		
		tab.page1.medMFModDate1.Value = substr(GetDate(),0,6) + "01";
		tab.page1.medMFModDate2.Value = GetDate();
		tab.page1.radMFGubun.BkColor = "khaki";
	}
}

/*
	지역 선택시
*/
function cbxMFHead_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 청조회조건 변경시 안전원 조건 연동 
	lfn_SearchBalance("11");
	lfn_FilterFireStation(strCode);
	if (strCode == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}
}

/*
	소방 본부 선택시 본부 포함된 서센터 정보 필터링
*/
function lfn_FilterFireStation(sFilterGubun) {	
	ds_oFireCd.UnFilter();
	ds_oFireCenterCd.UnFilter();
	
	//  필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "CTCD='" + trim(sFilterGubun) + "'";
    }  

    ds_oFireCd.Filter(ls_FilterExpr);        
    ds_oFireCenterCd.Filter(ls_FilterExpr); 
   
    if( ds_oFireCd.FindRow("DATA", tab.page1.cbxMFStation.Text) == -1) {
		tab.page1.cbxMFStation.Text = "";
		tab.page2.cbxMFStation.Text = "";
    }
    
    if (ds_oFireCd.GetColumn(0,"DATA") == "전체") {
		ds_oFireCd.AddRow(0);
    } else {
		ds_oFireCd.InsertRow(0);
    }
	ds_oFireCd.SetColumn(0,"DATA","전체");
	ds_oFireCd.SetColumn(0,"CTCD",trim(sFilterGubun));    
	if (ds_oFireCenterCd.GetColumn(0,"DATA") == "전체") {
		ds_oFireCenterCd.AddRow(0);
    } else {
		ds_oFireCenterCd.InsertRow(0);
    }	
	ds_oFireCenterCd.SetColumn(0,"DATA","전체");
	ds_oFireCenterCd.SetColumn(0,"CTCD",trim(sFilterGubun));    
	
    tab.page1.cbxMFStation.Index = 1; 
    tab.page1.cbxMFCenter.Index = 0; 
    tab.page2.cbxMFStation.Index = 0; 
    tab.page2.cbxMFCenter.Index = 0; 
}

/*
	소방서 변경시 
*/
function cbxMFStation_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_FilterFireCenter(strCode);
}

/*
	소방서 선택시 소방서에 포함된 센터정보 필터링 
*/
function lfn_FilterFireCenter(sFilterGubun) {	
	ds_oFireCenterCd.UnFilter();
	
	// 필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "UPCD='" + trim(sFilterGubun) + "'";
    }    
    ds_oFireCenterCd.Filter(ls_FilterExpr);    
	if( ds_oFireCenterCd.FindRow("DATA", tab.page1.cbxMFCenter.Text) == -1) {
		tab.page1.cbxMFCenter.Text = "";
		tab.page2.cbxMFCenter.Text = "";
    }
    
    // 전체 항목 추가 
	if (ds_oFireCenterCd.GetColumn(0,"DATA") == "전체") {
		ds_oFireCenterCd.AddRow(0);
    } else {
		ds_oFireCenterCd.InsertRow(0);
    }	
    ds_oFireCenterCd.SetColumn(0,"DATA","전체");
    ds_oFireCenterCd.SetColumn(0,"CTCD",trim(sFilterGubun));     
    
    tab.page1.cbxMFCenter.Index = 0;    
    tab.page2.cbxMFCenter.Index = 0;    
}


/*
	청자료 조회 
*/
function lfn_MFSearch(obj)
{
	// 신규대상일 경우는 시작 날짜 체크 
	if (tab.page1.radMFGubun.Value == 1) {
		if (tab.page1.medMFModDate1.Value == "" || tab.page1.medMFModDate1.Value ==null) {
			alert("신규등록일자를 입력하세요.");
			tab.page1.medMFModDate1.SetFocus();
			return;
		}
	}
	
	/* 초기화 */	
	KfClear(); // 안전원 정보 초기화 
	lfn_MatchColor();  // 매칭 컬러 
	ds_ioMFFireObj.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD.ClearData(); // 데이타셋 초기화
	tab.page1.edMFMatch.Text = "";

    
	/* 값 설정 */
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page1.edMFKeyword.Text != "") {		
		if (tab.page1.chkMFPerson.Value == "1") {
			KEYWORD = "%"+tab.page1.edMFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page1.edMFKeyword.Text+"%";
		}
	}
	
	/* 서버 호출 */
	// SQL 
	tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6300MFDangerTank", false);

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObj=ds_oMFFireObj"	// outDs
		,"CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2))   
	   + " BONBUCD=" + quote(tab.page1.cbxMFHead.Value)
	   + " STATION=" + quote(tab.page1.cbxMFStation.Value)
	   + " CENTER=" + quote(tab.page1.cbxMFCenter.Value)
	   + " MODDATE1=" + quote(tab.page1.medMFModDate1.Value)
	   + " MODDATE2=" + quote(tab.page1.medMFModDate2.Value)
	   + " MSTATUS=" + quote(tab.page1.radMFSelectGubun.Value)
	   + " KEYFIELD=" + quote(tab.page1.cbxMFKeyfield.Value)
       + " KEYWORD=" + quote(KEYWORD)
       + " GUBUN=" + quote(tab.page1.radMFGubun.Value)
       + " ROWNUM=" + quote(tab.page1.spMFRowNum.value)  
		,"lfn_MFAfterSearch"
		,false
		,false
		,true
	);
}

/*
	fn_MFSearch 조회후
*/
function lfn_MFAfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 조회로그 남기기 
    // logWrite("1");
   
    // 총건수 
    tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
    
    // 연계제외 버튼 처리 
    lfn_MFMatchExceptBTN();
    
    //  청자료 상세조회 
    lfn_MFObjInfoSearch("0");

}

/*
	청 그리드 원클릭시 
*/
function tab_page1_gdMFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 안전원 정보 초기 화 
	KfClear();
	lfn_MatchColor();
	
	// 연계 제외 여부 버튼 처리 
	lfn_MFMatchExceptBTN(nRow);
	
	// 대상물 정보 ,선임자 조회 
	lfn_MFObjInfoSearch(nRow);
}

/*
	청 그리드 셀 더블 클릭시 
*/
function tab_page1_gdMFOBJList_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 안전원 정보 초기 화 
	KfClear();
	lfn_MatchColor();
	
	// 제외 여부 체크 
	if(ds_ioMFFireObj.GetColumn(nRow,"MSTATUS") == -1) {
		alert("제외 대상물입니다.");
		tab.page1.btnMatch.Enable = false;
		tab.page1.btnMatchCancel.Enable = false;
		tab.page1.btnNewMatch.Enable = false;
		tab.page1.btnModMatch.Enable = false;
		return;
	} else {
		tab.page1.btnMatch.Enable = true;
		tab.page1.btnMatchCancel.Enable = true;
		tab.page1.btnNewMatch.Enable = true;
		tab.page1.btnModMatch.Enable = true;
	}
	//  안전원데이타조회
	lfn_MatchData();
}

/*
	대상 및 탱크 상세 정보 조회 
*/
function lfn_MFObjInfoSearch(nRow)
{
	ds_ioMFFireObjD.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("cust:searchCust6300MFDangerTankD", false);

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObjD=ds_oMFFireObjD"	// outDs
		,"MNFCTRETCSN=" + quote(ds_ioMFFireObj.GetColumn(nRow,"MNFCTRETC_SN"))  
		 + " TANKSN=" + quote(ds_ioMFFireObj.GetColumn(nRow,"TANK_SN"))  
		 + " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2))
		,"lfn_MFFMAfterSearch"
		,false
		,false
		,true
	);
}

/*
	lfn_MFFireManagerSearch 조회후
*/
function lfn_MFFMAfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
   /* 
    if (ds_ioMFFireObjD.GetCount() > 0) {
		// 조회로그 남기기 
		detailLogWrite("M");
    }
    */
    
    // 연계 처리 관련버튼 처리
	lfn_AllMatchBTN();
    
    // 하단상세보기 연계 여부 값입력 
	if(ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "-1") {
		tab.page1.edMFMatch.Text = "제외";
	} else if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "0") {
		tab.page1.edMFMatch.Text = "X";
	} else if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") > 0){
		tab.page1.edMFMatch.Text = "○";
	} else {
		tab.page1.edMFMatch.Text = "";
	}	
	
	// 삭제된 정보 색 표기 	
	if (ds_ioMFFireObjD.GetColumn(0,"DELETE_AT") == "Y"
		|| ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "-1") {
		tab.page1.Shape4.BkColor = "darkgray";
	} else {
		tab.page1.Shape4.BkColor = "white";
	}
}

// 5 연계 제외 버튼 처리 
function lfn_MFMatchExceptBTN(nRow)
{
	var MSTATUS = "";
	if (nRow == "" || nRow == null) {
		MSTATUS = ds_ioMFFireObj.GetColumn(0,"MSTATUS");
	} else {
		MSTATUS = ds_ioMFFireObj.GetColumn(nRow,"MSTATUS");
	}	
	
	if (MSTATUS == 0) {
		tab.page1.btnMFMatchCancel.Visible = false;
		tab.page1.btnMFMatchExcept.Visible = true;
	} else if (MSTATUS == -1) {
		tab.page1.btnMFMatchCancel.Visible = true;
		tab.page1.btnMFMatchExcept.Visible = false;		
	} else if (MSTATUS > 0 ) {
		tab.page1.btnMFMatchCancel.Visible = false;
		tab.page1.btnMFMatchExcept.Visible = false;
	} else {
		tab.page1.btnMFMatchCancel.Visible = false;
		tab.page1.btnMFMatchExcept.Visible = false;
	}
}

/*
	연계 제외 처리 
*/
function lfn_MFMatchExcept(obj)
{
	/* 체크 */
	if(!gfn_Confirm("차량번호 '"+ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
	
	/* 초기화 */
	KfClear(); // 안전원 정보 초기 화 
	
	/* 파라미터 */
	var parValue = "GUBUN='1'";
		parValue += " MNFCTRETC_SN="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN"));
		parValue += " TANK_SN="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"TANK_SN"));
		parValue += " EXCEPTCD="+quote(arrNo[0]);
		parValue += " EXCEPTTXT="+quote(arrNo[1]);
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	/* 서버호출 */
	// SQL
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExcept"
		,false
		,false
		,true
	);
}

/*
	lfn_MFMatchCancel, fn_MFMatchExcept 조회후
*/
function lfn_AfterMFMatchExcept(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 연계제외처리후  상태값 변경*/     
    // 연계제외대상 상태 값 -1(연계제외)로 변경 
    ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radMFSelectGubun.Value == "1" || tab.page1.radMFSelectGubun.Value == "2") {	
    	setRow = ds_ioMFFireObj.currow;
		ds_ioMFFireObj.Filter("MSTATUS!='-1'"); // 연계제외대상 필터링 
		tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();  // 총 건수 변경
		ds_ioMFFireObj.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioMFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN(ds_ioMFFireObj.currow);
	
	/* 대상, 차량 상세 조회 */
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

// 5 연계 제외 취소 
function lfn_MFMatchExceptCancel(obj)
{
	/* 체크 */
	if(!gfn_Confirm("차량번호 '"+ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO") +"' 연계제외를 취소하시겠습니까?")) {	
		return;
	}
	
	/* 초기화 */
	KfClear();   // 안전원 정보 초기 화 
	
	/* 파라미터 */
	var parValue = "GUBUN='1'";
		parValue += " MNFCTRETC_SN="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN"));
		parValue += " TANK_SN="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"TANK_SN"));
		parValue += " EXCEPTCD="+quote(arrNo[0]);
		parValue += " EXCEPTTXT="+quote(arrNo[1]);
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	/* 서버 호출 */
	// SQL 
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchCancel"
		,false
		,false
		,true
	);
}

// 5 lfn_MFMatchCancel, fn_MFMatchExcept 조회후
function lfn_AfterMFMatchCancel(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
	/* 연계제외처리취소후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radMFSelectGubun.Value == "3") {		
		setRow = ds_ioMFFireObj.currow;
		ds_ioMFFireObj.Filter("MSTATUS=='-1'");  // 연계제외대상 필터링 
		tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();  // 총 건수 변경
		ds_ioMFFireObj.row = setRow;
	}	
	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioMFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN(ds_ioMFFireObj.currow);
	
	/* 대상,차량정보 상세조회  */
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);  
}
/*
	청조회 결과 엑셀 출력 
*/
function tab_page1_btnMFExcel_OnClick(obj)
{
	if (ds_ioMFFireObj.GetCount() > 0) {
		tab.page1.gdMFOBJList.ExportExcelEx("sheet1");
	}
}

/* 
	멀티 정렬을 실행한다.
function tab_page1_btnMFMutilSort_OnClick(obj)
{
	gfn_GridMultiSort(ds_ioMFFireObj, 1); 
}
*/

/*
	청시스템 상세보기 
*/
function tab_page1_btnFPISInfo_OnClick(obj)
{
	if (ds_ioMFFireObj.GetCount() > 0 ) {
		var parValue = "sCourse=80";
		parValue += " sCivilAppeal=1";
		parValue += " sBarCode=''";	
		parValue += " sMFPIS1_SN="+quote(ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " sMFPIS2_SN="+quote(ds_ioMFFireObjD.GetColumn(0,"TANK_SN"));
		parValue += " sCTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));		// 지역코드
				
		var arrNo = Dialog("cust::frmcust5010.xml", parValue, 800, 590, "", -1, -1);
	} else {
		alert("선택된 자료가 없습니다.");
		return;
	}
}


/*============================================	소방 안전원 정보  =================================*/

/*
	지부변경 지역목록
*/
function tab_page1_cbxKFJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
	lfn_JibuChange(strCode);
}

/*
	지부변경 지역목록
*/
function lfn_JibuChange(strCode)
{ 
	gfn_SearchCodeRegion(strCode, ds_oRegion, "0");	//지역 코드 조회
    tab.page1.cbxKFRegion1.Index = 0;
    tab.page1.cbxKFRegion2.index = ds_oRegion.rowcount-1;
    tab.page2.cbxKFRegion1.Index = 0;
    tab.page2.cbxKFRegion2.index = ds_oRegion.rowcount-1;
}

/*
	청조회 그리드(gdMFOBJList) 더블 클릭시 소방안전원 정보 조회 
*/
function lfn_MatchData()
{	

	// 대상물을 3글자 조회 
	var SEARCHBNM2 = ds_ioMFFireObjD.GetColumn(0,"DMSERCHNM");	
	SEARCHBNM2 = substr(SEARCHBNM2,0,3);
	
	// 파라미터값 
	var parValue = "";
	parValue = "JIBU="+quote(tab.page1.cbxKFJibu.Value); 										// 지부
	parValue += " REGION1="+quote(tab.page1.cbxKFRegion1.Value); 								// 지역1
	parValue += " REGION2="+quote(tab.page1.cbxKFRegion2.Value); 								// 지역2
	parValue += " MSTATUS="+quote(tab.page1.radKFSelectGubun.Value);							// 검색조건
	parValue += " ROWNUM="+quote(tab.page1.spKFRowNum.value);									// 조회수
	parValue += " DELUSER=1";																	// 삭제자 포함
	parValue += " GUBUN=1";																		// 검색구분 1: 청그리드 조회 , 2:안전원조회버튼
	parValue += " SEARCHBNM="+quote(ds_ioMFFireObjD.GetColumn(0,"DMSERCHNM"));					// 대상물명
	parValue += " SEARCHBNM2="+quote(SEARCHBNM2);												// 대상물명2 (3자)	
	parValue += " SEARCHDONGFNM="+quote(ds_ioMFFireObjD.GetColumn(0,"DMADDRDONGFNM"));			// 동풀네임
	parValue += " SEARCHDONGNM="+quote(ds_ioMFFireObjD.GetColumn(0,"DMADDRDONGNM"));			// 동
	parValue += " SEARCHMAINADDR="+quote(ds_ioMFFireObjD.GetColumn(0,"DMADDMAINNM"));			// 주번지
	parValue += " SEARCHSUBADDR="+quote(ds_ioMFFireObjD.GetColumn(0,"DMADDSUBNM"));				// 부번지
	parValue += " SEARCHROADNM="+quote(ds_ioMFFireObjD.GetColumn(0,"ROAD_NM"));					// 도로명
	parValue += " SEARCHMAINBDNBR="+quote(ds_ioMFFireObjD.GetColumn(0,"MAIN_BDNBR"));			// 건물번호(주)
	parValue += " SEARCHSECBDNBR="+quote(ds_ioMFFireObjD.GetColumn(0,"SEC_BDNBR"));				// 건물번호(부)	
	parValue += " SERCHCARNO="+quote(ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO"));					// 차량번호
	parValue += " SERCHPNO="+quote(ds_ioMFFireObjD.GetColumn(0,"PRMISN_NO"));					// 허가번호 
	
	// 이미 연계된 대상 
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") > 0) {
		parValue += " MMGNO="+quote(ds_ioMFFireObjD.GetColumn(0,"MMGNO"));
	}
	
	lfn_KFSearch(parValue);
}


/*
	안전원 버튼 조회시 
*/
function tab_page1_btnKFSearch_OnClick(obj)
{
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page1.edKFKeyword.Text != "") {		
		if (tab.page1.chkKFPerson.Value == "1") {
			KEYWORD = "%"+tab.page1.edKFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page1.edKFKeyword.Text+"%";
		}
	}
	
	// 파라미터값 
	var parValue = "";
		parValue = "JIBU="+quote(tab.page1.cbxKFJibu.Value); 										// 지부
		parValue += " REGION1="+quote(tab.page1.cbxKFRegion1.Value); 								// 지역1
		parValue += " REGION2="+quote(tab.page1.cbxKFRegion2.Value); 								// 지역2
		parValue += " MSTATUS="+quote(tab.page1.radKFSelectGubun.Value);							// 검색조건
		parValue += " ROWNUM="+quote(tab.page1.spKFRowNum.value);									// 조회수	
		parValue += " GUBUN=2";																		// 검색구분 1: 청그리드 조회 , 2:안전원조회버튼	
		parValue += " KEYFIELD="+quote(tab.page1.cbxKFKeyfield.Value);								// 키워드 구분
		parValue += " KEYWORD="+quote(KEYWORD);														// 키워드
		parValue += " DELUSER="+quote(tab.page1.chkKFDelUser.Value);								// 삭제자포함

	lfn_KFSearch(parValue);
}


/*
	안전원정보조회
*/
function lfn_KFSearch(parValue)
{	
	/* 초기화 */
	ds_ioKFFireObj.ClearData(); // 데이타셋 초기화
	tab.page1.edKFMatch.Text = "";
	tab.page1.edKFCount.Text = "";

	/* 서버호출 */
	// SQL 
    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6300KFFireObj", false);	

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioKFFireObj=ds_oKFFireObj"	// outDs
		,parValue
		,"lfn_KFAfterSearch"
		,false
		,false
		,true
	);	
}

/*
	lfn_KFSearch 조회후
*/ 
function lfn_KFAfterSearch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 안전원정보 조회 후 처리 */
    // 연계관련 버튼 처리 
	lfn_AllMatchBTN("0");
	
    // 제외버튼처리 
    lfn_KFMatchExceptBTN();
    
    /* 안전원정보 조회 후 상태값 변경 */
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus("0");
	// 조회 건수 
    tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();
    // 매칭 컬러 
    lfn_MatchColor(0, "ON");    
}

/*
	안전원  클릭시 
*/
function tab_page1_gdKFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 제외버튼처리 
	lfn_KFMatchExceptBTN(nRow);
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus(nRow);
	// 매칭 데이타 비교
	lfn_MatchColor(nRow, "ON");
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(nRow);
}

// 4 연계 버튼 처리 
function lfn_KFMatchExceptBTN(nRow)
{
	var RFLAGEE = "";
	if (nRow == "" || nRow == null) {
		RFLAGEE = ds_ioKFFireObj.GetColumn(0,"RFLAGEE");
	} else {
		RFLAGEE = ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE");
	}
	
	if (RFLAGEE == "0") {
		tab.page1.btnKFMatchCancel.Visible = false;
		tab.page1.btnKFMatchExcept.Visible = true;
	} else if (RFLAGEE == "-1") {
		tab.page1.btnKFMatchCancel.Visible = true;
		tab.page1.btnKFMatchExcept.Visible = false;
	} else if (RFLAGEE > 0) {
		tab.page1.btnKFMatchCancel.Visible = false;
		tab.page1.btnKFMatchExcept.Visible = false;
	} else {
		tab.page1.btnKFMatchCancel.Visible = false;
		tab.page1.btnKFMatchExcept.Visible = false;
	}
}

/*
	연계  제외 처리 
*/
function lfn_KFMatchExcept(obj)
{	
	/* 체크 사항 */
	if(!gfn_Confirm("차량번호 '"+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TCARNO") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
	
	var parValue = "GUBUN='2'";
		parValue += " TBMGNO="+quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TBMGNO"));
		parValue += " TSEQ="+quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TSEQ"));
		parValue += " EXCEPTCD="+quote(arrNo[0]);
		parValue += " EXCEPTTXT="+quote(arrNo[1]);
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    , parValue
		,"lfn_AfterKFMatchExcept"
		,false
		,false
		,true
	);
}

/*
	lfn_KFMatchCancel, lfn_KFMatchExcept 조회후
*/
function lfn_AfterKFMatchExcept(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    /* 연계제외처리후  상태값 변경*/     
	// 연계제외대상 상태 값 -1(연계제외)로 변경 
	ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radKFSelectGubun.Value == "1" || tab.page1.radKFSelectGubun.Value == "2") {		
		setRow = ds_ioKFFireObj.currow;
		ds_ioKFFireObj.Filter("RFLAGEE!='-1'"); // 연계제외대상 필터링 
		tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();  // 총 건수 변경
		ds_ioKFFireObj.row = setRow;
	}
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioKFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN(ds_ioKFFireObj.currow);
		
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus(ds_ioKFFireObj.currow);
}

/*
	연계 제외 취소 
*/
function lfn_KFMatchExceptCancel(obj)
{	
	/* 체크사항 */
	if(!gfn_Confirm("차량번호 '"+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TCARNO") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	var parValue = "GUBUN='2'";
		parValue += " TBMGNO="+quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TBMGNO"));
		parValue += " TSEQ="+quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TSEQ"));
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterKFMatchExceptCancel"
		,false
		,false
		,true
	);
}

/*
	lfn_KFMatchCancel, lfn_KFMatchExcept 조회후
*/
function lfn_AfterKFMatchExceptCancel(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    /* 연계제외처리취소후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page1.radKFSelectGubun.Value == "3") {
		setRow = ds_ioKFFireObj.currow;
		ds_ioKFFireObj.Filter("RFLAGEE=='-1'");	// 연계제외대상 필터링 
		tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();  // 총 건수 변경
		ds_ioKFFireObj.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN(ds_ioKFFireObj.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN(ds_ioKFFireObj.currow);
	
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus();
}

/*
	신규 연계
*/
function btnNewMatch_OnClick(obj) {
	/* 체크 사항 */
	// 청
	if (ds_ioMFFireObjD.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}		
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "1") {
		alert(ORGNM + " 연계된 대상입니다.");
		return;
	}
	lfn_Match("I");
}

/*
	수정 연계
*/
function btnModMatch_OnClick(obj) {
	/* 체크 사항 */
	/// 청
	if (ds_ioMFFireObjD.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}		
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "1") {
		alert(ORGNM + " 연계된 대상입니다.");
		return;
	}
	
	// 안전원 
	if (ds_ioKFFireObj.GetCount() < 1) {
		alert("[한국소방안전원] 연계할 대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE") > 0 ) {
		alert("[한국소방안전원] 연계된 대상입니다.");
		return;
	}
	lfn_Match("U");
}

/*
	연계 창 오픈  
*/
function lfn_Match(mode)
{
	var sStatus = mode;
	var sMNFCTRETC_SN = "";
	var sTANK_SN = "";
	var sCMGNO = "";
	var sBMGNO = "";
	var sTSEQ = "";

	// 연계모드 설정
	if (sStatus == "U") {
		sCMGNO = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO");
		sBMGNO = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TBMGNO");
		sTSEQ = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TSEQ");
	}
	
	//  제조소등 관리번호 설정
	sMNFCTRETC_SN = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN");
	sTANK_SN = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"TANK_SN");
	
	
	        
	// 파라미터값 설정 
 	var parValue = "sStatus=" + quote(sStatus); // 연계모드(I : 신규 , U : 수정 )
	parValue += " sMNFCTRETC_SN=" + quote(sMNFCTRETC_SN); // 제조소등관리번호 
	parValue += " sTANK_SN=" + quote(sTANK_SN); // 제조소등관리번호 
	parValue += " sCMGNO=" + quote(sCMGNO);  // 안전원고객관리번호
	parValue += " sBMGNO=" + quote(sBMGNO);  // 빌딩관리번호
	parValue += " sTSEQ=" + quote(sTSEQ);    // 차량 SEQ
	parValue += " sJIBU=" + quote(tab.page1.cbxKFJibu.Value);
	parValue += " sCTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	if (mode == "I") {
		var arrNo = Dialog("cust::frmcust6301PDataConnectionTankManageNewSave.xml", parValue , 800, 700, "", -1, -1);
	} else {
		var arrNo = Dialog("cust::frmcust6301PDataConnectionTankManageOldSave.xml", parValue , 800, 700, "", -1, -1);
	}
	
	
	// 변경, 수정이 된경우 
	if (arrNo == "I") {
		// 매치후 처리 
		lfn_MatchAfter(arrNo);
		// 안전원정보 상태값 변경 
		lfn_KFViewStatus();
	} else if(arrNo == "U"){
		// 매치후 처리 
		lfn_MatchAfter(arrNo);
	}
	
	lfn_MatchData();
	
}

/*
	안전원 조회 결과 엑셀 출력 
*/
function tab_page1_btnKFExcel_OnClick(obj)
{
	if (ds_ioKFFireObj.GetCount() > 0) {
		tab.page1.gdKFOBJList.ExportExcelEx("sheet1");
	}	
}

/*
	7 멀티 정렬을 실행한다.

function tab_page1_btnKFMutilSort_OnClick(obj)
{
	gfn_GridMultiSort(ds_ioKFFireObj, 1); 
}
*/

/*
	즉시 연계 처리 
*/
function lfn_NowMatch(obj)
{  
	/* 체크 사항 */
	/// 청
	if (ds_ioMFFireObjD.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}		
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == "1") {
		alert(ORGNM + " 연계된 대상입니다.");
		return;
	}
	
	// 안전원 
	if (ds_ioKFFireObj.GetCount() < 1) {
		alert("[한국소방안전원] 연계할 대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE") > 0 ) {
		alert("[한국소방안전원] 연계된 대상입니다.");
		return;
	}
			
	var meg = "        " + ORGNM + " 차량번호 : "+ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO") +"\n";
	meg += "     [한국소방안전원] 차량번호 : "+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TCARNO") +"\n";
	meg +="   연계 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}	

	
	/* 파라미터 값 */
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " MFPIS2=" + quote(ds_ioMFFireObjD.GetColumn(0,"TANK_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TBMGNO"));
		parValue += " MKFSAPK2=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TSEQ"));
		parValue += " FIRECD=" + quote(ds_ioMFFireObjD.GetColumn(0,"CMPN119SCID"));
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
		//parValue += " DPERMISSIONNO=" + quote(ds_ioMFFireObjD.GetColumn(0,"PRMISN_NO"));
		//parValue += " DREMARK=" + quote("설치(변경)허가번호 : " + ds_ioMFFireObjD.GetColumn(0,"ITL_NO"));
	
	/* 서버 호출 */
	// SQL
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:insertCust6300Match", "", 0, "");     // 매치테이블

	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterNowMatch"
		,false
		,false
		,true
	);
}

/*
	lfn_NowMatch 처리 후 
*/
function lfn_AfterNowMatch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter("U");
	
	/* 조회 */
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow); // 업체, 기술자 정보 조회 
    lfn_MatchData(); // 안전원정보조회 (청 더블 클릭 조회 )
    
    /* 메세지 */
    alert("연계가 완료되었습니다."); 
}


// 안전원정보 상태값변경 
function lfn_KFViewStatus(nRow){
	if (nRow == "" || nRow = null){
		nRow = ds_ioKFFireObj.currow;
	}
	
	// 하단상세보기 연계 여부 값입력 
	if(ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page1.edKFMatch.Text = "제외";
	} else if (ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == "0") {
		tab.page1.edKFMatch.Text = "X";
	} else if (ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") > 0){
		tab.page1.edKFMatch.Text = "○";
	} else {
		tab.page1.edKFMatch.Text = "";
	}
	
	/* 안전원정보 조회 후 상세보기 배경색 변경 */
    // 삭제된 정보 색 표기 	
	if (ds_ioKFFireObj.GetColumn(nRow,"DELGUBUN") == "삭제" || ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page1.Shape2.BkColor = "darkgray";
		tab.page1.Shape3.BkColor = "darkgray";
	} else {
		tab.page1.Shape2.BkColor = "white";
		tab.page1.Shape3.BkColor = "white";
	}
}

/*
	연계해지  처리 
*/
function lfn_CancelMatch(obj)
{  
	
	/* 체크사항 */
	// 청
	if (ds_ioMFFireObjD.GetCount() < 1) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioMFFireObjD.GetColumn(0,"MSTATUS") != "1") {
		alert(ORGNM + " 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 안전원 
	if (ds_ioKFFireObj.GetCount() < 1) {
		alert("[한국소방안전원] 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE") < 1 ) {
		alert("[한국소방안전원] 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 연계 대상 확인 
	if (ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"MMGNO") != ds_ioMFFireObjD.GetColumn(0,"MMGNO")) {
		alert("잘못된 연계대상입니다.");
		return;
	}

	var meg = "        " + ORGNM + " 차량번호 : "+ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO") +"\n";
	meg += "     [한국소방안전원] 차량번호 : "+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TCARNO") +"\n";
	meg +="   연계해지 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}
	
	// 연계해지 사유 
	var cancelReason = Dialog("cust::frmcust5011.xml", "", 520, 188, "", -1, -1);	
	if (cancelReason == "" || cancelReason == null) {
		alert("연계 사유를 입력해 주세요");
		return;
	}
	
	
	
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " MFPIS2=" + quote(ds_ioMFFireObjD.GetColumn(0,"TANK_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TBMGNO"));
		parValue += " MKFSAPK2=" + quote(ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"TSEQ"));
		parValue += " MMGNO=" + quote(ds_ioMFFireObjD.GetColumn(0,"MMGNO"));
		parValue += " MDELREMARK=" + quote(cancelReason);
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		parValue += " MGUBUN='1'";   // 허가번호 처리 구분
		parValue += " CTCD=" + quote(substr(tab.page1.cbxMFHead.Value,0,2));
	
	/* 서버호출 */
	// SQL
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchCancel", "", 0, "");     // 연계취소 
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterCancelMatch"
		,false
		,false
		,true
	);
}

/*
	lfn_CancelMatch 처리 후 
*/
function lfn_AfterCancelMatch(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter("C");

	/* 조회 */
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow); // 업체, 기술자 정보 조회 
    lfn_MatchData(); // 안전원정보조회 (청 더블 클릭 조회 )
    
    alert("연계해지가 완료되었습니다.");
    
}


/*============================================	연계후 처리   =================================*/

function lfn_MatchAfter(mode) {
	if (mode == "I") {
		var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
		var MANAGERMATCHCNT = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MANAGERMATCHCNT");
		
		MFSTATUS++;
		
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
	
		// 필터링
		if(tab.page1.radMFSelectGubun.Value == "1" || tab.page1.radMFSelectGubun.Value == "3") {
			setRow = ds_ioMFFireObj.currow;
			ds_ioMFFireObj.Filter("MSTATUS1!='1'");
			tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
			ds_ioMFFireObj.row = setRow;
		}		
	} else if (mode == "U") {
		var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
		var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
		
		MFSTATUS++;
		KFSTATUS++;
		
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
		ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);
	
		// 필터링
		if(tab.page1.radMFSelectGubun.Value == "1" || tab.page1.radMFSelectGubun.Value == "3") {
			setRow = ds_ioMFFireObj.currow;
			ds_ioMFFireObj.Filter("MSTATUS!='1'");
			tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
			ds_ioMFFireObj.row = setRow;
		}
		
		if(tab.page1.radKFSelectGubun.Value == "1" || tab.page1.radKFSelectGubun.Value == "3") {
			setRow = ds_ioKFFireObj.currow;
			ds_ioKFFireObj.Filter("RFLAGEE>='1'");
			tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();
			ds_ioKFFireObj.row = setRow;
		}

	} else if (mode == "C") {
		// 상태값 
		var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
		var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
		
		// 감소
		MFSTATUS--;
		KFSTATUS--;
		
		// 적용 
		ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
		ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);	
	
		// 필터링
		if(tab.page1.radMFSelectGubun.Value == "2" || tab.page1.radMFSelectGubun.Value == "3") {
			setRow = ds_ioMFFireObj.currow;
			ds_ioMFFireObj.Filter("MSTATUS=='1'");
			tab.page1.edMFCount.Text = ds_ioMFFireObj.GetCount();
			ds_ioMFFireObj.row = setRow;
		}
		
		if(tab.page1.radKFSelectGubun.Value == "2" || tab.page1.radKFSelectGubun.Value == "3") {
			setRow = ds_ioKFFireObj.currow;
			ds_ioKFFireObj.Filter("RFLAGEE=='0'");
			tab.page1.edKFCount.Text = ds_ioKFFireObj.GetCount();
			ds_ioKFFireObj.row = setRow;
		}
	}
	
	// 매치후 처리 
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}


/*============================================	조건 처리   =================================*/

function lfn_MatchCancelAfter() {
	var MFSTATUS = ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS");
	var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
	
	MFSTATUS--;
	KFSTATUS--;
	ds_ioMFFireObj.SetColumn(ds_ioMFFireObj.currow,"MSTATUS",MFSTATUS);
	ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);
	
	// 필터링
	if(tab.page1.radMFSelectGubun.Value == "1") {
		setRow = ds_ioMFFireObj.currow;
		ds_ioMFFireObj.Filter("MNFCTRETC_SN!="+quote(ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MNFCTRETC_SN")));
		ds_ioMFFireObj.row = setRow;
	}
	
	
	if(tab.page1.radKFSelectGubun.Value == "1") {
		setRow = ds_ioKFFireObj.currow;
		ds_ioKFFireObj.Filter("CMGNO!="+ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"CMGNO"));
		ds_ioKFFireObj.row = setRow;
	}
	
	// 매치후 처리 
	lfn_MFObjInfoSearch(ds_ioMFFireObj.currow);
}

// 청 조회조건변경(연계구분)
function tab_page1_radMFSelectGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance("12");
}

// 청 조회조건변경 (공공기관)
function tab_page1_cbxMFPBLINSTT_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance("14");
}


function lfn_SearchBalance(gubun){
	if (gubun == "11") {		
		var row = ds_oFireHead.FindRow("CD", tab.page1.cbxMFHead.Value);
		tab.page1.cbxKFJibu.Value = ds_oFireHead.GetColumn(row,"JIBUCD");
		lfn_JibuChange(tab.page1.cbxKFJibu.Value);
	} else if (gubun == "12") {
		tab.page1.radKFSelectGubun.Value = tab.page1.radMFSelectGubun.Value;
	} else if (gubun == "14") {
		
	}
}

/*============================================	연계 처리 버튼   =================================*/

function lfn_AllMatchBTN(nRow) {
	var MRow = "";
	var KRow = "";	
	if (ds_ioMFFireObjD.GetCount() > 0) { MRow = ds_ioMFFireObjD.currow;}
	if (ds_ioKFFireObj.GetCount() > 0) { KRow = ds_ioKFFireObj.currow; }
	
	// 기본
	tab.page1.btnMatchCancel.Enable = false;
	tab.page1.btnMatch.Enable = false;
	tab.page1.btnNewMatch.Enable = false;
	tab.page1.btnModMatch.Enable = false;
	
	// 연계해지 버튼 활성화 
	if (
		ds_ioMFFireObjD.GetColumn(0,"MSTATUS") > 0 	
		&& ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") > 0
		&& (ds_ioMFFireObjD.GetColumn(0,"MMGNO") == ds_ioKFFireObj.GetColumn(nRow,"MMGNO"))
	   )
	{
		tab.page1.btnMatchCancel.Enable = true;
	} else {
		tab.page1.btnMatchCancel.Enable = false;
	}
	
	// 수정없이 연계처리 활성화 , 수정연계 
	if (
		ds_ioMFFireObjD.GetColumn(0,"MSTATUS") == 0 		
		&& ds_ioKFFireObj.GetColumn(nRow,"RFLAGEE") == 0
	   )
	{
		tab.page1.btnMatch.Enable = true;
		tab.page1.btnModMatch.Enable = true;
	} else {
		tab.page1.btnMatch.Enable = false;
		tab.page1.btnModMatch.Enable = false;
	}
	
	// 신규연계등록
	if (
		ds_ioMFFireObj.GetCount() > 0
		&& ds_ioMFFireObj.GetColumn(ds_ioMFFireObj.currow,"MSTATUS") == 0		
	   )
	{
		tab.page1.btnNewMatch.Enable = true;
	} else {
		tab.page1.btnNewMatch.Enable = false;
	}
}

/*============================================	매칭 컬러 처리    =================================*/

function lfn_MatchColor(nRow, mode) {
	if (mode == "ON") {
	
		// 대상물
		var SEARCHBNM = ds_ioMFFireObjD.GetColumn(0,"DMSERCHNM");
		var BNM = substr(ds_ioKFFireObj.GetColumn(nRow,"BSEARCHNM"),0,length(SEARCHBNM));
		
		SEARCHBNM = trim(SEARCHBNM);
		BNM = trim(BNM);
		
		if (SEARCHBNM == BNM) {
			if (SEARCHBNM == null || SEARCHBNM = "") {
				tab.page1.edMFOBJ_NM.BKColor = "white";
				tab.page1.edKFBNM.BKColor = "white";
			} else {
				tab.page1.edMFOBJ_NM.BKColor = "lightskyblue";
				tab.page1.edKFBNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFOBJ_NM.BKColor = "white";
			tab.page1.edKFBNM.BKColor = "white";
		}
		
		
		// 동명(풀네임)
		var SEARCHDONGFNM = ds_ioMFFireObjD.GetColumn(0,"DMADDRDONGFNM");
		var BADDRDONGFNM = ds_ioKFFireObj.GetColumn(nRow,"TADDRDONGFNM");
		
		SEARCHDONGFNM = trim(SEARCHDONGFNM);
		BADDRDONGFNM = trim(BADDRDONGFNM);
		
		if (SEARCHDONGFNM == BADDRDONGFNM) {
			if (SEARCHDONGFNM == null || SEARCHDONGFNM = "") {
				tab.page1.edMFFDong.BKColor = "white";
				tab.page1.edKFFDong.BKColor = "white";
			} else {
				tab.page1.edMFFDong.BKColor = "lightskyblue";
				tab.page1.edKFFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFFDong.BKColor = "white";
			tab.page1.edKFFDong.BKColor = "white";
		}
		
		
		// 동명(숏네임)
		var SEARCHDONGNM = ds_ioMFFireObjD.GetColumn(0,"DMADDRDONGNM");
		var BADDRDONGNM = ds_ioKFFireObj.GetColumn(nRow,"TADDRDONGNM");
		
		SEARCHDONGNM = trim(SEARCHDONGNM);
		BADDRDONGNM = trim(BADDRDONGNM);
		
		if (SEARCHDONGNM == BADDRDONGNM) {
			if (SEARCHDONGNM == null || SEARCHDONGNM = "") {
				tab.page1.edMFDong.BKColor = "white";
				tab.page1.edKFDong.BKColor = "white";
			} else {
				tab.page1.edMFDong.BKColor = "lightskyblue";
				tab.page1.edKFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFDong.BKColor = "white";
			tab.page1.edKFDong.BKColor = "white";
		}
		
		
		// 주번지
		var SEARCHMAINADDR = ds_ioMFFireObjD.GetColumn(0,"DMADDMAINNM");
		var BADDRMAINNM = ds_ioKFFireObj.GetColumn(nRow,"TADDRMAINNM");
		
		SEARCHMAINADDR = trim(SEARCHMAINADDR);
		BADDRMAINNM = trim(BADDRMAINNM);
		
		if (SEARCHMAINADDR == BADDRMAINNM) {
			if (SEARCHMAINADDR == null || SEARCHMAINADDR = "") {
				tab.page1.edMFMainAddr.BKColor = "white";
				tab.page1.edKFMainAddr.BKColor = "white";
			} else {
				tab.page1.edMFMainAddr.BKColor = "lightskyblue";
				tab.page1.edKFMainAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFMainAddr.BKColor = "white";
			tab.page1.edKFMainAddr.BKColor = "white";
		}
		
		
		// 부번지
		var SEARCHSUBADDR = ds_ioMFFireObjD.GetColumn(0,"DMADDSUBNM");
		var BADDRSUBNM = ds_ioKFFireObj.GetColumn(nRow,"TADDRSUBNM");
		
		SEARCHSUBADDR = trim(SEARCHSUBADDR);
		BADDRSUBNM = trim(BADDRSUBNM);
		
		if (SEARCHSUBADDR == BADDRSUBNM) {
			if (SEARCHSUBADDR == null || SEARCHSUBADDR = "") {
				tab.page1.edMFSubAddr.BKColor = "white";
				tab.page1.edKFSubAddr.BKColor = "white";
			} else {
				tab.page1.edMFSubAddr.BKColor = "lightskyblue";
				tab.page1.edKFSubAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFSubAddr.BKColor = "white";
			tab.page1.edKFSubAddr.BKColor = "white";
		}

		// 도로명
		var SEARCHROADNM = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"ROAD_NM");
		var BROADNM = ds_ioKFFireObj.GetColumn(nRow,"RROADNM");
		
		SEARCHROADNM = trim(SEARCHROADNM);
		BROADNM = trim(BROADNM);

		if (SEARCHROADNM == BROADNM) {
			if (SEARCHROADNM == null || SEARCHROADNM = "") {
				tab.page1.edMFRoadNM.BKColor = "white";
				tab.page1.edKFRoadNM.BKColor = "white";
			} else {
				tab.page1.edMFRoadNM.BKColor = "lightskyblue";
				tab.page1.edKFRoadNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFRoadNM.BKColor = "white";
			tab.page1.edKFRoadNM.BKColor = "white";
		}		
		
	
		// 건물번호1
		var SEARCHMAINNO = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"MAIN_BDNBR");
		var BMAINNO = ds_ioKFFireObj.GetColumn(nRow,"RBUILDMAINNO");
		
		SEARCHMAINNO = trim(SEARCHMAINNO);
		BMAINNO = trim(BMAINNO);
		
		if (SEARCHMAINNO == BMAINNO) {
			if (SEARCHMAINNO == null || SEARCHMAINNO = "") {
				tab.page1.edMFMainNO.BKColor = "white";
				tab.page1.edKFMainNO.BKColor = "white";
			} else {
				tab.page1.edMFMainNO.BKColor = "lightskyblue";
				tab.page1.edKFMainNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFMainNO.BKColor = "white";
			tab.page1.edKFMainNO.BKColor = "white";
		}		
		
		// 건물번호2
		var SEARCHSUBNO = ds_ioMFFireObjD.GetColumn(ds_ioMFFireObjD.currow,"SEC_BDNBR");
		var BSUBNO = ds_ioKFFireObj.GetColumn(nRow,"RBUILDSUBNO");
		
		SEARCHSUBNO = trim(SEARCHSUBNO);
		BSUBNO = trim(BSUBNO);
		
		if (SEARCHSUBNO == BSUBNO) {
			if (SEARCHSUBNO == null || SEARCHSUBNO = "") {
				tab.page1.edMFSubNO.BKColor = "white";
				tab.page1.edKFSubNO.BKColor = "white";
			} else {
				tab.page1.edMFSubNO.BKColor = "lightskyblue";
				tab.page1.edKFSubNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFSubNO.BKColor = "white";
			tab.page1.edKFSubNO.BKColor = "white";
		}	
		
		
		// 차량번호
		var MCARNO = ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO");
		var KCARNO = ds_ioKFFireObj.GetColumn(nRow,"TCARNO");
		
		MCARNO= trim(MCARNO);
		KCARNO = trim(KCARNO);
				
		if (MCARNO  == KCARNO) {
			if (MCARNO == null || MCARNO = "") {
				tab.page1.edMFVHCLE_NO.BKColor = "white";
				tab.page1.edKFTCARNO.BKColor = "white";
			} else {
				tab.page1.edMFVHCLE_NO.BKColor = "lightskyblue";
				tab.page1.edKFTCARNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFVHCLE_NO.BKColor = "white";
			tab.page1.edKFTCARNO.BKColor = "white";
		}
		
		
		// 허가번호
		var MPNO = ds_ioMFFireObjD.GetColumn(0,"PRMISN_NO");
		var KPNO = ds_ioKFFireObj.GetColumn(nRow,"TPERMISSIONNO");
		
		MPNO = trim(MPNO);
		KPNO = trim(KPNO);
		
		if (MPNO == KPNO) {
			if (MPNO == null || MPNO = "") {
				tab.page1.edMFPRMISN_NO.BKColor = "white";
				tab.page1.edKFTPERMISSIONNO.BKColor = "white";
			} else {
				tab.page1.edMFPRMISN_NO.BKColor = "lightskyblue";
				tab.page1.edKFTPERMISSIONNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page1.edMFPRMISN_NO.BKColor = "white";
			tab.page1.edKFTPERMISSIONNO.BKColor = "white";
		}
		
	} else {
		tab.page1.edMFOBJ_NM.BKColor = "white";
		tab.page1.edKFBNM.BKColor = "white";
		tab.page1.edMFFDong.BKColor = "white";
		tab.page1.edKFFDong.BKColor = "white";
		tab.page1.edMFDong.BKColor = "white";
		tab.page1.edKFDong.BKColor = "white";
		tab.page1.edMFMainAddr.BKColor = "white";
		tab.page1.edKFMainAddr.BKColor = "white";
		tab.page1.edMFSubAddr.BKColor = "white";
		tab.page1.edKFSubAddr.BKColor = "white";
		tab.page1.edMFRoadNM.BKColor = "white";
		tab.page1.edKFRoadNM.BKColor = "white";
		tab.page1.edMFMainNO.BKColor = "white";
		tab.page1.edKFMainNO.BKColor = "white";
		tab.page1.edMFSubNO.BKColor = "white";
		tab.page1.edKFSubNO.BKColor = "white";
		tab.page1.edMFPRMISN_NO.BKColor = "white";
		tab.page1.edKFTPERMISSIONNO.BKColor = "white";
		tab.page1.edMFVHCLE_NO.BKColor = "white";
		tab.page1.edKFTCARNO.BKColor = "white";
	}	
}

/*============================================	엔터키    =================================*/
					
function tab_page1_edMFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) { // Enter Key
		lfn_MFSearch();
	}
}

function tab_page1_edKFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) { // Enter Key
		tab_page1_btnKFSearch_OnClick();
	}
}


/*************************************************************************************************************
													안전원기준 
**************************************************************************************************************/

/*============================================	소방 안전 안전원=================================*/
/*
	지부 변경시
*/
function tab_page2_cbxKFJibu_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance2("11");
	lfn_JibuChange2(strCode);
}

/*
	지부변경 지역목록
*/
function lfn_JibuChange2(strCode)
{ 
	gfn_SearchCodeRegion(strCode, ds_oRegion2, "0");	//지역 코드 조회
    tab.page2.cbxKFRegion1.Index = 0;
    tab.page2.cbxKFRegion2.index = ds_oRegion2.rowcount-1;
}

// 안전원정보 그리드 원클릭!
function tab_page2_gdKFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	// 청조회정보초기화 
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.edMFCount.Text = "";
	
	// 제외버튼처리 
	lfn_KFMatchExceptBTN2(nRow);
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus2(nRow);
	// 매칭 데이타 비교
	lfn_MatchColor2();
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(nRow);
}

/*
	안전원자료 더블 클릭시 
*/
function tab_page2_gdKFOBJList_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	/* 초기화 */	
	ds_ioMFFireObjD2.ClearData();
	ds_ioMFFireObj2.ClearData();
	tab.page2.edMFCount.Text = "";
	lfn_MatchColor2();  // 매칭 컬러 초기화 
	
	/* 체크 사항 */
	// 제외 여부 체크 
	if(ds_ioMFFireObj2.GetColumn(nRow,"MSTATUS") == -1) {
		alert("제외 대상물입니다.");
		tab.page2.btnMatch.Enable = false;
		tab.page2.btnMatchCancel.Enable = false;
		tab.page2.btnNewMatch.Enable = false;
		tab.page2.btnModMatch.Enable = false;
		return;
	} 
	
	lfn_MatchData2();
}

/*
	안전원자료 파라미터 값 
*/
function lfn_MatchData2() {
	// 대상물을 3글자 조회 
	var SEARCHBNM2 = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BSEARCHNM");	
		SEARCHBNM2 = substr(SEARCHBNM2,0,3);
	
		// 파라미터값 
	var parValue = "CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));
		parValue += " BONBUCD=" + quote(tab.page2.cbxMFHead.Value);				// 본부코드
		parValue += " STATION=" + quote(tab.page2.cbxMFStation.Value);
		parValue += " CENTER=" + quote(tab.page2.cbxMFCenter.Value);
		parValue += " MODDATE1=" + quote(tab.page2.medMFModDate1.Value);
		parValue += " MODDATE2=" + quote(tab.page2.medMFModDate2.Value);
		parValue += " MSTATUS=" + quote(tab.page2.radMFSelectGubun.Value);
		parValue += " ROWNUM=" + quote(tab.page2.spMFRowNum.Value);
		parValue += " GUBUN=1";
		parValue += " SEARCHBNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BSEARCHNM"));					// 대상물명
		parValue += " SEARCHBNM2="+quote(SEARCHBNM2);											// 대상물명2 (3자)	
		parValue += " SEARCHDONGFNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRDONGFNM"));			// 동풀네임
		parValue += " SEARCHDONGNM="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRDONGNM"));			// 동
		parValue += " SEARCHMAINADDR="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRMAINNM"));		// 주번지
		parValue += " SEARCHSUBADDR="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRSUBNM"));			// 부번지
		parValue += " SERCHCARNO="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TCARNO"));				// 차량번호
		parValue += " SERCHPNO="+quote(substr(replace(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TPERMISSIONNO"), "-", ""),0,7));	// 허가번호
	
	// 연계된 대상인 경우
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") > 0) {
		parValue += " MMGNO="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"MMGNO"));
	}		
	
	lfn_MFSearch2(parValue);

}

/*
	안전원조회
*/
function lfn_KFSearch2()
{	
	/* 초기화 */
	ds_ioKFFireObj2.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObj2.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD2.ClearData(); // 데이타셋 초기화
	tab.page2.edKFMatch.Text = "";
	tab.page2.edMFMatch.Text = "";
    lfn_MatchColor2();  
	
	
	/* 파리미터값 */
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page2.edKFKeyword.Text != "") {		
		if (tab.page2.chkKFPerson.Value == "1") {
			KEYWORD = "%"+tab.page2.edKFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page2.edKFKeyword.Text+"%";
		}
	}
	
	// 파라미터값 
	var parValue = "";
		parValue = "JIBU="+quote(tab.page2.cbxKFJibu.Value); 										// 지부
		parValue += " REGION1="+quote(tab.page2.cbxKFRegion1.Value); 								// 지역1
		parValue += " REGION2="+quote(tab.page2.cbxKFRegion2.Value); 								// 지역2
		parValue += " MSTATUS="+quote(tab.page2.radKFSelectGubun.Value);							// 검색조건
		parValue += " ROWNUM="+quote(tab.page2.spKFRowNum.value);									// 조회수			
		parValue += " KEYFIELD="+quote(tab.page2.cbxKFKeyfield.Value);								// 키워드 구분
		parValue += " KEYWORD="+quote(KEYWORD);														// 키워드
		parValue += " DELUSER="+quote(tab.page2.chkKFDelUser.Value);								// 삭제자포함
	
	
	/* 서버 호출 */
	// SQL
    tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6300KFFireObj2", false);	

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioKFFireObj2=ds_oKFFireObj"	// outDs
		,parValue
		,"lfn_KFAfterSearch2"
		,false
		,false
		,true
	);	
}

/*
	lfn_KFSearch2 조회후 처리 
*/
function lfn_KFAfterSearch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    /* 안전원정보 조회 후 처리 */
    // 연계관련 버튼 처리 
	lfn_AllMatchBTN2("0");
	
    // 제외버튼처리 
    lfn_KFMatchExceptBTN2();
    
    /* 안전원정보 조회 후 상태값 변경 */
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus2("0");
	// 조회 건수 
    tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();
}

/*
	연계  제외 처리 
*/
function lfn_KFMatchExcept2(obj)
{	
	/* 체크 사항 */
	if(!gfn_Confirm("차량번호 '"+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TCARNO") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
	
	var parValue = "GUBUN='2'";
		parValue += " TBMGNO="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TBMGNO"));
		parValue += " TSEQ="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TSEQ"));
		parValue += " EXCEPTCD="+quote(arrNo[0]);
		parValue += " EXCEPTTXT="+quote(arrNo[1]);
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    , parValue
		,"lfn_AfterKFMatchExcept2"
		,false
		,false
		,true
	);
}

/*
	lfn_KFMatchExcept2 조회후
*/
function lfn_AfterKFMatchExcept2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    // 청조회정보초기화 
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.edMFCount.Text = "";
	
    //* 연계제외처리후  상태값 변경*/     
	// 연계제외대상 상태 값 -1(연계제외)로 변경 
	ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radKFSelectGubun.Value == "1" || tab.page2.radKFSelectGubun.Value == "2") {		
		setRow = ds_ioKFFireObj2.currow;
		ds_ioKFFireObj2.Filter("RFLAGEE!='-1'"); // 연계제외대상 필터링 
		tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();  // 총 건수 변경
		ds_ioKFFireObj2.row = setRow;
	}
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioKFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN2(ds_ioKFFireObj2.currow);
		
    // 안전원정보 상태값 변경 
	lfn_KFViewStatus2(ds_ioKFFireObj2.currow);
}

/*
	연계 제외 취소 
*/
function lfn_KFMatchExceptCancel2(obj)
{
	
	/* 체크사항 */
	if(!gfn_Confirm("차량번호 '"+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TCARNO") +"' 연계 제외를 취소하시겠습니까?")) {	
		return;
	}
	
	var parValue = "GUBUN='2'";
		parValue += " TBMGNO="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TBMGNO"));
		parValue += " TSEQ="+quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TSEQ"));
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterKFMatchExceptCancel2"
		,false
		,false
		,true
	);
}

/*
	lfn_KFMatchExceptCancel2 조회후
*/
function lfn_AfterKFMatchExceptCancel2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 청조회정보초기화 
	ds_ioMFFireObj2.ClearData();
	ds_ioMFFireObjD2.ClearData();
	tab.page2.edMFCount.Text = "";
	
    /* 연계제외처리취소후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioKFFireObj2.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radKFSelectGubun.Value == "3") {
		setRow = ds_ioKFFireObj2.currow;
		ds_ioKFFireObj2.Filter("RFLAGEE=='-1'");	// 연계제외대상 필터링 
		tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();  // 총 건수 변경
		ds_ioKFFireObj2.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioKFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_KFMatchExceptBTN2(ds_ioKFFireObj2.currow);
	
	// 안전원정보 상태값 변경 
	lfn_KFViewStatus2();
}


/*
	연계 제외 버튼 처리 
*/
function lfn_KFMatchExceptBTN2(nRow)
{
	var RFLAGEE = "";
	if (nRow == "" || nRow == null) {
		RFLAGEE = ds_ioKFFireObj2.GetColumn(0,"RFLAGEE");
	} else {
		RFLAGEE = ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE");
	}
	
	if (RFLAGEE == "0") {
		tab.page2.btnKFMatchCancel.Visible = false;
		tab.page2.btnKFMatchExcept.Visible = true;
	} else if (RFLAGEE == "-1") {
		tab.page2.btnKFMatchCancel.Visible = true;
		tab.page2.btnKFMatchExcept.Visible = false;
	} else if (RFLAGEE > 0) {
		tab.page2.btnKFMatchCancel.Visible = false;
		tab.page2.btnKFMatchExcept.Visible = false;
	} else {
		tab.page2.btnKFMatchCancel.Visible = false;
		tab.page2.btnKFMatchExcept.Visible = false;
	}
}

/*
	회비교육비
*/
function lfn_SunapEduInfo2(obj)
{
	// 안전원 
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO") == "" || ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO") == null) {
		alert("한국소방안전원 대상을 지정해주세요.");
		return;
	}
	var sArg  = "sCmgno=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO"));			// 고객관리번호
	Dialog("cust::frmcust6002MDataSunapEduInfo.xml", sArg, 600, 398, "", -1, -1);

}

/*
	엑셀
*/
function tab_page2_btnKFExcel_OnClick(obj)
{
	if (ds_ioKFFireObj2.GetCount() > 0) {
		tab.page2.gdKFOBJList.ExportExcelEx("sheet1");
	}	
}

/*
	안전원정보 상태값변경 
*/
function lfn_KFViewStatus2(nRow){
	if (nRow == "" || nRow = null){
		nRow = ds_ioKFFireObj2.currow;
	}
	
	// 하단상세보기 연계 여부 값입력 
	if(ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page2.edKFMatch.Text = "제외";
	} else if (ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "0") {
		tab.page2.edKFMatch.Text = "X";
	} else if (ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") > 0){
		tab.page2.edKFMatch.Text = "○";
	} else {
		tab.page2.edKFMatch.Text = "";
	}
	
	/* 안전원정보 조회 후 상세보기 배경색 변경 */
    // 삭제된 정보 색 표기 	
	if (ds_ioKFFireObj2.GetColumn(nRow,"DELGUBUN") == "삭제" || ds_ioKFFireObj2.GetColumn(nRow,"RFLAGEE") == "-1") {
		tab.page2.Shape2.BkColor = "darkgray";
		tab.page2.Shape3.BkColor = "darkgray";
	} else {
		tab.page2.Shape2.BkColor = "white";
		tab.page2.Shape3.BkColor = "white";
	}
}

/*============================================	소방청 =================================*/

/*
	지역 선택시
*/
function cbxMFHead_OnChanged2(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 청조회조건 변경시 안전원 조건 연동 
	lfn_FilterFireStation2(strCode);
	
	if (strCode == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}
}

/*
	소방 본부 선택시 본부 포함된 서센터 정보 필터링
*/
function lfn_FilterFireStation2(sFilterGubun) {	
	ds_oFireCd2.UnFilter();
	ds_oFireCenterCd2.UnFilter();
	
	//  필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "CTCD='" + trim(sFilterGubun) + "'";
    }  

    ds_oFireCd2.Filter(ls_FilterExpr);        
    ds_oFireCenterCd2.Filter(ls_FilterExpr); 
   
    if( ds_oFireCd2.FindRow("DATA", tab.page2.cbxMFStation.Text) == -1) {
		tab.page2.cbxMFStation.Text = "";
    }
    
    if (ds_oFireCd2.GetColumn(0,"DATA") == "전체") {
		ds_oFireCd2.AddRow(0);
    } else {
		ds_oFireCd2.InsertRow(0);
    }
	ds_oFireCd2.SetColumn(0,"DATA","전체");
	ds_oFireCd2.SetColumn(0,"CTCD",trim(sFilterGubun));    
	if (ds_oFireCenterCd2.GetColumn(0,"DATA") == "전체") {
		ds_oFireCenterCd2.AddRow(0);
    } else {
		ds_oFireCenterCd2.InsertRow(0);
    }	
	ds_oFireCenterCd2.SetColumn(0,"DATA","전체");
	ds_oFireCenterCd2.SetColumn(0,"CTCD",trim(sFilterGubun));    
	
    tab.page2.cbxMFStation.Index = 0; 
    tab.page2.cbxMFCenter.Index = 0; 
}

/*
	소방서 변경시 
*/
function cbxMFStation_OnChanged2(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_FilterFireCenter2(strCode);
}

/*
	소방서 선택시 소방서에 포함된 센터정보 필터링 
*/
function lfn_FilterFireCenter2(sFilterGubun) {	
	ds_oFireCenterCd2.UnFilter();
	
	// 필터링
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "UPCD='" + trim(sFilterGubun) + "'";
    }    
    ds_oFireCenterCd2.Filter(ls_FilterExpr);    
	if( ds_oFireCenterCd2.FindRow("DATA", tab.page2.cbxMFCenter.Text) == -1) {
		tab.page2.cbxMFCenter.Text = "";
    }
    
    // 전체 항목 추가 
	if (ds_oFireCenterCd2.GetColumn(0,"DATA") == "전체") {
		ds_oFireCenterCd2.AddRow(0);
    } else {
		ds_oFireCenterCd2.InsertRow(0);
    }	
    ds_oFireCenterCd2.SetColumn(0,"DATA","전체");
    ds_oFireCenterCd2.SetColumn(0,"CTCD",trim(sFilterGubun));     
 
    tab.page2.cbxMFCenter.Index = 0;
}

// 쳥그리드 원클릭
function tab_page2_gdMFOBJList_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 매칭 컬러 
	lfn_MatchColor2("ON");
	
	// 연계 제외 여부 버튼 처리 
	lfn_MFMatchExceptBTN2(nRow);
	
	// 청정보 상세조회 
	lfn_MFObjInfoSearch2(nRow);
}


/*
	청버튼 조회 
*/
function tab_page2_btnMFSearch_OnClick(obj)
{	
	/* 값 설정 */
	// 문자열 포함여부
	var KEYWORD = "";
	if (tab.page2.edMFKeyword.Text != "") {		
		if (tab.page2.chkMFPerson.Value == "1") {
			KEYWORD = "%"+tab.page2.edMFKeyword.Text+"%";
		} else {
			KEYWORD = tab.page2.edMFKeyword.Text+"%";
		}
	}

	var parValue = "CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
		parValue += " BONBUCD=" + quote(tab.page2.cbxMFHead.Value);				// 본부코드
		parValue += " STATION=" + quote(tab.page2.cbxMFStation.Value);			//  소방 서 
		parValue += " CENTER=" + quote(tab.page2.cbxMFCenter.Value); 			// 소방 센터 
		parValue += " MODDATE1=" + quote(tab.page2.medMFModDate1.Value);		// 변경일자1
		parValue += " MODDATE2=" + quote(tab.page2.medMFModDate2.Value);		// 변경일자 2
		parValue += " MSTATUS=" + quote(tab.page2.radMFSelectGubun.Value);		// 검색
		parValue += " ROWNUM=" + quote(tab.page2.spMFRowNum.value);				// 조회수		
		parValue += " KEYFIELD=" + quote(tab.page2.cbxMFKeyfield.Value);		// 검색 필드
		parValue += " KEYWORD=" + quote(KEYWORD);								// 검색어 
		parValue += " GUBUN=2";	 // 청 버튼 조회 
	
	lfn_MFSearch2(parValue);
}

/*
	청자료 조회 
*/
function lfn_MFSearch2(parValue)
{
	
	/* 초기화 */
	ds_ioMFFireObj2.ClearData(); // 데이타셋 초기화
	ds_ioMFFireObjD2.ClearData(); // 데이타셋 초기화
	tab.page2.edMFMatch.Text = "";
	
	/* 서버 호출 */
	// SQL 
	tit_clearActionInfo();
	tit_addCsvSearchActionInfo("cust:searchCust6300MFDangerTank2", false);

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObj2=ds_oMFFireObj"	// outDs
		,parValue
		,"lfn_MFAfterSearch2"
		,false
		,false
		,true
	);
}


/*
	lfn_MFSearch 조회후
*/
function lfn_MFAfterSearch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
      
    // 조회로그 남기기 
    // logWrite("1");
   
    // 총건수 
    tab.page2.edMFCount.Text = ds_ioMFFireObj2.GetCount();
    
    // 연계제외 버튼 처리 
    lfn_MFMatchExceptBTN2();
    
    //  청자료 상세조회 
    lfn_MFObjInfoSearch2("0");

}

/*
	청정보 상세조회 
*/
function lfn_MFObjInfoSearch2(nRow)
{
	/* 초기화 */
	ds_ioMFFireObjD2.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("cust:searchCust6300MFDangerTankD", false);

	// 서버 호출 
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_ioMFFireObjD2=ds_oMFFireObjD"	// outDs
		,"MNFCTRETCSN=" + quote(ds_ioMFFireObj2.GetColumn(nRow,"MNFCTRETC_SN"))  
		 + " TANKSN=" + quote(ds_ioMFFireObj2.GetColumn(nRow,"TANK_SN"))  
		 + " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2))
		,"lfn_MFFMAfterSearch2"
		,false
		,false
		,true
	);
}

/*
	lfn_MFFireManagerSearch2 조회후
*/
function lfn_MFFMAfterSearch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    /* 
    if (ds_ioMFFireObjD.GetCount() > 0) {
		// 조회로그 남기기 
		detailLogWrite("M");
    }
    */
    
    // 매칭 컬러 
	lfn_MatchColor2("ON");
    
    // 연계 처리 관련버튼 처리
	lfn_AllMatchBTN2();
    
    // 하단상세보기 연계 여부 값입력 
	if(ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "-1") {
		tab.page2.edMFMatch.Text = "제외";
	} else if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "0") {
		tab.page2.edMFMatch.Text = "X";
	} else if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") > 0){
		tab.page2.edMFMatch.Text = "○";
	} else {
		tab.page2.edMFMatch.Text = "";
	}	
	
	// 삭제된 정보 색 표기 	
	if (ds_ioMFFireObjD2.GetColumn(0,"DELETE_AT") == "Y"
		|| ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "-1") {
		tab.page2.Shape4.BkColor = "darkgray";
	} else {
		tab.page2.Shape4.BkColor = "white";
	}
}


/*
	연계 제외 처리 
*/
function lfn_MFMatchExcept2(obj)
{
	/* 체크 */
	if(!gfn_Confirm("차량번호 '"+ds_ioMFFireObjD2.GetColumn(0,"VHCLE_NO") +"' 연계 제외를 하시겠습니까?")) {	
		return;
	}
	
	// 제외사유 팝업
	var arrNo = Dialog("cust::frmcust6003PMatchExceptReason.xml", "", "", "", "", -1, -1);	
	
	// 제외사유 체크 
	if (arrNo == null || arrNo == "") {
		alert("제외사유를 선택 해주세요");
		return;
	}
		
	/* 파라미터 */
	var parValue = "GUBUN='1'";
		parValue += " MNFCTRETC_SN="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN"));
		parValue += " TANK_SN="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"TANK_SN"));
		parValue += " EXCEPTCD="+quote(arrNo[0]);
		parValue += " EXCEPTTXT="+quote(arrNo[1]);
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));
	
	/* 서버호출 */
	// SQL
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExcept", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExcept2"
		,false
		,false
		,true
	);
}

/*
	lfn_MFMatchExcept2조회후
*/
function lfn_AfterMFMatchExcept2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
   /* 연계제외처리후  상태값 변경*/     
    // 연계제외대상 상태 값 -1(연계제외)로 변경 
    ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MSTATUS","-1");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radMFSelectGubun.Value == "1" || tab.page2.radMFSelectGubun.Value == "2") {	
		setRow = ds_ioMFFireObj2.currow;
		ds_ioMFFireObj2.Filter("MSTATUS!='-1'"); // 연계제외대상 필터링 
		tab.page2.edMFCount.Text = ds_ioMFFireObj2.GetCount();  // 총 건수 변경
		ds_ioMFFireObj2.row = setRow;
	}	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioMFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN2(ds_ioMFFireObj2.currow);
	
	/* 대상, 차량 상세 조회 */
	lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);
}

/*
	연계 제외 취소 
*/
function lfn_MFMatchExceptCancel2(obj)
{
	/* 체크 */
	if(!gfn_Confirm("차량번호 '"+ds_ioMFFireObjD2.GetColumn(0,"VHCLE_NO") +"' 연계제외를 취소하시겠습니까?")) {	
		return;
	}
	
	/* 파라미터 */
	var parValue = "GUBUN='1'";
		parValue += " MNFCTRETC_SN="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN"));
		parValue += " TANK_SN="+quote(ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"TANK_SN"));
		parValue += " EXCEPTCD="+quote(arrNo[0]);
		parValue += " EXCEPTTXT="+quote(arrNo[1]);
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));
	
	/* 서버 호출 */
	// SQL 
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchExceptCancel", "", 0, "");
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs 
	    ,parValue
		,"lfn_AfterMFMatchExceptCancel2"
		,false
		,false
		,true
	);
}

/*
	lfn_MFMatchExceptCancel2조회후
*/
function lfn_AfterMFMatchExceptCancel2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
	/* 연계제외처리취소후  상태값 변경*/     
    // 연계제외대상 상태 값 0(미처리)로 변경 
    ds_ioMFFireObj2.SetColumn(ds_ioMFFireObj2.currow,"MSTATUS","0");
        
    // 검색구분 (미처리 or 일치완료인 경우 필터링)
    if (tab.page2.radMFSelectGubun.Value == "3") {	
		setRow = ds_ioMFFireObj2.currow;
		ds_ioMFFireObj2.Filter("MSTATUS=='-1'");  // 연계제외대상 필터링 
		tab.page2.edMFCount.Text = ds_ioMFFireObj2.GetCount();  // 총 건수 변경
		ds_ioMFFireObj2.row = setRow;
	}	
	
	
	// 연계관련 버튼 처리 
	lfn_AllMatchBTN2(ds_ioMFFireObj2.currow);
	
	// 연계제외버튼변경
	lfn_MFMatchExceptBTN2(ds_ioMFFireObj2.currow);
	
	/* 대상,차량정보 상세조회  */
	lfn_MFObjInfoSearch2(ds_ioMFFireObj2.currow);  
}

/*
	연계 제외 버튼 처리 
*/
function lfn_MFMatchExceptBTN2(nRow)
{
	var MSTATUS = "";
	if (nRow == "" || nRow == null) {
		MSTATUS = ds_ioMFFireObj2.GetColumn(0,"MSTATUS");
	} else {
		MSTATUS = ds_ioMFFireObj2.GetColumn(nRow,"MSTATUS");
	}	
	
	if (MSTATUS == 0) {
		tab.page2.btnMFMatchCancel.Visible = false;
		tab.page2.btnMFMatchExcept.Visible = true;
	} else if (MSTATUS == -1) {
		tab.page2.btnMFMatchCancel.Visible = true;
		tab.page2.btnMFMatchExcept.Visible = false;
	} else if (MSTATUS > 0 ) {
		tab.page2.btnMFMatchCancel.Visible = false;
		tab.page2.btnMFMatchExcept.Visible = false;
	} else {
		tab.page2.btnMFMatchCancel.Visible = false;
		tab.page2.btnMFMatchExcept.Visible = false;
	}
}

// 청시스템 상세보기 
function tab_page2_btnFPISInfo_OnClick(obj)
{
	if (ds_ioMFFireObj2.GetCount() > 0 ) {
		var parValue = "sCourse=80";
		parValue += " sCivilAppeal=-1";
		parValue += " sBarCode=''";	
		parValue += " sMFPIS1_SN="+quote(ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " sMFPIS2_SN="+quote(ds_ioMFFireObjD2.GetColumn(0,"TANK_SN"));
		parValue += " sCTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));		// 지역코드
				
		var arrNo = Dialog("cust::frmcust5010.xml", parValue, 800, 590, "", -1, -1);
	} else {
		alert("선택된 자료가 없습니다.");
		return;
	}
}


/*
	수정없이  연계 처리 
*/
function lfn_NowMatch2(obj)
{  
	/* 체크 사항 */	
	// 안전원 
	if (ds_ioKFFireObj2.GetCount() < 1) {
		alert("[한국소방안전원] 연계할 대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") > 0 ) {
		alert("[한국소방안전원] 연계된 대상입니다.");
		return;
	}	
	// 청
	if (ds_ioMFFireObjD2.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}		
	if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "1") {
		alert(ORGNM + " 연계된 대상입니다.");
		return;
	}
	
			
	var meg = "        " + ORGNM + " 차량번호 : "+ds_ioMFFireObjD2.GetColumn(0,"VHCLE_NO") +"\n";
	meg += "     [한국소방안전원] 차량번호 : "+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TCARNO") +"\n";
	meg +="   연계 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}	

	
	/* 파라미터 값 */
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " MFPIS2=" + quote(ds_ioMFFireObjD2.GetColumn(0,"TANK_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TBMGNO"));
		parValue += " MKFSAPK2=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TSEQ"));
		parValue += " FIRECD=" + quote(ds_ioMFFireObjD2.GetColumn(0,"CMPN119SCID"));
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));
		//parValue += " DPERMISSIONNO=" + quote(ds_ioMFFireObjD.GetColumn(0,"PRMISN_NO"));
		//parValue += " DREMARK=" + quote("설치(변경)허가번호 : " + ds_ioMFFireObjD.GetColumn(0,"ITL_NO"));
	
	/* 서버 호출 */
	// SQL
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:insertCust6300Match", "", 0, "");     // 매치테이블

	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterNowMatch2"
		,false
		,false
		,true
	);
}

/*
	lfn_NowMatch2 처리 후 
*/
function lfn_AfterNowMatch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    
    // 매치이후 처리 
    lfn_MatchAfter2("U");
	
	/* 조회 */
	lfn_KFSearch2();  // 안전원정보조회 
    lfn_MatchData2(); // 청 정보조회 (안전원 더블 클릭 조회 )
    
    /* 메세지 */
    alert("연계가 완료되었습니다."); 
}


/*
	연계해지  처리 
*/
function lfn_CancelMatch2(obj)
{  
	
	/* 체크사항 */
	// 안전원 
	if (ds_ioKFFireObj2.GetCount() < 1) {
		alert("[한국소방안전원] 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") < 1 ) {
		alert("[한국소방안전원] 연계된 대상을 지정해주세요.");
		return;
	}
	// 청
	if (ds_ioMFFireObjD2.GetCount() < 1) {
		alert(ORGNM + " 연계대상을 지정해주세요.");
		return;
	}	
	if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") != "1") {
		alert(ORGNM + " 연계된 대상을 지정해주세요.");
		return;
	}
	
	// 연계 대상 확인 
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"MMGNO") != ds_ioMFFireObjD2.GetColumn(0,"MMGNO")) {
		alert("잘못된 연계대상입니다.");
		return;
	}

	var meg = "        " + ORGNM + " 차량번호 : "+ds_ioMFFireObjD2.GetColumn(0,"VHCLE_NO") +"\n";
	meg += "     [한국소방안전원] 차량번호 : "+ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TCARNO") +"\n";
	meg +="   연계해지 하시겠습니까?";

	if(!gfn_Confirm(meg)) {	
		return;
	}
	
	// 연계해지 사유 
	var cancelReason = Dialog("cust::frmcust5011.xml", "", 520, 188, "", -1, -1);	
	if (cancelReason == "" || cancelReason == null) {
		alert("연계 사유를 입력해 주세요");
		return;
	}
	
	
	
	var parValue = "MFPIS1=" + quote(ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN"));
		parValue += " MFPIS2=" + quote(ds_ioMFFireObjD2.GetColumn(0,"TANK_SN"));
		parValue += " MKFSAPK=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TBMGNO"));
		parValue += " MKFSAPK2=" + quote(ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TSEQ"));
		parValue += " MMGNO=" + quote(ds_ioMFFireObjD2.GetColumn(0,"MMGNO"));
		parValue += " MDELREMARK=" + quote(cancelReason);
		parValue += " MSABUN=" + quote(gds_oUserInfo.GetColumn(0,"PSABUN"));
		parValue += " MGUBUN='1'";   // 허가번호 처리 구분
		parValue += " CTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));
		
	/* 서버호출 */
	// SQL
	tit_clearActionInfo();
	tit_addSingleActionInfo("cust:updateCust6300MatchCancel", "", 0, "");     // 연계취소 
	
	// 서버 호출 
	tit_callService( 
		""
		,""
		,""	// inDs
		,"" // outDs	  	  
	    ,parValue
		,"lfn_AfterCancelMatch2"
		,false
		,false
		,true
	);
}

// lfn_CancelMatch2 처리 후 
function lfn_AfterCancelMatch2(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    } 
    // 매치이후 처리 
    lfn_MatchAfter2("C");
	
	/* 조회 */
	lfn_KFSearch2();  // 안전원정보조회 
    lfn_MatchData2(); // 청 정보조회 (안전원 더블 클릭 조회 )
    
    /* 메세지 */
    alert("연계해지가 완료되었습니다."); 
    
}

// 엑셀 
function tab_page2_btnMFExcel_OnClick(obj)
{
	if (ds_ioMFFireObj2.GetCount() > 0) {
		tab.page2.gdMFOBJList.ExportExcelEx("sheet1");
	}
}
/*============================================	연계후 처리   =================================*/

function lfn_MatchAfter2(mode) {
	if (mode == "U") {
		var KFSTATUS = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
		
		KFSTATUS++;
		
		ds_ioKFFireObj.SetColumn(ds_ioKFFireObj2.currow,"RFLAGEE",KFSTATUS);
	
		// 필터링		
		if(tab.page2.radKFSelectGubun.Value == "1" || tab.page2.radKFSelectGubun.Value == "3") {
			setRow = ds_ioKFFireObj2.currow;
			ds_ioKFFireObj2.Filter("RFLAGEE>='1'");
			tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();
			ds_ioKFFireObj2.row = setRow;
		}

	} else if (mode == "C") {
		// 상태값 
		var KFSTATUS = ds_ioKFFireObj.GetColumn(ds_ioKFFireObj.currow,"RFLAGEE");
		
		// 감소
		KFSTATUS--;
		
		// 적용 
		ds_ioKFFireObj.SetColumn(ds_ioKFFireObj.currow,"RFLAGEE",KFSTATUS);	
	
		// 필터링
		if(tab.page2.radKFSelectGubun.Value == "2" || tab.page2.radKFSelectGubun.Value == "3") {
			setRow = ds_ioKFFireObj2.currow;
			ds_ioKFFireObj2.Filter("RFLAGEE=='0'");
			tab.page2.edKFCount.Text = ds_ioKFFireObj2.GetCount();
			ds_ioKFFireObj2.row = setRow;
		}
	}
}


/*
	수정연계
*/
function btnModMatch_OnClick2(obj) {
	/* 체크 사항 */	
	// 안전원 
	if (ds_ioKFFireObj2.GetCount() < 1) {
		alert("[한국소방안전원] 연계할 대상을 지정해주세요.");
		return;
	}	
	if (ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RFLAGEE") > 0 ) {
		alert("[한국소방안전원] 연계된 대상입니다.");
		return;
	}	
	// 청
	if (ds_ioMFFireObjD2.GetCount() < 1) {
		alert(ORGNM + " 연계할 대상을 지정해주세요.");
		return;
	}		
	if (ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == "1") {
		alert(ORGNM + " 연계된 대상입니다.");
		return;
	}

	var sStatus = "U";
	var sMNFCTRETC_SN = "";
	var sTANK_SN = "";
	var sCMGNO = "";
	var sBMGNO = "";
	var sTSEQ = "";

	
	sCMGNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO");
	sBMGNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TBMGNO");
	sTSEQ = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TSEQ");
	
	//  제조소등 관리번호 설정
	sMNFCTRETC_SN = ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"MNFCTRETC_SN");
	sTANK_SN = ds_ioMFFireObj2.GetColumn(ds_ioMFFireObj2.currow,"TANK_SN");

	        
	// 파라미터값 설정 
 	var parValue = "sStatus=" + quote(sStatus); // 연계모드(I : 신규 , U : 수정 )
	parValue += " sMNFCTRETC_SN=" + quote(sMNFCTRETC_SN); // 제조소등관리번호 
	parValue += " sTANK_SN=" + quote(sTANK_SN); // 제조소등관리번호 
	parValue += " sCMGNO=" + quote(sCMGNO);  // 안전원고객관리번호
	parValue += " sBMGNO=" + quote(sBMGNO);  // 빌딩관리번호
	parValue += " sTSEQ=" + quote(sTSEQ);    // 차량 SEQ
	parValue += " sJIBU=" + quote(tab.page2.cbxKFJibu.Value);
	parValue += " sCTCD=" + quote(substr(tab.page2.cbxMFHead.Value,0,2));

	var arrNo = Dialog("cust::frmcust6301PDataConnectionTankManageOldSave.xml", parValue , 800, 700, "", -1, -1);
	// 변경, 수정이 된경우 
	if(arrNo == "U"){
		// 매치후 처리 
		lfn_MatchAfter(arrNo);
	}
	/* 조회 */
	lfn_KFSearch2();  // 안전원정보조회 
    lfn_MatchData2(); // 청 정보조회 (안전원 더블 클릭 조회 )
}

/*================================    조건 연계	======================================*/
// 청 조회조건변경(연계구분)
function tab_page2_radKFSelectGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	lfn_SearchBalance2("12");
}
function lfn_SearchBalance2(gubun){
	if (gubun == "11") {
		var JIBUCD = tab.page2.cbxKFJibu.Value;
		if (JIBUCD == "1141") {
			 JIBUCD = "1081";
		}
		var row = ds_oFireHead2.FindRow("JIBUCD", JIBUCD );	
		tab.page2.cbxMFHead.Value = ds_oFireHead.GetColumn(row,"CD");
		cbxMFHead_OnChanged2("tab.page2.cbxMFHead",tab.page2.cbxMFHead.Value);
		lfn_FilterFireStation2(tab.page2.cbxMFHead.Value);
	} else if (gubun == "12") {
		 tab.page2.radMFSelectGubun.Value = tab.page2.radKFSelectGubun.Value;
	} 
}


/*============================================	매칭 컬러 처리    =================================*/

function lfn_MatchColor2(mode,nRow) {
	if (mode == "ON") {
	
		// 대상물
		var BNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"BSEARCHNM");
		var SEARCHBNM = substr(ds_ioMFFireObjD2.GetColumn(0,"DMSERCHNM"),0,length(BNM));
		
		
		SEARCHBNM = trim(SEARCHBNM);
		BNM = trim(BNM);
		
		if (SEARCHBNM == BNM) {
			if (SEARCHBNM == null || SEARCHBNM = "") {
				tab.page2.edMFOBJ_NM.BKColor = "white";
				tab.page2.edKFBNM.BKColor = "white";
			} else {
				tab.page2.edMFOBJ_NM.BKColor = "lightskyblue";
				tab.page2.edKFBNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFOBJ_NM.BKColor = "white";
			tab.page2.edKFBNM.BKColor = "white";
		}
		
		
		// 동명(풀네임)
		var SEARCHDONGFNM = ds_ioMFFireObjD2.GetColumn(0,"DMADDRDONGFNM");
		var BADDRDONGFNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRDONGFNM");
		
		SEARCHDONGFNM = trim(SEARCHDONGFNM);
		BADDRDONGFNM = trim(BADDRDONGFNM);
		
		if (SEARCHDONGFNM == BADDRDONGFNM) {
			if (SEARCHDONGFNM == null || SEARCHDONGFNM = "") {
				tab.page2.edMFFDong.BKColor = "white";
				tab.page2.edKFFDong.BKColor = "white";
			} else {
				tab.page2.edMFFDong.BKColor = "lightskyblue";
				tab.page2.edKFFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFFDong.BKColor = "white";
			tab.page2.edKFFDong.BKColor = "white";
		}
		
		
		// 동명(숏네임)
		var SEARCHDONGNM = ds_ioMFFireObjD2.GetColumn(0,"DMADDRDONGNM");
		var BADDRDONGNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRDONGNM");
		
		SEARCHDONGNM = trim(SEARCHDONGNM);
		BADDRDONGNM = trim(BADDRDONGNM);
		
		if (SEARCHDONGNM == BADDRDONGNM) {
			if (SEARCHDONGNM == null || SEARCHDONGNM = "") {
				tab.page2.edMFDong.BKColor = "white";
				tab.page2.edKFDong.BKColor = "white";
			} else {
				tab.page2.edMFDong.BKColor = "lightskyblue";
				tab.page2.edKFDong.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFDong.BKColor = "white";
			tab.page2.edKFDong.BKColor = "white";
		}
		
		
		// 주번지
		var SEARCHMAINADDR = ds_ioMFFireObjD2.GetColumn(0,"DMADDMAINNM");
		var BADDRMAINNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRMAINNM");
		
		SEARCHMAINADDR = trim(SEARCHMAINADDR);
		BADDRMAINNM = trim(BADDRMAINNM);
		
		if (SEARCHMAINADDR == BADDRMAINNM) {
			if (SEARCHMAINADDR == null || SEARCHMAINADDR = "") {
				tab.page2.edMFMainAddr.BKColor = "white";
				tab.page2.edKFMainAddr.BKColor = "white";
			} else {
				tab.page2.edMFMainAddr.BKColor = "lightskyblue";
				tab.page2.edKFMainAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFMainAddr.BKColor = "white";
			tab.page2.edKFMainAddr.BKColor = "white";
		}
		
		
		// 부번지
		var SEARCHSUBADDR = ds_ioMFFireObjD2.GetColumn(0,"DMADDSUBNM");
		var BADDRSUBNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TADDRSUBNM");
		
		SEARCHSUBADDR = trim(SEARCHSUBADDR);
		BADDRSUBNM = trim(BADDRSUBNM);
		
		if (SEARCHSUBADDR == BADDRSUBNM) {
			if (SEARCHSUBADDR == null || SEARCHSUBADDR = "") {
				tab.page2.edMFSubAddr.BKColor = "white";
				tab.page2.edKFSubAddr.BKColor = "white";
			} else {
				tab.page2.edMFSubAddr.BKColor = "lightskyblue";
				tab.page2.edKFSubAddr.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFSubAddr.BKColor = "white";
			tab.page2.edKFSubAddr.BKColor = "white";
		}

		// 도로명
		var SEARCHROADNM = ds_ioMFFireObjD2.GetColumn(0,"ROAD_NM");
		var BROADNM = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RROADNM");
		
		SEARCHROADNM = trim(SEARCHROADNM);
		BROADNM = trim(BROADNM);

		if (SEARCHROADNM == BROADNM) {
			if (SEARCHROADNM == null || SEARCHROADNM = "") {
				tab.page2.edMFRoadNM.BKColor = "white";
				tab.page2.edKFRoadNM.BKColor = "white";
			} else {
				tab.page2.edMFRoadNM.BKColor = "lightskyblue";
				tab.page2.edKFRoadNM.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFRoadNM.BKColor = "white";
			tab.page2.edKFRoadNM.BKColor = "white";
		}		
		
	
		// 건물번호1
		var SEARCHMAINNO = ds_ioMFFireObjD2.GetColumn(0,"MAIN_BDNBR");
		var BMAINNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RBUILDMAINNO");
		
		SEARCHMAINNO = trim(SEARCHMAINNO);
		BMAINNO = trim(BMAINNO);
		
		if (SEARCHMAINNO == BMAINNO) {
			if (SEARCHMAINNO == null || SEARCHMAINNO = "") {
				tab.page2.edMFMainNO.BKColor = "white";
				tab.page2.edKFMainNO.BKColor = "white";
			} else {
				tab.page2.edMFMainNO.BKColor = "lightskyblue";
				tab.page2.edKFMainNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFMainNO.BKColor = "white";
			tab.page2.edKFMainNO.BKColor = "white";
		}		
		
		// 건물번호2
		var SEARCHSUBNO = ds_ioMFFireObjD2.GetColumn(0,"SEC_BDNBR");
		var BSUBNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"RBUILDSUBNO");
		
		SEARCHSUBNO = trim(SEARCHSUBNO);
		BSUBNO = trim(BSUBNO);
		
		if (SEARCHSUBNO == BSUBNO) {
			if (SEARCHSUBNO == null || SEARCHSUBNO = "") {
				tab.page2.edMFSubNO.BKColor = "white";
				tab.page2.edKFSubNO.BKColor = "white";
			} else {
				tab.page2.edMFSubNO.BKColor = "lightskyblue";
				tab.page2.edKFSubNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFSubNO.BKColor = "white";
			tab.page2.edKFSubNO.BKColor = "white";
		}	
			
		if(nRow == "" || nRow == null) {
			nRow = ds_ioFireManagerInfo2.currow;
		} 

		// 차량번호
		var MCARNO = ds_ioMFFireObjD2.GetColumn(0,"VHCLE_NO");
		var KCARNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TCARNO");
		
		MCARNO= trim(MCARNO);
		KCARNO = trim(KCARNO);
				
		if (MCARNO  == KCARNO) {
			if (MCARNO == null || MCARNO = "") {
				tab.page2.edMFVHCLE_NO.BKColor = "white";
				tab.page2.edKFTCARNO.BKColor = "white";
			} else {
				tab.page2.edMFVHCLE_NO.BKColor = "lightskyblue";
				tab.page2.edKFTCARNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFVHCLE_NO.BKColor = "white";
			tab.page2.edKFTCARNO.BKColor = "white";
		}
		
		
		// 허가번호
		var MPNO = ds_ioMFFireObjD2.GetColumn(0,"PRMISN_NO");
		var KPNO = ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"TPERMISSIONNO");
		
		MPNO = trim(MPNO);
		KPNO = trim(KPNO);
		
		if (MPNO == KPNO) {
			if (MPNO == null || MPNO = "") {
				tab.page2.edMFPRMISN_NO.BKColor = "white";
				tab.page2.edKFTPERMISSIONNO.BKColor = "white";
			} else {
				tab.page2.edMFPRMISN_NO.BKColor = "lightskyblue";
				tab.page2.edKFTPERMISSIONNO.BKColor = "lightskyblue";
			}
		} else {
			tab.page2.edMFPRMISN_NO.BKColor = "white";
			tab.page2.edKFTPERMISSIONNO.BKColor = "white";
		}
		
	} else {
		tab.page2.edMFOBJ_NM.BKColor = "white";
		tab.page2.edKFBNM.BKColor = "white";
		tab.page2.edMFFDong.BKColor = "white";
		tab.page2.edKFFDong.BKColor = "white";
		tab.page2.edMFDong.BKColor = "white";
		tab.page2.edKFDong.BKColor = "white";
		tab.page2.edMFMainAddr.BKColor = "white";
		tab.page2.edKFMainAddr.BKColor = "white";
		tab.page2.edMFSubAddr.BKColor = "white";
		tab.page2.edKFSubAddr.BKColor = "white";
		tab.page2.edMFRoadNM.BKColor = "white";
		tab.page2.edKFRoadNM.BKColor = "white";
		tab.page2.edMFMainNO.BKColor = "white";
		tab.page2.edKFMainNO.BKColor = "white";	
		tab.page2.edMFSubNO.BKColor = "white";
		tab.page2.edKFSubNO.BKColor = "white";
		tab.page2.edMFPRMISN_NO.BKColor = "white";
		tab.page2.edKFTPERMISSIONNO.BKColor = "white";
		tab.page2.edMFVHCLE_NO.BKColor = "white";
		tab.page2.edKFTCARNO.BKColor = "white";
	}	
}

/*============================================	연계 처리 버튼   =================================*/

function lfn_AllMatchBTN2(nRow) {
	var MRow = "";
	var KRow = "";	
	if (ds_ioMFFireObjD2.GetCount() > 0) { MRow = ds_ioMFFireObjD2.currow;}
	if (ds_ioKFFireObj2.GetCount() > 0) { KRow = ds_ioKFFireObj2.currow; }
	
	// 기본
	tab.page2.btnMatchCancel.Enable = false;
	tab.page2.btnMatch.Enable = false;
	tab.page2.btnModMatch.Enable = false;

	// 연계해지 버튼 활성화 
	if (
		ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") > 0 	
		&& ds_ioKFFireObj2.GetColumn(KRow,"RFLAGEE") > 0
		&& (ds_ioMFFireObjD2.GetColumn(0,"MMGNO") == ds_ioKFFireObj2.GetColumn(KRow,"MMGNO"))
	   )
	{
		tab.page2.btnMatchCancel.Enable = true;
	} else {
		tab.page2.btnMatchCancel.Enable = false;
	}
	
	// 수정없이 연계처리 활성화 , 수정연계 
	if (
		ds_ioMFFireObjD2.GetColumn(0,"MSTATUS") == 0 		
		&& ds_ioKFFireObj2.GetColumn(KRow,"RFLAGEE") == 0
	   )
	{
		tab.page2.btnMatch.Enable = true;
		tab.page2.btnModMatch.Enable = true;
	} else {
		tab.page2.btnMatch.Enable = false;
		tab.page2.btnModMatch.Enable = false;
	}
}


/**************************************************************
공통함수 
**************************************************************/
function KfClear() {
	// 안전원 정보 초기 화 
	ds_ioKFFireObj.ClearData();
	ds_ioDangerInfo.ClearData();
	tab.page1.edKFCount = "";
	tab.page1.Shape2.BkColor = "";
	tab.page1.Shape3.BkColor = "";
}

/**************************************************************
로그 남기기 
**************************************************************/
function logWrite(gubun,row) {
	var ls_HistoryArg = "";
	var Action = "";
	if (gubun == "1") {
		// 조회이력을 저장한다.  
		ls_HistoryArg = " 소방본부=" + tab.page1.cbxMFHead.Value;
		ls_HistoryArg += ", 소방서=" + tab.page1.cbxMFStation.Value;
		ls_HistoryArg += ", 소방센터=" + tab.page1.cbxMFCenter.Value;
		ls_HistoryArg += ", 안전원수신일자1=" + tab.page1.medMFModDate1.Value;
		ls_HistoryArg += " ~ 안전원수신일자2=" + tab.page1.medMFModDate2.Value;
		ls_HistoryArg += ", 검색조건=" + tab.page1.radMFSelectGubun.Value;
		ls_HistoryArg += ", 검색필드=" + tab.page1.cbxMFKeyfield.Value;
		ls_HistoryArg += ", 검색키워드=" + tab.page1.edMFKeyword.Text;
		ls_HistoryArg += ", 문자열 포함여부=" + tab.page1.chkMFPerson.Value;
		ls_HistoryArg += ", 조회수=" + tab.page1.spMFRowNum.value;
		
		Action = "청기준 : 청자료 전체조회";
	} else if (gubun == "3") {
		// 조회이력을 저장한다.  
		ls_HistoryArg = " 소방본부=" + tab.page2.cbxMFHead.Value;
		ls_HistoryArg += ", 소방서=" + tab.page2.cbxMFStation.Value;
		ls_HistoryArg += ", 소방센터=" + tab.page2.cbxMFCenter.Value;
		ls_HistoryArg += ", 안전원수신일자1=" + tab.page2.medMFModDate1.Value;
		ls_HistoryArg += " ~ 안전원수신일자2=" + tab.page2.medMFModDate2.Value;
		ls_HistoryArg += ", 검색조건=" + tab.page2.radMFSelectGubun.Value;
		ls_HistoryArg += ", 검색필드=" + tab.page2.cbxMFKeyfield.Value;
		ls_HistoryArg += ", 검색키워드=" + tab.page2.edMFKeyword.Text;
		ls_HistoryArg += ", 문자열 포함여부=" + tab.page2.chkMFPerson.Value;
		ls_HistoryArg += ", 조회수=" + tab.page2.spMFRowNum.value;
		ls_HistoryArg += ", 고객번호=" + ds_ioKFFireObj2.GetColumn(ds_ioKFFireObj2.currow,"CMGNO");
		Action = "안전원기준 : 청자료 전체조회";
	} 
              
    gfn_InsertFPISSearchPrintHistory(
        "S"
        , this.ID
        , "위험물안전관리자 일치화 관리"
        , Action
        , ls_HistoryArg
    );
}

/**************************************************************
 상세조회 로그 남기기 
**************************************************************/
function detailLogWrite(code) {

	var searchNm = "";		// 조회대상명
	var sMFPIS1 = "";
	var sMFPIS2 = "";
	
	if(code == "M") {
		searchNm = ds_ioMFFireObjD.GetColumn(0,"VHCLE_NO");
		sMFPIS1 = ds_ioMFFireObjD.GetColumn(0,"MNFCTRETC_SN");
		sMFPIS2 = ds_ioMFFireObjD.GetColumn(0,"TANK_SN");
    } else if (code == "K") {
		searchNm = ds_ioMFFireObjD2.GetColumn(0,"VHCLE_NO");
		sMFPIS1 = ds_ioMFFireObjD2.GetColumn(0,"MNFCTRETC_SN");
		sMFPIS2 = ds_ioMFFireObjD2.GetColumn(0,"TANK_SN");
    }
	
	// 상세 조회이력을 저장한다.  	
    gfn_InsertFPISDetailSearchPrintHistory(
        "2"			// 대상구분
        , menuId		// 메뉴 아이디 
        , searchNm		// 조회 대상명 
        , sMFPIS1		// 메인 PK
        , sMFPIS2		// 탱크순번
    );
}


function tab_page2_edKFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {
		lfn_KFSearch2();
	}
}

function tab_page2_edMFKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {
		tab_page2_btnMFSearch_OnClick();
	}
}

function tab_OnChanged(obj,nOldIndex,nNewindex)
{
	if (nNewindex == "0") {
		lfn_FilterFireStation(tab.page1.cbxMFHead.value);
		lfn_JibuChange(tab.page1.cbxKFJibu.Value);
	} else if (nNewindex == "1") {
		lfn_FilterFireStation(tab.page2.cbxMFHead.value);
		lfn_JibuChange(tab.page2.cbxKFJibu.Value);
	}
	
	if (tab.page2.cbxMFHead.value == "1100000") {
		tab.page1.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbJubsu.Text = "서울소방본부(119행정정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 서울소방본부 자료 자동조회";
		ORGNM = "[서울소방본부]";
	} else {
		tab.page1.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbJubsu.Text = "소방청(소방민원정보시스템) 정보";
		tab.page2.lbsearchNotice.Text = "※ 위 리스트의 고객 정보를 더블클릭 시 우측 소방청 자료 자동조회";
		ORGNM = "[소방청]";
	}	
	
}



/*
 * 기능 : 데이타연계 조회 출력 HISTORY 창 팝업
*/
function btnDataHistory_OnClick(obj)
{	
	var arrNo = Dialog("sys::frmsys0095MDataMatchDetailSearchHistoryList.xml", "menuId="+quote(menuId), 800, 590, "", -1, -1);	
}


function Form_OnActivate(obj)
{
	gs_SysID = "[stm_01,bsn_1003,dsc_0008]";	// 개인정보접속기록 시스템ID 
}
]]></Script>
</Window>
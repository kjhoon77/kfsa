<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="400" Id="frmcust2011PCustomerSunapInfo" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="결제&#32;상세&#32;정보" Top="8" Ver="1.0" Width="700" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oCustomerFee">
				<Contents>
					<colinfo id="BNM" size="40" type="STRING"/>
					<colinfo id="CANCELDATE" size="18" type="STRING"/>
					<colinfo id="CCOURSECD" size="2" type="STRING"/>
					<colinfo id="CCOURSECDNM" size="50" type="STRING"/>
					<colinfo id="CFCMGNO" size="22" type="DECIMAL"/>
					<colinfo id="CFGROUPMGNO" size="29" type="STRING"/>
					<colinfo id="CFGUBUN" size="58" type="STRING"/>
					<colinfo id="CFGUBUNCD" size="2" type="STRING"/>
					<colinfo id="CFGUBUNCDNM" size="50" type="STRING"/>
					<colinfo id="CFREGNM" size="20" type="STRING"/>
					<colinfo id="CFREMARK" size="100" type="STRING"/>
					<colinfo id="CFREPAYREF" size="1" type="STRING"/>
					<colinfo id="CNO" size="6" type="STRING"/>
					<colinfo id="CREGCD" size="2" type="STRING"/>
					<colinfo id="FEESEQ" size="22" type="DECIMAL"/>
					<colinfo id="FMNM" size="20" type="STRING"/>
					<colinfo id="MEMBERGUBUN" size="1" type="STRING"/>
					<colinfo id="MGGTMGNO" size="4" type="STRING"/>
					<colinfo id="PMAMT" size="22" type="DECIMAL"/>
					<colinfo id="PMBUYER" size="50" type="STRING"/>
					<colinfo id="PMMGNO" size="22" type="DECIMAL"/>
					<colinfo id="PMPCORDERNO" size="13" type="STRING"/>
					<colinfo id="PMPGMGUBUN" size="2" type="STRING"/>
					<colinfo id="PMYEAR" size="4" type="STRING"/>
					<colinfo id="PONYDATE" size="18" type="STRING"/>
					<colinfo id="POSGTMGNO" size="4" type="STRING"/>
					<colinfo id="PROCDATE" size="18" type="STRING"/>
					<colinfo id="PROCGTMGNO" size="4" type="STRING"/>
					<colinfo id="REGDATE" size="7" type="DATE"/>
					<colinfo id="SEL" size="1" type="STRING"/>
					<colinfo id="SETLMGUBUN" size="1" type="STRING"/>
					<colinfo id="SETLMGUBUNNM" size="6" type="STRING"/>
					<colinfo id="SUNAPFEE" size="22" type="DECIMAL"/>
					<colinfo id="SUNAPYEAR" size="13" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="396" Height="280" Id="Shape2" Left="4" LineColor="user15" Right="696" TabOrder="6" Top="116" Type="Rectangle" Width="692"></Shape>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="431" LineColor="user14" Right="696" TabOrder="7" Top="1" Type="Rectangle" Width="265"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="608" OnClick="lfn_End" Style="sty_Button" TabOrder="3" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Shape Bottom="104" Height="64" Id="Shape0" Left="4" LineColor="user15" Right="696" TabOrder="8" Top="40" Type="Rectangle" Width="692"></Shape>
		<Static Align="Center" Height="20" Id="Static26" Left="20" Style="sty_LabelGruopBox" TabOrder="9" Text="기본&#32;정보" Top="32" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="10" Text="관리지부" Top="56" UserData="S" VAlign="Middle" Width="60"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edJibu" ImeMode="native" Left="72" LeftMargin="2" MaxLength="30" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edBuildingNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="11" Top="56" Width="64"></Edit>
		<Static Align="Center" Height="20" Id="lbProcDate" Left="140" Style="sty_Label" TabOrder="12" Text="처리일자" Top="80" UserData="S" VAlign="Middle" Width="60"></Static>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medProcDate" Left="204" LeftMargin="2" Mask="####-##-##" Style="sty_Maskedit" TabOrder="13" Top="80" Type="STRING" Width="80"></MaskEdit>
		<Static Align="Center" Height="20" Id="Static4" Left="20" Style="sty_LabelGruopBox" TabOrder="14" Text="결제&#32;정보" Top="108" VAlign="Middle" Width="96"></Static>
		<Image Height="10" Id="imgImage" ImageID="IMG_BULLET" Left="8" Style="sty_Image" TabOrder="16" Top="9" Transparent="TRUE" Width="12"></Image>
		<Static Font="굴림,12,Bold" Height="20" Id="lbWorkFormTitle" Left="28" TabOrder="15" Text="결제&#32;상세&#32;정보" Top="4" VAlign="Middle" Width="360"></Static>
		<Static Align="Center" Height="20" Id="lbSetlmGubun" Left="436" Style="sty_Label" TabOrder="17" Text="결제방법" Top="80" UserData="S" VAlign="Middle" Width="60"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edSetlmGubun" ImeMode="native" Left="500" LeftMargin="2" MaxLength="30" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edBuildingNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="18" Top="80" Width="192"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edFeeGubun" ImeMode="native" Left="204" LeftMargin="2" Style="sty_Edit" TabOrder="20" Top="56" Width="80"></Edit>
		<Static Align="Center" Height="20" Id="lbFeeGubun" Left="140" Style="sty_Label" TabOrder="19" Text="회비구분" Top="56" VAlign="Middle" Width="60"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="616" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="5" Top="120" Transparent="TRUE" Width="74"></Button>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oCustomerFee" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="392" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="248" Id="gdSunap" InputPanel="FALSE" Left="8" LineColor="default" OnHeadClick="lfn_SortGrid_OnHeadClick" Right="692" RowHeight="20" Style="sty_Grid" TabOrder="4" TabStop="true" Top="144" UseDBuff="true" UsePopupMenu="true" UserData="결제목록" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="684">
			<contents>
				<format id="Default">
					<columns>
						<col width="31"/>
						<col width="104"/>
						<col width="66"/>
						<col width="57"/>
						<col width="89"/>
						<col width="60"/>
						<col width="77"/>
						<col width="135"/>
						<col width="75"/>
						<col width="123"/>
						<col width="100"/>
						<col width="184"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell col="1" display="text" text="년월"/>
						<cell col="2" display="text" text="고객번호"/>
						<cell col="3" display="text" text="선임자명"/>
						<cell col="4" display="text" text="직능"/>
						<cell col="5" display="text" text="결제여부"/>
						<cell col="6" display="text" text="결제구분"/>
						<cell col="7" display="text" text="결제방법"/>
						<cell col="8" display="text" text="금액"/>
						<cell col="9" display="text" text="대상물(업체)명"/>
						<cell col="10" display="text" text="주문번호"/>
						<cell col="11" display="text" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" colid="FEESEQ" display="text"/>
						<cell align="center" col="1" colid="SUNAPYEAR" display="text"/>
						<cell align="center" col="2" colid="CNO" display="normal"/>
						<cell align="center" col="3" colid="FMNM" display="text"/>
						<cell align="center" col="4" colid="CCOURSECDNM" display="text"/>
						<cell align="center" col="5" colid="SETLMGUBUNNM" display="text"/>
						<cell align="center" col="6" colid="CFGUBUN" display="text"/>
						<cell align="center" col="7" colid="CFGUBUNCDNM" display="text"/>
						<cell align="right" col="8" colid="SUNAPFEE" display="number"/>
						<cell align="left" col="9" colid="BNM" display="text"/>
						<cell align="center" col="10" colid="PMPCORDERNO" display="text"/>
						<cell align="left" col="11" colid="CFREMARK" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medTotalAmount" Left="72" Readonly="TRUE" Style="sty_Edit" TabOrder="21" Top="80" Value="0" Width="64"></MaskEdit>
		<Static Align="Center" Height="20" Id="lbTotalAmount" Left="8" Style="sty_LabelStat" TabOrder="22" Text="전체금액" Top="80" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Height="20" Id="lbBuyer" Left="288" Style="sty_Label" TabOrder="23" Text="구매자" Top="56" VAlign="Middle" Width="60"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edBuyer" ImeMode="native" Left="352" LeftMargin="2" Style="sty_Edit" TabOrder="24" Top="56" Width="340"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="521" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="2" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="434" OnClick="lfn_Excel" Style="sty_Button" TabOrder="1" ToolTipText="엑셀로&#32;저장" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbPonyDate" Left="288" Style="sty_Label" TabOrder="25" Text="정산일자" Top="80" UserData="S" VAlign="Middle" Width="60"></Static>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medPonyDate" Left="352" LeftMargin="2" Mask="####-##-##" Style="sty_Maskedit" TabOrder="26" Top="80" Type="STRING" Width="80"></MaskEdit>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust2011PCustomerSunapInfo.xml
 * 설명 : 결제 상세 정보
 * 작성일 : 2009.12.08
 * 작성자 : 김동현
 */

#include "LIB::cust.js"; // 공통업무 관련

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {

	gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
	
    // 콜센터 직원 사용 이면
	if (gs_IsCallCenter == "Y") {
		btnToExcel.Enable = false; // 엑셀출력 버튼
		btnPrintScreen.Enable = false; // 화면출력 버튼
	}

    if (IsExistVar("sPmYear") && IsExistVar("sPmMgno")) {
        lfn_Search();
    } else {
        gfn_Alert("결제 정보가 없습니다.");
        lfn_Cancel();
    }

}

/**
 * 창닫기
 */
function lfn_End(obj) {
    Close("FAIL");
}

/**
 * 종료버튼
 */
function Form_OnUnloadCompleted(obj) {
    Close("FAIL");
}

/**
 * 조회
 */
function lfn_Search(obj) {

    tit_clearActionInfo();
    tit_addSearchActionInfo("cust:searchCust2011CustomerFee", false);
    
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""
        ,"ds_oCustomerFee=ds_oCustomerFee"
        ,"SPMYEAR=" + quote(sPmYear)
            + " SPMMGNO=" + quote(sPmMgno) // args
        ,""
        ,false
        ,false
        ,true
    );
    
    edJibu.Text = lfn_GetJibu(ds_oCustomerFee.GetColumn(0, "MGGTMGNO"));
    edFeeGubun.Text = iif(ds_oCustomerFee.GetColumn(0, "MEMBERGUBUN") == "0", "회비", "교육비");
    edBuyer.Text = ds_oCustomerFee.GetColumn(0, "PMBUYER");
    medTotalAmount.Value = ds_oCustomerFee.GetColumn(0, "PMAMT");
    edSetlmGubun.Text = lfn_GetSetlm(ds_oCustomerFee.GetColumn(0, "CFGUBUNCD"));
    medProcDate.Value = ds_oCustomerFee.GetColumn(0, "PROCDATE");
    medPonyDate.value = ds_oCustomerFee.GetColumn(0, "PONYDATE");

}

/**
 * 멀티 정렬
 */
function btnMutilSort_OnClick(obj) {
	gfn_GridMultiSort(gdSunap, 1);
}
]]></Script>
</Window>
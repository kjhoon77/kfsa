<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="595" Id="frmcust1025MEduJubsuManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="실무교육접수관리" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioEduJubsu">
				<Contents>
					<colinfo id="ADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="BNM" size="60" summ="default" type="STRING"/>
					<colinfo id="CCOURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="CGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="CMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="CNO" size="6" summ="default" type="STRING"/>
					<colinfo id="CSTATUSGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJADDRGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJBIRTHDAY" size="7" summ="default" type="STRING"/>
					<colinfo id="EJCADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="EJCADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="EJCADDRGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJCASGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJCHANGECNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJCMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJCOURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="EJCZIP" size="6" summ="default" type="STRING"/>
					<colinfo id="EJEDUMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJEJHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJEMAILDOMAIN" size="50" summ="default" type="STRING"/>
					<colinfo id="EJEMAILID" size="50" summ="default" type="STRING"/>
					<colinfo id="EJFMMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJHJUBSUNO" size="3" summ="default" type="STRING"/>
					<colinfo id="EJHMNY" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJHPMMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJHPMYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="EJHPROCDATE" size="7" summ="default" type="DATE"/>
					<colinfo id="EJHREASON" size="200" summ="default" type="STRING"/>
					<colinfo id="EJHSABUN" size="8" summ="default" type="STRING"/>
					<colinfo id="EJISUGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJMEMBERYN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJNM" size="20" summ="default" type="STRING"/>
					<colinfo id="EJPAYMNY" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJPERSONKEY" size="44" summ="default" type="STRING"/>
					<colinfo id="EJPHONE" size="16" summ="default" type="STRING"/>
					<colinfo id="EJPMMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJPMORDERNO" size="13" summ="default" type="STRING"/>
					<colinfo id="EJPMYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="EJRADDRETC" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRBUILDNM" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRCADDRETC" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRCBUILDNM" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRCCONVSTATUS" size="2" summ="default" type="STRING"/>
					<colinfo id="EJRCMAINBUNJI" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJRCONVDATE" size="7" summ="default" type="DATE"/>
					<colinfo id="EJRCONVPGM" size="1" summ="default" type="STRING"/>
					<colinfo id="EJRCONVSABUN" size="8" summ="default" type="STRING"/>
					<colinfo id="EJRCONVSTATUS" size="2" summ="default" type="STRING"/>
					<colinfo id="EJRCPNUCD" size="19" summ="default" type="STRING"/>
					<colinfo id="EJRCROADBUILDMGNO" size="25" summ="default" type="STRING"/>
					<colinfo id="EJRCROADDETAIL" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRCROADREMAIN" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRCSANGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJRCSUBBUNJI" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJREJEJHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJREJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJRMAINBUNJI" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJRPNUCD" size="19" summ="default" type="STRING"/>
					<colinfo id="EJRROADBUILDMGNO" size="25" summ="default" type="STRING"/>
					<colinfo id="EJRROADDETAIL" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRROADREMAIN" size="100" summ="default" type="STRING"/>
					<colinfo id="EJRSANGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="EJRSUBBUNJI" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJSTATUS" size="1" summ="default" type="STRING"/>
					<colinfo id="EJTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="EJZIP" size="6" summ="default" type="STRING"/>
					<colinfo id="ESACCESSCNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="ESCOUSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="ESDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="ESEDUORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="ESENDTIME" size="4" summ="default" type="STRING"/>
					<colinfo id="ESGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="ESMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="ESSEATCNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="ESSTARTTIME" size="4" summ="default" type="STRING"/>
					<colinfo id="ESYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="JUBSUSTATUS" size="50" summ="default" type="STRING"/>
					<colinfo id="LASTYN" size="1" summ="default" type="STRING"/>
					<colinfo id="MFEE" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EJBUILDING" size="256" summ="default" type="STRING"/>
					<colinfo id="FMHSTARTDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EJPAYGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="EPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CEDUEXPIREDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEmailDomain">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduOrderMgno"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuAllInfo" OnRowPosChanged="ds_oJubsuAllInfo_OnRowPosChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oOrderHist">
				<Contents>
					<colinfo id="ABSENTYN" size="7" summ="default" type="STRING"/>
					<colinfo id="AFTERJIBU" size="4" summ="default" type="STRING"/>
					<colinfo id="AFTERJUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="AFTERMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AFTERORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="BEFORJIBU" size="4" summ="default" type="STRING"/>
					<colinfo id="BEFORJUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="BEFORMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BEFORORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" summ="default" type="STRING"/>
					<colinfo id="TJLASTSUNAPGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="TJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TOHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BEFORTOTCCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORTOMUNJEGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioCustomerFeeInfo" OnRowPosChanged="ds_ioCustomerFeeInfo_OnRowPosChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMenuTree">
				<Contents>
					<colinfo id="MORDERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MENULEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="MPARENTMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MURL" size="256" summ="default" type="STRING"/>
					<colinfo id="MREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="MURLTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MSYSGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oModifyColumn">
				<Contents>
					<colinfo id="COLUMNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="COLUMNNM" size="256" summ="default" type="STRING"/>
					<record>
						<COLUMNCD>EJNM</COLUMNCD>
						<COLUMNNM>성명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>RESIDENTNO</COLUMNCD>
						<COLUMNNM>주민번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJZIP</COLUMNCD>
						<COLUMNNM>우편번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR1</COLUMNCD>
						<COLUMNNM>주소1</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR2</COLUMNCD>
						<COLUMNNM>주소2</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJTEL</COLUMNCD>
						<COLUMNNM>전화번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EHPHONE</COLUMNCD>
						<COLUMNNM>휴대폰</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJEMAILID</COLUMNCD>
						<COLUMNNM>이메일ID</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJEMAILDOMAIN</COLUMNCD>
						<COLUMNNM>이메일주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>COMPNM</COLUMNCD>
						<COLUMNNM>근무처</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJHREASON</COLUMNCD>
						<COLUMNNM>비고</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJHJUBSUNO</COLUMNCD>
						<COLUMNNM>접수번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>CMGNO</COLUMNCD>
						<COLUMNNM>고객바코드번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>CGTMGNO</COLUMNCD>
						<COLUMNNM>고객지부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>CNO</COLUMNCD>
						<COLUMNNM>고객관리번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJADDRGUBUN</COLUMNCD>
						<COLUMNNM>주소구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRROADBUILDMGNO</COLUMNCD>
						<COLUMNNM>건물관리번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJRROADDETAIL</COLUMNCD>
						<COLUMNNM>상세주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRROADREMAIN</COLUMNCD>
						<COLUMNNM>부가주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRSANGUBUN</COLUMNCD>
						<COLUMNNM>산여부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRMAINBUNJI</COLUMNCD>
						<COLUMNNM>주번지</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRSUBBUNJI</COLUMNCD>
						<COLUMNNM>부번지</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRBUILDNM</COLUMNCD>
						<COLUMNNM>건물명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJRADDRETC</COLUMNCD>
						<COLUMNNM>기타주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJBUILDING</COLUMNCD>
						<COLUMNNM>대상물명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EJCOURSECD</COLUMNCD>
						<COLUMNNM>직능</COLUMNNM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduJubsuResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduReport"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduOrder"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oPosResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEduCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>소속지부접수</DATA>
					</record>
					<record>
						<CD>T</CD>
						<DATA>타지부접수</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingPearson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oChangeTpmgno">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>조회</DATA>
					</record>
					<record>
						<CD>C</CD>
						<DATA>성명/주민번호&#32;변경</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioYearbizlink"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioT_E_L_JubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioEduJubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTraing_ReturnTpmgnoJubsuCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTrainingPerson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioSettelYN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>Y</CD>
						<DATA>입금</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>미입금</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEducationNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioControl">
				<Contents>
					<colinfo id="No" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioTraingSeatNoCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSiteMember"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oAddr">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>0</CD>
						<DATA>지번주소</DATA>
					</record>
					<record>
						<CD>1</CD>
						<DATA>도로명주소</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oYN">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>Y</CD>
						<DATA>예</DATA>
					</record>
					<record>
						<CD>N</CD>
						<DATA>아니오</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioManager">
				<Contents>
					<colinfo id="MMGNO" size="22" summ="default" type="STRING"/>
					<colinfo id="FMLASTFMHSEQ" size="22" summ="default" type="STRING"/>
					<colinfo id="FMRESIDENTERR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMemberStatus">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDeleteCustomerFee"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCustJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oDetailCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="GCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSunap"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iReady">
				<Contents>
					<colinfo id="SEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CFGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="CMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CFMGGTMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CREGCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CCOURSECD" size="256" summ="default" type="STRING"/>
					<colinfo id="CFMEMBERGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="BNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CFPROCAMOUNT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="CFPROCDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CFREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECKDATA" size="256" summ="default" type="STRING"/>
					<colinfo id="CFMGGTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CCOURSENM" size="256" summ="default" type="STRING"/>
					<colinfo id="CFMEMBERNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFee"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFeeMonth">
				<Contents>
					<colinfo id="CFCCGUBUN" size="1" type="STRING"/>
					<colinfo id="CFGYEAR" size="4" type="STRING"/>
					<colinfo id="CFSUNAPHALF" size="1" type="STRING"/>
					<colinfo id="CFSUNAPMONTH" size="2" type="STRING"/>
					<colinfo id="CMGNO" size="22" type="DECIMAL"/>
					<colinfo id="MINAPFEE" size="22" type="DECIMAL"/>
					<colinfo id="SEL" size="1" type="STRING"/>
					<colinfo id="SUNAPFEE" size="22" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iCustomerFee">
				<Contents>
					<colinfo id="CFCMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="CFSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="CFSETLMGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="CFMEMBERGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="CFGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="CFGUBUNCD" size="2" summ="default" type="STRING"/>
					<colinfo id="CFSUNAPYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="CFSUNAPMONTH" size="2" summ="default" type="STRING"/>
					<colinfo id="CFSUNAPHALF" size="1" summ="default" type="STRING"/>
					<colinfo id="CFPROCAMOUNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="CFPROCDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="CFPONYGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="CFPONYDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="CFMGGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="CFPROCGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="CFPOSGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="CFPMYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="CFPMMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="CFGROUPMGNO" size="29" summ="default" type="STRING"/>
					<colinfo id="CFCANCELDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="CFCANCELSABUN" size="8" summ="default" type="STRING"/>
					<colinfo id="CFREMARK" size="100" summ="default" type="STRING"/>
					<colinfo id="CFREPAYREF" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="CFACTIVEGUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="CFREGDATE" size="7" summ="default" type="STRING"/>
					<colinfo id="CFREGSABUN" size="8" summ="default" type="STRING"/>
					<colinfo id="CFMODDATE" size="7" summ="default" type="STRING"/>
					<colinfo id="CFMODSABUN" size="8" summ="default" type="STRING"/>
					<colinfo id="CGTMGNO" size="4" summ="default" type="STRING"/>
					<colinfo id="CNO" size="6" summ="default" type="STRING"/>
					<colinfo id="CREGCD" size="2" summ="default" type="STRING"/>
					<colinfo id="CCOURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="BNM" size="40" summ="default" type="STRING"/>
					<colinfo id="FMNM" size="20" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioVirtualAccoutAllocation"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuAlreadyInfo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oForm">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택</DATA>
					</record>
					<record>
						<CD>0006</CD>
						<DATA>실무교육원서</DATA>
					</record>
					<record>
						<CD>00081</CD>
						<DATA>일정변경신청서</DATA>
					</record>
					<record>
						<CD>00082</CD>
						<DATA>환불신청서</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormSave">
				<Contents>
					<colinfo id="I_PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FRDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormSave"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_iFormDelete">
				<Contents>
					<colinfo id="I_FCCD" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FAMGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK1VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PK2VAL" size="256" summ="default" type="STRING"/>
					<colinfo id="I_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="I_FILENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oFormDelete"></Dataset>
		</Datasets>
		<Shape Bottom="126" Height="86" Id="shpGubunBox2" Left="332" LineColor="user15" Right="996" TabOrder="70" Top="40" Type="Rectangle" Width="664"></Shape>
		<Shape Bottom="247" Height="111" Id="shpGubunBox3" Left="332" LineColor="user15" Right="996" TabOrder="60" Top="136" Type="Rectangle" Width="664"></Shape>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="472" LineColor="user14" Right="996" TabOrder="47" Top="1" Type="Rectangle" Width="524"></Shape>
		<Shape Bottom="352" Height="312" Id="shpGubunBox1" Left="4" LineColor="user15" Right="330" TabOrder="60" Top="40" Type="Rectangle" Width="326"></Shape>
		<Shape Bottom="448" Height="153" Id="shpGubunBox4" Left="332" LineColor="user15" Right="996" TabOrder="60" Top="295" Type="Rectangle" Width="664"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="42" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="232">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="566" OnClick="lfn_Delete" Style="sty_Button" TabOrder="3" ToolTipText="삭제&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="479" OnClick="lfn_Save" Style="sty_Button" TabOrder="2" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="734" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="5" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="821" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="6" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="908" OnClick="lfn_End" Style="sty_Button" TabOrder="7" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="43" Text="지부" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnChanged="lfn_SearchEduLatestOrder" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="8" Top="55" UserData="I:지부" Width="88"></Combo>
		<Static Align="Center" BKColor="user15" Height="72" Id="lbCourse" Left="6" Style="sty_Label" TabOrder="44" Text="직능" Top="80" UserData="S" VAlign="Middle" Width="16" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbTrainingYear" Left="192" Style="sty_Label" TabOrder="45" Text="년도" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Height="20" Id="edEduYear" ImeMode="native" Left="284" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edEduYear_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="56" UserData="I:년도" Width="36"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbTrainingOrder" Left="8" Style="sty_Label" TabOrder="46" Text="회차" Top="157" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbPersonNm" Left="336" Style="sty_Label" TabOrder="47" Text="성명" Top="151" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edEduOrder" ImeMode="native" Left="100" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edEduOrder_OnKeyDown" OnKillFocus="edEduOrder_OnKillFocus" Style="sty_Edit" TabOrder="11" Top="157" UserData="S:회차" Width="28"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbBirthday" Left="336" Style="sty_Label" TabOrder="48" Text="생년월일" Top="175" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbAt" Left="771" Style="sty_Text" TabOrder="49" Text="@" Top="199" VAlign="Middle" Visible="FALSE" Width="16"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJNM" Height="20" Id="edPersonNm" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="18" Top="151" UserData="S:성명" Width="106"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuNo" ImeMode="native" Left="100" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edJubsuNo_OnKeyDown" OnKillFocus="edJubsuNo_OnKillFocus" Style="sty_Edit" TabOrder="13" Top="181" UserData="S:접수번호" Width="28"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbSeq" Left="8" Style="sty_Label" TabOrder="50" Text="접수번호" Top="181" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbAddr" Left="336" Style="sty_Label" TabOrder="52" Text="주소" Top="102" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioEduJubsu" BKColor="user4" Border="Flat" Column="EJZIP" Enable="FALSE" Height="20" Id="medZipCode" Left="428" LeftMargin="2" Mask="######" OnFocus="edZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="20" Top="102" Type="STRING" UserData="S" Width="50"></MaskEdit>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="ADDR1" Enable="FALSE" Height="20" Id="edAddr1" ImeMode="native" Left="481" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="21" Top="102" UserData="S" Width="260"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="ADDR2" Enable="FALSE" Height="20" Id="edAddr2" ImeMode="native" Left="744" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="22" Top="102" UserData="S" Width="247"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbHpTel" Left="336" Style="sty_Label" TabOrder="51" Text="연락처" Top="199" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJPHONE" Height="20" Id="edHpTel" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="23" Top="199" UserData="S" Width="106"></Edit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJBIRTHDAY" Height="20" Id="medBirthday" Left="428" LeftMargin="2" Mask="######-#" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="19" Top="175" Type="STRING" UserData="S:주민번호" Value="접수자검색" Width="65"></MaskEdit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxEmailDomain" INDEX="0" InnerDataset="ds_oEmailDomain" Left="891" OnChanged="cbxEmailDomain_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="26" Top="198" Visible="FALSE" Width="92"></Combo>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbEmail" Left="613" Style="sty_Label" TabOrder="53" Text="E-Mail" Top="199" VAlign="Middle" Visible="FALSE" Width="60"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJEMAILID" Height="20" Id="edEmail" ImeMode="native" Left="677" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="24" Top="199" UserData="S" Visible="FALSE" Width="95"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJISUGUBUN" Enable="FALSE" Height="20" Id="edPassYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="37" Top="303" UserData="S" Width="28"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbPassYn" Left="8" Style="sty_Label" TabOrder="53" Text="이수여부" Top="303" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="ABSENTYN" Enable="FALSE" Height="20" Id="edAbsentYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="38" Text="Y&#32;:&#32;1일차" Top="327" UserData="S" Width="64"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbAbsentYn" Left="8" Style="sty_Label" TabOrder="54" Text="결강여부" Top="327" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAbsentManageLink" ImageID="BTN_TEXT_05" Left="168" OnClick="btnAbsentManageLink_OnClick" Style="sty_Button" TabOrder="17" Text="결강자관리" Top="354" Transparent="TRUE" Visible="FALSE" Width="79"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEduJubsuModify" ImageID="BTN_TEXT_COM" Left="100" OnClick="btnEduJubsuModify_OnClick" Style="sty_Button" TabOrder="16" Text="회차변경" Top="278" Transparent="TRUE" Width="85"></Button>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oJubsuAllInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="592" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdJubsuInfo" InputPanel="FALSE" Left="4" LineColor="default" OnCellClick="gdJubsuInfo_OnCellClick" Right="496" RowHeight="20" Style="sty_Grid" TabOrder="30" TabStop="true" Top="484" UseDBuff="true" UsePopupMenu="true" UserData="개인접수정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="492">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="60"/>
						<col width="36"/>
						<col width="109"/>
						<col width="31"/>
						<col width="58"/>
						<col width="83"/>
						<col width="59"/>
						<col width="83"/>
						<col width="83"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="지부"/>
						<cell align="center" col="2" display="text" text="년도"/>
						<cell align="center" col="3" display="text" text="직능"/>
						<cell align="center" col="4" display="text" text="회차"/>
						<cell align="center" col="5" display="text" text="접수번호"/>
						<cell align="center" col="6" display="text" text="이수일자"/>
						<cell align="center" col="7" display="text" text="수납여부"/>
						<cell align="center" col="8" display="text" text="접수일자"/>
						<cell align="center" col="9" display="text" text="접수자"/>
					</head>
					<body>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="0" display="number" expr="ln_TotalGridInfoCount&#32;-&#32;CURROW"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="1" colid="ESGTMGNO" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="2" colid="ESYEAR" display="text"/>
						<cell align="left" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="3" colid="ESCOUSECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="4" colid="ESEDUORDER" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="5" colid="EJHJUBSUNO" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="6" colid="ISUDATE" display="text" Mask="####-##-##"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="7" colid="SUNAPGUBUN" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="8" colid="PROCDATE" display="text" Mask="####-##-##"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="9" colid="EJHSABUN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="user30" Height="20" Id="lbJubsuInfo" Left="4" Style="sty_LabelGruopBox" TabOrder="55" Text="최종접수정보" Top="460" VAlign="Middle" Width="120"></Static>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oOrderHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="592" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdOrderHist" InputPanel="FALSE" Left="500" LineColor="default" OnCellClick="gdOrderHist_OnCellClick" Right="996" RowHeight="20" Style="sty_Grid" TabOrder="31" TabStop="true" Top="484" UseDBuff="true" UsePopupMenu="true" UserData="회차변경정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="496">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="85"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="85"/>
						<col width="85"/>
						<col width="189"/>
						<col width="60"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2" SuppressAlign="Middle" text="순번">
							<cell col="0" display="text" rowspan="2" text="순번"/>
						</cell>
						<cell col="1" display="text" rowspan="2" SuppressAlign="Middle" text="접수상태">
							<cell col="0" display="text" rowspan="2" text="처리일자"/>
						</cell>
						<cell col="2" display="text" rowspan="2" SuppressAlign="Middle" text="지부">
							<cell col="0" display="text" rowspan="2" text="지부"/>
						</cell>
						<cell col="3" display="text" rowspan="2" SuppressAlign="Middle" text="회차">
							<cell col="0" display="text" rowspan="2" text="회차"/>
						</cell>
						<cell col="4" display="text" rowspan="2" SuppressAlign="Middle" text="접수번호">
							<cell col="0" display="text" rowspan="2" text="접수번호"/>
						</cell>
						<cell col="5" colspan="3" display="text" text="변경&#32;후">
							<cell col="0" colspan="3" display="text" text="변경&#32;후"/>
						</cell>
						<cell col="8" display="text" rowspan="2" SuppressAlign="Middle" text="처리일자">
							<cell col="0" display="text" rowspan="2" text="처리일자"/>
						</cell>
						<cell col="9" display="text" rowspan="2" SuppressAlign="Middle" text="처리자">
							<cell col="0" display="text" rowspan="2" text="처리일자"/>
						</cell>
						<cell col="10" display="text" rowspan="2" SuppressAlign="Middle" text="사유">
							<cell col="0" display="text" rowspan="2" text="사유"/>
						</cell>
						<cell col="11" display="text" rowspan="2" SuppressAlign="Middle" text="수납여부">
							<cell col="0" display="text" rowspan="2" text="환불여부"/>
						</cell>
						<cell align="center" col="5" display="text" row="1" text="지부"/>
						<cell align="center" col="6" display="text" row="1" text="회차"/>
						<cell align="center" col="7" display="text" row="1" text="접수번호"/>
					</head>
					<body>
						<cell align="center" col="0" display="number" expr="ln_TotalGridOrderCount&#32;-&#32;CURROW"/>
						<cell align="center" col="1" colid="STATUS" display="text"/>
						<cell align="center" col="2" colid="BEFORJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="3" colid="BEFORORDER" display="text"/>
						<cell align="center" col="4" colid="BEFORJUBSUNO" display="text"/>
						<cell align="center" col="5" colid="AFTERJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="6" colid="AFTERORDER" display="text"/>
						<cell align="center" col="7" colid="AFTERJUBSUNO" display="text"/>
						<cell align="center" col="8" colid="PROCDATE" display="text"/>
						<cell align="center" col="9" colid="EJHSABUN" display="text"/>
						<cell col="10" colid="EJHREASON" display="text"/>
						<cell align="center" col="11" colid="SUNAPGUBUN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="user30" Height="20" Id="lbJubsuHist" Left="500" Style="sty_LabelGruopBox" TabOrder="56" Text="접수이력" Top="460" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" BKColor="user30" Height="20" Id="lbSetlmt" Left="341" Style="sty_LabelGruopBox" TabOrder="57" Text="회비/교육비&#32;내역" Top="282" VAlign="Middle" Width="120"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJEMAILDOMAIN" Height="20" Id="edEmailDomain" ImeMode="native" Left="785" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="25" Top="199" UserData="S" Visible="FALSE" Width="104"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeqList" ImageID="BTN_TEXT_05" Left="173" OnClick="btnSeqList_OnClick" Style="sty_Button" TabOrder="14" Text="접수목록" ToolTipText="현접수번호를&#32;제외한&#32;이후&#32;목록" Top="180" Transparent="TRUE" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchEduOrder" ImageID="BTN_TEXT_06" Left="132" OnClick="btnSearchEduOrder_OnClick" OnKeyDown="btnSearchEduOrder_OnClick" Style="sty_Button" TabOrder="12" Text="접수가능회차" Top="156" Transparent="TRUE" Width="92"></Button>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbRemark" Left="336" Style="sty_Label" TabOrder="58" Text="비고(사유&#32;등)" Top="223" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJHREASON" Height="20" Id="edRemark" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="27" Top="223" UserData="S" Width="560"></Edit>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Font="굴림,9" Height="72" Id="radCourse" INDEX="0" InnerDataset="ds_oCourse" Left="22" OnChanged="lfn_SearchEduLatestOrder" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="10" Top="80" UserData="I:직능" Width="306"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendSms" ImageID="BTN_TEXT_04" Left="537" OnClick="btnSendSms_OnClick" Style="sty_Button" TabOrder="28" Text="문자발송" Top="198" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintJubsu" ImageID="BTN_TEXT_05" Left="653" OnClick="btnPrintJubsu_OnClick" Style="sty_Button" TabOrder="4" Text="참가원출력" ToolTipText="참가원출력" Top="4" Width="80"></Button>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbOrderChange" Left="8" Style="sty_Label" TabOrder="60" Text="회차변경" Top="279" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="#cc0000" Bottom="281" Height="4" Id="shpBox1" Left="328" LineColor="#cc0000" Right="1000" TabOrder="60" Top="277" Type="Rectangle" Width="672"></Shape>
		<Shape BKColor="#cc0000" Bottom="456" Height="4" Id="shpBox2" Left="0" LineColor="#cc0000" Right="1000" TabOrder="60" Top="452" Type="Rectangle" Width="1000"></Shape>
		<Static Align="Center" BKColor="user15" Height="46" Id="lbTrainingInfo" Left="8" Style="sty_Label" TabOrder="60" Text="회차정보" Top="229" VAlign="Middle" Width="36" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="user30" Height="20" Id="lbTrainingPersonInfo" Left="340" Style="sty_LabelGruopBox" TabOrder="60" Text="선임자&#32;정보" Top="128" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" BKColor="user30" Height="20" Id="lbJubsu" Left="13" Style="sty_LabelGruopBox" TabOrder="60" Text="접수" Top="31" VAlign="Middle" Width="60"></Static>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbEduInfo2" Left="48" Style="sty_Label" TabOrder="36" Top="252" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnUnUseJubsuNo" ImageID="BTN_TEXT_04" Left="256" OnClick="lfn_SearchUnUseJubsuNo" Style="sty_Button" TabOrder="15" Text="빈번호" ToolTipText="빈접수번호조회" Top="180" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnModifyHistory" ImageID="BTN_TEXT_04" Left="258" OnClick="btnModifyHistory_OnClick" Style="sty_Button" TabOrder="29" Text="변경이력" ToolTipText="접수정보변경이력" Top="326" Transparent="TRUE" Width="66"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radJibuGubun" INDEX="0" InnerDataset="ds_oJibuGubun" Left="96" LeftMargin="2" OnChanged="radJibuGubun_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="61" Top="32" Value="S" Width="200"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsuHistory" ImageID="BTN_TEXT_04" Left="188" OnClick="btnJubsuHistory_OnClick" Style="sty_Button" TabOrder="62" Text="접수이력" Top="326" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfoChange" ImageID="BTN_TEXT_07" Left="787" OnClick="btnSearchPersonInfoChange_OnClick" Style="sty_Button" TabOrder="62" Text="접수자정보변경" Top="137" Transparent="TRUE" Visible="FALSE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEduJubsuinfo" ImageID="BTN_TEXT_11" Left="336" OnClick="btnEduJubsuinfo_OnClick" Style="sty_Button" TabOrder="63" Text="개인접수정보&#32;상세보기" Top="458" Transparent="TRUE" Visible="FALSE" Width="158"></Button>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbEduInfo1" Left="48" Style="sty_Label" TabOrder="63" Top="230" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_ioEduJubsu" Border="Flat" CodeColumn="CD" Column="EJADDRGUBUN" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxAddrGubun" INDEX="0" InnerDataset="ds_oAddr" Left="904" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="64" Top="101" UserData="S" Visible="FALSE" Width="89"></Combo>
		<Edit BindDataset="ds_ioEduJubsu" Column="EJMGNO" Height="20" Id="edImsiEJMGNO" Left="700" TabOrder="65" Top="459" Width="62"></Edit>
		<Static Align="Center" BKColor="user30" BorderColor="user0" Height="20" Id="lbImsiEJMGNO" Left="645" Style="sty_Label" TabOrder="66" Text="EJMGNO" Top="459" VAlign="Middle" Width="55"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDeleteSettlement" ImageID="BTN_TEXT_05" Left="776" OnClick="btnDeleteSettlement_OnClick" Style="sty_Button" TabOrder="67" Text="결제삭제" Top="283" Transparent="TRUE" Width="81"></Button>
		<Static Align="Center" BKColor="user30" Height="20" Id="Static0" Left="340" Style="sty_LabelGruopBox" TabOrder="72" Text="대상물(업체)&#32;정보" Top="32" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" BKColor="user15" Height="20" Id="Static1" Left="336" Style="sty_Label" TabOrder="73" Text="선임대상물" Top="79" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edBuildingNm" ImeMode="native" Left="427" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edBuildingNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="74" Top="79" UserData="I:대상물명" Width="229"></Edit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbDetailCourse" Left="697" Style="sty_LabelGruopBox" TabOrder="76" Text="세부직능" Top="79" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_ioEduJubsu" Border="Flat" CodeColumn="CD" Column="CCOURSECD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Font="굴림,10" Height="20" Id="cbxDetailCourse" ImeMode="none" INDEX="0" InnerDataset="ds_oDetailCourse" Left="786" OnChanged="cbxDetailCourse_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="75" Top="78" UserData="S" Value="B" Width="200"></Combo>
		<Static Align="Center" BKColor="user15" Height="20" Id="Static2" Left="336" Style="sty_LabelGruopBox" TabOrder="82" Text="지부" Top="56" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxCustJibu" INDEX="0" InnerDataset="ds_oJibu" Left="426" OnChanged="cbxCustJibu_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="77" Top="55" UserData="I:지부" Value="B" Width="90"></Combo>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbCustNo" Left="517" Style="sty_LabelGruopBox" TabOrder="81" Text="관리번호" Top="56" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medCustNo" Left="607" LeftMargin="2" Mask="######" MaxLength="6" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medCustNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="78" Top="56" Type="STRING" UserData="S" Width="50"></MaskEdit>
		<Static Align="Center" BKColor="user15" Height="20" Id="lbBarCode" Left="697" Style="sty_LabelGruopBox" TabOrder="80" Text="관리바코드" Top="56" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medBarCode" InputPanel="FALSE" Left="787" LeftMargin="2" Mask="#############" MaxLength="13" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medBarCode_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="79" TabStop="FALSE" Top="56" Type="STRING" UserData="S" Width="98"></MaskEdit>
		<Static Align="Center" BKColor="user15" Height="20" Id="Static3" Left="188" Style="sty_Label" TabOrder="83" Text="회차변경횟수" Top="279" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJCHANGECNT" Enable="FALSE" Height="20" Id="edChangeCnt" ImeMode="native" Left="279" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="84" Top="279" UserData="S" Width="36"></Edit>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radChangeTpmgno" INDEX="0" InnerDataset="ds_oChangeTpmgno" Left="896" LeftMargin="2" OnChanged="radChangeTpmgno_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="85" Top="139" Value="S" Visible="FALSE" Width="96"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCustNo" ImageID="검색" Left="659" OnClick="btnCustNo_OnClick" Style="sty_Button" TabOrder="86" Top="54" Transparent="TRUE" Width="35"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCmgno" ImageID="검색" Left="887" OnClick="btnCmgno_OnClick" Style="sty_Button" TabOrder="87" Top="55" Transparent="TRUE" Width="35"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnNm" ImageID="검색" Left="536" OnClick="btnNm_OnClick" Style="sty_Button" TabOrder="88" Top="150" Transparent="TRUE" Width="35"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnBnm" ImageID="검색" Left="659" OnClick="btnBnm_OnClick" Style="sty_Button" TabOrder="89" Top="78" Transparent="TRUE" Width="35"></Button>
		<Grid AutoFit="TRUE" BindDataset="ds_oFee" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="414" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="94" Id="gdMemFee" InputPanel="FALSE" Left="336" LineColor="default" MinWidth="100" Right="584" Style="sty_Grid" TabOrder="90" TabStop="true" Top="320" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="248">
			<contents>
				<format id="Default">
					<columns>
						<col width="38"/>
						<col width="46"/>
						<col width="78"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" combodataset="ds_ioAccount" display="text" text="년도"/>
						<cell col="1" display="text" text="구분"/>
						<cell col="2" display="text" text="미납금액"/>
						<cell col="3" display="text" text="수납금액"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CFGYEAR" display="text"/>
						<cell align="center" col="1" colid="CFCCGUBUN" display="text" expr="decode(CFCCGUBUN,0,&apos;회비&apos;,1,&apos;교육비&apos;)"/>
						<cell align="right" col="2" colid="MINAPFEE" display="number"/>
						<cell align="right" col="3" colid="SUNAPFEE" display="expr:iif(SUNAPFEE&#32;==&#32;0&#32;&amp;&amp;&#32;MINAPFEE&#32;==&#32;0&#32;&amp;&amp;&#32;REALSUNAPFEE&#32;==&#32;0,&#32;&apos;text&apos;,&#32;&apos;number&apos;)" expr="iif(SUNAPFEE&#32;==&#32;0&#32;&amp;&amp;&#32;MINAPFEE&#32;==&#32;0&#32;&amp;&amp;&#32;REALSUNAPFEE&#32;==&#32;0,&#32;&apos;면제&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&apos;,&#32;SUNAPFEE)"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbEmailCnt" Left="384" Style="sty_LabelStat" TabOrder="92" Text="교육년도&#32;기준&#32;미납액" Top="300" VAlign="Middle" Width="126"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" DisableColor="brown" Enable="FALSE" Font="굴림,10,Bold" Height="20" Id="medTotMinapFee" Left="511" Mask="#,###" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="91" Top="300" Width="71"></MaskEdit>
		<Button ButtonStyle="TRUE" Color="firebrick" Cursor="HAND" Font="굴림,11,Bold" Height="22" Id="btnSetlmt" ImageID="BTN_TEXT_12" Left="588" OnClick="btnSetlmt_OnClick" Style="sty_Button" TabOrder="93" Text="회비/교육비&#32;결제하기" Top="299" Transparent="TRUE" Width="170"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsuNo" ImageID="BTN_조회_ss" Left="130" OnClick="btnJubsuNo_OnClick" Style="sty_Button" TabOrder="94" Top="180" Transparent="TRUE" Width="35"></Button>
		<Grid AutoEnter="TRUE" BindDataset="ds_oSunap" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="443" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="120" Id="gdSunap" InputPanel="FALSE" Left="588" LineColor="default" Right="994" RowHeight="20" Style="sty_Grid" TabOrder="95" TabStop="true" Top="323" UseDBuff="true" UsePopupMenu="true" UserData="결제정보(POS)" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="406">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="95"/>
						<col width="39"/>
						<col width="65"/>
						<col width="103"/>
						<col width="54"/>
						<col width="76"/>
						<col width="78"/>
						<col width="55"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="102"/>
						<col width="296"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="No"/>
						<cell align="center" col="1" display="text" text="년월"/>
						<cell col="2" display="text" text="결제"/>
						<cell col="3" display="text" text="결제구분"/>
						<cell col="4" display="text" text="결제방법"/>
						<cell col="5" display="text" text="금액"/>
						<cell col="6" display="text" text="처리일자"/>
						<cell col="7" display="text" text="정산일자"/>
						<cell col="8" display="text" text="계산서"/>
						<cell col="9" display="text" text="처리자"/>
						<cell col="10" display="text" text="처리지부"/>
						<cell col="11" display="text" text="관리지부"/>
						<cell col="12" display="text" text="POS지부"/>
						<cell col="13" display="text" text="주문번호"/>
						<cell col="14" display="text" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="0" display="text" expr="ds_oSunap.GetRowCount()&#32;-&#32;currow" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="1" colid="SUNAPYEAR" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="2" colid="SETLMGUBUNNM" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="3" colid="CFGUBUN" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="4" colid="CFGUBUNCDNM" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="right" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="5" colid="SUNAPFEE" display="number" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="6" colid="PROCDATE" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="7" colid="PONYDATE" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="8" colid="PVINFO" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="9" colid="CFREGNM" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="10" colid="PROCGTNM" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="11" colid="MGGTNM" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="12" colid="POSGTNM" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="center" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="13" colid="PMPCORDERNO" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
						<cell align="left" bkcolor='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;USER6&quot;)' col="14" colid="CFREMARK" display="text" font='expr:iif(SETLMGUBUN&#32;==&#32;&quot;1&quot;&#32;&amp;&amp;&#32;CFGUBUNCD&#32;&lt;&gt;&#32;&quot;31&quot;,&#32;&quot;굴림,10,Italic&quot;)'/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user10" Bottom="442" Height="120" Id="Shape2" Left="584" LineColor="user10" Right="587" TabOrder="96" Top="322" Type="Rectangle" Width="3"></Shape>
		<Grid AutoEnter="TRUE" BindDataset="ds_iReady" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="708" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="92" Id="gdReady" InputPanel="FALSE" Left="336" LineColor="default" OnHeadClick="lfn_GridCheck" Right="1128" RowHeight="20" Style="sty_Grid" TabOrder="97" TabStop="true" Top="616" UseDBuff="true" UsePopupMenu="true" UserData="결제대기" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="792">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="34"/>
						<col width="70"/>
						<col width="69"/>
						<col width="57"/>
						<col width="96"/>
						<col width="58"/>
						<col width="154"/>
						<col width="65"/>
						<col width="80"/>
						<col width="233"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" text="순번"/>
						<cell col="2" display="text" text="지부"/>
						<cell align="center" col="3" display="text" text="관리번호"/>
						<cell col="4" display="text" text="지역"/>
						<cell col="5" display="text" text="직능"/>
						<cell col="6" display="text" text="고객구분"/>
						<cell align="center" col="7" display="text" text="대상물(업체)명"/>
						<cell align="center" col="8" display="text" text="선임자명"/>
						<cell col="9" display="text" text="금액"/>
						<cell col="10" display="text" text="사유(비고)"/>
					</head>
					<body>
						<cell col="0" colid="SEL" display="expr:iif(SEL&#32;==&#32;&apos;X&apos;,&#32;&apos;null&apos;,&#32;&apos;checkbox&apos;)" edit="expr:iif(SEL&#32;==&#32;&apos;X&apos;,&#32;&apos;none&apos;,&#32;&apos;checkbox&apos;)"/>
						<cell align="center" col="1" display="number" expr="row+1"/>
						<cell align="center" col="2" colid="CFMGGTNM" display="text"/>
						<cell align="center" col="3" colid="CNO" display="text"/>
						<cell align="center" col="4" colid="CREGCD" display="text"/>
						<cell align="center" col="5" colid="CCOURSENM" display="text"/>
						<cell align="center" col="6" colid="CFMEMBERNM" display="text"/>
						<cell align="left" col="7" colid="BNM" display="text"/>
						<cell align="center" col="8" colid="FMNM" display="text"/>
						<cell align="right" col="9" colid="CFPROCAMOUNT" display="number"/>
						<cell align="left" col="10" colid="CFREMARK" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="user37" Border="RaisedEdge" Font="굴림,12,Bold" Height="23" Id="lbInputStatus" Left="48" Style="sty_LabelStat" TabOrder="98" Text="신규/수정" Top="204" VAlign="Middle" Width="131"></Static>
		<Static Align="Center" BKColor="user39" Border="RaisedEdge" Font="굴림,12,Bold" Height="23" Id="lbJubsuStatus" Left="188" Style="sty_LabelStat" TabOrder="99" Text="접수상태" Top="204" VAlign="Middle" Width="131"></Static>
		<Shape Bottom="448" Height="85" Id="Shape3" Left="4" LineColor="maroon" Right="330" TabOrder="100" Top="363" Type="Rectangle" Width="326"></Shape>
		<Static Align="Center" BKColor="darkred" Border="Flat" Height="20" Id="Static4" Left="13" Style="sty_LabelGruopBox" TabOrder="101" Text="기존&#32;접수자&#32;조회" Top="355" VAlign="Middle" Width="110"></Static>
		<Static Align="Center" BKColor="sienna" Height="20" Id="Static5" Left="12" Style="sty_Label" TabOrder="103" Text="성명" Top="379" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edExistNM" ImeMode="native" Left="102" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExistNM_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="102" Top="379" Width="87"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExistNM" ImageID="BTN_조회_ss" Left="192" OnClick="btnExistNM_OnClick" Style="sty_Button" TabOrder="104" Top="378" Transparent="TRUE" Width="35"></Button>
		<Static Align="Center" BKColor="sienna" Height="20" Id="Static6" Left="12" Style="sty_LabelGruopBox" TabOrder="107" Text="지부+관리번호" Top="402" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxExistJibu" INDEX="0" InnerDataset="ds_oJibu" Left="101" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="105" Top="401" Value="B" Width="90"></Combo>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medExistCustNo" Left="193" LeftMargin="2" Mask="######" MaxLength="6" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medExistCustNo_OnKeyDown" OnKillFocus="medCustNo_OnKillFocus" Style="sty_Maskedit" TabOrder="106" Top="402" Type="STRING" Width="50"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExistCustNo" ImageID="BTN_조회_ss" Left="245" OnClick="btnExistCustNo_OnClick" Style="sty_Button" TabOrder="108" Top="400" Transparent="TRUE" Width="35"></Button>
		<Static Align="Center" BKColor="sienna" Height="20" Id="Static7" Left="12" Style="sty_LabelGruopBox" TabOrder="109" Text="선임대상물" Top="424" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnExistBnm" ImageID="BTN_조회_ss" Left="290" OnClick="btnExistBnm_OnClick" Style="sty_Button" TabOrder="110" Top="423" Transparent="TRUE" Width="35"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edExistBnm" ImeMode="native" Left="102" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edExistBnm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="111" Top="424" Width="186"></Edit>
		<Static Color="firebrick" Font="굴림,9,Bold" Height="15" Id="Static8" Left="470" TabOrder="112" Text='&quot;검색&quot;버튼&#32;:&#32;접수대상&#32;검색시&#32;또는&#32;접수자&#32;정보&#32;변경시&#32;사용' Top="39" VAlign="Bottom" Width="360"></Static>
		<Static Color="user10" Font="굴림,9,Bold" Height="15" Id="Static9" Left="775" TabOrder="113" Text="※&#32;접수시&#32;결제한&#32;내역만&#32;표시됩니다." Top="306" VAlign="Bottom" Visible="FALSE" Width="220"></Static>
		<Static Align="Center" BKColor="user15" Height="20" Id="Static10" Left="8" Style="sty_Label" TabOrder="114" Text="상태" Top="205" UserData="S" VAlign="Middle" Width="36"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnShowVirtualAccount" ImageID="BTN_TEXT_15" Left="354" OnClick="btnShowVirtualAccount_OnClick" Style="sty_Button" TabOrder="115" Text="가상계좌(유효기간&#32;부여&amp;문자발송)&#32;" Top="420" Transparent="TRUE" Width="212"></Button>
		<Static Align="Center" BKColor="darkred" Height="20" Id="lbEduExpireDate" Left="613" Style="sty_Label" TabOrder="116" Text="실무교육&#32;유효기간" Top="175" VAlign="Middle" Visible="FALSE" Width="110"></Static>
		<Calendar BindDataset="ds_ioEduJubsu" Border="Flat" Column="CEDUEXPIREDATE" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" Enable="FALSE" HeaderFont="돋음,10,Bold" Height="20" Id="calEduExpireDate" Left="725" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="117" Top="175" UserData="S" Visible="FALSE" WeeksFont="돋음,9" Width="96"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSmsStat" ImageID="BTN_TEXT_04" Left="537" OnClick="btnSmsStat_OnClick" Style="sty_Button" TabOrder="118" Text="문자현황" Top="175" Transparent="TRUE" Width="66"></Button>
		<Shape Bottom="276" Height="27" Id="Shape0" Left="332" LineColor="darkgoldenrod" Right="996" TabOrder="119" Top="249" Type="Rectangle" Width="664"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSave" ImageID="BTN_TEXT_04" Left="909" OnClick="btnScanSave_OnClick" Style="sty_Button" TabOrder="126" Text="③서류저장" ToolTipText="서류저장" Top="252" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLocalFormView" ImageID="BTN_SEARCH" Left="883" OnClick="btnLocalFormView_OnClick" Style="sty_Button" TabOrder="128" Top="252" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edScanFileName" ImeMode="native" Left="808" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="125" Top="253" UserData="S" Width="74"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScanSearch" ImageID="BTN_TEXT_04" Left="739" OnClick="btnScanSearch_OnClick" Style="sty_Button" TabOrder="124" Text="②불러오기" ToolTipText="불러오기" Top="252" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Font="굴림,9,Bold" Height="22" Id="btnScan" ImageID="BTN_TEXT_04" Left="670" OnClick="btnScan_OnClick" Style="sty_Button" TabOrder="123" Text="①스캔실행" ToolTipText="스캔실행" Top="252" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeverFormView" ImageID="BTN_SEARCH" Left="644" OnClick="btnSeverFormView_OnClick" Style="sty_Button" TabOrder="122" Top="252" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edFormResult" ImeMode="native" Left="598" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="121" Top="252" UserData="S" Width="45"></Edit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxForm" INDEX="0" InnerDataset="ds_oForm" Left="426" OnChanged="cbxForm_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="127" Top="251" Width="172"></Combo>
		<Static Align="Center" BKColor="firebrick" Height="20" Id="Static11" Left="336" Style="sty_Label" TabOrder="120" Text="민원서류&#32;등록" Top="252" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnFormDelete" ImageID="BTN_MINUS" Left="978" OnClick="btnFormDelete_OnClick" Style="sty_Button" TabOrder="129" ToolTipText="서류삭제" Top="255" Transparent="TRUE" Visible="FALSE" Width="16"></Button>
		<FileDialog Bottom="24" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage2" Left="330" Right="354" TabOrder="130" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage2" Left="357" Width="24"></HttpFile>
		<File Bottom="24" Height="24" Id="fiImageFile2" Left="384" Right="408" TabOrder="131" Width="24"></File>
		<Static Align="Center" BKColor="user39" Font="굴림,9" Height="20" Id="Static12" Left="580" Style="sty_Label" TabOrder="130" Text="개인식별번호" Top="151" VAlign="Middle" Width="80"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJPERSONKEY" Font="굴림,9" Height="20" Id="medPersonKey" Left="661" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Maskedit" TabOrder="131" Top="151" Type="STRING" Width="75"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCyberInfoOLD" ImageID="BTN_TEXT_07" Left="250" OnClick="btnCyberInfo_OnClick" Style="sty_Button" TabOrder="132" Text="사이버교육&#32;정보" ToolTipText="사이버교육&#32;정보" Top="354" Transparent="TRUE" Visible="FALSE" Width="106"></Button>
		<Static Align="Center" BKColor="user32" Height="20" Id="Static13" Left="136" Style="sty_Label" TabOrder="133" Text="사이버" Top="303" VAlign="Middle" Width="40"></Static>
		<Static Align="Center" BKColor="user32" Height="20" Id="Static14" Left="244" Style="sty_Label" TabOrder="134" Text="소집" Top="303" VAlign="Middle" Visible="FALSE" Width="40"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="CYBERISUGUBUN" Enable="FALSE" Height="20" Id="edCyberPassYn" ImeMode="native" Left="179" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="135" Top="303" UserData="S" Width="36"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="EJISUGUBUN" Enable="FALSE" Height="20" Id="edFieldPassYn" ImeMode="native" Left="287" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="136" Top="303" UserData="S" Visible="FALSE" Width="36"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCyberInfo" ImageID="BTN_SEARCH" Left="218" OnClick="btnCyberInfo_OnClick" Style="sty_Button" TabOrder="137" Top="303" Transparent="TRUE" Width="22"></Button>
		<Static Align="Center" BKColor="user39" Font="굴림,9" Height="20" Id="Static15" Left="748" Style="sty_Label" TabOrder="138" Text="주민번호대체키" Top="151" VAlign="Middle" Width="90"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_ioEduJubsu" Border="Flat" Column="PDI" Enable="FALSE" Height="20" Id="edPDI" ImeMode="native" Left="840" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="139" Top="151" UserData="S" Width="45"></Edit>
	</Form>
	<Script><![CDATA[/*

 * 프로그램명 : frmcust1025MEduJubsuManagement.xml

 * 설명 : 실무교육접수관리

 * 작성일 : 2015.01.19

 * 작성자 : 정현호

 */



#include "LIB::cust.js"; // 공통업무 관련
/*
sJibu	: 고객정보관리에서 연동된 지부코드
sCustNo	: 고객정보관리에서 연동된 관리번호
sCoursecd : 고객정보관리에서 연동된 직능코드
*/


var ls_IsChangedJubsuInfoYn = "N"; // 접수자정보 변경여부
var Tomgno_AA = "";     // 회차관리번호 이전  좌석 선택시 가비지 정보 제거 위함
var TohjubsuNo_AA = "";   // 접수번호 이전

var ls_EjMgno = ""; // 실무교육접수관리번호
var ls_EsMgno = ""; // 실무교육일정관리번호

var ls_OldCmgno = "";  // 수정전 고객바코드번호
var ls_OldGtmgno = ""; // 수정전 지부
var ls_OldCno = "";    // 수정전 CNO
var ls_OldBnm = "";    // 수정전 대상물명
var ls_OldEjnm = "";   // 수정전 성명
	
var serch_falg = "";   // 0:접수번호조회, 1:선택해서 조회, 2:기존접수자 조회로 조회

var ls_FormUploadPath = "/IMGDATA/Form/" + left(GetDate(), 4); // 서류스캔파일경로;
var ls_UploadFormName = false; 		// 서류스캔 저장파일명
var lb_FormFileUpload = false; 		// 서류스캔파일등록여부


/* 공통 필수 시작 */

function Form_OnLoadCompleted(obj) {

    gfn_Form_OnLoadCompletedCheck(obj); //공통 폼 로딩 이벤트 처리(공통코드 조회되었는지 확인)

    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정

    ls_SystemGubun = gs_SystemGubun;

    ls_SystemMenuId = gs_SystemMenuId;

    var ls_FormId = split(sFormUrl, "::");

    ls_FormId = split(ls_FormId[1], ".");

    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";



    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.



    ms_FormAuth = gfn_GetFormAuth(this, sFormUrl); // 권한을 조회한다.

    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정

        lfn_SetFormAuth(true); // 저장 권한

    } else if (ms_FormAuth == "R") {

        lfn_SetFormAuth(false); // 읽기 권한

    } else {

        gfn_Alert(MSGI00080);

        close();

    }

	// 시스템관리자만 tjmgno, tpmgno가 보이도록 설정
	if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM") {
		lbImsiEJMGNO.Visible = true;
		edImsiEJMGNO.Visible = true;
		edImsiEJMGNO.Text = "";
		btnDeleteSettlement.Visible = true;
		btnDeleteSettlement.Enable = true;
		btnFormDelete.Visible = true;	// 민원서류 삭제
	} else {
		lbImsiEJMGNO.Visible = false;
		edImsiEJMGNO.Visible = false;
		edImsiEJMGNO.Text = "";
		btnDeleteSettlement.Visible = false;
		btnDeleteSettlement.Enable = false;
		btnFormDelete.Visible = false;	// 민원서류 삭제
	}
	

    // 공통 코드 조회

    gfn_SearchAllJibu(cbxJibu, "Y", "선택"); // 지부 코드 조회

    if (gfn_IsNull(gds_oUserInfo.GetColumn(0, "ADMINGUBUN")) || gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "DM") {
        cbxCustJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");	// 대상물지부
        cbxExistJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");	// 접수자검색지부    
    } 
    
    if (gs_IsCallCenter == "Y") { // 콜센터 직원용 이면
		cbxJibu.Value = "1011";	// 접수지부
        cbxCustJibu.Value = "1011";	// 대상물지부
        cbxExistJibu.Value = "1011";	// 접수자검색지부
    } 

    gfn_SearchCustomerCourseFullName(ds_oCourse, "0");				// 대표고객직능 조회

    gfn_SearchCustomerDetailCourseFullName("", ds_oDetailCourse, "0");			// 세부고객직능 조회
    
    // 교육접수가능 직능만 남김
    for (var i = 0; i <= ds_oCourse.GetRowCount(); i++) {
    
		if ((ds_oCourse.GetColumn(i, "CD") == "60") 
		
		|| (ds_oCourse.GetColumn(i, "CD") == "70")
		
		|| (ds_oCourse.GetColumn(i, "CD") == "90")) {
		
			ds_oCourse.DeleteRow(i);
			
			i = i - 1;
		}
    }

    radCourse.Value = "10";

    gfn_SearchCommonCode(ds_oEmailDomain, "EMAILDOMAIN", "Y", "직접입력"); // 이메일도메인 조회


    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

    edEduYear.Text = left(GetDate(), 4);

    
    btnSetlmt.Enable = false;

    

    serch_falg = "0";

    edEmail.ImeMode = "english";

    edEmailDomain.ImeMode = "english";

	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 Call ID 가져오기(Unique ID)
		global.mnuLeft.lfn_CallUIDImport();
	}

	// 고객정보관리에서 연동되어 온 화면이면
	if (IsExistVar("sJibu") && !gfn_isNull(sJibu) && !gfn_isNull(sCustNo)) {
		serch_falg = "2";
		if (substr(sCoursecd,0,1) == "1" || sCoursecd == "91") {
			radCourse.Value = "10";
		} else if (substr(sCoursecd,0,1) == "2") {
			radCourse.Value = "20";
		} else if (substr(sCoursecd,0,1) == "3" || sCoursecd == "92") {
			radCourse.Value = "30";
		} else if (substr(sCoursecd,0,1) == "5" || sCoursecd == "93") {
			radCourse.Value = "50";
		} else if (substr(sCoursecd,0,1) == "8") {
			radCourse.Value = "80";
		}
		
		// 이미 접수된 자료가 있는지 조회
		lfn_AlreadySearch();


	// 민원서류 등록현황에서 바로가기 연동
	} else if (IsExistVar("sPK1") && !gfn_isNull(sPK1)) {
		serch_falg = "2";
		// 이미 접수된 자료가 있는지 조회
		lfn_AlreadySearch();		
		
	} else {
	
		lfn_SearchEduLatestOrder(); // 최근 접수가능회차 조회

		edEduOrder.SetFocus();
	
	}
}



function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

    if (nChar == 117) {

        btnTraingJubsuHist_OnClick();

        return;

    }



    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리

}



function Form_OnSize(obj,nCx,nCy,nState) {

    if (gs_IsResizingForm == "Y") {

//        gdMemFee.Width = nCx - gdMemFee.Left - 4 - 4;

        shpGubunBox4.Width = nCx - shpGubunBox4.Left - 4;

        gdJubsuInfo.Height = nCy - gdJubsuInfo.Top - 4;

        gdOrderHist.Height = nCy - gdOrderHist.Top - 4;

        gdOrderHist.Width = nCx - gdOrderHist.Left - 4;

        shpBox1.Width = nCx - shpBox1.Left;

        shpBox2.Width = nCx;

    }

}



/*

 * 기능 : 취소

 */

function lfn_Cancel(obj) {

    gfn_FormInit(this);

    ls_EsMgno = ""; // 실무교육일정관리번호
    
    ls_EjMgno = ""; // 실무교육접수관리번호


    // 회차정보

    lbEduInfo1.Text = "";

    lbEduInfo2.Text = "";




    // 접수 디폴트값 설정

    edEduYear.Text = left(GetDate(), 4);

	// 고객정보관리에서 연동되어 온 화면이면
	if (IsExistVar("sJibu") && !gfn_isNull(sJibu) && !gfn_isNull(sCustNo)) {
		serch_falg = "2";
		if (substr(sCoursecd,0,1) == "1" || sCoursecd == "91") {
			radCourse.Value = "10";
		} else if (substr(sCoursecd,0,1) == "2") {
			radCourse.Value = "20";
		} else if (substr(sCoursecd,0,1) == "3" || sCoursecd == "92") {
			radCourse.Value = "30";
		} else if (substr(sCoursecd,0,1) == "5" || sCoursecd == "93") {
			radCourse.Value = "50";
		} else if (substr(sCoursecd,0,1) == "8") {
			radCourse.Value = "80";
		}
	} else {
		radCourse.Value = "10";
	}



    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

    // 그리드 초기화

    ds_oJubsuAllInfo.ClearData();

    gdJubsuInfo.NoDataText = "";

    ds_oOrderHist.ClearData();

    gdOrderHist.NoDataText = "";

    ds_oFee.ClearData();
    
	ds_oFeeMonth.ClearData();
	
	ds_oSunap.ClearData();
	
	ds_iReady.ClearData();
	
	ds_iCustomerFee.ClearData();

    gdMemFee.NoDataText = "";

    btnSetlmt.Enable = false; // 결제(POS) 버튼

//    btnShowVirtualAccount.Enable = false;


    edPersonNm.Readonly = false;

    medBirthday.Readonly = false;

    btnSearchPersonInfoChange.Enable = false;

    medTotMinapFee.Value = 0;	//미납금액

    edEduOrder.SetFocus();

}



/*

 * 기능 : 조회

 */

function lfn_Search(obj) {

    if (gfn_IsNull(ls_EsMgno)) {

        gfn_Alert(MSGI00300); // "교육을 먼저 선택해 주십시오.";

        edEduOrder.SetFocus();

        return false;

    }

    if (gfn_IsNull(ls_EsMgno)) {

        gfn_Alert("접수번호를 입력해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    lfn_SearchEduJubsuList(obj);

}



/*

 * 기능 : 삭제

 */

function lfn_Delete(obj) {

    if ((ds_ioEduJubsu.currow < 0) || gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.

        return false;

    }

	// 교육일이 지났으면 삭제불가
	if (ds_ioEduJubsu.GetColumn(0, "ESDATE") < left(GetDate(), 8)) {
	
		gfn_Alert("교육일이 지나서 삭제할 수 없습니다.");

		return false;

	}
	
	// 이수된 자료 삭제불가
	if (ds_ioEduJubsu.GetColumn(0, "EJISUGUBUN") == "Y") {
	
		gfn_Alert("이수된 자료는 삭제할 수 없습니다.");

		return false;

	}
	
	
/*
    // 결제를 하지 않았을 경우에는 삭제 가능

    if (ds_oSunap.GetCount() > 0 && ds_oSunap.GetColumn(ds_oSunap.currow, "MEMBERGUBUN") == "1") {
	
		gfn_Alert("결제내역이 있어 삭제할 수 없습니다.");

		return false;
		
	}
*/

	if (!gfn_Confirm(MSGW00030)) { // 삭제 하시겠습니까?

		return false;

	}



	lfn_SaveModifyHistory("D"); // 변경이력을 저장한다.

	tit_clearActionInfo();
		
	var inDS = "";
	var outDS = "";
		
	// 등록된 서류파일이 있으면 삭제
	if (edFormResult.Text == "완료") {

		var vFAMGNO = "";
		var vPK1 = "";
		var vPK2 = "";
		var vPathArr = "";
		var vPath = "";
		var vfile = "";
		
		// 실무교육원서
		if (cbxForm.Value == "0006") {
			if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJFAMGNO"))) {
				vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
				vPK2 = "";
				vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJFAMGNO");
				vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
				vPath = substr(vPathArr[1],0,18);	// 서버경로
				vfile = substr(vPathArr[1],19,21);	// 파일명
			}
					
		} else if (cbxForm.Value == "00081") {	// 일정변경신청서
			if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO"))) {
				vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
				vPK2 = ds_ioEduJubsu.GetColumn(0, "EJHSEQ");
				vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO");
				vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC00081"), "|");
				vPath = substr(vPathArr[1],0,18);	// 서버경로
				vfile = substr(vPathArr[1],19,21);	// 파일명
			}
		} else if (cbxForm.Value == "00082") {	// 환불신청서
			if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO"))) {
				vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
				vPK2 = ds_ioEduJubsu.GetColumn(0, "EJHSEQ");
				vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO");
				vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC00082"), "|");
				vPath = substr(vPathArr[1],0,18);	// 서버경로
				vfile = substr(vPathArr[1],19,21);	// 파일명
			}
		}
	
		ds_iFormDelete.ClearData();
		ds_iFormDelete.AddRow();
		
		ds_iFormDelete.SetColumn(0, "I_FCCD", cbxForm.Value);		//FORMCODE.FCCD 서식관리번호
		ds_iFormDelete.SetColumn(0, "I_FAMGNO", vFAMGNO);			//FormAttach.FAmgno
		ds_iFormDelete.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값
		ds_iFormDelete.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록
		ds_iFormDelete.SetColumn(0, "I_PATH", vPath);				//저장경로
		ds_iFormDelete.SetColumn(0, "I_FILENM", vfile);				//파일명
		
		inDS = "ds_iFormDelete=ds_iFormDelete";
		outDS = "ds_oFormDelete=ds_oFormDelete";		
		
		ds_oFormDelete.ClearData(); // 결과 데이타셋 초기화
	
		tit_addSingleActionInfo("com:deleteForm", "", 0, "");
		
	}

	tit_addSingleActionInfo("cust:deleteCust1025EduJubsu", "", 0, "");

	//서버 호출

	tit_callService(

		""

		,""

		,inDS	// inDs

		,outDS	// outDs

		,"EJMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO")) 

			+ " ESMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "ESMGNO")) // args

		,"lfn_AfterDeleteEduJubsu"

		,false

		,false

		,true

	);


}



function lfn_searchJubsuList() {

/////////////////// 접수한 인원이 있는지 체크하여 있으면 저장 안되게 하기



    ds_ioEduJubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchEduJubsuCheck", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioEduJubsuCheck=ds_oEduJubsuCheck"	// outDs

        , "ESGTMGNO=" + quote(cbxJibu.Value)  // 지부

        + " ESYEAR=" + quote(edEduYear.Text) // 년도

        + " ESCOUSECD=" + quote(radCourse.Value) // 직능

        + " ESEDUORDER=" + quote(edEduOrder.Text) // 회차 

        + " ESNM=" + quote(edPersonNm.Text) // 성명 

        + " BIRTHDAY=" + quote(medBirthday.value) // 생년월일
        
        + " PERSONKEY=" + quote(medPersonKey.value) // 개인식별번호

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}

///////////////////





function lfn_searchTraingPerson() {

/////////////////// 신규 접수전에 기본정보 클릭 않고 접수시 trainingperson에 이미 있으면

/////////////////// 값을 미리 넣어주기 위해 강습자관리번호를 검색함



    ds_ioT_E_L_JubsuCheck.ClearData();

    tit_clearActionInfo(); //사람이 이미 있는지 검색한다.

    tit_addCsvSearchActionInfo("com:searchTrainingPerson", false);

    // 서버 호출 

    tit_callService(

        ""

        ,""

        ,""	// inDs

        ,"ds_ioTrainingPerson=ds_oTrainingPerson"	// outDs

        , "TPNM=" + quote(edPersonNm.Text) // 성명 

        + " BIRTHDAY=" + quote(medBirthday.value) // 생년월일
        
        + " PERSONKEY=" + quote(medPersonKey.value) // 개인식별번호

        // args

        ,""

        ,false

        ,""

        ,true

    );  

}



/*

 * 기능 : 저장

 */

var ls_ServiceName = "";

var ls_CallBackServiceName = "";

function lfn_Save(obj) {

    if (gfn_IsNull(ls_EsMgno)) {

        gfn_Alert(MSGI00300); // "교육을 먼저 선택해 주십시오.";

        edEduOrder.SetFocus();

        return false;

    }

	// 교육당일은 접수인원수 체크 안함
	if (ds_oEduOrderMgno.GetColumn(0, "ESDATE") <> left(getDate(),8)) {	// 교육당일이 아니면 접수인원체크
	
//	if (!((ds_oEduOrderMgno.GetColumn(0, "ESDATE") <= left(getDate(),8)) &&
	
//		(ds_oEduOrderMgno.GetColumn(0, "ESDATEPLUS7") >= left(getDate(),8)))) {	// 교육당일부터 교육일+7일이 아니면 접수인원체크
	
		if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO")) // 신규이면서
	
					&& (ds_oEduOrderMgno.GetColumn(0, "ESSEATCNT") <= ds_oEduOrderMgno.GetColumn(0, "ESACCESSCNT"))
	
				) {
	
			gfn_Alert("접수인원수를 초과하였습니다.");

			if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {	//시스템관리자가 아니면
				return false;
			}
		}

	}

 ////////////////////  신규이면서 교육일 지나면 접수 안되게 함 (추가함)

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO")) // 신규이면서

                && (left(GetDAte(), 8) > ds_oEduOrderMgno.GetColumn(0, "ESDATE"))
//                && (left(GetDAte(), 8) > ds_oEduOrderMgno.GetColumn(0, "ESDATEPLUS7"))	// 교육일+7일이 지나면

            ) {

        gfn_Alert("교육일이 지나서 접수하실 수 없습니다.");

		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {	//시스템관리자가 아니면
			return false;
		}

    }

 ////////////////////   

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO")) // 신규이면서

                && (left(GetDAte(), 8) = ds_oEduOrderMgno.GetColumn(0, "ESDATE"))

            ) {

            if (!gfn_Confirm("교육 당일입니다. 그래도 접수하시겠습니까?")) {

                return false;

            }

    }

	if (lbInputStatus.Value == "신규/수정") {
	
		gfn_Alert("신규입력 상태가 아닙니다.\n\n"
		
		          + "접수자를 추가하시려면 접수번호에서 [Enter] 또는 [조회] 버튼을 누른 후\n\n"
		
		          + "신규 저장하십시오!");

		return false;			
	
	}


    if (!gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) { // 수정이면서
    
		// 교육일이 지났으면 삭제불가
		if (ds_ioEduJubsu.GetColumn(0, "ESDATE") < left(GetDate(), 8)) {
		
			gfn_Alert("교육일이 지나서 수정할 수 없습니다.");
	
			if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {	//시스템관리자가 아니면
				return false;
			}
		}
    

		if (ls_IsChangedJubsuInfoYn == "N") { // 접수대상자 변경이 아니면
		
			if ((ls_OldCmgno <> replace(ltrim(replace(medBarCode.Value, '0',' ')),' ','0')) || // 수정전 고객바코드번호
			
				(ls_OldGtmgno <> cbxCustJibu.Value) ||	// 수정전 지부
				
				(ls_OldCno <> lpad(medCustNo.Value, '0', 6)) ||	// 수정전 CNO
			
				(ls_OldBnm <> edBuildingNm.Text) ||		// 수정전 대상물명
				
				(ls_OldEjnm <> edPersonNm.Text) )		// 수정전 성명
			{
			
				gfn_Alert("기존 접수내역(고객지부, 고객번호, 고객바코드, 대상물명, 성명)을\n\n"
				 
						  + "수정하셨지만 변경 저장되지 않습니다.\n\n"
						  
						  + "접수대상자를 변경하시면 [검색]버튼을 눌러 접수대상자를 검색하여\n\n"
				                 
				          + "변경하시기 바랍니다.");
				
					return false;
			
			}

		} else { // 접수대상자 변경이면

	
			if (!gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJHPMMGNO")) 
			
				&& (ls_OldCmgno <> ds_ioEduJubsu.GetColumn(0, "CMGNO"))) {	// 접수 대상 변경이면
			
				gfn_Alert("결제내역이 있는자료는 접수대상 변경을 할 수 없습니다.");
		
				if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") <> "SM") {	//시스템관리자가 아니면
					return false;		
				}
				
			}
	
			if ((toNumber(edChangeCnt.Text) > 0)				// 회차변경자료이고
			
				&& (ls_OldCmgno <> ds_ioEduJubsu.GetColumn(0, "CMGNO"))) {	// 접수 대상 변경이면
			
				gfn_Alert("회차변경하여 이번회차로 들어온 자료는 접수대상 변경을 할 수 없습니다.");
		
				return false;		
				
			}
		
		}
		
	}
	
	// 소방기술자는 같은 업종만 접수가능
	if (radCourse.Value == "50") {
	
		if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") {
		
			if (!(cbxDetailCourse.Value == "51" || cbxDetailCourse.Value == "53" || cbxDetailCourse.Value == "55" || cbxDetailCourse.Value == "93")) {
			
				gfn_Alert("소방기술자는 같은 업종만 접수하실 수 있습니다.\n\n" +
						  "  [교육업종] : 설계·감리업\n\n" + 
						  "  [고객업종] : " +  cbxDetailCourse.Text);
		
				return false;
			
			}
		
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") {
		
			if (!(cbxDetailCourse.Value == "52" || cbxDetailCourse.Value == "55" || cbxDetailCourse.Value == "93")) {
			
				gfn_Alert("소방기술자는 같은 업종만 접수하실 수 있습니다.\n\n" +
						  "  [교육업종] : 공사업\n\n" + 
						  "  [고객업종] : " +  cbxDetailCourse.Text);
		
				return false;
			
			}
		
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "12") {
	
			if (!(cbxDetailCourse.Value == "54" || cbxDetailCourse.Value == "55" || cbxDetailCourse.Value == "93")) {
			
				gfn_Alert("소방기술자는 같은 업종만 접수하실 수 있습니다.\n\n" +
						  "  [교육업종] : 관리업\n\n" + 
						  "  [고객업종] : " +  cbxDetailCourse.Text);
		
				return false;
			
			}
	
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "18") {
	
			if (!(cbxDetailCourse.Value == "51" || cbxDetailCourse.Value == "52" || cbxDetailCourse.Value == "53")) {
			
				gfn_Alert("소방기술자는 같은 업종만 접수하실 수 있습니다.\n\n" +
						  "  [교육업종] : 세미나(기술사)\n\n" + 
						  "  [고객업종] : " +  cbxDetailCourse.Text);
		
				return false;
			
			}
			
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "19") {
	
			if (!(cbxDetailCourse.Value == "54")) {
			
				gfn_Alert("소방기술자는 같은 업종만 접수하실 수 있습니다.\n\n" +
						  "  [교육업종] : 세미나(관리사)\n\n" + 
						  "  [고객업종] : " +  cbxDetailCourse.Text);
		
				return false;
			
			}
	
		}
	
	}

	if (medPersonKey.Value == "NON-MATCH") {
	
		gfn_Alert("개인식별번호가 없으면 실무교육을 접수하실 수 없습니다.\n\n"
				  + "  * 개인식별번호 생성조건 : 성명+주민등록번호, 성명+생년월일+휴대폰번호");
		
		return false;
	
	}


    if (!gfn_FormValidate(this)) { // 입력 Validation Check

        return false;

    }
    

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO")) // 신규이면서

                && lfn_CheckEduJubsuEduPassed() // 수료한 교육이 있으면

            ) {

        if (!gfn_Confirm(ds_oEduCheck.GetColumn(0, "PASSDATE") +"에 이수한 이력이 있습니다.\n신규 접수 하시겠습니까?")) {

            return false;

        }

    }

    if (ds_ioEduJubsu.GetColumn(0, "LASTYN") == "N") {

        gfn_Alert("회차변경된 접수번호는 수정하실 수 없습니다.");

        return false;

    }

//////////////////

/*
    var lb_ValidRedidentNoYn = gfn_CheckResidentNo(medResidentNo.Value); // 주민번호체계 검사

    var lb_ValidForeignNoYn = gfn_CheckForeignNo(medResidentNo.Value); // 재외국인 등록번호 검사

    if (!lb_ValidRedidentNoYn && !lb_ValidForeignNoYn) { // 둘다 실패면

        if (!gfn_Confirm("주민등록번호가 형식에 맞지않습니다.\n강제로 저장 하시겠습니까?")) {

            medBirthday.SetFocus();

            return false;

        }

    }
*/

    var sArg = "";

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) { // 신규


      ///////////////////  해당 동일 직능 회차에 이미 접수 내역이 있으면 접수 안되게 함      

		lfn_searchJubsuList();     

        if (ds_ioEduJubsuCheck.count > 0) {

             alert("   아래와 같이 동일인이 접수가 되어 있습니다. 확인 바랍니다. \n\n"

                + "         직          능 :   " + radCourse.Text + "\n" 

                + "         회          차 :   " + edEduOrder.Text + "\n" 

                + "         이          름 :   " + edPersonNm + "\n" 

                + "         접수 번호는 :   " + ds_ioEduJubsuCheck.Getcolumn(0, "EJHJUBSUNO")+ " 입니다. \n" );


            return false;

        }

     

        if (gds_oUserInfo.GetColumn(0, "PDEPTCD") == cbxJibu.Value) { // 소속지부

            if (!gfn_Confirm("신규 저장 하시겠습니까?")) {

                return false;

            }

        } else {

            if (!gfn_Confirm("타지부 접수입니다. 접수 저장 하시겠습니까?")) {

                return false;

            }

        }

     ////////////////////



        ls_ServiceName = "cust:insertCust1025EduJubsu";

        ls_CallBackServiceName = "lfn_AfterInsertEduJubsu";

        sArg = "";

    } else { // 수정
    
    
		if (ls_OldCmgno <> ds_ioEduJubsu.GetColumn(0, "CMGNO")) {
		
			if (!gfn_Confirm("기존 접수와 대상이 변경되었습니다.\n\n"
			
			   + "수정 하시겠습니까?" )) {
	
				return false;
	
			}		
		
		} else {

			if (!gfn_Confirm("수정 하시겠습니까?")) {
	
				return false;
	
			}

		}


        ls_ServiceName = "cust:updateCust1025EduJubsu";

        ls_CallBackServiceName = "lfn_AfterUpdateEduJubsu";

        lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.

        sArg = "ISCHANGEDJUBSUINFOYN=" + quote(ls_IsChangedJubsuInfoYn);

    }

    ds_ioEduJubsu.SetColumn(0, "ESMGNO", ls_EsMgno);

    ds_ioEduJubsu.SetColumn(0, "EJHJUBSUNO", edJubsuNo.Text);

    ds_ioEduJubsu.SetColumn(0, "ESCOUSECD", radCourse.Value);
    
    
    // null일 경우 저장시 오류나서 "" 값을 넣어줌
    if(gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJRSANGUBUN"))) {
    
		ds_ioEduJubsu.SetColumn(0, "EJRSANGUBUN", "");
		
	}
    
    

    ds_oEduJubsuResult.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo(ls_ServiceName, "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iEduJubsu=ds_ioEduJubsu"    // inDs

        ,"ds_oEduJubsuResult=ds_oEduJubsu"    // outDs

        ,sArg    // args

        ,ls_CallBackServiceName

        ,false

        ,false

        ,true

    );

}



/* 공통 필수 종료 */



/* 사용자 함수 */

/*

 * 기능 : 최근 접수가능회차를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchEduLatestOrder(obj) {

	cbxCustJibu.Value = cbxJibu.Value;	// 대상물(업체)정보 지부
	
	cbxExistJibu.Value = cbxJibu.Value;	// 기존 접수 조회 지부
	
    
    ds_oEduOrder.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();

	tit_addSearchActionInfo("cust:searchCust1025EduOrderList_NoToday", false);

	// 서버 호출

	tit_callService(

		""

		,""

		,""	// inDs

		,"ds_oEduOrder=ds_oEduOrder"	// outDs

		,"ESCOUSECD=" + quote(radCourse.Value)

            + " ESGTMGNO=" + quote(cbxJibu.Value)

            + " ESYEAR=" + quote(edEduYear.Text)

            + " sPosiYn=" + quote("Y") // 접수가능여부

            + " sRowCount=" + quote("1") // 건수

		,"lfn_AfterSearchEduLatestOrder"

        ,false

        ,false

        ,true

	);
	
	lfn_FilterDetailCourse(radCourse.Value);		// 세부고객직능 필터링	
	
	// 실무교육 유효기간 보이기
	if (radCourse.Value == "10" || radCourse.Value == "20") {
	
		lbEduExpireDate.Visible = true;
		
		calEduExpireDate.Visible = true;
		
	} else {
	
		lbEduExpireDate.Visible = false;
		
		calEduExpireDate.Visible = false;
		
	}

}



/*

 * 기능 : 최근 접수가능회차 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduLatestOrder(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oEduOrder.GetCount() > 0) {

        ls_EsMgno = ds_oEduOrder.GetColumn(0, "ESMGNO"); // 관리번호

        cbxJibu.Value = ds_oEduOrder.GetColumn(0, "ESGTMGNO"); // 지부코드

        edEduYear.Text = ds_oEduOrder.GetColumn(0, "ESYEAR"); // 년도

        radCourse.Value = ds_oEduOrder.GetColumn(0, "ESCOUSECD"); // 직능코드

        edEduOrder.Text = ds_oEduOrder.GetColumn(0, "ESEDUORDER"); // 회차



        lfn_SearchEduOrderMgno(); // 강습회차관리번호를 조회한다.

    } else {

        ls_EsMgno = ""; // 실무교육일정관리번호



        // 회차정보

        lbEduInfo1.Text = "";

        lbEduInfo2.Text = "";


        edJubsuNo.Text = "";


        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

        // 그리드 초기화

        ds_oJubsuAllInfo.ClearData();

        gdJubsuInfo.NoDataText = "";

        ds_oOrderHist.ClearData();

        gdOrderHist.NoDataText = "";

        ds_oFee.ClearData();
        
		ds_oFeeMonth.ClearData();
		
		ds_oSunap.ClearData();
		
		ds_iReady.ClearData();
		
		ds_iCustomerFee.ClearData();

        gdMemFee.NoDataText = "";

        btnSetlmt.Enable = false; // 결제(POS) 버튼

//        btnShowVirtualAccount.Enable = false;

        medTotMinapFee.Value = 0;	//미납금액

    }

}


/*
 * 세부직능 필터링
 */
function lfn_FilterDetailCourse(sFilterGubun) {
	ds_oDetailCourse.UnFilter();
		
	var ls_FilterExpr = "";
    if (!gfn_IsNull(sFilterGubun)) {
        ls_FilterExpr += "GCD=='" + trim(sFilterGubun) + "'";
    }
    ds_oDetailCourse.Filter(ls_FilterExpr);

	if( ds_oDetailCourse.FindRow("DATA", cbxDetailCourse.Text) == -1) {
		cbxDetailCourse.Text = "";
    }
}


/*

 * 기능 : 직능별교육자접수 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchTrainingJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    gfn_SearchMessage(gdTrainingJubsu); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

    lb_FileUpload = false;

}



/*

 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용

 * parameter : strSvcID - 서비스ID

 *             nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterDeleteEduJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

	if (edFormResult.Text == "완료") {
	
		lfn_AfterFormDelete(nErrorCode, strErrorMsg);
		
	}


    gfn_Alert("정상적으로 삭제되었습니다.");

    lfn_SearchEduOrderMgno(); // 강습정보를 조회한다.

}



/*

 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용

 * parameter : strSvcID - 서비스ID

 *             nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterUpdateEduJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    ///// 정상 수정접수 후 좌석 TEMP임시 테이블의 동일 자료를 삭제 함

    ds_ioControl.SetColumn(0, "No", "1"); // 트랜잭션 호출 위함


    //lfn_SeatNoDelete();

    /////

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

    lb_FileUpload = false;



    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부

    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부

    ls_IsChangedPictureYn = "N"; // 사진 변경여부



    lfn_SearchEduJubsuList(); // 접수번호로 다시 조회한다.

}



/*

 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용

 * parameter : strSvcID - 서비스ID

 *             nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterInsertEduJubsu(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    switch (ds_oEduJubsuResult.GetColumn(0, "RESULTCODE")) {

        case "JUBSUNO" : // 접수번호중복

            var ls_NewJubsuNo = lpad((toNumber(edJubsuNo.Text) + 1), "0", 3); // 접수번호

            if (!gfn_Confirm("접수번호가 중복되었습니다.\n다음 접수번호[" + ls_NewJubsuNo + "]로 접수하시겠습니까?")) {

                return false;

            }

            edJubsuNo.Text = ls_NewJubsuNo;



            tit_addSingleActionInfo(ls_ServiceName, "", 0, "");

            // 서버 호출

            tit_callService(

                ""

                ,""

                ,"ds_iEduJubsu=ds_ioEduJubsu:U"    // inDs

                ,"ds_oEduJubsuResult=ds_oEduJubsu"    // outDs

                ,""    // args

                ,ls_CallBackServiceName

                ,false

                ,false

                ,true

            );

            break;


        case "OK" : // 정상처리
        
        
            lfn_SaveModifyHistory("I"); // 변경이력을 저장한다.

            gfn_SaveMessage(); // 저장 메세지를 처리한다.

            lfn_Search();
			
			if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "2") {
		
				if (gfn_Confirm("접수내역을 문자메시지로 전송 하시겠습니까?")) {
				
					btnSendSms_OnClick();                
			
				}
				
			}
			
            break;

    }

}



/*

 * 기능 : 강습회차관리번호를 조회한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_SearchEduOrderMgno() {

    if (gfn_IsNull(cbxJibu.Value)

            || gfn_IsNull(radCourse.Value)

            || gfn_IsNull(edEduYear.Text)

            || gfn_IsNull(edEduOrder.Text)) {

        return false;

    }



    ds_oEduOrderMgno.ClearData(); // 데이타셋 초기화


 
    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025EduOrderMgno", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oEduOrderMgno=ds_oEduOrderMgno"    // outDs

        ,"ESGTMGNO=" + quote(cbxJibu.Value)

            + " ESCOUSECD=" + quote(radCourse.Value)

            + " ESYEAR=" + quote(edEduYear.Text)

            + " ESORDER=" + quote(lpad(edEduOrder.Text, "0", 3))

        ,"lfn_AfterSearchEduOrderMgno"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 :  강습회차관리번호 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduOrderMgno(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oEduOrderMgno.GetCount() > 0) {

        ls_EsMgno = ds_oEduOrderMgno.GetColumn(0, "ESMGNO"); // 회차관리번호

        // 회차정보1
        
		lbEduInfo1.Height = 22;

		lbEduInfo1 = " 좌석수:" + ds_oEduOrderMgno.GetColumn(0, "ESSEATCNT"); // 좌석수

		lbEduInfo1 = lbEduInfo1 + "  접수자수:" + ds_oEduOrderMgno.GetColumn(0, "ESACCESSCNT"); // 현재접수인원수
		
		lbEduInfo1 = lbEduInfo1 + "  접수가능:" + ds_oEduOrderMgno.GetColumn(0, "ESPOSSIBLECNT"); // 접수가능인원수
		
		if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") = "10") {
		 
			if (ds_oEduOrderMgno.GetColumn(0, "ESCYBERGUBUN") == "0") {
		
				lbEduInfo1 = lbEduInfo1 + " [혼합과정]"; // 사이버구분
		
			} else {
		
				lbEduInfo1 = lbEduInfo1 + " [사전이수]"; // 사이버구분
			
			}
		}

		// 회차정보2

		lbEduInfo2 = " " + ds_oEduOrderMgno.GetColumn(0, "TOCOURSEGUBUNNM"); // 과정구분

		var ls_date = ds_oEduOrderMgno.GetColumn(0, "ESDATE"); // 교육시작일

		lbEduInfo2 = " 교육일시:" + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + right(ls_date, 2); // 교육일

		var ls_time1 = ds_oEduOrderMgno.GetColumn(0, "ESSTARTTIME"); // 교육시작시간
		var ls_time2 = ds_oEduOrderMgno.GetColumn(0, "ESENDTIME"); // 교육종료시간

		lbEduInfo2 = lbEduInfo2 + " " + left(ls_time1, 2) + ":" + right(ls_time1, 2) + "~" +
										left(ls_time2, 2) + ":" + right(ls_time2, 2);
	
		// 소방안전관리자
		var addinfo2 = "";
		if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "10") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "1") addinfo2 = "일반반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "2") addinfo2 = "중급반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "3") addinfo2 = "고급반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "4") addinfo2 = "업무대행"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "특급·1급"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "12") addinfo2 = "2급"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "13") addinfo2 = "3급"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "14") addinfo2 = "공공기관"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "15") addinfo2 = "업무대행"; 
		
		// 소방안전관리보조자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "20") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "1") addinfo2 = "일반반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "2") addinfo2 = "중급반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "일반반"; 
			
		// 위험물안전관리자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "30") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "제조소·취급소"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "저장소"; 
		// 소방기술자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "50") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "설계·감리업"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "공사업";
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "12") addinfo2 = "관리업"; 	
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "18") addinfo2 = "세미나(기술자)"; 	
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "19") addinfo2 = "세미나(관리사)"; 	
				
		// 위험물운송자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "80") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 		
		}
	
		lbEduInfo2 = lbEduInfo2 + " [" +addinfo2+"]";
		
		edJubsuNo.Text = lpad((toNumber(ds_oEduOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 3); // 접수번호

		lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

		

		if(serch_falg == "0") {  // 조회하는 플래그를 통해 초기화하는 DS를 선택

			// 그리드 초기화

			ds_oJubsuAllInfo.ClearData();

			gdJubsuInfo.NoDataText = "";

			ds_oOrderHist.ClearData();

			gdOrderHist.NoDataText = "";

			ds_oFee.ClearData();
			
			ds_oFeeMonth.ClearData();
			
			ds_oSunap.ClearData();
			
			ds_iReady.ClearData();
			
			ds_iCustomerFee.ClearData();

			gdMemFee.NoDataText = "";

			btnSetlmt.Enable = false; // 결제(POS) 버튼

//			btnShowVirtualAccount.Enable = false;

			medTotMinapFee.Value = 0;	//미납금액

		} else if (serch_falg == "1" || serch_falg == "2") {

			ds_oFee.ClearData();
			
			ds_oFeeMonth.ClearData();
			
			ds_oSunap.ClearData();
			
			ds_iReady.ClearData();
			
			ds_iCustomerFee.ClearData();

			gdMemFee.NoDataText = "";

			btnSetlmt.Enable = false; // 결제(POS) 버튼

//			btnShowVirtualAccount.Enable = false;

			medTotMinapFee.Value = 0;	//미납금액

		}

		edJubsuNo.SetFocus();

    } else {

        gfn_Alert("접수할 회차정보가 없습니다. 다시 선택해 주십시오.");

        lfn_Cancel();
        
        edEduOrder.SetFocus();

    }



}



/*

 * 기능 : 접수자목록을 조회한다.

 * parameter : sOrderMgno - 회차관리번호

 *             sJubsuNo - 접수번호

 *             sLikeYn - LIKE 검색 여부

 * return value : 접수자목록 정보를 가진 배열 오브젝트

 */

function lfn_SearchEduJubsuList(obj) {

    var ls_HistoryArg = "";

    var ls_SearchArg = "";

	if (serch_falg == "0") {	// 접수번호로 조회할 경우

		if (gfn_IsNull(ls_EsMgno) || gfn_IsNull(edJubsuNo.Text)) {
	
			return false;
	
		}

	}

    if (!gfn_IsNull(ls_EjMgno)) {

		ls_HistoryArg = "접수관리번호=" + ls_Ejmgno;

		ls_SearchArg = "EJMGNO=" + quote(ls_Ejmgno);

    } else {
    
		ls_HistoryArg = "교육일정관리번호=" + ls_EsMgno
	
			+ ", 접수번호=" + lpad(edJubsuNo.Text, "0", 3);
	
		ls_SearchArg = "ESMGNO=" + quote(ls_EsMgno)
	
			+ " EJHJUBSUNO=" + quote(lpad(edJubsuNo.Text, "0", 3));
			
    }

    ds_ioEduJubsu.ClearData(); // 데이타셋 초기화

    lfn_SetChangedJubsuInfo(true);



    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025EduJubsuList", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_ioEduJubsu=ds_oEduJubsu"    // outDs

        ,ls_SearchArg

        ,"lfn_AfterSearchEduJubsuList"

        ,false

        ,false

        ,true

    );
    

    // 조회이력을 저장한다.

    gfn_InsertSearchPrintHistory(

            "S"

            , this.ID

            , global.mnuLeft.cbxOpenForm.Text

            , ls_HistoryArg
            
            //, ds_ioEduJubsu.SaveXML("ds_ioEduJubsu","",false)

        );


   
	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
		
				"S"
				
				, gs_CallCenterUID
	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")

				, this.ID
	
				, global.mnuLeft.cbxOpenForm.Text
	
				, ls_HistoryArg
				
			);
	}

}



/*

 * 기능 : 접수자목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduJubsuList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }


    if (ds_ioEduJubsu.GetCount() > 0) {
    
//    TRACE(ds_ioEduJubsu.SAVEXML());
    
		ls_Ejmgno = ds_ioEduJubsu.GetColumn(0, "EJMGNO"); // 접수관리번호

        cbxJibu.Value = ds_ioEduJubsu.GetColumn(0, "ESGTMGNO"); // 지부

        edEduYear.Text = ds_ioEduJubsu.GetColumn(0, "ESYEAR"); // 년도

        radCourse.Value = ds_ioEduJubsu.GetColumn(0, "ESCOUSECD"); // 직능

        edEduOrder.Text = ds_ioEduJubsu.GetColumn(0, "ESEDUORDER"); // 회차

        edJubsuNo.Text = ds_ioEduJubsu.GetColumn(0, "EJHJUBSUNO"); // 접수번호

		cbxCustJibu.Value = ds_ioEduJubsu.GetColumn(0, "CGTMGNO"); // 선임지부
		
		medCustNo.Value = ds_ioEduJubsu.GetColumn(0, "CNO"); // 관리번호

		medBarCode.Value = lpad(ds_ioEduJubsu.GetColumn(0, "EJCMGNO"), "0", 13);	//고객관리바코드
		
		edBuildingNm.Text = ds_ioEduJubsu.GetColumn(0, "BNM");	//선임대상물
		
		lbInputStatus.Text = "수정모드";	// 입력모드
		
		lbJubsuStatus.Text = ds_ioEduJubsu.GetColumn(0, "JUBSUSTATUS");	//접수상태
		
		ls_OldCmgno = ds_ioEduJubsu.GetColumn(0, "CMGNO"); // 수정전 고객바코드번호

		ls_OldGtmgno = ds_ioEduJubsu.GetColumn(0, "CGTMGNO"); // 수정전 지부
		
		ls_OldCno = ds_ioEduJubsu.GetColumn(0, "CNO");    // 수정전 CNO
		
		ls_OldBnm = ds_ioEduJubsu.GetColumn(0, "EJBUILDING");    // 수정전 대상물명
	
		ls_OldEjnm = ds_ioEduJubsu.GetColumn(0, "EJNM");  // 수정전 성명


        // 결제(POS) 버튼
        if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정

            btnSetlmt.Enable = true; // 결제(POS) 버튼

        }

        // 회차정보1

		ls_Esmgno = ds_ioEduJubsu.GetColumn(0, "ESMGNO"); // 일정관리번호
		
		lbEduInfo1.Height = 22;

		lbEduInfo1 = " 좌석수:" + ds_ioEduJubsu.GetColumn(0, "ESSEATCNT"); // 좌석수
		lbEduInfo1 = lbEduInfo1 + "  접수자수:" + ds_ioEduJubsu.GetColumn(0, "ESACCESSCNT"); // 현재접수인원수
		
		lbEduInfo1 = lbEduInfo1 + "  접수가능:" + ds_ioEduJubsu.GetColumn(0, "ESPOSSIBLECNT"); // 접수가능인원수
		if (ds_ioEduJubsu.GetColumn(0, "ESCOUSECD") = "10") {
			if (ds_ioEduJubsu.GetColumn(0, "ESCYBERGUBUN") == "0") {
				lbEduInfo1 = lbEduInfo1 + " [혼합과정]"; // 사이버구분
			} else {
				lbEduInfo1 = lbEduInfo1 + " [사전이수]"; // 사이버구분
			}
		}
		// 회차정보2
		lbEduInfo2 = " " + ds_oEduOrderMgno.GetColumn(0, "TOCOURSEGUBUNNM"); // 과정구분
		var ls_date = ds_ioEduJubsu.GetColumn(0, "ESDATE"); // 교육시작일
		lbEduInfo2 = " 교육일시:" + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + right(ls_date, 2); // 교육일
		var ls_time1 = ds_ioEduJubsu.GetColumn(0, "ESSTARTTIME"); // 교육시작시간
		var ls_time2 = ds_ioEduJubsu.GetColumn(0, "ESENDTIME"); // 교육종료시간
		lbEduInfo2 = lbEduInfo2 + " " + left(ls_time1, 2) + ":" + right(ls_time1, 2) + "~" +
										left(ls_time2, 2) + ":" + right(ls_time2, 2);

		// 소방안전관리자
		var addinfo2 = "";
		if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "10") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "1") addinfo2 = "일반반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "2") addinfo2 = "중급반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "3") addinfo2 = "고급반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "4") addinfo2 = "업무대행"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "특급·1급"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "12") addinfo2 = "2급"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "13") addinfo2 = "3급"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "14") addinfo2 = "공공기관"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "15") addinfo2 = "업무대행"; 
		
		// 소방안전관리보조자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "20") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "1") addinfo2 = "일반반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "2") addinfo2 = "중급반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "일반반"; 
			
		// 위험물안전관리자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "30") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "제조소·취급소"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "저장소"; 
		// 소방기술자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "50") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "10") addinfo2 = "설계·감리업"; 
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "11") addinfo2 = "공사업";
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "12") addinfo2 = "관리업"; 	
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "18") addinfo2 = "세미나(기술자)"; 	
			else if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "19") addinfo2 = "세미나(관리사)"; 	
				
		// 위험물운송자
		} else if (ds_oEduOrderMgno.GetColumn(0, "ESCOUSECD") == "80") {
			if (ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE") == "0") addinfo2 = "입문반"; 		
		}
	
		lbEduInfo2 = lbEduInfo2 + " [" +addinfo2+"]";
		
		
		// 민원서류 스캔등록
		
		if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "1" ||		
		    ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "2") {

			// 실무교육원서
			if (ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN") == 1 ||
			    gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN"))) { // KEMS 접수
				
				cbxForm.Value = "0006";	// 실무교육원서
						
				if (ds_ioEduJubsu.GetColumn(0, "ATC0006") == "0" ||
					ds_ioEduJubsu.GetColumn(0, "ATC0006") == "E") {
					edFormResult.Text = "미등록";
				} else {
					edFormResult.Text = "완료";
				}
				
			} else if (ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN") == 2) {	// 인터넷 접수
			
				cbxForm.Index = 0;	// 미대상
				edFormResult.Text = "미대상";
								
			}
				
		// 일정변경
		} else if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == 4) {	// 일정변경이면
		
			if (ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN") == 1 ||
			    gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN"))) { // KEMS 접수
		
				cbxForm.Value = "00081";	// 일정변경신청서
				
				if (ds_ioEduJubsu.GetColumn(0, "ATC00081") == "0" ||
					ds_ioEduJubsu.GetColumn(0, "ATC00081") == "E") {
					edFormResult.Text = "미등록";
				} else {
					edFormResult.Text = "완료";
				}
				
			} else if (ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN") == 2) {	// 인터넷 접수
			
				cbxForm.Index = 0;	// 미대상
				edFormResult.Text = "미대상";
								
			}
				
		// 환불이면
		} else if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "7") {
				
			if (ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN") == 1 ||
			    gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN"))) { // KEMS 접수
				
				cbxForm.Value = "00082";	// 환불신청서
				
				if (ds_ioEduJubsu.GetColumn(0, "ATC00082") == "0" ||
					ds_ioEduJubsu.GetColumn(0, "ATC00082") == "E") {
					edFormResult.Text = "미등록";
				} else {
					edFormResult.Text = "완료";
				}

			} else if (ds_ioEduJubsu.GetColumn(0, "EJHJUBSUGUBUN") == 2) {	// 인터넷 접수
			
				cbxForm.Index = 0;	// 미대상
				edFormResult.Text = "미대상";
								
			}

		} else {
				
			cbxForm.Index = 0;
			edFormResult.Text = "미대상";
			
		}
		
		if (edFormResult.Text == "미대상" || edFormResult.Text == "") {
		
			btnScan.Enable = false;
			btnScanSearch.Enable = false;
			btnScanSave.Enable = false;
			edFormResult.DisableBkColor = "user4";
		
		} else if (edFormResult.Text == "미등록") {
		
			btnScan.Enable = true;
			btnScanSearch.Enable = true;
			btnScanSave.Enable = true;
			edFormResult.DisableBkColor = "user37";
			
		} else if (edFormResult.Text == "완료") {
		
			edFormResult.DisableBkColor = "user4";
			
		}
		
		
        lfn_SearchCustomerFeeList(); // 결제내역 조회

    } else {

		// 교육당일은 접수인원수 체크 안함
		if (ds_oEduOrderMgno.GetColumn(0, "ESDATE") <> left(getDate(),8)) {	// 교육당일이 아니면 접수인원체크

			if (ds_oEduOrderMgno.GetColumn(0, "ESSEATCNT") <= ds_oEduOrderMgno.GetColumn(0, "ESACCESSCNT")) {
	
				gfn_Alert("접수인원수를 초과하였습니다.");
	
			}
        
		}

        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
        
		lbInputStatus.Text = "신규입력";	// 입력모드
		
		lbJubsuStatus.Text = "";	//접수상태

        // 그리드 초기화

        ds_oJubsuAllInfo.ClearData();

        gdJubsuInfo.NoDataText = "";

        ds_oOrderHist.ClearData();

        gdOrderHist.NoDataText = "";

        ds_oFee.ClearData();
        
		ds_oFeeMonth.ClearData();
		
		ds_oSunap.ClearData();
		
		ds_iReady.ClearData();
		
		ds_iCustomerFee.ClearData();

        gdMemFee.NoDataText = "";

        btnSetlmt.Enable = false; // 결제(POS) 버튼

//        btnShowVirtualAccount.Enable = false;

        medTotMinapFee.Value = 0;	//미납금액
        
        //cbxCustJibu.Value = cbxJibu.Value;


    }


    if (!gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

//////////////////////////////////////////////////////////////////////////

        if(serch_falg == "0" || serch_falg == "2") {

            lfn_SearchEduJubsuAllInfoList(); // 개인접수정보 조회

        } else if (serch_falg == "1") {

    

        }

        serch_falg = "0";   // 플래그 값 초기화 하기

//////////////////////////////////////////////////////////////////////////



    }



    if (ds_ioEduJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부

        lfn_SetChangedJubsuInfo(false);

    }



    lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경

    //radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부

    medCustNo.SetFocus();

    

///////////////////////////////////  


    if (!gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBirthday.Value))) {

    ////////////////////////////////

        //edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 

        medBirthday.Readonly = true;

        //btnSearchPersonInfoChange.Enable = true;  // 접수자정보변경은 활성화 함

    ////////////////////////////////	


    } else if (gfn_isNull(edPersonNm.Text) and (!gfn_isNull(medBirthday.Value))) {
    
        //edPersonNm.Readonly = true;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 

        medBirthday.Readonly = true;

        //btnSearchPersonInfoChange.Enable = true;  // 접수자정보변경은 활성화 함    
    

    } else {

    ////////////////////////////////

        //edPersonNm.Readonly = false;   // 신규를 하기 위해 조회를 하면 성명 , 주민번호를 변경 하게 함 

        medBirthday.Readonly = false;

        //btnSearchPersonInfoChange.Enable = false;  // 접수자정보변경은 활성화 함

    ////////////////////////////////

    }
    
    edScanFileName.Text = "";	// 불러오기한 민원서류 스캔파일명

}



/*

 * 기능 : 강습접수자목록 팝업을 호출한다.

 * parameter : sOrderMgno - 회차관리번호

 *             sJubsuNo - 접수번호

 *             sLikeYn - LIKE 검색 여부

 * return value : 강습접수자목록 정보를 가진 배열 오브젝트

 */

function lfn_EduJubsuListPopup(sOrderMgno, sJubsuNo, sLikeYn) {

    var sArg = "sOrderMgno=" + quote(sOrderMgno);

    sArg += " sJubsuNo=" + quote(sJubsuNo);

    sArg += " sLikeYn=" + quote(sLikeYn);


    var arrEjmgno = Dialog("cust::frmcust1025PEduJubsuList.xml", sArg, 600, 400, "", -1, -1);

    if (length(arrEjmgno) > 0) {

        ls_EjMgno = arrEjmgno[0];  // 접수관리번호

        lfn_SearchEduJubsuList();

    } else {

        ls_EjMgno = "";

    }

}



/*

 * 기능 : 빈번호를 조회한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_SearchUnUseJubsuNo(obj) {

    if (gfn_IsNull(ls_EsMgno)) {

        gfn_Alert(MSGI00300); // "교육을 먼저 선택해 주십시오.";

        edEduOrder.SetFocus();

        return false;

    }



    ds_oJubsuNo.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025UnUseEduJubsuNo", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,""    // inDs

        ,"ds_oJubsuNo=ds_oJubsuNo"    // outDs

        ,"ESMGNO=" + quote(ls_EsMgno)

        ,"lfn_AfterSearchUnUseEduJubsuNo"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 빈번호 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchUnUseEduJubsuNo(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

    // 그리드 초기화

    ds_oJubsuAllInfo.ClearData();

    gdJubsuInfo.NoDataText = "";

    ds_oOrderHist.ClearData();

    gdOrderHist.NoDataText = "";

    ds_oFee.ClearData();
    
	ds_oFeeMonth.ClearData();
	
	ds_oSunap.ClearData();
	
	ds_iReady.ClearData();
	
	ds_iCustomerFee.ClearData();

    gdMemFee.NoDataText = "";

    btnSetlmt.Enable = false; // 결제(POS) 버튼

//    btnShowVirtualAccount.Enable = false;

	medTotMinapFee.Value = 0;	//미납금액
	

    var ln_TotalCnt = ds_oJubsuNo.GetCount();

    if (ln_TotalCnt > 0) {

		edJubsuNo.Text = ds_oJubsuNo.GetColumn(0, "EJHJUBSUNO"); // 접수번호

//        edJubsuNo.Text = lpad((toNumber(ds_oEduOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 3); // 접수번호

    } else {

        edJubsuNo.Text = "001"; // 접수번호

    }

}


/*

 * 기능 : 개인접수정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchEduJubsuAllInfoList(obj) {

    ds_oJubsuAllInfo.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025EduJubsuAllInfoList", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oJubsuAllInfo=ds_oJubsuAllInfo" // outDs

        , "PERSONNM=" + quote(ds_ioEduJubsu.GetColumn(0, "EJNM"))
        
          + " BIRTHDAY=" + quote(ds_ioEduJubsu.GetColumn(0, "EJBIRTHDAY"))
        
          + " PERSONKEY=" + quote(ds_ioEduJubsu.GetColumn(0, "EJPERSONKEY")) // args

        , "lfn_AfterSearchEduJubsuAllInfoList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 개인접수정보 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

var ln_TotalGridInfoCount = 0;

function lfn_AfterSearchEduJubsuAllInfoList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    ln_TotalGridInfoCount = ds_oJubsuAllInfo.GetCount();



    gfn_SearchMessage(gdJubsuInfo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

	ds_oJubsuAllInfo.row = ds_oJubsuAllInfo.FindRow("EJMGNO", ls_Ejmgno);

    lfn_SearchEduOrderHistList(); // 회차변경이력 조회

}



/*

 * 기능 : 회차변경이력를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchEduOrderHistList(obj) {

    ds_oOrderHist.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025OrderHistList", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oOrderHist=ds_oOrderHist" // outDs

        , "EJMGNO=" + quote(ds_oJubsuAllInfo.GetColumn(ds_oJubsuAllInfo.currow, "EJMGNO")) // args

        , "lfn_AfterSearchEduOrderHistList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 회차변경이력 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

var ln_TotalGridOrderCount = 0;

function lfn_AfterSearchEduOrderHistList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if(serch_falg == "1" || serch_falg == "2") {

        gdOrderHist_OnCellClick(0,0,0,0,0);

    }



    ln_TotalGridOrderCount = ds_oOrderHist.GetCount();



    gfn_SearchMessage(gdOrderHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

}



/*

 * 기능 : 회비/교육비 결제내역를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchCustomerFeeList(obj) {

    ds_oFee.ClearData(); // 데이타셋 초기화

    ds_oSunap.ClearData();

    ds_oFeeMonth.ClearData();
    
    var vFEEGUBUN3 = "";
    
    // 회원이고 내년 실무교육이면 내년회비까지 미납내역 조회
    if (ds_ioEduJubsu.GetColumn(0, "CSTATUSGUBUN") == "0") {
    
		if (left(getDate(),4) < edEduYear.Text) {
		
			vFEEGUBUN3 = "NEXTYEAR";
		
		} else {
		
			vFEEGUBUN3 = "THISYEAR";
			
		}

	} else {	// 교육비이면 올해 교육비 조회
	
		vFEEGUBUN3 = "THISYEAR";	
		
	}
    
    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust2010Fee", false);

    tit_AddSearchActionInfo("cust:searchCust1025SunapEduJubsu", false);
    
    tit_AddSearchActionInfo("cust:searchCust2010Fee2", false);
    
    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oFee=ds_oFee ds_oSunap=ds_oSunap ds_oFeeMonth=ds_oFee2" // outDs

        , "CMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "CMGNO")) 
        
        + " FEEGUBUN='YEAR'"	// 회비/교육비 년도 
        
        + " FEEGUBUN2='HALFMONTH'"
        
        + " FEEGUBUN3=" + quote(vFEEGUBUN3)
        
        + " EJMGNO=" + quote(ls_Ejmgno) // args

        , "lfn_AfterSearchCustomerFeeList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 결제내역 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

var ln_TotalGridSetlementCount = 0;

function lfn_AfterSearchCustomerFeeList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    ln_TotalGridSetlementCount = ds_oFee.GetCount();

    medTotMinapFee.Value = 0;	//미납금액
    
    if (ln_TotalGridSetlementCount > 0) {
    
		for(var i=0; i<ds_oFee.GetRowCount(); i++) {
	
			medTotMinapFee.Value = toNumber(medTotMinapFee.Value) + toNumber(ds_oFee.GetColumn(i, "MINAPFEE"));
			
		}
		
		if (medTotMinapFee.Value > 0) {
		
			btnSetlmt.Enable = true;	// 결제하기 버튼
			
		} else {

			if (ds_oSunap.GetCount() > 0) {		// 결제건수가 있고
		

				if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJPAYGUBUN"))
				   
				   && ds_ioEduJubsu.GetColumn(0, "EJPAYGUBUN") <= "5") {	// 접수시 결제한 내역이면

					btnSetlmt.Enable = true;	// 결제하기 버튼 활성화(환불)
					
				} else {
				
					btnSetlmt.Enable = false;	// 결제하기 버튼 비활성화
				
				}
				
				
			} else {
			
				btnSetlmt.Enable = false;	// 결제하기 버튼 비활성화
		
			}
			
		}
		
    }
/*
//        btnShowVirtualAccount.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnPosvath.Enable = false;

    }
*/
    gfn_SearchMessage(gdMemFee); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

}



/*

 * 기능 : 접수대상의 회비/교육비 년도별 결제내역를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchCustomerYearFeeList(obj) {

    ds_oFee.ClearData(); // 데이타셋 초기화

    ds_oFeeMonth.ClearData();
    
    var vFEEGUBUN3 = "";
    
    // 회원이고 내년 실무교육이면 내년회비까지 미납내역 조회
    if (ds_ioEduJubsu.GetColumn(0, "CSTATUSGUBUN") == "0") {

		if (left(getDate(),4) < edEduYear.Text) {
		
			vFEEGUBUN3 = "NEXTYEAR";
		
		} else {
		
			vFEEGUBUN3 = "THISYEAR";
			
		}
    
	} else {	// 교육비이면 올해 교육비 조회
	
		vFEEGUBUN3 = "THISYEAR";	
		
	}
    
    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust2010Fee", false);

    tit_AddSearchActionInfo("cust:searchCust2010Fee2", false);
    
    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oFee=ds_oFee ds_oFeeMonth=ds_oFee2" // outDs

        , "CMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "CMGNO")) 
        
        + " FEEGUBUN='YEAR'"	// 회비/교육비 년도 
        
        + " FEEGUBUN2='HALFMONTH'"
           
        + " FEEGUBUN3=" + quote(vFEEGUBUN3) // args

        , "lfn_AfterSearchCustomerYearFeeList"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 년도별 결제내역 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchCustomerYearFeeList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    ln_TotalGridSetlementCount = ds_oFee.GetCount();

    medTotMinapFee.Value = 0;	//미납금액
    
    if (ln_TotalGridSetlementCount > 0) {
    
		for(var i=0; i<ds_oFee.GetRowCount(); i++) {
	
			medTotMinapFee.Value = toNumber(medTotMinapFee.Value) + toNumber(ds_oFee.GetColumn(i, "MINAPFEE"));
			
		}
	}
		
	btnSetlmt.Enable = false;	// 결제하기 버튼 비활성화

/*
//        btnShowVirtualAccount.Enable = false;

        btnShowVirtualAccount.Enable = false;

        btnPosvath.Enable = false;

    }
*/
    gfn_SearchMessage(gdMemFee); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

}


/*

 * 기능 : 버튼 활성/비활성시킨다.

 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)

 * return : 없음

 */

function lfn_SetFormAuth(bStatus) {

    btnDelete.Enable = bStatus; // 삭제 버튼

    btnSave.Enable = bStatus; // 수정&저장 버튼

	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
	
		btnPrintScreen.Enable = false; // 화면출력 버튼
		
		btnSetlmt.Enable = false; // 결제 버튼
	
	}
}



/*

 * 기능 : 접수자 기본 정보를 초기화한다.

 * parameter : 없음

 * return : 없음

 */

function lfn_InitJubsuBaseInfo() {

    lfn_SetChangedJubsuInfo(true);

    ds_oEduJubsuResult.ClearData();


    ds_ioEduJubsu.ClearData();

    ds_ioEduJubsu.InsertRow(0);


    cbxEmailDomain.Value = "";

    // 비고

    edRemark.Text = "";

    edRemark.Enable = true;

    // 사진

    ds_ioEduJubsu.ApplyChange();

 
    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부


	// 선임정보
	
	//cbxCustJibu.Value = "";
	
	medCustNo.Value = "";
    
    medBarCode.Value = ""; // 바코드
    
    edBuildingNm.Text = "";
    
    cbxDetailCourse.Value = "";


    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
    
	lbInputStatus.Text = "신규/수정";	// 입력모드
	
	lbJubsuStatus.Text = "접수상태";	//접수상태
    
    
    // 기존접수자조회
    
    edExistNM.Text = "";
    
    medExistCustNo.Value = "";
    
    edExistBnm.Text = "";
    
	ls_OldGtmgno = ""; // 수정전 지부
    
	ls_OldCno = "";    // 수정전 CNO
    
	ls_OldCmgno = "";  // 수정전 CMGNO

	ls_OldBnm = "";    // 수정전 대상물명

	ls_OldEjnm = "";   // 수정전 성명
	
    cbxForm.Index = 0;			// 민원서류 종류
    
    edFormResult.Text = "";		// 민원서류 등록여부
    
    edFormResult.DisableBkColor = "user4";
    
    edScanFileName.Text = "";	// 민원서류 불러오기한 파일
    
    hfImage2.CloseFile();		// 민원서류 파일객체

}



/*

 * 기능 : 강습접수자정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_SearchTrainingPearsonMgno(obj) {

    ds_oTrainingPearson.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("training:searchTrainingPearsonMgno", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oTrainingPearson=ds_oTrainingPearson" // outDs

        , "TPNM=" + quote(edPersonNm.Text) // args

          + " BIRTHDAY=" + quote(medBirthday.value) // 생년월일
        
          + " PERSONKEY=" + quote(medPersonKey.value) // 개인식별번호

        , ""

        ,false

        ,false

        ,true

    );



    if (ds_oTrainingPearson.GetCount() == 1) {

        ms_TrainingPersonMgno = ds_oTrainingPearson.getcolumn(0, "TPMGNO");

        ds_ioEduJubsu.SetColumn(0, "TPMGNO", ds_oTrainingPearson.getcolumn(0, "TPMGNO"));

    }

}



/*

 * 기능 : 회차변경된 정보 상태변경한다.

 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)

 * return : 없음

 */

function lfn_SetChangedJubsuInfo(bStatus) {

    if (bStatus) {
    
		shpGubunBox2.BkColor = "";
        shpGubunBox3.BkColor = "";
        shpGubunBox4.BkColor = "";

    } else {
    
		shpGubunBox2.BkColor = "user18";
        shpGubunBox3.BkColor = "user18";
        shpGubunBox4.BkColor = "user18";

    }



    if (bStatus && ms_FormAuth == "W") { // 권한에 따른 버튼 설정

        btnSave.Enable = true;

        btnDelete.Enable = true;

    } else {

        btnSave.Enable = false;

        btnDelete.Enable = false;

    }


    btnEduJubsuModify.Enable = bStatus; // 회차변경


//    btnShowVirtualAccount.Enable = bStatus; // 가상계좌보기

    btnPrintJubsu.Enable = bStatus; // 참가원출력 버튼

    //edAddr1.Enable = bStatus;

    //edAddr2.Enable = bStatus;

    //edTel.Enable = bStatus;

    edHpTel.Enable = bStatus;

    edEmail.Enable = bStatus;

    edEmailDomain.Enable = bStatus;

    cbxEmailDomain.Enable = bStatus;

    edRemark.Enable = bStatus;
    
	//lbInputStatus.Text = "";	// 입력모드
		
	//lbJubsuStatus.Text = "";	//접수상태

}



/*

 * 기능 : 업무 변경이력을 저장한다.

 * parameter : sGubun - 변경구분. 예) I, U, D

 * return : 없음

 */

function lfn_SaveModifyHistory(sGubun) {

    if (sGubun = "I") { // 신규

        gds_iModifyHistory.InsertRow(0);

        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "실무교육접수"); // 업무구분

        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oEduJubsuResult.GetColumn(0, "RESULTEJMGNO")); // KEY값

        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명

        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값

        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값

    } else if (sGubun = "D") { // 삭제

        gds_iModifyHistory.InsertRow(0);

        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "실무교육접수"); // 업무구분

        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioEduJubsu.GetColumn(0, "EJMGNO")); // KEY값

        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명

        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값

        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값

    } else if (sGubun = "U") { // 수정

        var ln_TotalCount = ds_oModifyColumn.GetCount();

        var ls_ColumnCd = "";

        var ls_ColumnNm = "";

        for (var i = 0; i < ln_TotalCount; i++) {

            ls_ColumnCd = ds_oModifyColumn.GetColumn(i, "COLUMNCD");

            ls_ColumnNm = ds_oModifyColumn.GetColumn(i, "COLUMNNM");

            if (ds_ioEduJubsu.GetOrgBuffColumn(0, ls_ColumnCd) <> ds_ioEduJubsu.GetColumn(0, ls_ColumnCd)

                        && (!gfn_IsNull(ds_ioEduJubsu.GetOrgBuffColumn(0, ls_ColumnCd)) || !gfn_IsNull(ds_ioEduJubsu.GetColumn(0, ls_ColumnCd)))

                    ) {

                gds_iModifyHistory.InsertRow(0);

                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "실무교육접수"); // 업무구분

                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분

                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioEduJubsu.GetColumn(0, "EJMGNO")); // KEY값

                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_ColumnNm); // 변경 컬럼명

				if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", substr(ds_ioEduJubsu.GetOrgBuffColumn(0, ls_ColumnCd),0,7)); // 변경 전 값
				} else {
					gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ds_ioEduJubsu.GetOrgBuffColumn(0, ls_ColumnCd)); // 변경 전 값
				}
				if (ls_ColumnNm == "주민번호") {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", substr(ds_ioEduJubsu.GetColumn(0, ls_ColumnCd),0,7)); // 변경 후 값
				} else {
					gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ds_ioEduJubsu.GetColumn(0, ls_ColumnCd)); // 변경 후 값
				}

            }

        }

    }



    gfn_InsertModifyHistory(); // 업무 변경이력을 저장한다.

}



/*

 * 기능 : 기접수여부를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_CheckEduJubsuAlready(obj) {

    ds_oEduCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    //tit_addSearchActionInfo("training:searchCheckTrainingJubsuAlready", false);
    tit_addSearchActionInfo("cust:searchCust1025EduJubsuAlready", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oEduCheck=ds_oEduCheck" // outDs

        ,"ESMGNO=" + quote(ls_EsMgno)

            + " EJNM=" + quote(edPersonNm.Text)

			+ " BIRTHDAY=" + quote(medBirthday.value) // 생년월일
        
			+ " PERSONKEY=" + quote(medPersonKey.value) // 개인식별번호
        
            + " EJCMGNO=" + quote(replace(ltrim(replace(medBarCode.Value, '0',' ')),' ','0'))
            
            + " ESCOUSECD=" + quote(radCourse.Value)

        ,"lfn_AfterSearchCheckEduJubsuAlready"

        ,false

        ,false

        ,true

    );

}



/*

 * 기능 : 기접수여부 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchCheckEduJubsuAlready(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }



    if (ds_oEduCheck.GetCount() > 0) {
		// 같은 회차+번호에서 조회한 경우에는 최신 정보(성명,주민번호)로 변경됨
		// 다른 회차+번호에서 조회한 경우에는 기존 접수내역으로 이동
		if (ls_Esmgno <> ds_oEduCheck.GetColumn(0, "ESMGNO") || edJubsuNo.Text <> ds_oEduCheck.GetColumn(0, "EJHJUBSUNO")) {

			if (!gfn_isNull(ds_oEduCheck.GetColumn(0, "EJHJUBSUNO"))) {
	
				gfn_Alert(ds_oEduCheck.GetColumn(0, "ESEDUORDER") +"회차 "+ ds_oEduCheck.GetColumn(0, "EJHJUBSUNO") +"번으로 이미 접수하셨습니다.");
	
			}
	
			ls_Ejmgno = ds_oEduCheck.GetColumn(0, "EJMGNO");  // 접수관리번호
		
			lfn_SearchEduJubsuList();	// 접수관리번호로 조회
			
			// 2015.02.09 추가 
//			lfn_SearchEduOrderMgno();	// 회차정보조회	(회차정보가 업데이트 안되어서)
//			lfn_SearchEduJubsuList();	// 다시한번 접수관리호로 조회(회차정보가 업데이트 안되어서)
			
		}
    }
}



/*

 * 기능 : 수료한 교육이 있는지 조회한다.

 * parameter : 없음

 * Return : 있으면 true, 없으면 false

 */

function lfn_CheckEduJubsuEduPassed(obj) {

    ds_oEduCheck.ClearData(); // 데이타셋 초기화



    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025CheckEduJubsuEduPassed", false);

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"" // inDs

        ,"ds_oEduCheck=ds_oEduCheck" // outDs

        ,"COUSECD=" + quote(radCourse.Value)

            + " PERSONNM=" + quote(edPersonNm.Text)

			+ " BIRTHDAY=" + quote(medBirthday.value) // 생년월일
        
			+ " PERSONKEY=" + quote(medPersonKey.value) // 개인식별번호

        ,""

        ,false

        ,false

        ,true

    );


    if (ds_oEduCheck.GetCount() > 0) {

        return true;

    } else {

        return false;

    }

}



/*

 * 기능 : 소속지부 버튼 변경

 * parameter : 없음

 * return value : 없음

 */

function lfn_ChangeJibuRadioButton() {

	if (gds_oUserInfo.GetColumn(0, "PDEPTCD") == cbxJibu.Value) { // 소속지부

        cbxJibu.Enable = false;

        radJibuGubun.Value = "S";

        radJibuGubun.BkColor = "";

	} else { // 타지부

        cbxJibu.Enable = true;

        radJibuGubun.Value = "T";

        radJibuGubun.BkColor = "red";

	}

}



/* 사용자 이벤트 함수 */

function lfn_SortGrid2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {

    var lobj_Dataset = object(obj.BindDataset);

    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.

    if (lobj_Dataset.GetRowCount() > 1) {

 	    if (nCell > 0) {

            gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.

        }

    }

}



// 년도

function edEduYear_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) { // Enter key

        edEduOrder.SetFocus();

        

        //gfn_EnterNextFocus();

	} else {

        if (!gfn_IsNull(ls_EsMgno)) {

            ls_EsMgno = ""; // 강습관리번호


            // 교육정보

            lbEduInfo1.Text = "";

            lbEduInfo2.Text = "";


            edJubsuNo.Text = "";


            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

            // 그리드 초기화

            ds_oJubsuAllInfo.ClearData();

            gdJubsuInfo.NoDataText = "";

            ds_oOrderHist.ClearData();

            gdOrderHist.NoDataText = "";

            ds_oFee.ClearData();
            
			ds_oFeeMonth.ClearData();
			
			ds_oSunap.ClearData();
			
			ds_iReady.ClearData();
			
			ds_iCustomerFee.ClearData();

            gdMemFee.NoDataText = "";

            btnSetlmt.Enable = false; // 결제(POS) 버튼

//            btnShowVirtualAccount.Enable = false;

            medTotMinapFee.Value = 0;	//미납금액

        }

	}

}



// 회차

function edEduOrder_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) { // Enter key

        btnSearchEduOrder.SetFocus();

        lfn_SearchEduOrderMgno(obj);

	} else {

        if (!gfn_IsNull(ls_EsMgno)) {

            ls_EsMgno = ""; // 강습관리번호



            // 교육정보

            lbEduInfo1.Text = "";

            lbEduInfo2.Text = "";


            edJubsuNo.Text = "";


            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화

            // 그리드 초기화

            ds_oJubsuAllInfo.ClearData();

            gdJubsuInfo.NoDataText = "";

            ds_oOrderHist.ClearData();

            gdOrderHist.NoDataText = "";

            ds_oFee.ClearData();
            
			ds_oFeeMonth.ClearData();
			
			ds_oSunap.ClearData();
			
			ds_iReady.ClearData();
			
			ds_iCustomerFee.ClearData();

            gdMemFee.NoDataText = "";

            btnSetlmt.Enable = false; // 결제(POS) 버튼

//            btnShowVirtualAccount.Enable = false;

            medTotMinapFee.Value = 0;	//미납금액

        }

	}     

}



function edEduOrder_OnKillFocus(obj) {

    gfn_ComponentOnKillFocus(obj);



    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));



    lfn_SearchEduOrderMgno(); // 강습정보를 조회한다.

}



// 접수가능회차

function btnSearchEduOrder_OnClick(obj) {

    var arrEduOrder = lfn_EduScheduleList(cbxJibu.Value, edEduYear.Text, radCourse.Value, Left(getDate(),8)); // 교육일정관리목록 조회 팝업

    if (length(arrEduOrder) > 0) {

        ls_EsMgno = arrEduOrder[8];

        cbxJibu.Value = arrEduOrder[10];

        edEduYear.Text = arrEduOrder[4];

        radCourse.Value = arrEduOrder[9];

        edEduOrder.Text = arrEduOrder[11];

        lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경

        lfn_SearchEduOrderMgno(); // 강습회차관리번호를 조회한다.
        
        // 고객정보관리에서 연동되어 온 화면이면
		if (IsExistVar("sJibu") && !gfn_isNull(sJibu) && !gfn_isNull(sCustNo)) {
		
			edJubsuNo_OnKeyDown(obj, "13");
	
			cbxCustJibu.Value = sJibu;
	
			medCustNo.Value = sCustNo;
	
			btnCustNo_OnClick();
	
			sJibu = ""; 	// 고객정보관리에서 연동된 지부
			sCustNo = "";	// 고객정보관리에서 연동된 관리번호
			sCoursecd = "";	// 고객정보관리에서 연동된 직능코드
		}

    } else {

        lfn_cancel();

    }

}


/*
 * 기능 : 실무교육일정검색 팝업을 호출한다.
 * parameter : 없음
 * return value : 실무교육일정 정보를 가진 배열 오브젝트
 */
function lfn_EduScheduleList(sJibuCode, sEduYear, sCourseCode, sEduDate) {
    var sArg = "sJibuCode=" + quote(sJibuCode)
				+ " sEduYear=" + quote(sEduYear)
				+ " sCourseCode=" + quote(sCourseCode)
				+ " sEduDate=" + quote(sEduDate);
    return Dialog(ls_Prefix + "::frmcust1091PEduScheduleList.xml", sArg, 600, 400, "", -1, -1);
}



// 접수번호

function edJubsuNo_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

	if (nChar == 13) { // Enter key

        btnSeqList.SetFocus();
		
		serch_falg = "0";	// 조회버튼으로 조회
		
		ls_EjMgno = "";		// 접수관리번호 초기화
		
        lfn_SearchEduJubsuList(obj);

	}

}



function edJubsuNo_OnKillFocus(obj) {

    gfn_ComponentOnKillFocus(obj);



    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));

}



// 접수목록

function btnSeqList_OnClick(obj) {



    if (gfn_IsNull(ls_EsMgno)) {

        gfn_Alert(MSGI00300); // "교육을 먼저 선택해 주십시오.";

        edEduOrder.SetFocus();

        return false;

    }



    lfn_EduJubsuListPopup(ls_EsMgno, edJubsuNo.Text, iif(gfn_IsNull(edJubsuNo.Text), "", "Y")); // 교육접수자목록 조회 팝업

}




// 결강자관리

function btnAbsentManageLink_OnClick(obj) {

    var ArrMenuInfo = gfn_SearchMenuInfo("training", "training::frmtraining0040MTrainingAbsentManagement.xml");	//메뉴정보조회

    if(length(ArrMenuInfo) > 0 ) {

        ls_SystemGubun = arrMenuInfo[7];                      //"training";

        gs_SystemMenuId = arrMenuInfo[5];                     //"0000000003";

        global.mnuLeft.tabMenu.tabpgMenu.Text = arrMenuInfo[6];	 //"강습관리";

        var ls_MenuId = arrMenuInfo[0];                          //"0000000043";

        var ls_MenuTitle = arrMenuInfo[1];                       //"결강자관리";

        var ls_MenuUrl = arrMenuInfo[2];             //"training::frmtraining0040MTrainingAbsentManagement.xml";

    

        global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", ls_SystemGubun);

        gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId);

    } else {

			gfn_Alert("해당 메뉴를 찾을 수 없습니다.");

		}

}



// 회차변경

function btnEduJubsuModify_OnClick(obj) {

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        edJubsuNo.SetFocus();

        return false;

    }

    if (left(GetDate(), 4) > left(ds_oEduOrderMgno.GetColumn(0, "ESDATE"),4)) {

        gfn_Alert("교육년도가 지나서 회차변경하실 수 없습니다.");

        return false;

    }

    if (!(ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "2" ||ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "4")) { // 접수상태가 아니면

        gfn_Alert("접수 상태가 아니므로 회차변경할 수 없습니다.");

        return false;

    }


	if (ds_ioEduJubsu.GetColumn(0, "EJISUGUBUN") == "Y") {
	
        gfn_Alert("이수된 자료는 회차변경할 수 없습니다.");

        return false;	
	
	}

    var sArg = "sJibu=" + quote(cbxJibu.Text);

    sArg += " sJibuCd=" + quote(cbxJibu.Value);

    sArg += " sCourse=" + quote(ds_oCourse.GetColumn(ds_oCourse.FindRow("CD", radCourse.Value), "DATA"));

    sArg += " sCourseCd=" + quote(radCourse.Value);

    sArg += " sYear=" + quote(edEduYear.Text);

    sArg += " sOrder=" + quote(edEduOrder.Text);

    sArg += " sEjmgno=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"));

    sArg += " sEsmgno=" + quote(ls_EsMgno);
    
    sArg += " sEsedutype=" + quote(ds_oEduOrderMgno.GetColumn(0, "ESEDUTYPE"));

    return Dialog("cust::frmcust1025PEduOrderChange.xml", sArg, 800, 400, "", -1, -1);



    lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경

}


/*
// 성명

function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

   if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면

        if (nChar == 13) {

            btnAuthResidentNo.SetFocus();

            lfn_SearchPersonNm();

        } else {

            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJNM"))) {

                lfn_ResetPerson();

                medResidentNo.Value = "";

            }

        }

    }

}
*/



function lfn_ResetPerson() {

    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부



    lfn_SetChangedJubsuInfo(true);

    ds_ioEduJubsu.SetColumn(0, "TJMGNO", ""); // 접수관리번호

    ms_TrainingPersonMgno = "";

    ds_ioEduJubsu.SetColumn(0, "TPMGNO", "");

    medZipCode.Value = "";

    edAddr1.Text = "";

    edAddr2.Text = "";

    edCompNm.Text = "";

    edTel.Text = "";

    edHpTel.Text = "";

    edEmail.text = "";

    edEmailDomain.Value = "";

 
    // 그리드 초기화

    ds_oJubsuAllInfo.ClearData();

    gdJubsuInfo.NoDataText = "";

    ds_oOrderHist.ClearData();

    gdOrderHist.NoDataText = "";

    ds_oFee.ClearData();
    
	ds_oFeeMonth.ClearData();
	
	ds_oSunap.ClearData();
	
	ds_iReady.ClearData();
	
	ds_iCustomerFee.ClearData();

    gdMemFee.NoDataText = "";

    btnSetlmt.Enable = false; // 결제(POS) 버튼

//    btnShowVirtualAccount.Enable = false;

	medTotMinapFee.Value = 0;	//미납금액
	
}



// 변경이력

function btnModifyHistory_OnClick(obj) {

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        return false;

    }

	gfn_ModifyHistoryListPopup("실무교육접수", ds_ioEduJubsu.GetColumn(0, "EJMGNO"));

}



// E-Mail

function cbxEmailDomain_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

    if (strText == "직접입력") {

        edEmailDomain.Enable = true;

        edEmailDomain.Value = "";

        edEmailDomain.SetFocus();

    } else {

        edEmailDomain.Value = cbxEmailDomain.Value;

        edEmailDomain.SetFocus();

    }

}



// 문자발송

function btnSendSms_OnClick(obj) {


    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");

        return false;

    }

    if (gfn_IsNull(edHpTel.Text)) {

        gfn_Alert("발송할 휴대폰번호가 존재하지 않습니다.");

        return false;

    }

	// gfn_KTSendOneSmsPopup(sMBCCD, sMPK1, sMPK2, sMPK3, sMBSMGNO, sMRECVNM, sMRECVTEL, sMTITLE, sMMSG);
	
	
	var vMessage = "";
	if (radCourse.Value == "10") {
	
		if (ds_ioEduJubsu.GetColumn(0, "ESDATE") < "20180301") {
			vMessage = radCourse.Text +" 실무교육이 접수되었습니다.\n"+"*"+substr(lbEduInfo2.text,1)+
					   "\n*교육장소:"+ds_ioEduJubsu.GetColumn(0, "EPNM");		
		} else {
		
			if (ds_ioEduJubsu.GetColumn(0, "ESCYBERGUBUN") == "0") {
			
				vMessage = "소방안전관리자 실무교육(혼합과정)이 접수되었습니다.\n"+
						   "혼합과정은 사이버교육과 소집교육을 안전원교육장에서 이수하는 교육과정입니다.\n"+
						   "*"+substr(lbEduInfo2.text,1)+
						   "\n*교육장소:"+ds_ioEduJubsu.GetColumn(0, "EPNM")+
						   "\n*안내사항 : 2018년부터 기존 소집교육(4시간) 외 사이버교육(2차시/40분)을 추가로 이수하셔야 법정실무교육을 이수한 것으로 인정됩니다.";
			
			} else {
			
				vMessage = "소방안전관리자 실무교육(사전이수과정)이 접수되었습니다.\n"+ 
						   "사전이수과정은 온라인 학습으로 사이버교육 이수 후, 안전원교육장에서 소집교육을 이수하는 과정으로, 사이버교육 미이수 시 소집교육 참석이 불가합니다.\n"+ 
						   //"* 사이버교육 바로가기 : 클릭(www.kfsi.or.kr)\n"+
						   "*"+substr(lbEduInfo2.text,1)+
						   "\n*교육장소:"+ds_ioEduJubsu.GetColumn(0, "EPNM")+
						   "\n*안내사항 : 2018년부터 기존 소집교육(4시간) 외 사이버교육(2차시/40분)을 추가로 이수하셔야 법정실무교육을 이수한 것으로 인정됩니다.";
				
			}
		
		}
	
	
	} else {
	
		vMessage = radCourse.Text +" 실무교육이 접수되었습니다.\n"+"*"+substr(lbEduInfo2.text,1)+
                   "\n*교육장소:"+ds_ioEduJubsu.GetColumn(0, "EPNM");
	
	}
	
	
	
    var arrSms = gfn_KTSendOneSmsPopup("301" // 실무교육접수자

                    , ds_ioEduJubsu.GetColumn(0, "ESMGNO")

                    , ds_ioEduJubsu.GetColumn(0, "EJMGNO")

                    , ds_ioEduJubsu.GetColumn(0, "EJHJUBSUNO")
                    
                    , ""
                    
                    , edPersonNm.Text
                    
                    , edHpTel.Text
                    
                    , "<실무교육 접수 안내>"

                    , vMessage
                    //, radCourse.Text +" 실무교육이 접수되었습니다.\n"+"*"+substr(lbEduInfo2.text,1)+
                    //  "\n*교육장소:"+ds_ioEduJubsu.GetColumn(0, "EPNM")

                ); // 단일문자메시지발송 팝업
                
}


// 문자현황
function btnSmsStat_OnClick(obj)
{

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        return false;

    }



    var sArg = "sEjmgno=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"));

	Dialog("cust::frmcust1025PEduSmsSendList.xml", sArg, 600, 400, "", -1, -1);


}



// 개인접수정보

function ds_oJubsuAllInfo_OnRowPosChanged(obj,nOldRow,nRow) {

    if (nRow <> -1) {

        lfn_SearchEduOrderHistList(); // 회차변경이력 조회

    }

    

}




function btnBarCodeSearch_OnClick(obj) {

    if (gfn_IsNull(medBarCode.Value)) {

        gfn_Alert("관리바코드를 입력해 주십시오.");

        medBarCode.SetFocus();

        return false;

    }

	lfn_SearchEduJubsuList();

}

// 참가원출력

function btnPrintJubsu_OnClick(obj) {

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    if (!gfn_Confirm("참가원을 출력 하시겠습니까?")) {

        return false;

	}



    // 출력이력을 저장한다.

    gfn_InsertSearchPrintHistory(

            "P"

            , this.ID

            , global.mnuLeft.cbxOpenForm.Text + "(참가원)"

            , "실무교육접수관리번호=" + ds_ioEduJubsu.GetColumn(0, "EJMGNO")

	);
	
	// 콜센터 직원용 이면
	if (gs_IsCallCenter == "Y") {
		// 콜센터 직원 조회이력 저장
		gfn_InsertCallCenterSearchPrintHistory(
		
				"P"
				
				, gs_CallCenterUID
	
				, gds_OpenedForm.GetColumn(gds_OpenedForm.FindRow("MURL",this.ID),"MMENUID")

				, this.ID
	
				, global.mnuLeft.cbxOpenForm.Text + "(참가원)"
	
				, "실무교육접수관리번호=" + ds_ioEduJubsu.GetColumn(0, "EJMGNO")
				
			);
	}


    var ls_RexFile = "";

    ds_oEduReport.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addCsvSearchActionInfo("cust:searchCust1031InetReport", false);
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oEduReport=ds_oInetReport" // outDs
        ,"EJMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))
        ,""
        ,false
        ,false
        ,true
    );
    
    if (left(ds_oEduReport.GetColumn(0, "EJCOURSECD"), 1) == "8") { //운송자
        ls_RexFile = "frmCust1031R02PInetEduStatistics.rex";
    } else {
        ls_RexFile = "frmCust1031R01PInetEduStatistics.rex";
    }
    
    gfn_CallReportPopup(ls_RexFile
        , "ds_oEduReport"
        , ""
        , true
    );

}





function radJibuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (strCode == "S") { // 소속지부

        cbxJibu.Enable = false;

        radJibuGubun.BkColor = "";

        if (ds_oJibu.FindRow("CD", gds_oUserInfo.GetColumn(0, "PDEPTCD")) <> -1) {

            cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");

        }

        lfn_SearchEduLatestOrder();

	} else { // 타지부

        cbxJibu.Enable = true;

        radJibuGubun.BkColor = "red";

	}

}



function radChangeTpmgno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (strCode == "C") {

        if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "TJMGNO"))) {

            gfn_Alert("접수 정보가 없습니다.");

            radChangeTpmgno.Value = "S";

            return false;

        } else {

            gfn_Alert("이 기능은 동일 인물에 대한 오타에 의한 성명/주민번호 변경용입니다.\n따라서, 해당 강습자와 관련된 모든 정보가 일괄 변경되므로, 신중히 변경하시기 바랍니다.");

        }

	}

}



// 접수이력

function btnJubsuHistory_OnClick(obj) {

    if (gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {

        gfn_Alert("접수 정보가 없습니다.");

        return false;

    }



    var sArg = "sEjmgno=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"));

    Dialog("cust::frmcust1025PEduJubsuHistory.xml", sArg, 600, 400, "", -1, -1);

}



/*

// 회차변경이력 클릭시 상단에 상세 조회 함 (강습접수)

*/

function gdOrderHist_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)

{

    var cnt = nRow; // 선택 row 값			

	var edJubsuNo_Num; // 접수번호 담는 변수

	

	if(ds_oOrderHist.rowcount > 0)

	{

		serch_falg = "1";	

       

        cbxJibu.value = ds_oOrderHist.GetColumn(cnt, "BEFORJIBU");    // 지부

        edEduYear.Text = ds_oOrderHist.GetColumn(cnt, "BEFORESYEAR");  // 년도

        radCourse.Value = ds_oOrderHist.GetColumn(cnt, "BEFORESCOUSECD");   // 직능
        
        edEduOrder.Text = ds_oOrderHist.GetColumn(cnt, "BEFORORDER"); // 회차 정보
		
        edJubsuNo.text  = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호
		
        edJubsuNo_Num = ds_oOrderHist.GetColumn(cnt, "BEFORJUBSUNO"); // 접수번호 담음


		/*

		if(ds_oOrderHist.GetColumn(cnt, "BEFORJIBU") != gds_oUserInfo.GetColumn(0, "PDEPTCD"))

			{

				changeJibuRadio("T", false);	

				radJibuGubun.Value = "T";

			}else{

				

				changeJibuRadio("S", false);

				radJibuGubun.Value = "S";

			}

		*/

		
		lfn_ChangeJibuRadioButton();  // 지부에 따른 자동 선택 

		

		lfn_SearchEduOrderMgno();  //  회차관리번호를 조회한다.

		

		edJubsuNo.text  = edJubsuNo_Num; // 접수번호


		//alert("회차관리번호 조회함");
		
		ls_EjMgno = "";

		lfn_SearchEduJubsuList();  // 접수 내용을 조회한다.

	}

}



function gdJubsuInfo_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)

{



    serch_falg = "1";  // 조회 플래그만 변경
    
    ls_Ejmgno = ds_oJubsuAllInfo.GetColumn(nRow, "EJMGNO");


    if(ds_oJubsuAllInfo.currow == nRow) {

        ds_oJubsuAllInfo_OnRowPosChanged(); // ds 변경 함수를 호출함 (같은 row선택시)

    }

    

}



///////////////////



/* 사용자 함수 */

/*

 * 기능 : 접수내역 update 후 처리

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchChane(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return ;

    }



    lfn_Search(); 

    gfn_SaveMessage(); // 저장 메세지를 처리한다.

  //  lfn_Save();  

	

}



function lfn_AfterAllJubsuSearch(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    	

}



function btnPrintEstimate_OnClick(obj)

{

	var retArr = gfn_EstimatePopup(ds_oFee.GetColumn(0, "PVPMYEAR"), ds_oFee.GetColumn(0, "ACCNTJIBU"), ds_oFee.GetColumn(0, "PVVMBILLTYPE"), ds_oFee.GetColumn(0, "PVVMVATNO"));  //팝업 호출

}



/*

* 결재 그리드 배경색을 기본으로 하고 선택한 ROW에 배경색을 지정(셀의 색상속성을 지정위함)

*/

function fn_bkcolor(currow)

{

    if(ds_oFee.row == currow)

     {

        return "#DFCF91";

      }else

      {

        return "default";

      }

}




/*

* 개인접수정보 상세보기 

*/

function btnEduJubsuinfo_OnClick(obj)

{

    lfn_SearchEduJubsuAllInfoList(); // 개인접수정보 조회

}



// 결제삭제
function btnDeleteSettlement_OnClick(obj)
{

    if (ds_oSunap.GetRowCount() < 1

        || gfn_IsNull(ds_oSunap.GetColumn(ds_oSunap.currow, "PMYEAR"))

        || gfn_IsNull(ds_oSunap.GetColumn(ds_oSunap.currow, "PMMGNO"))) {

        gfn_Alert("결제정보가 없습니다.");

        return;

    }
    
    if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "4") {
    
        gfn_Alert("회차변경된 자료는 결제를 삭제할 수 없습니다.");

        return;    
    
    } else if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") = "5" || ds_ioEduJubsu.GetColumn(0, "EJSTATUS") = "6") {
    
        gfn_Alert("환불신청 또는 환불접수 중인 자료는 결제를 삭제할 수 없습니다.");

        return;    
    
    }
    

    if (!gfn_confirm("결제를 삭제 하시겠습니까?")) {

        return;

    }

	// 가상계좌 정보 갱신
	ds_ioVirtualAccoutAllocation.ClearData();
	lfn_VirtualAccoutAllocation(ds_ioEduJubsu.GetColumn(0, "CMGNO"), ds_ioEduJubsu.GetColumn(0, "BNM"), ds_ioEduJubsu.GetColumn(0, "CGTMGNO"));

    tit_clearActionInfo();

	tit_addSingleActionInfo("cust:deleteCust1025CustomerFee", 0, "");
	tit_addSingleActionInfo("cust:executeCust0010VirtualAccoutAllocation", "", 0, "");
	
	var arg = "EJMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"));
	arg += " EJHSEQ=" + quote(ds_ioEduJubsu.GetColumn(0, "EJEJHSEQ"));
	arg += " EJPMYEAR=" + quote(ds_oSunap.GetColumn(ds_oSunap.currow, "PMYEAR"));
	arg += " EJPMMGNO=" + quote(ds_oSunap.GetColumn(ds_oSunap.currow, "PMMGNO"));
	arg += " CFSRGUBUN=" + quote(ds_oSunap.GetColumn(ds_oSunap.currow, "CFSRGUBUN"));	// 수납환불구분

    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iVirtualAccoutAllocation=ds_ioVirtualAccoutAllocation" // inDs
        ,"ds_oDeleteCustomerFee=ds_oDeleteCustomerFee"	// outDs
        ,arg
        ,"lfn_AfterDeleteCustomerFee"
        ,false
        ,""
        ,true
    );

}


function lfn_AfterDeleteCustomerFee(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    if (ds_oDeleteCustomerFee.GetCount() > 0) {
    
		if(ds_oDeleteCustomerFee.GetColumn(0, "RESULTCODE") == "OK") {
		
			gfn_Alert(ds_oDeleteCustomerFee.GetColumn(0, "RESULTMSG"));
			
			lfn_SearchEduJubsuList(); // 접수번호로 다시 조회한다.
			
		}
    
    }
    
}

// 조회 후 입력모드 활성화 여부
function lfn_setEduInputMode(bStatus) {

//	



}
////////////////////////////////////////////////////////////////////////////////////////////////////////
////결제관련////
////////////////////////////////////////////////////////////////////////////////////////////////////////


// 결제하기
function btnSetlmt_OnClick(obj)
{

	if( gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "CMGNO")) || gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "CNO")) ) {

		gfn_Alert("대상물(업체) 및 선임정보를 자료를 찾을 수 없습니다.");

		return false;

	}
	
    if (ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == '5' // 5:환불신청(미입금)

            || ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == '6') { // 6:환불접수(신청확인)

        gfn_Alert("인터넷 환불 처리 중입니다.");

        return false;

    }

    if ((ds_ioEduJubsu.GetColumn(0, "EJISUGUBUN") == "Y")  // 이수여부

            && ((ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "2") || ds_ioEduJubsu.GetColumn(0, "EJSTATUS") == "4")

            && !gfn_IsNull(ds_ioEduJubsu.GetColumn(0, "EJPMYEAR"))) { // 최종수납구분:수납

        gfn_Alert("[이수처리]된 자료입니다. 환불이 불가합니다.");

        return false;

    }
	
	if (medTotMinapFee.Value > 0) {	// 미납금액이 있으면
	
		// 회원이고 내년 실무교육이면 내년회비까지 미납내역 조회
		if (ds_ioEduJubsu.GetColumn(0, "CSTATUSGUBUN") == "0") {
	
			if (left(getDate(),4) < edEduYear.Text) {

				gfn_Alert(edEduYear.Text+"년도 교육이므로 " + edEduYear.Text + "년도 회비까지 수납처리됩니다.");
			
			}
		
		}
	
		lfn_SunapReady();	// 수납결제대기

	} else {

		if (ds_oSunap.GetCount() > 0) {		// 결제건수가 있고
	
            if (ds_oSunap.GetColumn(ds_oSunap.currow, "PVINFO") == "미발행") {
            
				gfn_Alert("                   < (세금)계산서 발행 자료 >\n\n"
		
					 + "해당 자료는 (세금)계산서가 발행되어 있습니다.\n\n"
		
					 + "    - (세금)계산서 관리번호 : " + ds_oSunap.GetColumn(ds_oSunap.currow, "PVVMYEAR") +"-"
														+ iif(ds_oSunap.GetColumn(ds_oSunap, "PVVMBILLTYPE")=="1","F","T") +"-"
														+ ds_oSunap.GetColumn(ds_oSunap.currow, "PVVMVATNO") + "\n\n"
		
					 + "회계 담당자에게 (세금)계산서 삭제 후 환불해 주시기 바랍니다.");

            }
	

			lfn_RepayReady();	// 환불결제대기
			
		}
		
	}
	
	lfn_Pos();			// 결제
		


}


// 수납결제대기
function lfn_SunapReady() {

	ls_SetlmGubun = "0"; //수납대기 구분 0:수납대기

    var sCheck = "YEAR";


    ds_iReady.InsertRow(0);

    ds_iReady.SetColumn(0, "SEL", "0");

    ds_iReady.SetColumn(0, "CFGUBUN", ls_SetlmGubun);

	ds_iReady.SetColumn(0, "CMGNO", ds_ioEduJubsu.GetColumn(0, "CMGNO"));

	ds_iReady.SetColumn(0, "CFMGGTMGNO", ds_ioEduJubsu.GetColumn(0, "CGTMGNO"));

	ds_iReady.SetColumn(0, "CNO", ds_ioEduJubsu.GetColumn(0, "CNO"));

	//ds_iReady.SetColumn(0, "CREGCD", lfn_GetRegion(ds_ioEduJubsu.GetColumn(0, "CGTMGNO"), ds_ioEduJubsu.GetColumn(0, "CREGCD")));

	ds_iReady.SetColumn(0, "CCOURSECD", ds_ioEduJubsu.GetColumn(0, "CCOURSECD"));

	ds_iReady.SetColumn(0, "CFMEMBERGUBUN", ds_ioEduJubsu.GetColumn(0, "CSTATUSGUBUN"));

	ds_iReady.SetColumn(0, "BNM", ds_ioEduJubsu.GetColumn(0, "BNM"));

	ds_iReady.SetColumn(0, "FMNM", ds_ioEduJubsu.GetColumn(0, "EJNM"));

	ds_iReady.SetColumn(0, "CFPROCAMOUNT", medTotMinapFee.Value);

	ds_iReady.SetColumn(0, "CFPROCDATE", left(getDate(), 8));

	ds_iReady.SetColumn(0, "CFREMARK", "");

	ds_iReady.SetColumn(0, "CFMGGTNM", lfn_GetJibu(ds_ioEduJubsu.GetColumn(0, "CGTMGNO")));

	//ds_iReady.SetColumn(0, "CFMEMBERNM", iif(ls_MemberGubun == "0", "회원", "비회원"));

	ds_iReady.SetColumn(0, "CCOURSENM", lfn_GetCourseNick(ds_ioEduJubsu.GetColumn(0, "CCOURSECD")));

	

	for (var i=0; i<ds_oFee.GetRowCount(); i++) {

        if (ds_oFee.GetColumn(i, "MINAPFEE") > 0) {

            sCheck += "," + i;

        }

	}

	

	ds_iReady.SetColumn(0, "CHECKDATA", sCheck); // 체크 row를 알기 위한 데이터



    ds_oFeeMonth.Filter("MINAPFEE>0");

    for (var i=0; i<ds_oFeeMonth.GetRowCount(); i++) {

        lfn_SetCustomerFee(i, "01");

    }

    ds_oFeeMonth.UnFilter();

}



// 환불결제대기
function lfn_RepayReady() {

    var sCMgno = "0";
 
	ls_SetlmGubun = "1"; //수납대기 구분 1:환불대기

    ds_iReady.InsertRow(0);
    
	ds_iReady.SetColumn(0, "SEL", "0");
	ds_iReady.SetColumn(0, "CFGUBUN", ls_SetlmGubun);
	ds_iReady.SetColumn(0, "CMGNO", ds_ioEduJubsu.GetColumn(0, "CMGNO"));
	ds_iReady.SetColumn(0, "CFMGGTMGNO", ds_ioEduJubsu.GetColumn(0, "CGTMGNO"));
	ds_iReady.SetColumn(0, "CNO", ds_ioEduJubsu.GetColumn(0, "CNO"));
	//ds_iReady.SetColumn(0, "CREGCD", lfn_GetRegion(ds_ioEduJubsu.GetColumn(0, "CGTMGNO"), ds_ioEduJubsu.GetColumn(0, "CREGCD")));
	ds_iReady.SetColumn(0, "CCOURSECD", ds_ioEduJubsu.GetColumn(0, "CCOURSECD"));
	ds_iReady.SetColumn(0, "CFMEMBERGUBUN", ds_ioEduJubsu.GetColumn(0, "CSTATUSGUBUN"));
	ds_iReady.SetColumn(0, "BNM", ds_ioEduJubsu.GetColumn(0, "BNM"));
	ds_iReady.SetColumn(0, "FMNM", ds_ioEduJubsu.GetColumn(0, "EJNM"));
	ds_iReady.SetColumn(0, "CFPROCAMOUNT", ds_oSunap.GetColumn(ds_oSunap.currow, "SUNAPFEE"));
	ds_iReady.SetColumn(0, "CFPROCDATE", left(getDate(), 8));
	ds_iReady.SetColumn(0, "CFREMARK", "[환불 : " + ds_oSunap.GetColumn(ds_oSunap.currow, "SUNAPFEE") +"원]");
	ds_iReady.SetColumn(0, "CHECKDATA", ds_oSunap.GetColumn(ds_oSunap.currow, "PMAMT")
										+ "," + ds_oSunap.GetColumn(ds_oSunap.currow, "PMBUYER")
										+ "," + ds_oSunap.GetColumn(ds_oSunap.currow, "CFGUBUNCD")
										+ "," + ds_oSunap.GetColumn(ds_oSunap.currow, "PMPCORDERNO")
					   ); // 체크 row를 알기 위한 데이터
	ds_iReady.SetColumn(0, "CFMGGTNM", lfn_GetJibu(ds_ioEduJubsu.GetColumn(0, "CGTMGNO")));
	ds_iReady.SetColumn(0, "CCOURSENM", lfn_GetCourseNick(ds_ioEduJubsu.GetColumn(0, "CCOURSECD")));
	ds_iReady.SetColumn(0, "CFMEMBERNM", ds_ioEduJubsu.GetColumn(0, "EJNM"));
	sCMgno = ds_ioEduJubsu.GetColumn(0, "CMGNO");


    ds_iCustomerFee.ClearData();
    
    tit_clearActionInfo();
    tit_addSearchActionInfo("cust:searchCust2012CustomerFee", false);
    
    // 서버 호출 
    tit_callService(
        ""
        ,""
        ,""
        ,"ds_iCustomerFee=ds_oCustomerFee"
        ,"SPMYEAR=" + quote(ds_ioEduJubsu.GetColumn(0, "EJPMYEAR"))
            + " SPMMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "EJPMMGNO"))
            + " SCMGNO=" + quote(sCMgno)
            + " LAST=" + quote("Y") // args 
        ,""
        ,false
        ,false
        ,true
    );

}


// POS 결제창
function lfn_Pos() {

    var sArgs = split(ds_iReady.GetColumn(0, "CHECKDATA"), ",", "webstyle");

    var sArg = "sProgramId=" + quote(iif(ds_iReady.GetColumn(ds_iReady.currow, "CFMEMBERGUBUN") == "0", "11", "12"))

        + " sSunapGubun=" + quote(ds_iReady.GetColumn(0, "CFGUBUN"))

        + " sTotalAmount=" + quote(sArgs[0])

        + " sAmount=" + quote(iif(ds_iReady.GetColumn(0, "CFGUBUN") == "0", medTotMinapFee.Value, sArgs[0]))

        + " sJibu=" + quote(ds_ioEduJubsu.GetColumn(0, "CGTMGNO"))

        + " sBuyer=" + quote(sArgs[1])

        + " sSetlmGubun=" + quote(sArgs[2])

        + " sOrderNo=" + quote(sArgs[3])

    ;
    
    
	if (ds_iReady.GetRowCount() == 1) {
	
		sArg += " sCMgno=" + quote(ds_ioEduJubsu.GetColumn(0, "CMGNO"));
		sArg += " sFMNM=" + quote(edPersonNm.Text);
		sArg += " sEduJubsu='Y'";	// 실무교육접수여부
		sArg += " sEjmgno=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"));	// 접수관리번호
		sArg += " sEjhseq=" + quote(ds_ioEduJubsu.GetColumn(0, "EJEJHSEQ"));	// 접수관리순번
	} else {

		sArg += " sCMgno='' sFMNM=''";
		
	}
    

    var retDlg = Dialog(ls_Prefix + "::frmcust2020PCustomerFeePos.xml", sArg, 600, 312, "", -1, -1);
 
	ds_iReady.ClearData();
	ds_iCustomerFee.ClearData();
	
    var sSMMSG;

    var SunapGubunSms;

    if(retDlg[1] = "0") {  // 수납여부

        SunapGubunSms = "수납";

    } else if(retDlg[1] = "1") {

        SunapGubunSms = "환불";

    }
	
    if (retDlg[0] == "OK") {
    
        if (retDlg[1] = "0") { // 수납이면        

			if (gfn_Confirm("결제내역을 문자메시지로 전송 하시겠습니까?")) {
			
			    sSMMSG = radCourse.Text + " 실무교육 " + NumFormat(abs(retDlg[2])) + "원이 " + SunapGubunSms + "(접수완료)되었습니다.";  // retDlg[2] 금액
			
			
				// gfn_KTSendOneSmsPopup(sMBCCD, sMPK1, sMPK2, sMPK3, sMBSMGNO, sMRECVNM, sMRECVTEL, sMTITLE, sMMSG);
				var arrSms = gfn_KTSendOneSmsPopup("301" // 실무교육접수자
			
								, ds_ioEduJubsu.GetColumn(0, "ESMGNO")
			
								, ds_ioEduJubsu.GetColumn(0, "EJMGNO")
			
								, ds_ioEduJubsu.GetColumn(0, "EJHJUBSUNO")
								
								, ""
								
								, edPersonNm.Text
								
								, edHpTel.Text
								
								, "한국소방안전원"
			
								, sSMMSG
			
							); // 단일문자메시지발송 팝업
                   
		
			}

		}

        lfn_Search();

    }

}


/**

 * 회비/교육비 결제 정보 set

 */

function lfn_SetCustomerFee(nRow, sSunapGubun) {

    ds_iCustomerFee.InsertRow(0);

    ds_iCustomerFee.SetColumn(0, "CFCMGNO", ds_ioEduJubsu.GetColumn(0, "CMGNO")); //고객번호

    ds_iCustomerFee.SetColumn(0, "CFSETLMGUBUN", "1");

    ds_iCustomerFee.SetColumn(0, "CFMEMBERGUBUN", ds_oFeeMonth.GetColumn(nRow, "CFCCGUBUN"));

    ds_iCustomerFee.SetColumn(0, "CFGUBUN", sSunapGubun);

    ds_iCustomerFee.SetColumn(0, "CFSUNAPYEAR", ds_oFeeMonth.GetColumn(nRow, "CFGYEAR"));

    ds_iCustomerFee.SetColumn(0, "CFSUNAPMONTH", ds_oFeeMonth.GetColumn(nRow, "CFSUNAPMONTH"));

    ds_iCustomerFee.SetColumn(0, "CFSUNAPHALF", ds_oFeeMonth.GetColumn(nRow, "CFSUNAPHALF"));

    ds_iCustomerFee.SetColumn(0, "CFPROCAMOUNT", ds_oFeeMonth.GetColumn(nRow, "MINAPFEE"));

	ds_iCustomerFee.SetColumn(0, "CFMGGTMGNO", gds_oUserInfo.GetColumn(0, "PDEPTCD"));

    ds_iCustomerFee.SetColumn(0, "CFREMARK", "");

}

// 접수번호 조회 버튼

function btnJubsuNo_OnClick(obj)
{
	edJubsuNo_OnKeyDown(obj, "13");
}



/*

 * 기능 : 접수대상 정보를 조회한다.

 * parameter : 없음

 * return value : 없음

 */

function lfn_CustomerListSearch(sGubun, sCourse, sValue1, sValue2) {

    var arrCustomer = gfn_CustomerListPopup(sGubun, sCourse, sValue1, sValue2); // 고객 조회 팝업
    
    if (arrCustomer == "END") {
    
        ls_IsChangedJubsuInfoYn = "N";	// 접수자기본정보 변경여부

    } else if (length(arrCustomer) > 0) {
    
		cbxCustJibu.Value = arrCustomer[0];
		
		medCustNo.text = arrCustomer[1];

        medBarCode.Value = lpad(arrCustomer[2], "0", 13);
        
        ds_ioEduJubsu.SetColumn(0, "CMGNO", arrCustomer[2]);
        
        cbxDetailCourse.Value = arrCustomer[3];
        
        ds_ioEduJubsu.SetColumn(0, "CSTATUSGUBUN", arrCustomer[4]);
        
        edBuildingNm.Text = arrCustomer[5];
        
        ds_ioEduJubsu.SetColumn(0, "BNM", arrCustomer[5]);
        
        cbxAddrGubun.Value = iif(gfn_IsNull(arrCustomer[6]), "0", arrCustomer[6]);

		medZipCode.Value = arrCustomer[7];
		
		edAddr1.text = arrCustomer[8];
		
		edAddr2.text = arrCustomer[9];
		
		edPersonNm.Text = arrCustomer[10];
		
		medBirthday.Value = arrCustomer[11];
		
		ds_ioEduJubsu.SetColumn(0, "EJPERSONKEY", arrCustomer[12]);
		
		ds_ioEduJubsu.SetColumn(0, "EJFMMGNO", arrCustomer[13]);
		
        ds_ioEduJubsu.SetColumn(0, "EJTEL", arrCustomer[14]);

        edHpTel.Text = arrCustomer[15];

        edEmail.text = arrCustomer[16];

        edEmailDomain.Value = arrCustomer[17];  
             
        calEduExpireDate.Value = arrCustomer[41];  
                
        ds_ioEduJubsu.SetColumn(0, "FMHSTARTDATE", arrCustomer[18]);
        
        
        ds_ioEduJubsu.SetColumn(0, "EJRPNUCD", arrCustomer[19]);	// BRPNUCD
        
        ds_ioEduJubsu.SetColumn(0, "EJRROADBUILDMGNO", arrCustomer[20]);	// TBROADBUILDMGNO
        
        ds_ioEduJubsu.SetColumn(0, "EJRROADDETAIL", arrCustomer[21]);	// BRROADDETAIL
        
        ds_ioEduJubsu.SetColumn(0, "EJRROADREMAIN", arrCustomer[22]);	// BRROADREMAIN
        
        ds_ioEduJubsu.SetColumn(0, "EJRSANGUBUN", arrCustomer[23]);	// BRSANGUBUN
        
        ds_ioEduJubsu.SetColumn(0, "EJRMAINBUNJI", arrCustomer[24]);	// BRMAINBUNJI
        
        ds_ioEduJubsu.SetColumn(0, "EJRSUBBUNJI", arrCustomer[25]);	// BRSUBBUNJI
        
        ds_ioEduJubsu.SetColumn(0, "EJRBUILDNM", arrCustomer[26]);	// BRBUILDNM
        
        ds_ioEduJubsu.SetColumn(0, "EJRADDRETC", arrCustomer[27]);	// BRADDRETC
        
		ds_ioEduJubsu.SetColumn(0, "EJRCONVSTATUS", arrCustomer[28]);	// BRCONVSTATUS
		
        ds_ioEduJubsu.SetColumn(0, "EJRCPNUCD", arrCustomer[29]);	// BRPNUCD
        
        ds_ioEduJubsu.SetColumn(0, "EJRCROADBUILDMGNO", arrCustomer[30]);	// TBROADBUILDMGNO
        
        ds_ioEduJubsu.SetColumn(0, "EJRCROADDETAIL", arrCustomer[31]);	// BRROADDETAIL
        
        ds_ioEduJubsu.SetColumn(0, "EJRCROADREMAIN", arrCustomer[32]);	// BRROADREMAIN
        
        ds_ioEduJubsu.SetColumn(0, "EJRCSANGUBUN", arrCustomer[33]);	// BRSANGUBUN
        
        ds_ioEduJubsu.SetColumn(0, "EJRCMAINBUNJI", arrCustomer[34]);	// BRMAINBUNJI
        
        ds_ioEduJubsu.SetColumn(0, "EJRCSUBBUNJI", arrCustomer[35]);	// BRSUBBUNJI
        
        ds_ioEduJubsu.SetColumn(0, "EJRCBUILDNM", arrCustomer[36]);	// BRBUILDNM
        
        ds_ioEduJubsu.SetColumn(0, "EJRCADDRETC", arrCustomer[37]);	// BRADDRETC
        
		ds_ioEduJubsu.SetColumn(0, "EJRCCONVSTATUS", arrCustomer[38]);	// BRCONVSTATUS

		ds_ioEduJubsu.SetColumn(0, "EJRCONVPGM", arrCustomer[39]);	// BRCONVPGM

        ls_IsChangedJubsuInfoYn = "Y";	// 접수자기본정보 변경여부

		lfn_SearchCustomerYearFeeList(); // 결제내역 조회ds_ioEduJubsu.GetColumn(0, "CMGNO");
		
		// 고객정보관리에서 연동되어 온 화면이면
		if (IsExistVar("sJibu") && !gfn_isNull(sJibu) && !gfn_isNull(sCustNo)) {
			sJibu = ""; 	// 고객정보관리에서 연동된 지부
			sCustNo = "";	// 고객정보관리에서 연동된 관리번호
		}
		
    } else {

		gfn_alert("검색된 자료가 없습니다.");

        edRemark.SetFocus();

    }

    lfn_CheckEduJubsuAlready(); // 기접수여부 조회

}


// 접수대상 관리번호 검색
function medCustNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{

	if (nChar == 13) { // Enter key

		if (gfn_isNull(medCustNo.Text) || medCustNo.Text == "______") {
	
			gfn_Alert("관리번호를 입력 후 검색 하세요!");
		
			medCustNo.SetFocus();
			
		} else {
		
			medCustNo.Value = lpad(medCustNo.Value, "0", 6);
			
			lfn_CustomerListSearch("1", radCourse.Value, cbxCustJibu.Value, medCustNo.Text);
		
		}

	}
		
}


// 접수대상 관리바코드 검색
function medBarCode_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) 
{
	if (nChar == 13) {

		if (gfn_isNull(cbxCustJibu.Value)) {

			gfn_Alert("지부를 선택 후 검색 하세요!");	
		
			medBarCode.SetFocus();
			
			return false;
			
		
			
		}

		if (gfn_isNull(medBarCode.Text) || medBarCode.Text == "_____________") {
	
			gfn_Alert("관리바코드를 입력 후 검색 하세요!");
		
			medBarCode.SetFocus();
			
		} else {
		
			medBarCode.Value = lpad(medBarCode.Value, "0", 13);
	
			lfn_CustomerListSearch("2", radCourse.Value, medBarCode.Text, "");
			
		}
		
	}

}

// 접수대상 대상물명으로 검색
function edBuildingNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {

		if (gfn_isNull(edBuildingNm.Text)) {
	
			gfn_Alert("대상물명을 입력 후 검색 하세요!");
		
			edBuildingNm.SetFocus();
			
		} else {
		
			lfn_CustomerListSearch("3", radCourse.Value, edBuildingNm.Text, "");
			
		}
		
	}
}

// 접수대상 성명으로 검색
function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {

   if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면

        if (nChar == 13) {

			if (gfn_isNull(edPersonNm.Text)) {
		
				gfn_Alert("성명을 입력 후 검색 하세요!");
			
				edPersonNm.SetFocus();
				
			} else {
			
				lfn_CustomerListSearch("4", radCourse.Value, edPersonNm.Text, "");
	
			} 
			
		}
    }

}

// 접수대상 관리번호 버튼으로 검색
function btnCustNo_OnClick(obj)
{
	medCustNo_OnKeyDown(obj, "13");
}

// 접수대상 관리바코드 버튼으로 검색
function btnCmgno_OnClick(obj)
{
	medBarCode_OnKeyDown(obj, "13");
}

// 접수대상 대상물명 버튼으로 검색
function btnBnm_OnClick(obj)
{
	edBuildingNm_OnKeyDown(obj, "13");
}

// 접수대상 성명 버튼으로 검색
function btnNm_OnClick(obj)
{
	edPersonNm_OnKeyDown(obj, "13");
}


// 기존접수자 조회
function lfn_ExistEduJubsuListSearch(sGubun, sValue1, sValue2)
{
var sArg = "";

	if (sGubun == "1") {
    
		sArg = "sGubun='1'" + " sPersonNm=" + quote(sValue1);
		
	} else if (sGubun == "2") {
	
		sArg = "sGubun='2'" + " sGtmgno=" + quote(sValue1) + " sCno=" + quote(sValue2);

	} else if (sGubun == "3") {

		sArg = "sGubun='3'" + " sBnm=" + quote(sValue1);
		
	}

	serch_falg = "2"; // 기존접수자 조회로 조회

    var arrEjmgno = Dialog("cust::frmcust1025PEduJubsuHistList.xml", sArg, 600, 400, "", -1, -1);

    if (arrEjmgno == "END") {
    
    
    } else if (length(arrEjmgno) > 0) {

        ls_Ejmgno = arrEjmgno[0];  // 접수관리번호

        lfn_SearchEduJubsuList();
        
    } else {

        ls_Ejmgno = "";

    }

	serch_falg = "0";


}


// 기존접수자 조회(성명)
function edExistNM_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {

		medExistCustNo.Text = "";
		edExistBnm.Text = "";
		
		if (gfn_isNull(edExistNM.Text)) {
	
			gfn_Alert("성명을 입력 후 조회 하세요!");
		
			edExistNM.SetFocus();
			
		} else {
		
			lfn_ExistEduJubsuListSearch("1", edExistNM.Text, "");

		} 
		
	}
}

// 기존접수자 조회(관리번호)
function medExistCustNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if (nChar == 13) { // Enter key

		edExistNM.Text = "";
		edExistBnm.Text = "";

		if (gfn_isNull(medExistCustNo.Text) || medExistCustNo.Text == "______") {
	
			gfn_Alert("관리번호를 입력 후 조회 하세요!");
		
			medExistCustNo.SetFocus();
			
		} else {
		
			medExistCustNo.Value = lpad(medExistCustNo.Value, "0", 6);
			
			lfn_ExistEduJubsuListSearch("2", cbxExistJibu.Value, medExistCustNo.Text);
		
		}

	}	
}

// 기존접수자 조회(대상물명)
function edExistBnm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13) {

		edExistNM.Text = "";
		medExistCustNo.Text = "";

		if (gfn_isNull(edExistBnm.Text)) {
	
			gfn_Alert("대상물명을 입력 후 조회 하세요!");
		
			edExistBnm.SetFocus();
			
		} else {
		
			lfn_ExistEduJubsuListSearch("3", edExistBnm.Text, "");
			
		}
		
	}	
}

// 기존접수자(성명) 버튼으로 조회
function btnExistNM_OnClick(obj)
{
	edExistNM_OnKeyDown(obj,"13");
}

// 기존접수자(관리번호) 버튼으로 조회
function btnExistCustNo_OnClick(obj)
{
	medExistCustNo_OnKeyDown(obj,"13");
}

// 기존접수자(대상물명) 버튼으로 조회
function btnExistBnm_OnClick(obj)
{
	edExistBnm_OnKeyDown(obj,"13");
}

/**
 * 가상계좌 정보 갱신
 * Parameter : sCMGNO - 관리번호
 *           : sBuyer - 대상물명
 *           : sCGTMGNO - 지부
 */
function lfn_VirtualAccoutAllocation(sCMGNO, sBNM, sCGTMGNO) {

    var nRow = ds_ioVirtualAccoutAllocation.AddRow();
    ds_ioVirtualAccoutAllocation.SetColumn(nRow, "SCMGNO", sCMGNO);
    ds_ioVirtualAccoutAllocation.SetColumn(nRow, "SBNM", sBNM);
    ds_ioVirtualAccoutAllocation.SetColumn(nRow, "SJIBU", sCGTMGNO);
	
}


// 은행 가상계좌 보기
function btnShowVirtualAccount_OnClick(obj)
{
	// 고객자료가 조회된 상태이면
	if(ds_ioEduJubsu.rowcount > 0) {
	
		// 세틀뱅크 가상계좌 보기
		sArg = "sGUBUN=" + quote(ds_ioEduJubsu.GetColumn(0, "CSTATUSGUBUN"));
		sArg += " sTotalAmount=" + quote(medTotMinapFee.Value);
		sArg += " sJibu=" + quote(ds_ioEduJubsu.GetColumn(0, "CGTMGNO"));
		sArg += " sCMgno=" + quote(ds_ioEduJubsu.GetColumn(0, "CMGNO"));
		sArg += " sFMNM=" + quote(edPersonNm.Text);
		sArg += " sHPTEL=" + quote(edHpTel.Text);
		sArg += " sBNM=" + quote(edBuildingNm.Text);
		sArg += " sCOURSENM=" + quote(radCourse.Text);
		sArg += " sEJMGNO=" + quote(ds_ioEduJubsu.GetColumn(0, "EJMGNO"));
		sArg += " sESDATE=" + quote(ds_ioEduJubsu.GetColumn(0, "ESDATE"));

		vRtl = Dialog("cust::frmcust2019PFixVirtualAccountSend.xml", sArg, 400, 220, "", -1, -1);	

	} else {

		gfn_Alert("접수정보가 없습니다. 접수정보를 조회하신 후 가상계좌보기를 클릭해주세요!");
		return;
		
	}
}



/*

 * 기능 : 고객정보관리에서 연동되어 오픈된 경우 오늘이후 날자로 이미 접수된 자료가 있는지 조회

 */

function lfn_AlreadySearch(obj) {

var args = "";

    ds_oJubsuAlreadyInfo.ClearData(); // 데이타셋 초기화
	
	if (!gfn_isNull(sJibu)) {
	
		args = "GTMGNO=" + quote(sJibu) + " CNO=" + quote(sCustNo);
		
	} else if (!gfn_isNull(sPK1)) {	// 민원서류 등록현황 바로가기 연동
	
		args = "EJMGNO=" + quote(sPK1);

	}

    tit_clearActionInfo();

    tit_addSearchActionInfo("cust:searchCust1025EduJubsuAlreadyInfo", false);

    // 서버 호출

    tit_callService(

        ""

        , ""

        , "" // inDs

        , "ds_oJubsuAlreadyInfo=ds_oJubsuAlreadyInfo" // outDs

        , args // args

        , "lfn_AfterSearchEduJubsuAlreadyInfo"

        ,false

        ,false

        ,true

    );

}


function lfn_AfterSearchEduJubsuAlreadyInfo(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
	if (ds_oJubsuAlreadyInfo.GetCount() > 0) {
	
		if (gfn_isNull(sPK1)) {	// 민원서류 등록현황 바로가기 연동
	
			gfn_Alert("오늘("+left(getDate(),4)+"."+substr(getDate(),4,2)+"."+substr(getDate(),6,2)+")"+" 이후로 이미 접수된 내역이 있습니다.");
			
		} else {
		
			sPK1 = ""; 	// 민원서류 등록현황 바로가기 연동 PK 초기화
			
		}
	
        ls_Ejmgno = ds_oJubsuAlreadyInfo.GetColumn(0, "EJMGNO");  // 접수관리번호
     
		lfn_SearchEduJubsuList();
        
	
	} else {
	
		lfn_SearchEduLatestOrder(); // 최근 접수가능회차 조회
	
		edEduOrder.SetFocus();
	
	}

}

// 서류스캔 실행
function btnScan_OnClick(obj)
{
	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	} else {
	
		ExecProc(gs_FormScanProgram);
		
	}
}

// 서류스캔파일 불러오기
function btnScanSearch_OnClick(obj)
{

	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	}

    var ls_File = split(gs_FormScanFile,"\\");



    fdImage2.FilePath = left(gs_FormScanFile, length(gs_FormScanFile) - length(ls_File[length(ls_file) - 1]));

    fdImage2.FileName = ls_File[length(ls_file) - 1];



    fiImageFile2.FileName = gs_FormScanFile;

    if (fiImageFile2.Open()) {

        fiImageFile2.Open("rb");



        var ln_ImageSize = fiImageFile2.GetLength();

        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경

        if (ln_ImageSize > 300) {

            gfn_Alert("서류 스캔파일 사이즈가 300KB를 넘겼습니다.\n 사이즈 : " + NumFormat(ln_ImageSize) + "KB");

            return false;

        }

        fiImageFile2.Close();

    } else {

        gfn_Alert("서류스캔 이미지가 없습니다.");

        return;

    }



    edScanFileName.Text = fdImage2.FileName;


    lb_FormFileUpload = true;	// 서류스캔파일 등록 여부


	// 파일명 형식 : 년월일시분초+ 랜덤(3자리)
    ls_UploadFormName = GetDate() + Random(100,999) + gfn_GetFileExtensionName(fdImage2.FileName);

}

// 민원서류 스캔파일 저장
function btnScanSave_OnClick(obj)
{

	if (gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJMGNO"))) {
	
        gfn_Alert("접수자료가 없습니다.\n\n" +
                  "접수자료 조회 후 저장하세요!");

        return;
	
	}
	
	
	if (cbxForm.Index == 0) {
	
        gfn_Alert("민원서류 종류를 먼저 선택하세요!");

        return;
	
	}
	
	if (edScanFileName.Text == "") {

        gfn_Alert("스캔한 파일이 없습니다!");

        return;
	
	}
	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 저장하시겠습니까?")) {

		return false;

	}
	
	
		
	ds_iFormSave.ClearData();
	
	ds_iFormSave.AddRow();
			
	var vPROC = "";
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	
	// 실무교육원서
	if (cbxForm.Value == "0006") {
		if (gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
			vPK2 = "";
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJFAMGNO");
		}
	// 일정변경신청서
	} else if (cbxForm.Value == "00081") {
		if (gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioEduJubsu.GetColumn(0, "EJHSEQ");
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO");
		}
	// 환불신청서
	} else if (cbxForm.Value == "00082") {
		if (gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO"))) {
			vPROC = "I";	// 신규
			vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioEduJubsu.GetColumn(0, "EJHSEQ");
		} else {
			vPROC = "A";	// 변경
			vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO");
		}
	}
			
	ds_iFormSave.SetColumn(0, "I_PROC", vPROC);					//신규(I), 화일변경(A)
    ds_iFormSave.SetColumn(0, "I_FCCD", left(cbxForm.Value,4));	//FORMCODE.FCCD 서식관리번호(신규/화일변경 공통]
    ds_iFormSave.SetColumn(0, "I_FAMGNO", vFAMGNO);				//FormAttach.FAmgno (화일변경만)
    ds_iFormSave.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값(신규만)
    ds_iFormSave.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록(신규만)
    ds_iFormSave.SetColumn(0, "I_FRDATE", left(getDate(),8));	//보관시작일(신규만)
    ds_iFormSave.SetColumn(0, "I_PATH", ls_FormUploadPath);		//저장위치(신규 /화일변경)
    ds_iFormSave.SetColumn(0, "I_FILENM", ls_UploadFormName);	//파일명(신규 /화일변경)
    
//    TRACE(ds_iFormSave.SaveXML());
						
    ds_oFormSave.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:insertFormSave", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormSave=ds_iFormSave"    // inDs

        ,"ds_oFormSave=ds_oFormSave"    // outDs

        ,""    // args

        ,"lfn_AfterFormSave"

        ,false

        ,false

        ,true

    );
    


}

function lfn_AfterFormSave(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
    if (ds_oFormSave.GetColumn(0, "O_status") == "FAIL") {
    
        gfn_ErrorMsg(ds_oFormSave.GetColumn(0, "O_status"), ds_oFormSave.GetColumn(0, "O_value"));

        return false;    
        
    } else if (ds_oFormSave.GetColumn(0, "O_status") == "SUCCESS") {

		var UploadResult = tit_FileWrite(

						hfImage2
				
						, ls_FormUploadPath
				
						, fdImage2.FilePath
				
						, fdImage2.FileName
				
						, ls_UploadFormName
				
						, "U"
				
						, true
				
					);
						
		/* Array
			0 - 성공 : S / 실패 : E / 파일크기 초과 : O
			1 - 서버에 저장된 실제 경로
			2 - 서버에 저장된 실제 파일명
			3 - 서버에 저장된 파일 사이즈
		*/
		// 성공여부 체크 && 파일사이즈 체크
		if (UploadResult[0] == "S" && UploadResult[3] == fiImageFile2.GetLength()) {
			
			gfn_Alert("서류스캔파일이 정상적으로 저장되었습니다.");
			
			lfn_Search();
		
		} else {
		
			gfn_Alert("서류스캔파일 저장 시 오류가 발생했습니다.");
			
			return false;
		}
							
		hfImage2.CloseFile();
		
	}

}

// 서버 서식스캔파일 보기
function btnSeverFormView_OnClick(obj)
{

	if (edFormResult.Text == "완료") {

		var sFile = split(ds_ioEduJubsu.GetColumn(0, "ATC" + cbxForm.Value), "|");
		
		sArg = "sURL=" + GF_FILE_SERVER_URL + "kems"+ sFile[1];
		
		//alert(sArg);
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}
	
}

// PC 서식스캔파일 보기
function btnLocalFormView_OnClick(obj)
{
	
	if (!gfn_isNull(edScanFileName.Text)) {
	
		sArg = "sURL="+"C:\\KFSA\\Form.pdf";
	
		Dialog("COM::frmCOM1500PWebBrowserView.xml", sArg, 700, 500, "", -1, -1);	
		
	}
}


function cbxForm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	btnScan.SetFocus();
}

// 서류 DB삭제(관리자만)
function btnFormDelete_OnClick(obj)
{

	if (edFormResult.Text <> "완료") {
	
		gfn_Alert("등록된 자료가 없습니다.");

		return false;

	}

	
	if (!gfn_Confirm("민원서류(" + cbxForm.Text + ")를 삭제하시겠습니까?")) {

		return false;

	}
	
	var vFAMGNO = "";
	var vPK1 = "";
	var vPK2 = "";
	var vPathArr = "";
	var vPath = "";
	var vfile = "";
	
	// 실무교육원서
	if (cbxForm.Value == "0006") {
		if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJFAMGNO"))) {
			vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
			vPK2 = "";
			vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJFAMGNO");
			vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
				
	} else if (cbxForm.Value == "00081") {	// 일정변경신청서
		if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO"))) {
			vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioEduJubsu.GetColumn(0, "EJHSEQ");
			vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO");
			vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC00081"), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	} else if (cbxForm.Value == "00082") {	// 환불신청서
		if (!gfn_isNull(ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO"))) {
			vPK1 = ds_ioEduJubsu.GetColumn(0, "EJMGNO");
			vPK2 = ds_ioEduJubsu.GetColumn(0, "EJHSEQ");
			vFAMGNO = ds_ioEduJubsu.GetColumn(0, "EJHFAMGNO");
			vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC00082"), "|");
			vPath = substr(vPathArr[1],0,18);	// 서버경로
			vfile = substr(vPathArr[1],19,21);	// 파일명
		}
	}

		
	ds_iFormDelete.ClearData();
	ds_iFormDelete.AddRow();
	
    ds_iFormDelete.SetColumn(0, "I_FCCD", cbxForm.Value);		//FORMCODE.FCCD 서식관리번호
    ds_iFormDelete.SetColumn(0, "I_FAMGNO", vFAMGNO);			//FormAttach.FAmgno
    ds_iFormDelete.SetColumn(0, "I_PK1VAL", vPK1);				//관리PK1 값
    ds_iFormDelete.SetColumn(0, "I_PK2VAL", vPK2);				//관리PK2 값 있는 경우만 등록
    ds_iFormDelete.SetColumn(0, "I_PATH", vPath);				//저장경로
    ds_iFormDelete.SetColumn(0, "I_FILENM", vfile);				//파일명
    
    ds_oFormDelete.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();

    tit_addSingleActionInfo("com:deleteForm", "", 0, "");

    // 서버 호출

    tit_callService(

        ""

        ,""

        ,"ds_iFormDelete=ds_iFormDelete"    // inDs

        ,"ds_oFormDelete=ds_oFormDelete"    // outDs

        ,""    // args

        ,"lfn_AfterFormDelete"

        ,false

        ,false

        ,true

    );
    
}

// 민원서류 서버파일삭제
function lfn_AfterFormDelete(nErrorCode, strErrorMsg)
{
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }
    
	var vPathArr = split(ds_ioEduJubsu.GetColumn(0, "ATC"+cbxForm.Value), "|");
	var vPath = substr(vPathArr[1],0,18);	// 서버경로
	var vfile = substr(vPathArr[1],19,21);	// 파일명


	var UploadResult = tit_FileDelete(  //serverSaveDir, serverFileName, isNeedRtn

					vPath	// 서버경로
			
					, vfile	// 파일명
			
					, true				// 처리결과
			
				);
					
	// 결과	true / false

	// 성공여부 체크 && 파일사이즈 체크
	if (UploadResult == true) {
		
		gfn_Alert("서류스캔파일이 정상적으로 삭제되었습니다.");
		
		lfn_Search();
	
	} else {
	
		gfn_Alert("서류스캔파일 삭제 시 오류가 발생했습니다.");
		
		return false;
		
	}
							
}

// 사이버교육 정보
function btnCyberInfo_OnClick(obj)
{
    
    if (gfn_IsNull(edEduOrder.Text)) {

        gfn_Alert("회차를 입력해 주십시오.");

        edEduOrder.SetFocus();

        return false;

    }

    if (gfn_IsNull(edJubsuNo.Text)) {

        gfn_Alert("접수번호를 입력해 주십시오.");

        edJubsuNo.SetFocus();

        return false;

    }

    
    if (gfn_IsNull(edPersonNm.Text)) {

        gfn_Alert("성명을 입력해 주십시오.");

        edPersonNm.SetFocus();

        return false;

    }

    if (gfn_IsNull(medBirthday.Value)) {

        gfn_Alert("생년월일을 입력해 주십시오.");

        medBirthday.SetFocus();

        return false;

    }
    
    if (ds_ioEduJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부
    
		gfn_Alert("회차변경된 자료는 사이버교육 정보가 없습니다.");
		
		return false;
		
	} else {

		var sArg = "sEsgtmgno=" + quote(ds_ioEduJubsu.GetColumn(0, "ESGTMGNO"));
		
		sArg += " sCoursecd=" + quote(ds_ioEduJubsu.GetColumn(0, "ESCOUSECD"));
	
		sArg += " sEsyear=" + quote(ds_ioEduJubsu.GetColumn(0, "ESYEAR"));
	
		sArg += " sEsorder=" + quote(ds_ioEduJubsu.GetColumn(0, "ESEDUORDER"));
		
		sArg += " sEsmgno=" + quote(ds_ioEduJubsu.GetColumn(0, "ESMGNO"));
		
		sArg += " sEjhjubsuno=" + quote(ds_ioEduJubsu.GetColumn(0, "EJHJUBSUNO"));
	
		Dialog("cust::frmcust1025PEduCyberInfo.xml", sArg, 600, 400, "", -1, -1);
	
	}
	
}


function Form_OnActivate(obj)
{
	gs_SysID = "[stm_01,bsn_2000,dsc_0001]";	// 개인정보접속기록 시스템ID 
}

]]></Script>
</Window>
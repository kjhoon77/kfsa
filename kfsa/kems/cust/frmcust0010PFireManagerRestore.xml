<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="280" Id="frmcust0010PFireManagerRestore" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="기존&#32;선임자로&#32;복구" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="476" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oOldFMInfo">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRestoreStatus">
				<Contents>
					<colinfo id="O_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="O_RESULT_MSG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="272" Height="199" Id="shpGubunBox4" Left="4" LineColor="user15" Right="470" TabOrder="2" Top="73" Type="Rectangle" Width="466"></Shape>
		<Shape Bottom="268" Height="90" Id="Shape1" Left="250" LineColor="user15" Right="458" TabOrder="18" Top="178" Type="Rectangle" Width="208"></Shape>
		<Shape Bottom="268" Height="90" Id="shpGubunBox3" Left="15" LineColor="user15" Right="223" TabOrder="15" Top="178" Type="Rectangle" Width="208"></Shape>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="281" LineColor="user14" Right="469" TabOrder="4" Top="1" Type="Rectangle" Width="188"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="381" OnClick="lfn_End" Style="sty_Button" TabOrder="1" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" BKColor="darkred" Font="굴림,10,Bold" Height="20" Id="lbRepay" Left="20" Style="sty_LabelGruopBox" TabOrder="3" Text="기존&#32;선임자로&#32;복구" Top="65" VAlign="Middle" Width="156"></Static>
		<Static Border="Flat" BorderColor="user6" Font="굴림,9,Bold" Height="71" Id="lbNotice" Left="9" LineSpacing="5" TabOrder="5" Top="89" VAlign="Middle" Width="455"></Static>
		<Button ButtonStyle="TRUE" Color="user6" Cursor="HAND" Height="24" Id="btnSave" ImageID="BTN_TEXT_06" Left="287" OnClick="lfn_Save" Style="sty_Button" TabOrder="6" Text="선임자&#32;복구" Top="4" Width="92"></Button>
		<Static Align="Center" Height="20" Id="lbPersonNm1" Left="19" Style="sty_Label" TabOrder="11" Text="성명" Top="194" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edPersonNm" ImeMode="native" Left="111" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="9" Top="194" Width="106"></Edit>
		<Static Align="Center" Height="20" Id="lbBirthday1" Left="19" Style="sty_Label" TabOrder="12" Text="생년월일" Top="218" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medBirthday" Left="111" LeftMargin="2" Mask="######" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="10" Top="218" Type="STRING" Width="50"></MaskEdit>
		<Static Align="Center" BKColor="user36" Height="20" Id="lbPersonNm2" Left="255" Style="sty_Label" TabOrder="14" Text="성명" Top="194" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="edOldPersonNm" ImeMode="native" Left="347" LeftMargin="2" OnCharChanged="edPersonNm2_OnCharChanged" OnKeyDown="edPersonNm2_OnKeyDown" OnKillFocus="edPersonNm2_OnKillFocus" Style="sty_Edit" TabOrder="7" Top="194" Width="106"></Edit>
		<Static Align="Center" BKColor="user36" Height="20" Id="lbBirthday2" Left="255" Style="sty_Label" TabOrder="13" Text="생년월일" Top="218" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medOldBirthday" Left="347" LeftMargin="2" Mask="######" OnChanged="medResidentNo2_OnChanged" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="medResidentNo2_OnKillFocus" Style="sty_Maskedit" TabOrder="8" Top="218" Type="STRING" Width="50"></MaskEdit>
		<Static Align="Center" Height="20" Id="lbPersonInfo" Left="25" Style="sty_LabelGruopBox" TabOrder="16" Text="현재&#32;선임자" Top="170" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="darkred" Height="20" Id="Static0" Left="261" Style="sty_LabelGruopBox" TabOrder="17" Text="기존&#32;선임자" Top="170" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Font="굴림,16,Bold" Height="24" Id="Static1" Left="227" TabOrder="19" Text="☞" Top="204" Width="19"></Static>
		<Static Border="Flat" Font="굴림,10,Bold" Height="20" Id="lbChangeDate" Left="116" TabOrder="20" Top="34" VAlign="Middle" Width="156"></Static>
		<Static Align="Center" Font="굴림,10,Bold" Height="20" Id="Static2" Left="6" Style="sty_Label" TabOrder="21" Text="선임자&#32;변경일시" Top="34" VAlign="Middle" Width="106"></Static>
		<Static Align="Center" Height="20" Id="lbPersonKey" Left="19" Style="sty_Label" TabOrder="22" Text="개인식별번호" Top="242" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medPersonKey" Left="111" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="23" Top="242" Type="STRING" Width="86"></MaskEdit>
		<Static Align="Center" BKColor="user36" Height="20" Id="Static3" Left="255" Style="sty_Label" TabOrder="24" Text="개인식별번호" Top="242" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medOldPersonKey" Left="347" LeftMargin="2" Mask="A####-#####" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="25" Top="242" Type="STRING" Width="86"></MaskEdit>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmcust2018PFixVirtualAccount.xml
 * 설명 : 은행 고정가상계좌정보
 * 작성일 : 2013.07.17
 * 작성자 : 정현호
 */

#include "LIB::cust.js"; // 공통 관련

/*
	sCMgno			= 고객관리바코드
	sIFCMGNO		= INETFIREMANAGERCHANGEH 관리번호
	sIFCCHANGEDATE	= INETFIREMANAGERCHANGEH 등록일시
	sFMNM			= 성명
	sBIRTHDAY		= 생년월일
	sPERSONKEY		= 개인식별번호
*/

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    if (IsExistVar("sCMgno")) {
        lfn_Search();
    } else {
        gfn_Alert("고객 정보가 없습니다.");
        close();
    }

	lbNotice = " [인터넷 실무교육 신청]시 이직 등으로 다른 대상처로 선임된 경우\n"+
			   " 신청인이 다른 대상처를 검색하여 자동으로 '선임자 변경'이 가능함에 따라\n"+
			   " 신청인의 실수로 잘못된 선임자 변경이 된 대상처의 경우\n"+				   
			   " 기존 선임자 자료로 복구하는 기능입니다.";
}

/**
 * 조회
 */
function lfn_Search() {

    tit_clearActionInfo();
    tit_addSearchActionInfo("cust:searchCust0010OldFireManagerInfo", false);
    tit_callService(
        ""
        ,""
        ,""
        ,"ds_oOldFMInfo=ds_oOldFMInfo" // outDs
        ,"sCMgno=" + quote(sCMgno)
         + " sPersonkey=" + quote(sPERSONKEY) // args 
        ,""
        ,false
        ,false
        ,true
    );
    lbChangeDate.Text = sIFCCHANGEDATE;	// 변경일시
    edPersonNM.Text = sFMNM;			// 현재선임자 성명
	medBirthday.Text = sBIRTHDAY;	// 현재선임자 생년월일
	medPersonKey.Text = sPERSONKEY;	// 현재선임자 개인식별번호
    edOldPersonNM.Text = ds_oOldFMInfo.GetColumn(0, "FMNM");			// 기존선임자 성명
	medOldBirthday.Text = ds_oOldFMInfo.GetColumn(0, "FMBIRTHDAY");	// 기존선임자 생년월일
	medOldPersonkey.Text = ds_oOldFMInfo.GetColumn(0, "FMPERSONKEY");	// 기존선임자 개인식별번호

}

function Form_OnUnloadCompleted(obj) {
    Close("END");
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    switch (nChar) {
        case 27 : // 종료(Esc)
            lfn_End();
            break;
    }
}


/*
 * 기능 : 종료
 */
function lfn_End(obj) {
    Close("END");
}
/* 공통 필수 종료 */

/* 사용자 함수 */

/* 사용자 이벤트 함수 */


// 선임자 복구
function lfn_Save(obj)
{
	if(!gfn_Confirm("기존 선임자로 복구하시겠습니까?")) {	
		return;
	}

	ds_oRestoreStatus.ClearData();
	
    tit_clearActionInfo();
    tit_addSingleActionInfo("cust:executeCust0010FireManagerRestore", "", 0, "");
    
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oRestoreStatus=ds_oRestoreStatus"	// outDs
        ,"sIFCMGNO=" + quote(sIFCMGNO)	// args
        ,"lfn_AfterRestore"
        ,false
        ,false
        ,true
    );


}

/*
 * 기능 : 선임자 복구 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */

function lfn_AfterRestore(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oRestoreStatus.getColumn(0, "O_STATUS") == "FAIL") {
    
		gfn_Alert("기존 선임자로 복구에 실패했습니다.");
        close("FAIL");		
    
    } else {

		gfn_Alert("기존 선임자로 복구에 성공했습니다.");
        close("SUCC");		
    }

    //gfn_SearchMessage(gdModifyHistory); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}
]]></Script>
</Window>
<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
<isEqual col="GTMGNO" value="1011">  -- 서울지부
<isEqual col="MMBIZGUBUN" value="0">
	-- 서울지부 소방안전관리자(MMBIZGUBUN : 0)
	SELECT BILD_SN, OBJ_NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT BILD_SN, OBJ_NM, CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, WIK_TELNO DYTM_TLPHON,
		   RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
		   || ' '
		   || DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR)
		   || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR) ADDR,   -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_OJ_BULD_GNSIT OB,
	              FIREINFO.TC_CM_CMMN_CODE CC_A,
	              FIREINFO.TC_CM_CMMN_CODE CC_B,
	              FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE , CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO,
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
		                      MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = MC.MMFPIS1
	    AND OB.OBJ_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'OBJ_SE_CODE'
	    AND OB.OBJ_STDR_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'OBJ_STDR_CODE'
	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
	    AND OB.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND OB.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND OB.EMD_SN = RNC.EMD_SN(+)
		<isEqual col='ADDSEARCHCD' value='1'>
			    AND OB.OBJ_NM = #ADDSEARCH#
		</isEqual>
		<isEqual col='ADDSEARCHCD' value='2'>
			    AND REPLACE(RNC.CTRD_NM||RNC.SIGNGU_NM||RNC.EMD_NM|| DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR) || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR), ' ','') LIKE '%'|| REPLACE(#ADDSEARCH#,' ','') || '%'
		</isEqual>
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
<isEqual col="MMBIZGUBUN" value="2">
	-- 서울지부 위험물운송자(MMBIZGUBUN : 2)
	SELECT BILD_SN, APNT_DE_8, QUALFUSER_SN, OBJ_NM, NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, 
                           DYTM_TLPHON, ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM 
	FROM 
	    (
	    SELECT OB.BILD_SN, CS.APNT_YMD APNT_DE_8, CS.QUALFMAN_SN QUALFUSER_SN, OBJ_NM, CPT.NM, 
	    	    CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, WIK_TELNO DYTM_TLPHON,
	    	    RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
	    	    || ' '
	    	    || DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR)
	    	    || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR) ADDR,   -- 주소
	    	    MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_OJ_BULD_GNSIT OB,
	    	FIREINFO.TH_CG_ARSON_MNGR_ASSTN_STTUS CS,
	    	FIREINFO.TH_CG_ARSON_MNGR_A_S_MATCH CM,
	    	FIREINFO.TN_CG_FGTSFMNGMAN CFM,                        -- 소방안전관리자
	   	FIREINFO.TN_CM_PARTCPNT CPT,                           -- 자격자 기본정보
         	    	FIREINFO.TC_CM_CMMN_CODE CC_A,
	    	FIREINFO.TC_CM_CMMN_CODE CC_B,
	    	FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
		                   MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                  MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = CS.BILD_SN
	    AND CS.BILD_SN = CM.CMBILD_SN
	    AND CS.APNT_YMD = CM.CMAPNT_YMD
	    AND CS.QUALFMAN_SN = CM.CMQUALFMAN_SN
          	    AND CFM.FGT_SAFE_MNGR_ID = CPT.PARTCPNT_ID(+)
	    AND CM.CMBILD_SN = MC.MMFPIS1
	    AND CM.CMAPNT_YMD = MC.MMFPIS3
	    AND CM.CMQUALFMAN_SN = MC.MMFPIS4
	    AND CM.CMQUALFMAN_SN = CFM.QUALFMAN_SN
	    AND OB.OBJ_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'OBJ_SE_CODE'
	    AND OB.OBJ_STDR_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'OBJ_STDR_CODE'
          	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
          	    AND CPT.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND CPT.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND CPT.EMD_SN = RNC.EMD_SN(+)
		<isEqual col='ADDSEARCHCD' value='1'>
			    AND OB.OBJ_NM = #ADDSEARCH#
		</isEqual>
		<isEqual col='ADDSEARCHCD' value='2'>
			    AND REPLACE(RNC.CTRD_NM||RNC.SIGNGU_NM||RNC.EMD_NM|| DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR) || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR), ' ','') LIKE '%'|| REPLACE(#ADDSEARCH#,' ','') || '%'
		</isEqual>     
			    ORDER BY MMREGDATE DESC)
			WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>

<isEqual col="MMBIZGUBUN" value="1">
	-- 서울지부 위험물안전관리자(MMBIZGUBUN : 1)
	SELECT MNFCTRETC_SN, OBJ_NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, TELNO DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT DM.MNFCTRLMP_SN MNFCTRETC_SN, OBJ_NM, CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, CRE.TELNO,
			RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
			|| ' '
			|| DECODE (DM.ITLPC_LNM_MN_LNBR, NULL, NULL, DM.ITLPC_LNM_MN_LNBR)
			|| DECODE (DM.ITLPC_LNM_SUB_LNBR, NULL, NULL, '-' || DM.ITLPC_LNM_SUB_LNBR) ADDR, -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_DAN_MNFCTRLMP DM,
		 FIREINFO.TN_CM_RELATE_ENTRPS CRE,             -- 관련업체
		 FIREINFO.TC_CM_CMMN_CODE CC_A,
		 FIREINFO.TC_CM_CMMN_CODE CC_B,
		 FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
		                   MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                   MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE DM.MNFCTRLMP_SN = MC.MMFPIS1
	    AND DM.INSTL_ENTRPS_ID = CRE.ENTRPS_ID(+)
	    AND DM.MNFCTRLMP_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'MNFCTRLMP_SE_CODE'
	    AND DM.MNFCTRLMP_DETAIL_SE_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'MNFCTRLMP_DETAIL_SE_CODE'
	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
	    AND DM.ITLPC_SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND DM.ITLPC_ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND DM.ITLPC_EMD_SN = RNC.EMD_SN(+)
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>

<isEqual col="MMBIZGUBUN" value="3">
	-- 서울지부 소방기술자(MMBIZGUBUN : 3)
    SELECT BSNM_REGIST_NO, ENTRPS_SE, ENTRPS_DETAIL_SE, ENTRPS_SN, HOLD_QUALFUSER_SN, QUALFUSER_SN,
           ENTRPS_NM OBJ_NM, ENTRPS_SENM||'/'||ENTRPS_DETAIL_SENM OBJ_COURSE, DYTM_TLPHON,
           ADDR, NM,
           MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
           CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE , CAGGUBUN, AGNM
    FROM 
        (
        SELECT CRE.ENTRPS_NM, CRE.BSNM_REGIST_NO, CF.ENTRPS_SE_CODE ENTRPS_SE, CF.ENTRPS_DETAIL_SE, 
                     CF.ENTRPS_SN, CH.HOLD_QUALFMAN_SN HOLD_QUALFUSER_SN, CH.QUALFMAN_SN QUALFUSER_SN,
               CC_A.CODE_NM ENTRPS_SENM, CC_B.CODE_NM ENTRPS_DETAIL_SENM, CC_C.CODE_NM HNF_SE_CODENM,
               CRE.TELNO DYTM_TLPHON,
            RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
               || ' '
               || DECODE (CRE.LNM_MN_LNBR, NULL, NULL, CRE.LNM_MN_LNBR)
               || DECODE (CRE.LNM_SUB_LNBR, NULL, NULL, '-' || CRE.LNM_SUB_LNBR) ADDR,   -- 주소
           CPT.NM,
           MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE, CAGGUBUN, AGNM
        FROM FIREINFO.TN_CG_FGT_FCLTY_RL_ENTRPS CF,
             FIREINFO.TN_CM_RELATE_ENTRPS CRE,
             FIREINFO.TH_CG_ENTRPS_HOLD_MAN_STTUS CH,
             FIREINFO.TN_CG_FGTSFMNGMAN CM,
             FIREINFO.TN_CM_PARTCPNT CPT,        
             FIREINFO.TC_CM_CMMN_CODE CC_A,
             FIREINFO.TC_CM_CMMN_CODE CC_B,
             FIREINFO.TC_CM_CMMN_CODE CC_C,
             FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
        (SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
	 DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
               MCMCNT,
               DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
               C.CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE, CAGGUBUN, AGNM
        FROM CUSTOMER C, COURSE CS, AGENCY AE,
             (SELECT MMCMGNO, 
                           CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                    WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                 MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE,  
                 MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
	      FROM MATCHCHANGEM, MATCHCHANGEH 
	      WHERE MMMGNO = MHMMMGNO
	          AND MMBIZGUBUN = #MMBIZGUBUN#
		<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
		<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
		<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
		<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
              GROUP BY MMCMGNO, 
                               CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
	                          WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                               MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMAPPLYGUBUN ) MCM
        WHERE C.CMGNO = MCM.MMCMGNO
        AND C.CCOURSECD = CS.COURSECD
        AND C.CAGMGNO = AE.AGMGNO(+)
        AND CS.CGROUPCD = #CGROUPCD#
        AND C.CGTMGNO = #GTMGNO#
        AND C.CREGCD &gt;= #REGCD1# 
        AND C.CREGCD &lt;= #REGCD2# ) MC
        WHERE CF.ENTRPS_SN = CH.ENTRPS_SN(+)
          AND CF.RELATE_ENTRPS_ID = CRE.ENTRPS_ID(+)
          AND CH.QUALFMAN_SN = CM.QUALFMAN_SN(+)
          AND CM.FGT_SAFE_MNGR_ID = CPT.PARTCPNT_ID(+)
          AND CH.ENTRPS_SN = MC.MMFPIS3 
          AND CH.HOLD_QUALFMAN_SN = MC.MMFPIS4
          AND CH.QUALFMAN_SN = MC.MMFPIS5
          AND CF.ENTRPS_SE_CODE = CC_A.CODE(+)
          AND CC_A.REFRN_COLUMN_NM(+) = 'ENTRPS_SE_CODE'
          AND CF.ENTRPS_DETAIL_SE = CC_B.CODE(+)
          AND CC_B.REFRN_COLUMN_NM(+) = 'ENTRPS_DETAIL_SE'
          AND CH.HNF_SE_CODE = CC_C.CODE(+)
          AND CC_C.REFRN_COLUMN_NM(+) = 'HNF_SE_CODE'
          AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y' AND CC_C.USE_AT(+) = 'Y'
          AND CRE.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
          AND CRE.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
          AND CRE.EMD_SN = RNC.EMD_SN(+)     
        ORDER BY MMREGDATE DESC)
    WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
<isEqual col="MMBIZGUBUN" value="4">
	-- 서울지부 소방안전관리보조자(MMBIZGUBUN : 4)
	SELECT BILD_SN, APNT_DE_8, QUALFUSER_SN, OBJ_NM, NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, 
                           DYTM_TLPHON, ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM 
	FROM 
	    (
	    SELECT OB.BILD_SN, CS.APNT_YMD APNT_DE_8, CS.QUALFMAN_SN QUALFUSER_SN, OBJ_NM, CPT.NM, 
	    	    CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, WIK_TELNO DYTM_TLPHON,
	    	    RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
	    	    || ' '
	    	    || DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR)
	    	    || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR) ADDR,   -- 주소
	    	    MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_OJ_BULD_GNSIT OB,
	    	FIREINFO.TH_CG_ARSON_MNGR_ASSTN_STTUS CS,
	    	FIREINFO.TH_CG_ARSON_MNGR_A_S_MATCH CM,
	    	FIREINFO.TN_CG_FGTSFMNGMAN CFM,                        -- 소방안전관리자
	   	FIREINFO.TN_CM_PARTCPNT CPT,                           -- 자격자 기본정보
	   	FIREINFO.TC_CM_CMMN_CODE CC_A,
	    	FIREINFO.TC_CM_CMMN_CODE CC_B,
	    	FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO,
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMFPIS1, MMFPIS3, MMFPIS4, MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, 
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                   MMFPIS1, MMFPIS3, MMFPIS4, MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = CS.BILD_SN
	    AND CS.BILD_SN = CM.CMBILD_SN
	    AND CS.APNT_YMD = CM.CMAPNT_YMD
	    AND CS.QUALFMAN_SN = CM.CMQUALFMAN_SN
	    AND CFM.FGT_SAFE_MNGR_ID = CPT.PARTCPNT_ID(+)
	    AND CM.CMBILD_SN = MC.MMFPIS1
	    AND CM.CMAPNT_YMD = MC.MMFPIS3
	    AND CM.CMQUALFMAN_SN = MC.MMFPIS4
	    AND CM.CMQUALFMAN_SN = CFM.QUALFMAN_SN
	    AND OB.OBJ_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'OBJ_SE_CODE'
	    AND OB.OBJ_STDR_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'OBJ_STDR_CODE'
	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
	    AND OB.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND OB.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND OB.EMD_SN = RNC.EMD_SN(+)       
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
</isEqual>  -- 서울지부 끝



<isNotEqual col="GTMGNO" value="1011">  -- 서울지부 외

<isEqual col="GTMGNO" value="1151">  -- 서울동부지부
<isEqual col="MMBIZGUBUN" value="0">
	-- 서울동부지부 소방안전관리자(MMBIZGUBUN : 0)
	SELECT BILD_SN, OBJ_NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT BILD_SN, OBJ_NM, CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, WIK_TELNO DYTM_TLPHON,
		   RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
		   || ' '
		   || DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR)
		   || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR) ADDR,   -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_OJ_BULD_GNSIT OB,
	              FIREINFO.TC_CM_CMMN_CODE CC_A,
	              FIREINFO.TC_CM_CMMN_CODE CC_B,
	              FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO,
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
		                      MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = MC.MMFPIS1
	    AND OB.OBJ_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'OBJ_SE_CODE'
	    AND OB.OBJ_STDR_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'OBJ_STDR_CODE'
	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
	    AND OB.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND OB.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND OB.EMD_SN = RNC.EMD_SN(+)
		<isEqual col='ADDSEARCHCD' value='1'>
			    AND OB.OBJ_NM = #ADDSEARCH#
		</isEqual>
		<isEqual col='ADDSEARCHCD' value='2'>
			    AND REPLACE(RNC.CTRD_NM||RNC.SIGNGU_NM||RNC.EMD_NM|| DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR) || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR), ' ','') LIKE '%'|| REPLACE(#ADDSEARCH#,' ','') || '%'
		</isEqual>
			    ORDER BY MMREGDATE DESC)
			WHERE ROWNUM &lt;=  #SEARCHNUM#
		</isEqual>
<isEqual col="MMBIZGUBUN" value="2">
	-- 서울동부지부 위험물운송자(MMBIZGUBUN : 2)
	SELECT BILD_SN, APNT_DE_8, QUALFUSER_SN, OBJ_NM, NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, 
                           DYTM_TLPHON, ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE , CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT OB.BILD_SN, CS.APNT_YMD APNT_DE_8, CS.QUALFMAN_SN QUALFUSER_SN, OBJ_NM, CPT.NM, 
	    	    CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, WIK_TELNO DYTM_TLPHON,
	    	    RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
	    	    || ' '
	    	    || DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR)
	    	    || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR) ADDR,   -- 주소
	    	    MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_OJ_BULD_GNSIT OB,
	    	FIREINFO.TH_CG_ARSON_MNGR_ASSTN_STTUS CS,
	    	FIREINFO.TH_CG_ARSON_MNGR_A_S_MATCH CM,
	    	FIREINFO.TN_CG_FGTSFMNGMAN CFM,                        -- 소방안전관리자
	   	FIREINFO.TN_CM_PARTCPNT CPT,                           -- 자격자 기본정보
         	    	FIREINFO.TC_CM_CMMN_CODE CC_A,
	    	FIREINFO.TC_CM_CMMN_CODE CC_B,
	    	FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
		                   MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                  MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = CS.BILD_SN
	    AND CS.BILD_SN = CM.CMBILD_SN
	    AND CS.APNT_YMD = CM.CMAPNT_YMD
	    AND CS.QUALFMAN_SN = CM.CMQUALFMAN_SN
          	    AND CFM.FGT_SAFE_MNGR_ID = CPT.PARTCPNT_ID(+)
	    AND CM.CMBILD_SN = MC.MMFPIS1
	    AND CM.CMAPNT_YMD = MC.MMFPIS3
	    AND CM.CMQUALFMAN_SN = MC.MMFPIS4
	    AND CM.CMQUALFMAN_SN = CFM.QUALFMAN_SN
	    AND OB.OBJ_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'OBJ_SE_CODE'
	    AND OB.OBJ_STDR_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'OBJ_STDR_CODE'
          	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
          	    AND CPT.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND CPT.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND CPT.EMD_SN = RNC.EMD_SN(+)
		<isEqual col='ADDSEARCHCD' value='1'>
			    AND OB.OBJ_NM = #ADDSEARCH#
		</isEqual>
		<isEqual col='ADDSEARCHCD' value='2'>
			    AND REPLACE(RNC.CTRD_NM||RNC.SIGNGU_NM||RNC.EMD_NM|| DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR) || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR), ' ','') LIKE '%'|| REPLACE(#ADDSEARCH#,' ','') || '%'
		</isEqual>     
			    ORDER BY MMREGDATE DESC)
			WHERE ROWNUM &lt;=  #SEARCHNUM#
		</isEqual>

<isEqual col="MMBIZGUBUN" value="1">
	-- 서울동부지부 위험물안전관리자(MMBIZGUBUN : 1)
	SELECT MNFCTRETC_SN, OBJ_NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, TELNO DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE , CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT DM.MNFCTRLMP_SN MNFCTRETC_SN, OBJ_NM, CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, CRE.TELNO,
			RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
			|| ' '
			|| DECODE (DM.ITLPC_LNM_MN_LNBR, NULL, NULL, DM.ITLPC_LNM_MN_LNBR)
			|| DECODE (DM.ITLPC_LNM_SUB_LNBR, NULL, NULL, '-' || DM.ITLPC_LNM_SUB_LNBR) ADDR, -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_DAN_MNFCTRLMP DM,
		 FIREINFO.TN_CM_RELATE_ENTRPS CRE,             -- 관련업체
		 FIREINFO.TC_CM_CMMN_CODE CC_A,
		 FIREINFO.TC_CM_CMMN_CODE CC_B,
		 FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
		                   MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                   MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE DM.MNFCTRLMP_SN = MC.MMFPIS1
	    AND DM.INSTL_ENTRPS_ID = CRE.ENTRPS_ID(+)
	    AND DM.MNFCTRLMP_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'MNFCTRLMP_SE_CODE'
	    AND DM.MNFCTRLMP_DETAIL_SE_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'MNFCTRLMP_DETAIL_SE_CODE'
	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
	    AND DM.ITLPC_SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND DM.ITLPC_ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND DM.ITLPC_EMD_SN = RNC.EMD_SN(+)
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>

<isEqual col="MMBIZGUBUN" value="3">
	-- 서울동부지부 소방기술자(MMBIZGUBUN : 3)
    SELECT BSNM_REGIST_NO, ENTRPS_SE, ENTRPS_DETAIL_SE, ENTRPS_SN, HOLD_QUALFUSER_SN, QUALFUSER_SN,
           ENTRPS_NM OBJ_NM, ENTRPS_SENM||'/'||ENTRPS_DETAIL_SENM OBJ_COURSE, DYTM_TLPHON,
           ADDR, NM,
           MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
           CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE , CAGGUBUN, AGNM
    FROM 
        (
        SELECT CRE.ENTRPS_NM, CRE.BSNM_REGIST_NO, CF.ENTRPS_SE_CODE ENTRPS_SE, CF.ENTRPS_DETAIL_SE, 
                     CF.ENTRPS_SN, CH.HOLD_QUALFMAN_SN HOLD_QUALFUSER_SN, CH.QUALFMAN_SN QUALFUSER_SN,
               CC_A.CODE_NM ENTRPS_SENM, CC_B.CODE_NM ENTRPS_DETAIL_SENM, CC_C.CODE_NM HNF_SE_CODENM,
               CRE.TELNO DYTM_TLPHON,
            RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
               || ' '
               || DECODE (CRE.LNM_MN_LNBR, NULL, NULL, CRE.LNM_MN_LNBR)
               || DECODE (CRE.LNM_SUB_LNBR, NULL, NULL, '-' || CRE.LNM_SUB_LNBR) ADDR,   -- 주소
           CPT.NM,
           MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE, CAGGUBUN, AGNM
        FROM FIREINFO.TN_CG_FGT_FCLTY_RL_ENTRPS CF,
             FIREINFO.TN_CM_RELATE_ENTRPS CRE,
             FIREINFO.TH_CG_ENTRPS_HOLD_MAN_STTUS CH,
             FIREINFO.TN_CG_FGTSFMNGMAN CM,
             FIREINFO.TN_CM_PARTCPNT CPT,        
             FIREINFO.TC_CM_CMMN_CODE CC_A,
             FIREINFO.TC_CM_CMMN_CODE CC_B,
             FIREINFO.TC_CM_CMMN_CODE CC_C,
             FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
        (SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
	 DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
               MCMCNT,
               DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
               C.CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE, CAGGUBUN, AGNM
        FROM CUSTOMER C, COURSE CS, AGENCY AE,
             (SELECT MMCMGNO, 
                           CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                    WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                 MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE,  
                 MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
	      FROM MATCHCHANGEM, MATCHCHANGEH 
	      WHERE MMMGNO = MHMMMGNO
	          AND MMBIZGUBUN = #MMBIZGUBUN#
		<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
		<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
		<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
		<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
              GROUP BY MMCMGNO, 
                               CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
	                          WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                               MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMAPPLYGUBUN ) MCM
        WHERE C.CMGNO = MCM.MMCMGNO
        AND C.CCOURSECD = CS.COURSECD
        AND C.CAGMGNO = AE.AGMGNO(+)
        AND CS.CGROUPCD = #CGROUPCD#
        AND C.CGTMGNO = #GTMGNO#
        AND C.CREGCD &gt;= #REGCD1# 
        AND C.CREGCD &lt;= #REGCD2# ) MC
        WHERE CF.ENTRPS_SN = CH.ENTRPS_SN(+)
          AND CF.RELATE_ENTRPS_ID = CRE.ENTRPS_ID(+)
          AND CH.QUALFMAN_SN = CM.QUALFMAN_SN(+)
          AND CM.FGT_SAFE_MNGR_ID = CPT.PARTCPNT_ID(+)
          AND CH.ENTRPS_SN = MC.MMFPIS3 
          AND CH.HOLD_QUALFMAN_SN = MC.MMFPIS4
          AND CH.QUALFMAN_SN = MC.MMFPIS5
          AND CF.ENTRPS_SE_CODE = CC_A.CODE(+)
          AND CC_A.REFRN_COLUMN_NM(+) = 'ENTRPS_SE_CODE'
          AND CF.ENTRPS_DETAIL_SE = CC_B.CODE(+)
          AND CC_B.REFRN_COLUMN_NM(+) = 'ENTRPS_DETAIL_SE'
          AND CH.HNF_SE_CODE = CC_C.CODE(+)
          AND CC_C.REFRN_COLUMN_NM(+) = 'HNF_SE_CODE'
          AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y' AND CC_C.USE_AT(+) = 'Y'
          AND CRE.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
          AND CRE.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
          AND CRE.EMD_SN = RNC.EMD_SN(+)     
        ORDER BY MMREGDATE DESC)
    WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
<isEqual col="MMBIZGUBUN" value="4">
	-- 서울동부지부 소방안전관리보조자(MMBIZGUBUN : 4)
	SELECT BILD_SN, APNT_DE_8, QUALFUSER_SN, OBJ_NM, NM, CODE_NM_A||'/'||CODE_NM_B OBJ_COURSE, 
                           DYTM_TLPHON, ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM 
	FROM 
	    (
	    SELECT OB.BILD_SN, CS.APNT_YMD APNT_DE_8, CS.QUALFMAN_SN QUALFUSER_SN, OBJ_NM, CPT.NM, 
	    	    CC_A.CODE_NM CODE_NM_A, CC_B.CODE_NM CODE_NM_B, WIK_TELNO DYTM_TLPHON,
	    	    RNC.CTRD_NM||' '||RNC.SIGNGU_NM||' '||RNC.EMD_NM
	    	    || ' '
	    	    || DECODE (OB.LNM_MN_LNBR, NULL, NULL, OB.LNM_MN_LNBR)
	    	    || DECODE (OB.LNM_SUB_LNBR, NULL, NULL, '-' || OB.LNM_SUB_LNBR) ADDR,   -- 주소
	    	    MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.TN_OJ_BULD_GNSIT OB,
	    	FIREINFO.TH_CG_ARSON_MNGR_ASSTN_STTUS CS,
	    	FIREINFO.TH_CG_ARSON_MNGR_A_S_MATCH CM,
	    	FIREINFO.TN_CG_FGTSFMNGMAN CFM,                        -- 소방안전관리자
	   	FIREINFO.TN_CM_PARTCPNT CPT,                           -- 자격자 기본정보
	   	FIREINFO.TC_CM_CMMN_CODE CC_A,
	    	FIREINFO.TC_CM_CMMN_CODE CC_B,
	    	FIREINFO.TC_CM_ROAD_NM_CODE RNC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS,AGENCY AE,
		     (SELECT MMCMGNO,
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMFPIS1, MMFPIS3, MMFPIS4, MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, 
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                   MMFPIS1, MMFPIS3, MMFPIS4, MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = CS.BILD_SN
	    AND CS.BILD_SN = CM.CMBILD_SN
	    AND CS.APNT_YMD = CM.CMAPNT_YMD
	    AND CS.QUALFMAN_SN = CM.CMQUALFMAN_SN
	    AND CFM.FGT_SAFE_MNGR_ID = CPT.PARTCPNT_ID(+)
	    AND CM.CMBILD_SN = MC.MMFPIS1
	    AND CM.CMAPNT_YMD = MC.MMFPIS3
	    AND CM.CMQUALFMAN_SN = MC.MMFPIS4
	    AND CM.CMQUALFMAN_SN = CFM.QUALFMAN_SN
	    AND OB.OBJ_SE_CODE = CC_A.CODE(+)
	    AND CC_A.REFRN_COLUMN_NM(+) = 'OBJ_SE_CODE'
	    AND OB.OBJ_STDR_CODE = CC_B.CODE(+)
	    AND CC_B.REFRN_COLUMN_NM(+) = 'OBJ_STDR_CODE'
	    AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y'
	    AND OB.SIGNGU_CODE = RNC.SIGNGU_CODE(+)
	    AND OB.ROAD_NM_NO = RNC.ROAD_NM_NO(+)
	    AND OB.EMD_SN = RNC.EMD_SN(+)       
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
</isEqual>



<isNotEqual col="GTMGNO" value="1151">  -- 서울동부지부 외

<isEqual col="MMBIZGUBUN" value="0">
	-- 서울 외 소방안전관리자(MMBIZGUBUN : 0)
	SELECT BILD_SN, OBJ_NM, CODE_GROUP_NM||'/'||CODE_NM OBJ_COURSE, DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT BILD_SN, OBJ_NM, CCG.CODE_GROUP_NM, CC.CODE_NM, DYTM_TLPHON,
			ALC.LEGALDONG_ADRES_NM
		       || ' '
		       || DECODE (OB.MNTN_LNBR_AT, 'Y', '산', NULL)
		       || DECODE (OB.MAIN_LNBR,NULL,NULL,OB.MAIN_LNBR)
		       || DECODE (OB.SEC_LNBR,NULL,NULL,'-' || OB.SEC_LNBR) ADDR, -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.OJ_BULDSTA OB,
		 FIREINFO.CM_CMMN_CODE_GROUP CCG,
		 FIREINFO.CM_CMMN_CODE CC,
		 FIREINFO.CM_ADRES_LEGALDONG_CODE ALC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                  MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = MC.MMFPIS1
	      AND OB.OBJ_SE_CODE = CCG.CODE_GROUP(+)
	      AND OB.OBJ_STDR_CODE = CC.CODE(+)
	      AND CCG.USE_AT(+) = 'Y' AND CC.USE_AT(+) = 'Y'
	      AND OB.CTRD_CODE = ALC.LEGALDONG_CTRD_CODE(+)
	      AND OB.SIGNGU_CODE = ALC.LEGALDONG_SIGNGU_CODE(+)
	      AND OB.DONG_CODE = ALC.LEGALDONG_DONG_CODE(+)
	      AND OB.LI_CODE = ALC.LEGALDONG_LI_CODE(+)     
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
<isEqual col="MMBIZGUBUN" value="2">
	-- 서울 외 위험물운송자(MMBIZGUBUN : 0)
	SELECT BILD_SN, OBJ_NM, CODE_GROUP_NM||'/'||CODE_NM OBJ_COURSE, DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT BILD_SN, OBJ_NM, CCG.CODE_GROUP_NM, CC.CODE_NM, DYTM_TLPHON,
			ALC.LEGALDONG_ADRES_NM
		       || ' '
		       || DECODE (OB.MNTN_LNBR_AT, 'Y', '산', NULL)
		       || DECODE (OB.MAIN_LNBR,NULL,NULL,OB.MAIN_LNBR)
		       || DECODE (OB.SEC_LNBR,NULL,NULL,'-' || OB.SEC_LNBR) ADDR, -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.OJ_BULDSTA OB,
		 FIREINFO.CM_CMMN_CODE_GROUP CCG,
		 FIREINFO.CM_CMMN_CODE CC,
		 FIREINFO.CM_ADRES_LEGALDONG_CODE ALC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                  MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE OB.BILD_SN = MC.MMFPIS1
	      AND OB.OBJ_SE_CODE = CCG.CODE_GROUP(+)
	      AND OB.OBJ_STDR_CODE = CC.CODE(+)
	      AND CCG.USE_AT(+) = 'Y' AND CC.USE_AT(+) = 'Y'
	      AND OB.CTRD_CODE = ALC.LEGALDONG_CTRD_CODE(+)
	      AND OB.SIGNGU_CODE = ALC.LEGALDONG_SIGNGU_CODE(+)
	      AND OB.DONG_CODE = ALC.LEGALDONG_DONG_CODE(+)
	      AND OB.LI_CODE = ALC.LEGALDONG_LI_CODE(+)      
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>

<isEqual col="MMBIZGUBUN" value="1">
	-- 서울 외 위험물안전관리자(MMBIZGUBUN : 1)
	SELECT MNFCTRETC_SN, OBJ_NM, CODE_GROUP_NM||'/'||CODE_NM OBJ_COURSE, INSTLR_TELNO DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM 
	FROM 
	    (
	    SELECT MNFCTRETC_SN, OBJ_NM, CCG.CODE_GROUP_NM, CC.CODE_NM, INSTLR_TELNO,
			ALC.LEGALDONG_ADRES_NM
		       || ' '
		       || DECODE (DM.ITLPC_MNTN_LNBR_AT, 'Y', '산', NULL)
		       || DECODE (DM.ITLPC_MAIN_LNBR,NULL,NULL,DM.ITLPC_MAIN_LNBR)
		       || DECODE (DM.ITLPC_SEC_LNBR,NULL,NULL,'-' || DM.ITLPC_SEC_LNBR) ADDR, -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.DAN_MNFCTRETC DM,
		 FIREINFO.CM_CMMN_CODE_GROUP CCG,
		 FIREINFO.CM_CMMN_CODE CC,
		 FIREINFO.CM_ADRES_LEGALDONG_CODE ALC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, MAX(MMFPIS1) MMFPIS1,
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                   MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	    WHERE DM.MNFCTRETC_SN = MC.MMFPIS1
	      AND DM.MNFCTRETC_SE_CODE = CCG.CODE_GROUP(+)
	      AND DM.MNFCTRETC_DETAIL_SE_CODE = CC.CODE(+)
	      AND CCG.USE_AT(+) = 'Y' AND CC.USE_AT(+) = 'Y'
	      AND DM.ITLPC_CTRD_CODE = ALC.LEGALDONG_CTRD_CODE(+)
	      AND DM.ITLPC_SIGNGU_CODE = ALC.LEGALDONG_SIGNGU_CODE(+)
	      AND DM.ITLPC_DONG_CODE = ALC.LEGALDONG_DONG_CODE(+)
	      AND DM.ITLPC_LI_CODE = ALC.LEGALDONG_LI_CODE(+)     
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>

<isEqual col="MMBIZGUBUN" value="3">
	-- 서울 외 소방기술자(MMBIZGUBUN : 3)
    SELECT BSNM_REGIST_NO, ENTRPS_SE, ENTRPS_DETAIL_SE, HOLD_QUALFUSER_SN, QUALFUSER_SN,
           ENTRPS_NM OBJ_NM, ENTRPS_SENM||'/'||ENTRPS_DETAIL_SENM OBJ_COURSE, DYTM_TLPHON,
           ADDR, NM,
           MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
           CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE , CAGGUBUN, AGNM
    FROM 
        (
        SELECT ENTRPS_NM, CF.BSNM_REGIST_NO, CF.ENTRPS_SE, CF.ENTRPS_DETAIL_SE, CH.HOLD_QUALFUSER_SN, CH.QUALFUSER_SN,
               CC_A.CODE_NM ENTRPS_SENM, CC_B.CODE_NM ENTRPS_DETAIL_SENM, CC_C.CODE_NM HNF_SE_CODENM,
               CF.TLPHON_NO DYTM_TLPHON,
            ALC.LEGALDONG_ADRES_NM
               || ' '
               || DECODE (CF.MNTN_LNBR_AT, 'Y', '산', NULL)
               || DECODE (CF.MAIN_LNBR,NULL,NULL,CF.MAIN_LNBR)
               || DECODE (CF.SEC_LNBR,NULL,NULL,'-' || CF.SEC_LNBR) ADDR, -- 주소
           CQ.NM,
           MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE, CAGGUBUN, AGNM
        FROM FIREINFO.CG_FGT_FCLTY_RELATE_ENTRP CF,
             FIREINFO.CG_HOLD_QUALFUSER_STTUS CH,
             FIREINFO.CG_QUALFUSER_BASSINFO CQ,        
             FIREINFO.CM_CMMN_CODE CC_A,
             FIREINFO.CM_CMMN_CODE CC_B,
             FIREINFO.CM_CMMN_CODE CC_C,
             FIREINFO.CM_ADRES_LEGALDONG_CODE ALC,  -- 주소 조인
        (SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
               DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
               MCMCNT,
               DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
               C.CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMREGDATE, CAGGUBUN, AGNM
        FROM CUSTOMER C, COURSE CS, AGENCY AE,
             (SELECT MMCMGNO, 
                           CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                    WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                           MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE,  
                           MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
	      FROM MATCHCHANGEM, MATCHCHANGEH 
	      WHERE MMMGNO = MHMMMGNO
	          AND MMBIZGUBUN = #MMBIZGUBUN#
		<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
		<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
		<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
		<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
              GROUP BY MMCMGNO, 
                               CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
	                          WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                              MMFPIS1, MMFPIS3, MMFPIS4, MMFPIS5, MMFPIS6, MMAPPLYGUBUN ) MCM
        WHERE C.CMGNO = MCM.MMCMGNO
        AND C.CCOURSECD = CS.COURSECD
        AND C.CAGMGNO = AE.AGMGNO(+)
        AND CS.CGROUPCD = #CGROUPCD#
        AND C.CGTMGNO = #GTMGNO#
        AND C.CREGCD &gt;= #REGCD1# 
        AND C.CREGCD &lt;= #REGCD2# ) MC
        WHERE CF.ENTRPS_SN = CH.ENTRPS_SN
          AND CH.QUALFUSER_SN = CQ.QUALFUSER_SN
          AND CH.ENTRPS_SN = MC.MMFPIS3 
          AND CH.HOLD_QUALFUSER_SN = MC.MMFPIS4
          AND CH.QUALFUSER_SN = MC.MMFPIS5
          AND CF.ENTRPS_SE = CC_A.CODE(+)
          AND CF.ENTRPS_DETAIL_SE = CC_B.CODE(+)
          AND CH.HNF_SE_CODE = CC_C.CODE(+)
          AND CC_A.USE_AT(+) = 'Y' AND CC_B.USE_AT(+) = 'Y' AND CC_C.USE_AT(+) = 'Y'
          AND CF.CTRD_CODE = ALC.LEGALDONG_CTRD_CODE(+)
          AND CF.SIGNGU_CODE = ALC.LEGALDONG_SIGNGU_CODE(+)
          AND CF.DONG_CODE = ALC.LEGALDONG_DONG_CODE(+)
          AND CF.LI_CODE = ALC.LEGALDONG_LI_CODE(+)      
        ORDER BY MMREGDATE DESC)
    WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
<isEqual col="MMBIZGUBUN" value="4">
	-- 서울 외 소방안전관리보조자(MMBIZGUBUN : 4)
	SELECT BILD_SN, APNT_DE_8, QUALFUSER_SN, OBJ_NM, NM, CODE_GROUP_NM||'/'||CODE_NM OBJ_COURSE, DYTM_TLPHON,
	       ADDR, MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMREGDATE , CAGGUBUN, AGNM
	FROM 
	    (
	    SELECT OB.BILD_SN, CS.APNT_DE_8, CS.QUALFUSER_SN, OBJ_NM, NM, CCG.CODE_GROUP_NM, CC.CODE_NM, DYTM_TLPHON,
			ALC.LEGALDONG_ADRES_NM
		       || ' '
		       || DECODE (OB.MNTN_LNBR_AT, 'Y', '산', NULL)
		       || DECODE (OB.MAIN_LNBR,NULL,NULL,OB.MAIN_LNBR)
		       || DECODE (OB.SEC_LNBR,NULL,NULL,'-' || OB.SEC_LNBR) ADDR, -- 주소
		   MMDBPROCDATE, MHPROCGUBUN, MCMCNT, MMAPPLYGUBUNNM, MMAPPLYGUBUN, CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
	    FROM FIREINFO.OJ_BULDSTA OB,
		 FIREINFO.CG_ARSON_MNGR_ASSTN_STTUS CS,
		 FIREINFO.CG_ARSON_MNGR_ASSTN_MATCH CM,
		 FIREINFO.CG_QUALFUSER_BASSINFO CB,
		 FIREINFO.CM_CMMN_CODE_GROUP CCG,
		 FIREINFO.CM_CMMN_CODE CC,
		 FIREINFO.CM_ADRES_LEGALDONG_CODE ALC,  -- 주소 조인
		(SELECT SUBSTR(MMDBPROCDATE,1,4)||'-'||SUBSTR(MMDBPROCDATE,5,2)||'-'||SUBSTR(MMDBPROCDATE,7,2) MMDBPROCDATE,
		       DECODE(MHPROCGUBUN,'01','대상물','02','선임자','') MHPROCGUBUN,
		       MCMCNT,
		       DECODE(MMAPPLYGUBUN, '0', 'X','○')||' ('||MCMCNT||'건)' MMAPPLYGUBUNNM, MMAPPLYGUBUN, 
		       C.CMGNO, MMFPIS1, MMFPIS3, MMFPIS4, MMREGDATE, CAGGUBUN, AGNM
		FROM CUSTOMER C, COURSE CS, AGENCY AE,
		     (SELECT MMCMGNO, 
		                   CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
                                                        WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END MHPROCGUBUN,
                                               MMFPIS1, MMFPIS3, MMFPIS4, MMAPPLYGUBUN, MAX(MMDBPROCDATE) MMDBPROCDATE, 
			     MAX(MMREGDATE) MMREGDATE, COUNT(*) MCMCNT 
		      FROM MATCHCHANGEM, MATCHCHANGEH 
		      WHERE MMMGNO = MHMMMGNO
		          AND MMBIZGUBUN = #MMBIZGUBUN#
			<isNotNull col="DBPROCDATE1">      AND MMDBPROCDATE &gt;= #DBPROCDATE1# </isNotNull>
			<isNotNull col="DBPROCDATE2">      AND MMDBPROCDATE &lt;= #DBPROCDATE2# </isNotNull>
			<isEqual col="APPLYGUBUN" value="0">      AND MMAPPLYGUBUN = '0' </isEqual>
			<isEqual col="APPLYGUBUN" value="1">      AND MMAPPLYGUBUN = '1' </isEqual>
		      GROUP BY MMCMGNO, 
		                      CASE WHEN MHPROCGUBUN &gt;='00' AND MHPROCGUBUN &lt;='08' THEN '01'
		                                WHEN MHPROCGUBUN &gt;='09' AND MHPROCGUBUN &lt;='13' THEN '02' ELSE '' END,
                                                  MMFPIS1, MMFPIS3, MMFPIS4, MMAPPLYGUBUN ) MCM
		WHERE C.CMGNO = MCM.MMCMGNO
		AND C.CCOURSECD = CS.COURSECD
		AND C.CAGMGNO = AE.AGMGNO(+)
		AND CS.CGROUPCD = #CGROUPCD#
		AND C.CGTMGNO = #GTMGNO#
		AND C.CREGCD &gt;= #REGCD1# 
		AND C.CREGCD &lt;= #REGCD2# ) MC
	      WHERE OB.BILD_SN = CS.BILD_SN
	      AND CS.BILD_SN = CM.CMBILD_SN
	      AND CS.APNT_DE_8 = CM.CMAPNT_DE_8
	      AND CS.QUALFUSER_SN = CM.CMQUALFUSER_SN
	      AND CM.CMBILD_SN = MC.MMFPIS1
	      AND CM.CMAPNT_DE_8 = MC.MMFPIS3
	      AND CM.CMQUALFUSER_SN = MC.MMFPIS4
	      AND CM.CMQUALFUSER_SN = CB.QUALFUSER_SN
	      AND OB.OBJ_SE_CODE = CCG.CODE_GROUP(+)
	      AND OB.OBJ_STDR_CODE = CC.CODE(+)
	      AND CCG.USE_AT(+) = 'Y' AND CC.USE_AT(+) = 'Y'
	      AND OB.CTRD_CODE = ALC.LEGALDONG_CTRD_CODE(+)
	      AND OB.SIGNGU_CODE = ALC.LEGALDONG_SIGNGU_CODE(+)
	      AND OB.DONG_CODE = ALC.LEGALDONG_DONG_CODE(+)
	      AND OB.LI_CODE = ALC.LEGALDONG_LI_CODE(+)     
	    ORDER BY MMREGDATE DESC)
	WHERE ROWNUM &lt;=  #SEARCHNUM#
</isEqual>
</isNotEqual>
</isNotEqual>	</statement>
	<input default-name="_none">
	</input>
	<output default-name="ds_ioChangeMList">
	</output>
</query>

<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="590" Id="frmtraining0020MTrainingJubsuManagement" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="강습접수관리" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ioTrainingJubsu">
				<Contents>
					<colinfo id="ABSENTDAY" size="1" summ="default" type="STRING"/>
					<colinfo id="ABSENTYN" size="7" summ="default" type="STRING"/>
					<colinfo id="ADDR1" size="100" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="100" summ="default" type="STRING"/>
					<colinfo id="AUTHYN" size="1" summ="default" type="STRING"/>
					<colinfo id="BARCODE" size="12" summ="default" type="STRING"/>
					<colinfo id="COMPNM" size="30" summ="default" type="STRING"/>
					<colinfo id="COURSECD" size="2" summ="default" type="STRING"/>
					<colinfo id="COURSEMUNJECD" size="3" summ="default" type="STRING"/>
					<colinfo id="COURSENM" size="30" summ="default" type="STRING"/>
					<colinfo id="DECISIONSEATNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EMAILDOMAIN" size="40" summ="default" type="STRING"/>
					<colinfo id="EMAILID" size="40" summ="default" type="STRING"/>
					<colinfo id="HPTEL" size="16" summ="default" type="STRING"/>
					<colinfo id="IIDIRPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IIIMGSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="IIREALNM" size="256" summ="default" type="STRING"/>
					<colinfo id="IISAVENM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUBSUNO" size="6" summ="default" type="STRING"/>
					<colinfo id="LASTIMGSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LASTSUNAPGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="LASTTJHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LASTTOHSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="LASTTSSEQ" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="MGJIBUCD" size="4" summ="default" type="STRING"/>
					<colinfo id="MGJIBUNICK" size="20" summ="default" type="STRING"/>
					<colinfo id="MGJIBUNM" size="70" summ="default" type="STRING"/>
					<colinfo id="MUNJEGUBUN" size="2" summ="default" type="STRING"/>
					<colinfo id="PASSYN" size="1" summ="default" type="STRING"/>
					<colinfo id="PERSONNM" size="20" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="100" summ="default" type="STRING"/>
					<colinfo id="REMARKCD" size="2" summ="default" type="STRING"/>
					<colinfo id="RESIDENTNO" size="13" summ="default" type="STRING"/>
					<colinfo id="TEL" size="16" summ="default" type="STRING"/>
					<colinfo id="TJMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TPMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TOMGNO" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TORDER" size="3" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZIPCD" size="6" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="IIIMGBINARY" size="4000" summ="default" type="BLOB"/>
					<colinfo id="TJFIREMANYN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oCourse">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oEmailDomain">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oImage">
				<Contents>
					<colinfo id="FILE_NAME" size="260" summ="default" type="STRING"/>
					<colinfo id="SHORT_FILE_NAME" size="14" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="4" summ="default" type="INT"/>
					<colinfo id="CREATE_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="UPDATE_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="ACCESS_DATE" size="4" summ="default" type="DATE"/>
					<colinfo id="ATTR_ARCHIVE" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_SYSTEM" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_HIDDEN" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_READONLY" size="4" summ="default" type="INT"/>
					<colinfo id="ATTR_DIRECTORY" size="4" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRemarkGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingOrderMgno"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSeatNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJubsuAllInfo" OnRowPosChanged="ds_oJubsuAllInfo_OnRowPosChanged">
				<Contents>
					<colinfo id="COURSECD" size="2" type="STRING"/>
					<colinfo id="COURSEMUNJECD" size="4" type="STRING"/>
					<colinfo id="JUBSUNO" size="6" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>
					<colinfo id="MGJIBUCD" size="4" type="STRING"/>
					<colinfo id="PASSDATE" size="8" type="STRING"/>
					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TJPASSYN" size="1" type="STRING"/>
					<colinfo id="TOMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TORDER" size="3" type="STRING"/>
					<colinfo id="YEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oOrderHist">
				<Contents>
					<colinfo id="ABSENTYN" size="7" type="STRING"/>
					<colinfo id="AFTERJIBU" size="4" type="STRING"/>
					<colinfo id="AFTERJUBSUNO" size="6" type="STRING"/>
					<colinfo id="AFTERMGNO" size="22" type="DECIMAL"/>
					<colinfo id="AFTERORDER" size="3" type="STRING"/>
					<colinfo id="BEFORJIBU" size="4" type="STRING"/>
					<colinfo id="BEFORJUBSUNO" size="6" type="STRING"/>
					<colinfo id="BEFORMGNO" size="22" type="DECIMAL"/>
					<colinfo id="BEFORORDER" size="3" type="STRING"/>
					<colinfo id="LASTSUNAPGUBUN" size="50" type="STRING"/>
					<colinfo id="TJLASTSUNAPGUBUN" size="2" type="STRING"/>
					<colinfo id="TJMGNO" size="22" type="DECIMAL"/>
					<colinfo id="TOHSEQ" size="22" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSetlmentHist" OnRowPosChanged="ds_oSetlmentHist_OnRowPosChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ioMenuTree">
				<Contents>
					<colinfo id="MORDERSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MENULEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="MPARENTMENUID" size="256" summ="default" type="STRING"/>
					<colinfo id="MMENUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MURL" size="256" summ="default" type="STRING"/>
					<colinfo id="MREMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="MURLTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MSYSGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oModifyColumn">
				<Contents>
					<colinfo id="COLUMNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="COLUMNNM" size="256" summ="default" type="STRING"/>
					<record>
						<COLUMNCD>PERSONNM</COLUMNCD>
						<COLUMNNM>성명</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>RESIDENTNO</COLUMNCD>
						<COLUMNNM>주민번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ZIPCD</COLUMNCD>
						<COLUMNNM>우편번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR1</COLUMNCD>
						<COLUMNNM>주소1</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>ADDR2</COLUMNCD>
						<COLUMNNM>주소2</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TEL</COLUMNCD>
						<COLUMNNM>전화번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>HPTEL</COLUMNCD>
						<COLUMNNM>휴대폰</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EMAILID</COLUMNCD>
						<COLUMNNM>이메일ID</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>EMAILDOMAIN</COLUMNCD>
						<COLUMNNM>이메일주소</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>COMPNM</COLUMNCD>
						<COLUMNNM>근무처</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>REMARKCD</COLUMNCD>
						<COLUMNNM>적요구분</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>REMARK</COLUMNCD>
						<COLUMNNM>적요내용</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>PICTURE</COLUMNCD>
						<COLUMNNM>사진</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>JUBSUNO</COLUMNCD>
						<COLUMNNM>접수번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>DECISIONSEATNO</COLUMNCD>
						<COLUMNNM>좌석번호</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>BARCODE</COLUMNCD>
						<COLUMNNM>바코드</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>TJFIREMANYN</COLUMNCD>
						<COLUMNNM>소방공무원여부</COLUMNNM>
					</record>
					<record>
						<COLUMNCD>IIIMGSEQ</COLUMNCD>
						<COLUMNNM>사진</COLUMNNM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingOrder"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oPosResult"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingJubsuPrint3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingCheck"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibuGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>소속지부접수</DATA>
					</record>
					<record>
						<CD>T</CD>
						<DATA>타지부접수</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oTrainingPearson"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oChangeTpmgno">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>S</CD>
						<DATA>조회</DATA>
					</record>
					<record>
						<CD>C</CD>
						<DATA>성명/주민번호&#32;변경</DATA>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="272" Height="232" Id="shpGubunBox3" Left="332" LineColor="user15" Right="996" TabOrder="97" Top="40" Type="Rectangle" Width="664"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnApplyPicture" ImageID="BTN_TEXT_06" Left="680" OnClick="btnApplyPicture_OnClick" Style="sty_Button" TabOrder="45" Text="최근사진반영" Top="104" Transparent="TRUE" Width="93"></Button>
		<Shape Bottom="29" Height="28" Id="shpBtnBox" Left="175" LineColor="user14" Right="996" TabOrder="80" Top="1" Type="Rectangle" Width="821"></Shape>
		<Shape Bottom="436" Height="45" Id="shpGubunBox2" Left="4" LineColor="user15" Right="324" TabOrder="99" Top="391" Type="Rectangle" Width="320"></Shape>
		<Shape Bottom="364" Height="324" Id="shpGubunBox1" Left="4" LineColor="user15" Right="324" TabOrder="97" Top="40" Type="Rectangle" Width="320"></Shape>
		<Shape Bottom="436" Height="140" Id="shpGubunBox4" Left="332" LineColor="user15" Right="996" TabOrder="98" Top="296" Type="Rectangle" Width="664"></Shape>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="75" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="172">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oSetlmentHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="431" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="97" Id="gdSetlmentHist" InputPanel="FALSE" Left="435" LineColor="default" Right="992" RowHeight="20" Style="sty_Grid" TabOrder="57" TabStop="true" Top="334" UseDBuff="true" UsePopupMenu="true" UserData="결제내역" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="557">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="77"/>
						<col width="62"/>
						<col width="80"/>
						<col width="106"/>
						<col width="70"/>
						<col width="55"/>
						<col width="0"/>
						<col width="70"/>
						<col width="73"/>
						<col width="94"/>
						<col width="70"/>
						<col width="70"/>
						<col width="77"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="처리일자"/>
						<cell align="center" col="2" display="text" text="결제여부"/>
						<cell align="center" col="3" display="text" text="결제구분"/>
						<cell align="center" col="4" display="text" text="결제방법"/>
						<cell align="center" col="5" display="text" text="금액(원)"/>
						<cell align="center" col="6" display="text" text="환불No."/>
						<cell align="center" col="7" display="text" text="세금계산서발행여부"/>
						<cell align="center" col="8" display="text" text="처리지부"/>
						<cell align="center" col="9" display="text" text="처리자"/>
						<cell align="center" col="10" display="text" text="주문번호"/>
						<cell align="center" col="11" display="text" text="관리지부"/>
						<cell align="center" col="12" display="text" text="POS지부"/>
						<cell align="center" col="13" display="text" text="정산일자"/>
					</head>
					<body>
						<cell align="right" col="0" colid="TSSEQ" display="number"/>
						<cell align="center" col="1" colid="TSPROCDATE" display="text" Mask="####-##-##"/>
						<cell align="center" col="2" colid="TSSETLMTYN" display="text"/>
						<cell align="center" col="3" colid="TSGUBUNCDNM" display="text"/>
						<cell align="center" col="4" colid="TSGUBUNNM" display="text"/>
						<cell align="right" col="5" colid="TSPROCAMOUNT" display="number" Mask="#,###"/>
						<cell align="center" col="6" colid="TSREPAYREF" display="text"/>
						<cell align="center" col="7" colid="TAXRCPTYN" display="text"/>
						<cell align="center" col="8" colid="TSPROCGTMGNONM" display="text"/>
						<cell align="center" col="9" colid="PROCSABUN" display="text"/>
						<cell align="center" col="10" colid="TSJUMUNNO" display="text"/>
						<cell align="center" col="11" colid="TSMGGTMGNONM" display="text"/>
						<cell align="center" col="12" colid="TSPOSGTMGNONM" display="text"/>
						<cell align="center" col="13" colid="TSPONYDATE" display="text" Mask="####-##-##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="178" OnClick="lfn_Search" Style="sty_Button" TabOrder="64" ToolTipText="조회" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnDelete" ImageID="BTN_COM_DEL" Left="352" OnClick="lfn_Delete" Style="sty_Button" TabOrder="3" ToolTipText="삭제&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnSave" ImageID="BTN_COM_SAVE" Left="265" OnClick="lfn_Save" Style="sty_Button" TabOrder="2" ToolTipText="수정&#32;저장" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="734" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="7" ToolTipText="입력&#32;초기화" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="821" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="8" ToolTipText="화면&#32;출력" Top="4" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="908" OnClick="lfn_End" Style="sty_Button" TabOrder="9" ToolTipText="닫기" Top="4" Width="85"></Button>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="76" Text="지부" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Enable="FALSE" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="99" OnChanged="lfn_SearchTrainingLatestOrder" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="10" Top="55" UserData="I:지부" Width="88"></Combo>
		<Static Align="Center" Height="82" Id="lbCourse" Left="8" Style="sty_Label" TabOrder="77" Text="직능" Top="80" UserData="S" VAlign="Middle" Width="20" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="20" Id="lbTrainingYear" Left="192" Style="sty_Label" TabOrder="78" Text="년도" Top="56" UserData="S" VAlign="Middle" Width="88"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingYear" ImeMode="native" Left="284" LeftMargin="2" MaxLength="4" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edTrainingYear_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="11" Top="56" UserData="I:년도" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lbTrainingOrder" Left="8" Style="sty_Label" TabOrder="79" Text="회차" Top="166" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbPersonNm" Left="336" Style="sty_Label" TabOrder="80" Text="성명" Top="56" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edTrainingOrder" ImeMode="native" Left="100" LeftMargin="2" MaxLength="3" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edTrainingOrder_OnKeyDown" OnKillFocus="edTrainingOrder_OnKillFocus" Style="sty_Edit" TabOrder="13" Top="166" UserData="S:회차" Width="28"></Edit>
		<Static Align="Center" Height="20" Id="lbResidentNo" Left="336" Style="sty_Label" TabOrder="81" Text="주민번호" Top="80" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbCompNm" Left="336" Style="sty_Label" TabOrder="82" Text="근무처" Top="224" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="COMPNM" Height="20" Id="edCompNm" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="40" Top="224" UserData="S" Width="442"></Edit>
		<Static Align="Center" Height="20" Id="lbAt" Left="522" Style="sty_Text" TabOrder="83" Text="@" Top="200" VAlign="Middle" Width="16"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchPersonInfo" ImageID="BTN_TEXT_06" Left="538" OnClick="btnSearchPersonInfo_OnClick" Style="sty_Button" TabOrder="24" Text="기본정보" Top="55" Transparent="TRUE" Width="93"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="PERSONNM" Height="20" Id="edPersonNm" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edPersonNm_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="23" Top="56" UserData="S:성명" Width="106"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Height="20" Id="edJubsuNo" ImeMode="native" Left="100" LeftMargin="2" MaxLength="6" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edJubsuNo_OnKeyDown" OnKillFocus="edJubsuNo_OnKillFocus" Style="sty_Edit" TabOrder="15" Top="190" UserData="S:접수번호" Width="50"></Edit>
		<Static Align="Center" Height="20" Id="lbSeq" Left="8" Style="sty_Label" TabOrder="84" Text="접수번호" Top="190" UserData="S" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="20" Id="lbAddr" Left="336" Style="sty_Label" TabOrder="87" Text="주소" Top="104" VAlign="Middle" Width="88"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" BindDataset="ds_ioTrainingJubsu" BKColor="user4" Border="Flat" Column="ZIPCD" Height="20" Id="medZipCode" Left="428" LeftMargin="2" Mask="###-###" OnFocus="edZipCode_OnFocus" OnKeyDown="gfn_EnterNextFocus" Readonly="TRUE" Style="sty_ZipCodeReadOnly" TabOrder="27" Top="104" Type="STRING" UserData="S:우편번호" Width="58"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchZipCode" ImageID="BTN_SEARCH" Left="488" OnClick="btnSearchZipCode_OnClick" Style="sty_Button" TabOrder="28" Top="104" Transparent="TRUE" Width="22"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="ADDR1" Height="20" Id="edAddr1" ImeMode="native" Left="336" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="edAddr1_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="29" Top="128" UserData="S:주소" Width="436"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="ADDR2" Height="20" Id="edAddr2" ImeMode="native" Left="336" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="30" Top="152" UserData="S:주소상세" Width="436"></Edit>
		<Static Align="Center" Height="20" Id="lbTel" Left="336" Style="sty_Label" TabOrder="85" Text="전화번호" Top="176" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="TEL" Height="20" Id="edTel" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="31" Top="176" UserData="S" Width="104"></Edit>
		<Static Align="Center" Height="20" Id="lbHpTel" Left="536" Style="sty_Label" TabOrder="86" Text="휴대폰" Top="176" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="HPTEL" Height="20" Id="edHpTel" ImeMode="native" Left="628" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="32" Top="176" UserData="S" Width="104"></Edit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="RESIDENTNO" Height="20" Id="medResidentNo" Left="428" LeftMargin="2" Mask="######-#######" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medResidentNo_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="25" Top="80" Type="STRING" UserData="S:주민번호" Width="106"></MaskEdit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxEmailDomain" INDEX="0" InnerDataset="ds_oEmailDomain" Left="642" OnChanged="cbxEmailDomain_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="37" Top="199" Width="92"></Combo>
		<Static Align="Center" Height="20" Id="lbEmail" Left="336" Style="sty_Label" TabOrder="88" Text="E-Mail" Top="200" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="EMAILID" Height="20" Id="edEmail" ImeMode="native" Left="428" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="35" Top="200" UserData="S" Width="95"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAuthResidentNo" ImageID="BTN_TEXT_06" Left="538" OnClick="btnAuthResidentNo_OnClick" Style="sty_Button" TabOrder="26" Text="실명인증" Top="79" Transparent="TRUE" Width="93"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="PASSYN" Enable="FALSE" Height="20" Id="edPassYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="70" Top="313" UserData="S" Width="36"></Edit>
		<Static Align="Center" Height="20" Id="lbPassYn" Left="8" Style="sty_Label" TabOrder="88" Text="수료여부" Top="313" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="ABSENTYN" Enable="FALSE" Height="20" Id="edAbsentYn" ImeMode="native" Left="100" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="71" Text="Y&#32;:&#32;1일차" Top="337" UserData="S" Width="64"></Edit>
		<Static Align="Center" Height="20" Id="lbAbsentYn" Left="8" Style="sty_Label" TabOrder="89" Text="결강여부" Top="337" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnAbsentManageLink" ImageID="BTN_TEXT_05" Left="168" OnClick="btnAbsentManageLink_OnClick" Style="sty_Button" TabOrder="21" Text="결강자관리" Top="336" Transparent="TRUE" Width="79"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTrainingJubsuModify" ImageID="BTN_TEXT_COM" Left="100" OnClick="btnTrainingJubsuModify_OnClick" Style="sty_Button" TabOrder="20" Text="회차변경" Top="288" Transparent="TRUE" Width="85"></Button>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oJubsuAllInfo" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="584" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdJubsuInfo" InputPanel="FALSE" Left="4" LineColor="default" Right="496" RowHeight="20" Style="sty_Grid" TabOrder="58" TabStop="true" Top="476" UseDBuff="true" UsePopupMenu="true" UserData="개인접수정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="492">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="68"/>
						<col width="36"/>
						<col width="134"/>
						<col width="31"/>
						<col width="58"/>
						<col width="83"/>
						<col width="47"/>
						<col width="83"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="순번"/>
						<cell align="center" col="1" display="text" text="지부"/>
						<cell align="center" col="2" display="text" text="년도"/>
						<cell align="center" col="3" display="text" text="직능"/>
						<cell align="center" col="4" display="text" text="회차"/>
						<cell align="center" col="5" display="text" text="접수번호"/>
						<cell align="center" col="6" display="text" text="수료일자"/>
						<cell align="center" col="7" display="text" text="환불"/>
						<cell align="center" col="8" display="text" text="접수일자"/>
					</head>
					<body>
						<cell align="right" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="0" display="number" expr="ln_TotalGridInfoCount&#32;-&#32;CURROW"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="1" colid="MGJIBUCD" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="2" colid="YEAR" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="3" colid="COURSEMUNJECD" combocol="CD" combodataset="ds_oCourse" combotext="DATA" display="combo"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="4" colid="TORDER" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="5" colid="JUBSUNO" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="6" colid="PASSDATE" display="text" Mask="####-##-##"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="7" colid="LASTSUNAPGUBUN" display="text"/>
						<cell align="center" bkcolor='expr:decode(LASTYN,&#32;&quot;Y&quot;,&#32;&quot;&quot;,&#32;&quot;user18&quot;)' col="8" colid="FIRSTREGDATE" display="text" Mask="####-##-##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJubsuInfo" Left="4" Style="sty_LabelGruopBox" TabOrder="90" Text="개인접수정보" Top="452" VAlign="Middle" Width="120"></Static>
		<Grid AutoEnter="TRUE" AutoSelect="TRUE" BindDataset="ds_oOrderHist" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="584" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="20" Height="108" Id="gdOrderHist" InputPanel="FALSE" Left="500" LineColor="default" Right="996" RowHeight="20" Style="sty_Grid" TabOrder="59" TabStop="true" Top="476" UseDBuff="true" UsePopupMenu="true" UserData="회차변경정보" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="496">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="85"/>
						<col width="189"/>
						<col width="60"/>
						<col width="70"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2" SuppressAlign="Middle" text="순번">
							<cell col="0" display="text" rowspan="2" text="순번"/>
						</cell>
						<cell col="1" display="text" rowspan="2" SuppressAlign="Middle" text="지부">
							<cell col="0" display="text" rowspan="2" text="지부"/>
						</cell>
						<cell col="2" display="text" rowspan="2" SuppressAlign="Middle" text="회차">
							<cell col="0" display="text" rowspan="2" text="회차"/>
						</cell>
						<cell col="3" display="text" rowspan="2" SuppressAlign="Middle" text="접수번호">
							<cell col="0" display="text" rowspan="2" text="접수번호"/>
						</cell>
						<cell col="4" colspan="3" display="text" text="변경&#32;후">
							<cell col="0" colspan="3" display="text" text="변경&#32;후"/>
						</cell>
						<cell col="7" display="text" rowspan="2" SuppressAlign="Middle" text="처리일자">
							<cell col="0" display="text" rowspan="2" text="처리일자"/>
						</cell>
						<cell col="8" display="text" rowspan="2" SuppressAlign="Middle" text="사유">
							<cell col="0" display="text" rowspan="2" text="사유"/>
						</cell>
						<cell col="9" display="text" rowspan="2" SuppressAlign="Middle" text="환불여부">
							<cell col="0" display="text" rowspan="2" text="환불여부"/>
						</cell>
						<cell col="10" display="text" rowspan="2" SuppressAlign="Middle" text="결강일차">
							<cell col="0" display="text" rowspan="2" text="결강일차"/>
						</cell>
						<cell align="center" col="4" display="text" row="1" text="지부"/>
						<cell align="center" col="5" display="text" row="1" text="회차"/>
						<cell align="center" col="6" display="text" row="1" text="접수번호"/>
					</head>
					<body>
						<cell align="right" col="0" display="number" expr="ln_TotalGridOrderCount&#32;-&#32;CURROW"/>
						<cell align="center" col="1" colid="BEFORJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="2" colid="BEFORORDER" display="text"/>
						<cell align="center" col="3" colid="BEFORJUBSUNO" display="text"/>
						<cell align="center" col="4" colid="AFTERJIBU" combocol="CD" combodataset="ds_oJibu" combotext="DATA" display="combo"/>
						<cell align="center" col="5" colid="AFTERORDER" display="text"/>
						<cell align="center" col="6" colid="AFTERJUBSUNO" display="text"/>
						<cell align="center" col="7" colid="PROCDATE" display="text" Mask="####-##-##"/>
						<cell col="8" colid="REMARK" display="text"/>
						<cell align="center" col="9" colid="LASTSUNAPGUBUN" display="text"/>
						<cell align="center" col="10" colid="ABSENTYN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="lbJubsuHist" Left="500" Style="sty_LabelGruopBox" TabOrder="91" Text="개인접수회차이력" Top="452" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="20" Id="lbSetlmt" Left="348" Style="sty_LabelGruopBox" TabOrder="92" Text="결제내역" Top="288" VAlign="Middle" Width="120"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="EMAILDOMAIN" Height="20" Id="edEmailDomain" ImeMode="native" Left="536" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="36" Top="200" UserData="S" Width="104"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeqList" ImageID="BTN_TEXT_06" Left="154" OnClick="btnSeqList_OnClick" Style="sty_Button" TabOrder="16" Text="접수목록" ToolTipText="현접수번호를&#32;제외한&#32;이후&#32;목록" Top="189" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchTrainingOrder" ImageID="BTN_TEXT_06" Left="132" OnClick="btnSearchTrainingOrder_OnClick" OnKeyDown="btnSearchTrainingOrder_OnClick" Style="sty_Button" TabOrder="14" Text="접수가능회차" Top="165" Transparent="TRUE" Width="92"></Button>
		<FileDialog Bottom="28" Filter="JPG&#32;File(*.jpg)|*.jpg|GIF&#32;File(*.gif)|*.gif|BMP&#32;File(*.bmp)|*.bmp|" Height="24" Id="fdImage" Left="238" Right="262" TabOrder="93" Top="4" Width="24"></FileDialog>
		<HttpFile Height="24" Id="hfImage" Left="268" Top="4" Width="24"></HttpFile>
		<Static Align="Center" Height="20" Id="lbRemark" Left="336" Style="sty_Label" TabOrder="93" Text="적요" Top="248" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_ioTrainingJubsu" Border="Flat" Column="REMARK" Height="20" Id="edRemark" ImeMode="native" Left="516" LeftMargin="2" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="42" Top="248" UserData="S" Width="354"></Edit>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="82" Id="radCourse" INDEX="0" InnerDataset="ds_oCourse" Left="32" OnChanged="lfn_SearchTrainingLatestOrder" OnKeyDown="gfn_EnterNextFocus" Style="sty_Radio" TabOrder="12" Top="80" UserData="I:직능" Width="288"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnTraingJubsuHist" ImageID="BTN_TEXT_06" Left="538" OnClick="btnTraingJubsuHist_OnClick" Style="sty_Button" TabOrder="49" Text="접수정보(F6)" Top="104" Transparent="TRUE" Width="92"></Button>
		<Combo BindDataset="ds_ioTrainingJubsu" Border="Flat" CodeColumn="CD" Column="REMARKCD" DataColumn="DATA" Editable="TRUE" Height="20" Id="cbxRemarkGubun" INDEX="0" InnerDataset="ds_oRemarkGubun" Left="427" OnChanged="cbxRemarkGubun_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Search="NOTFILTERED" Style="sty_Combo" TabOrder="41" Top="247" UserData="S" Width="88"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnChangeProcDate" ImageID="BTN_TEXT_06" Left="700" OnClick="btnChangeProcDate_OnClick" Style="sty_Button" TabOrder="54" Text="처리일자변경" Top="309" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnProcRct" ImageID="BTN_TEXT_07" Left="794" OnClick="btnProcRct_OnClick" Style="sty_Button" TabOrder="55" Text="현금영수증처리" Top="309" Transparent="TRUE" Width="105"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPrintReRct" ImageID="BTN_TEXT_06" Left="901" OnClick="btnPrintReRct_OnClick" Style="sty_Button" TabOrder="56" Text="영수증재발행" Top="309" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendSms" ImageID="BTN_TEXT_04" Left="736" OnClick="btnSendSms_OnClick" Style="sty_Button" TabOrder="33" Text="SMS발송" Top="176" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintJubsu" ImageID="BTN_TEXT_05" Left="533" OnClick="btnPrintJubsu_OnClick" Style="sty_Button" TabOrder="5" Text="수강증출력" ToolTipText="수강증출력" Top="4" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSendEmail" ImageID="BTN_TEXT_04" Left="736" Style="sty_Button" TabOrder="38" Text="메일발송" Top="200" Transparent="TRUE" Visible="FALSE" Width="66"></Button>
		<Static Align="Center" Height="20" Id="lbSeatNo" Left="8" Style="sty_Label" TabOrder="95" Text="좌석번호" Top="214" VAlign="Middle" Width="88"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" Border="Flat" Height="20" Id="edSeatNo" ImeMode="native" Left="100" LeftMargin="2" Number="TRUE" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Edit" TabOrder="18" Top="214" UserData="S" Width="50"></Edit>
		<Button BKColor="user17" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Font="굴림,10,Bold" Height="97" Id="btnSetlmt" Left="336" OnClick="btnSetlmt_OnClick" Style="sty_Button" TabOrder="51" Text="결제(POS)" Top="334" Width="96"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSeatList" ImageID="BTN_TEXT_06" Left="154" OnClick="btnSeatList_OnClick" Style="sty_Button" TabOrder="19" Text="좌석목록" Top="213" Transparent="TRUE" Width="92"></Button>
		<Static Align="Center" Height="20" Id="lbOrderChange" Left="8" Style="sty_Label" TabOrder="96" Text="회차변경" Top="289" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="#cc0000" Bottom="284" Height="4" Id="shpBox1" Left="328" LineColor="#cc0000" Right="1000" TabOrder="96" Top="280" Type="Rectangle" Width="672"></Shape>
		<Shape BKColor="#cc0000" Bottom="446" Height="4" Id="shpBox2" Left="0" LineColor="#cc0000" Right="1000" TabOrder="96" Top="442" Type="Rectangle" Width="1000"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSmsStat" ImageID="BTN_TEXT_04" Left="804" OnClick="btnSmsStat_OnClick" Style="sty_Button" TabOrder="34" Text="SMS현황" Top="176" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEmailStat" ImageID="BTN_TEXT_04" Left="804" Style="sty_Button" TabOrder="39" Text="메일현황" Top="200" Transparent="TRUE" Visible="FALSE" Width="66"></Button>
		<Static Align="Center" Height="46" Id="lbTrainingInfo" Left="8" Style="sty_Label" TabOrder="96" Text="회차정보" Top="238" VAlign="Middle" Width="36" WordWrap="TRUE"></Static>
		<Image BindDataset="ds_ioTrainingJubsu" Border="Flat" FillType="STRETCH" Height="144" Id="imgPicture" Left="876" Style="sty_Image" TabOrder="61" Text="사진" Top="47" Transparent="TRUE" Width="112"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="120" Id="imgLastestPicture" Left="777" Style="sty_Image" TabOrder="60" Text="최근사진" Top="47" Transparent="TRUE" Width="94"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearchRegPicture" ImageID="BTN_TEXT_06" Left="680" OnClick="btnSearchRegPicture_OnClick" Style="sty_Button" TabOrder="43" Text="등록사진조회" Top="56" Transparent="TRUE" Width="93"></Button>
		<Static Align="Center" Height="20" Id="lbTrainingPersonInfo" Left="348" Style="sty_LabelGruopBox" TabOrder="98" Text="접수자&#32;기본&#32;정보" Top="32" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="20" Id="lbJubsu" Left="16" Style="sty_LabelGruopBox" TabOrder="99" Text="접수" Top="31" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Height="20" Id="lbBarCodeInfo" Left="20" Style="sty_LabelGruopBox" TabOrder="99" Text="수강증바코드정보" Top="382" VAlign="Middle" Width="120" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="20" Id="lbBarCode" Left="8" Style="sty_Label" TabOrder="100" Text="바코드" Top="408" UserData="S" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnBarCodeSearch" ImageID="BTN_TEXT_08" Left="196" OnClick="btnBarCodeSearch_OnClick" Style="sty_Button" TabOrder="22" Text="바코드로&#32;조회" Top="407" Transparent="TRUE" Width="119"></Button>
		<Shape BKColor="#cc0000" Bottom="376" Height="4" Id="shpBox3" Left="0" LineColor="#cc0000" Right="328" TabOrder="100" Top="372" Type="Rectangle" Width="328"></Shape>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbTrainingInfo1" Left="48" Style="sty_Label" TabOrder="68" Top="239" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Static BKColor="user4" Color="black" Font="굴림,9" Height="22" Id="lbTrainingInfo2" Left="48" Style="sty_Label" TabOrder="69" Top="261" VAlign="Middle" Width="272" WordWrap="TRUE"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnUnUseJubsuNo" ImageID="BTN_TEXT_04" Left="250" OnClick="lfn_SearchUnUseJubsuNo" Style="sty_Button" TabOrder="17" Text="빈번호" ToolTipText="빈접수번호조회" Top="189" Transparent="TRUE" Width="66"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnLoadPicture_OnClick" Style="sty_Button" TabOrder="48" Text="사진찾기" Top="247" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLoadScanPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnLoadScanPicture_OnClick" Style="sty_Button" TabOrder="47" Text="스캔사진불러오기" Top="223" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnScanPicture" ImageID="BTN_TEXT_08" Left="874" OnClick="btnScanPicture_OnClick" Style="sty_Button" TabOrder="46" Text="사진스캔실행" Top="199" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPictureManagement" ImageID="BTN_TEXT_06" Left="680" OnClick="btnPictureManagement_OnClick" Style="sty_Button" TabOrder="44" Text="사진관리" Top="80" Transparent="TRUE" Width="93"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnShowVirtualAccount" ImageID="BTN_TEXT_06" Left="606" OnClick="btnShowVirtualAccount_OnClick" Style="sty_Button" TabOrder="53" Text="가상계좌보기" Top="309" Transparent="TRUE" Width="92"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnModifyHistory" ImageID="BTN_TEXT_04" Left="252" OnClick="btnModifyHistory_OnClick" Style="sty_Button" TabOrder="50" Text="변경이력" ToolTipText="접수정보변경이력" Top="312" Transparent="TRUE" Width="66"></Button>
		<MaskEdit AutoSelect="TRUE" Border="Flat" Height="20" Id="medBarCode" Left="100" LeftMargin="2" Mask="############" MaxLength="12" OnFocus="gfn_ComponentOnFocus" OnKeyDown="medBarCode_OnKeyDown" OnKillFocus="gfn_ComponentOnKillFocus" Style="sty_Maskedit" TabOrder="101" Top="408" Type="STRING" UserData="S" Width="92"></MaskEdit>
		<File Bottom="28" Height="24" Id="fiImageFile" Left="212" Right="236" TabOrder="99" Top="4" Width="24"></File>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btnPosResultList" ImageID="BTN_TEXT_08" Left="486" OnClick="btnPosResultList_OnClick" Style="sty_Button" TabOrder="52" Text="결제처리결과조회" Top="309" Transparent="TRUE" Width="118"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_TEXT_08" Left="614" OnClick="lfn_Print" Style="sty_Button" TabOrder="6" Text="강습원서출력(F9)" ToolTipText="강습원서출력" Top="4" Transparent="TRUE" Width="119"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintJubsuResult" ImageID="BTN_TEXT_06" Left="439" OnClick="btnPrintJubsuResult_OnClick" Style="sty_Button" TabOrder="4" Text="접수결과출력" ToolTipText="강습접수결과출력" Top="4" Transparent="TRUE" Width="93"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radJibuGubun" INDEX="0" InnerDataset="ds_oJibuGubun" Left="88" LeftMargin="2" OnChanged="radJibuGubun_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="102" Top="32" Value="S" Width="200"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnLicenseList" ImageID="BTN_TEXT_06" Left="155" OnClick="btnLicenseList_OnClick" Style="sty_Button" TabOrder="103" Text="수첩보유현황" ToolTipText="수첩보유현황" Top="312" Transparent="TRUE" Width="92"></Button>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="2" DataColumn="DATA" Height="20" Id="radChangeTpmgno" INDEX="0" InnerDataset="ds_oChangeTpmgno" Left="480" LeftMargin="2" OnChanged="radChangeTpmgno_OnChanged" RightMargin="2" Style="sty_Radio" TabOrder="104" Top="32" Value="S" Width="200"></Radio>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnJubsuHistory" ImageID="BTN_TEXT_04" Left="252" OnClick="btnJubsuHistory_OnClick" Style="sty_Button" TabOrder="105" Text="접수이력" Top="336" Transparent="TRUE" Width="66"></Button>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmtraining0020MTrainingJubsuManagement.xml
 * 설명 : 강습접수관리
 * 작성일 : 2009.07.17
 * 작성자 : 장성호
 */

#include "LIB::training.js"; // 공통업무 관련

var ls_FileUploadPath = "/IMGDATA/" + left(GetDate(), 4) + "/" + substr(GetDate(), 4, 2); // 사진이미지경로;
var ls_UploadRealName = ""; // 사진이미지 실제파일명
var lb_FileUpload = false; // 사진등록여부
var lb_BarcodeCheck = false; // 바코드로 조회 여부
var ls_OldSeatNo = ""; // 기존 좌석번호
var ls_OldPictureNo = ""; // 기존 사진번호
var ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부
var ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부
var ls_IsChangedPictureYn = "N"; // 사진 변경여부
var ls_RetTjmgno = "";

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj) {
    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리

    // 폼 환경설정
    ls_SystemGubun = gs_SystemGubun;
    ls_SystemMenuId = gs_SystemMenuId;
    var ls_FormId = split(sFormUrl, "::");
    ls_FormId = split(ls_FormId[1], ".");
    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";

    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.

    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.
    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        lfn_SetFormAuth(true); // 저장 권한
    } else if (ms_FormAuth == "R") {
        lfn_SetFormAuth(false); // 읽기 권한
    } else {
        gfn_Alert(MSGI00080);
        close();
    }

    // 공통 코드 조회
    gfn_SearchTrainingCourseMunje("T", ds_oCourse, "Y"); // 직능 코드 조회
    radCourse.Value = "22N";
    gfn_SearchAllJibu(cbxJibu, "Y", "선택"); // 지부 코드 조회
    gfn_SearchCommonCode(ds_oEmailDomain, "EMAILDOMAIN", "Y", "직접입력"); // 이메일도메인 조회
    gfn_SearchCommonCode(ds_oRemarkGubun, "REMARKGUBUN", "Y", "선택"); // 적요

    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
    edTrainingYear.Text = left(GetDate(), 4);
    lfn_SearchTrainingLatestOrder(); // 최근 접수가능회차 조회

    edTrainingOrder.SetFocus();
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {
    if (nChar == 117) {
        btnTraingJubsuHist_OnClick();
        return;
    }

    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리
}

function Form_OnSize(obj,nCx,nCy,nState) {
    if (gs_IsResizingForm == "Y") {
        gdSetlmentHist.Width = nCx - gdSetlmentHist.Left - 4 - 4;
        shpGubunBox4.Width = nCx - shpGubunBox4.Left - 4;
        gdJubsuInfo.Height = nCy - gdJubsuInfo.Top - 4;
        gdOrderHist.Height = nCy - gdOrderHist.Top - 4;
        gdOrderHist.Width = nCx - gdOrderHist.Left - 4;
        shpBox1.Width = nCx - shpBox1.Left;
        shpBox2.Width = nCx;
    }
}

/*
 * 기능 : 취소
 */
function lfn_Cancel(obj) {
    gfn_FormInit(this);
    ms_TrainingMgno = ""; // 강습관리번호

    // 시험정보
    lbTrainingInfo1.Text = "";
    lbTrainingInfo2.Text = "";

    // 접수 디폴트값 설정
    edTrainingYear.Text = left(GetDate(), 4);
    radCourse.Value = "22N";

    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;
	btnPosResultList.Enable = false;
	btnChangeProcDate.Enable = false;
	btnPrintReRct.Enable = false;

    edTrainingOrder.SetFocus();
}

/*
 * 기능 : 조회
 */
function lfn_Search(obj) {
    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";
        edTrainingOrder.SetFocus();
        return false;
    }
    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert("접수번호를 입력해 주십시오.");
        edJubsuNo.SetFocus();
        return false;
    }

    lfn_SearchTrainingJubsuList(obj);
}

/*
 * 기능 : 삭제
 */
function lfn_Delete(obj) {
    if ((ds_ioTrainingJubsu.currow < 0) || gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert(MSGI00030); // 삭제할 레코드가 없습니다.
        return false;
    }

    // 결제를 하지 않았을 경우에는 삭제 가능
    if (ds_oSetlmentHist.GetCount() > 0) {
        gfn_Alert("결제가 진행되어 삭제할 수 없습니다.");
        return false;
    } else {
        if (!gfn_Confirm(MSGW00030)) { // 삭제 하시겠습니까?
            return false;
        }

        lfn_SaveModifyHistory("D"); // 변경이력을 저장한다.

        tit_clearActionInfo();
        tit_addSingleActionInfo("training:deleteTrainingJubsu", "", 0, "");
        //서버 호출
        tit_callService(
            ""
            ,""
            ,""	// inDs
            ,""	// outDs
            ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args
                + " TOMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TOMGNO"))
            ,"lfn_AfterDeleteTrainingJubsu"
            ,false
            ,false
            ,true
        );
    }
}

/*
 * 기능 : 저장
 */
var ls_ServiceName = "";
var ls_CallBackServiceName = "";
function lfn_Save(obj) {
    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";
        edTrainingOrder.SetFocus();
        return false;
    }
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서
                && (ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT") <= ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT"))
            ) {
        gfn_Alert("접수인원수를 초과하였습니다.");
        return false;
    }
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서
                && (left(GetDAte(), 8) > ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"))
            ) {
        gfn_Alert("교육시작일이 지나서 접수하실 수 없습니다.");
        return false;
    }

    if (!gfn_FormValidate(this)) { // 입력 Validation Check
        return false;
    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서
                && lfn_CheckTrainingJubsuEduPassed() // 수료한 교육이 있으면
            ) {
        if (!gfn_Confirm("수료한 강습이 있습니다.\n신규 접수 하시겠습니까?")) {
            return false;
        }
    }
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서
                && lfn_CheckTrainingJubsuHaveSameCourseLcs() // 보유한 수첩이 있으면
            ) {
        if (!gfn_Confirm("보유한 수첩이 있습니다.\n신규 접수 하시겠습니까?")) {
            return false;
        }
    }

    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "N") {
        gfn_Alert("회차변경된 접수번호는 수정하실 수 없습니다.");
        return false;
    }
    
    if (!gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규가 아니면서
                && (ds_ioTrainingJubsu.GetOrgBuffColumn(0, "PERSONNM") <> ds_ioTrainingJubsu.GetColumn(0, "PERSONNM"))
                && (ds_ioTrainingJubsu.GetOrgBuffColumn(0, "RESIDENTNO") <> ds_ioTrainingJubsu.GetColumn(0, "RESIDENTNO"))
            ) {
        gfn_Alert("수강자(성명과 주민등록)를 변경하실 수 없습니다.");
        return false;
    }

    var lb_ValidRedidentNoYn = gfn_CheckResidentNo(medResidentNo.Value); // 주민번호체계 검사
    var lb_ValidForeignNoYn = gfn_CheckForeignNo(medResidentNo.Value); // 재외국인 등록번호 검사
    if (!lb_ValidRedidentNoYn && !lb_ValidForeignNoYn) { // 둘다 실패면
        if (!gfn_Confirm("주민등록번호가 형식에 맞지않습니다.\n강제로 저장 하시겠습니까?")) {
            medResidentNo.SetFocus();
            return false;
        }
    }

    // 정현호 대리 요청은 실명인증부분 주석처리함.2009.09.29
    // if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // 신규이면서
            // && (ds_ioTrainingJubsu.GetColumn(0, "AUTHYN") <> "Y")) {
        // gfn_Alert("실명인증을 먼저 실행해주십시오.");
        // return false;
    // }
    // 정현호대리 요청으로 코멘트 처리함.2009.09.28.
    // if (gfn_IsNull(imgPicture.ImageID)) {
        // gfn_Alert("사진을 먼저 등록해주십시오.");
        // return false;
    // }

    var sArg = "";
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) { // 신규
        if (gds_oUserInfo.GetColumn(0, "PDEPTCD") == cbxJibu.Value) { // 소속지부
            if (!gfn_Confirm("저장 하시겠습니까?")) {
                return false;
            }
        } else {
            if (!gfn_Confirm("타지부 접수입니다. 접수 저장 하시겠습니까?")) {
                return false;
            }
        }

        ls_ServiceName = "training:insertTrainingJubsu";
        ls_CallBackServiceName = "lfn_AfterInsertTrainingJubsu";
        sArg = "IsNewPictureYn=" + quote(iif(lb_FileUpload, "Y", "N"));
    } else { // 수정
        if (!gfn_Confirm("수정 하시겠습니까?")) {
            return false;
        }

        ls_ServiceName = "training:updateTrainingJubsu";
        ls_CallBackServiceName = "lfn_AfterUpdateTrainingJubsu";
        lfn_SaveModifyHistory("U"); // 변경이력을 저장한다.
        sArg = "IsChangedJubsuInfoYn=" + quote(ls_IsChangedJubsuInfoYn);
        sArg += " IsChangedSeatNoYn=" + quote(ls_IsChangedSeatNoYn);
        sArg += " IsChangedPictureYn=" + quote(ls_IsChangedPictureYn);
    }

    if (lb_FileUpload) { // 사진등록인 경우(파일 업로드일 경우)
        tit_FileWrite(
            hfImage
            , ls_FileUploadPath
            , fdImage.FilePath
            , fdImage.FileName
            , ls_UploadRealName
            , "U"
            , true
        );
        hfImage.CloseFile();
    }

    ds_ioTrainingJubsu.SetColumn(0, "TOMGNO", ms_TrainingMgno);
    ds_ioTrainingJubsu.SetColumn(0, "JUBSUNO", edJubsuNo.Text);
    ds_ioTrainingJubsu.SetColumn(0, "DECISIONSEATNO", edSeatNo.Text);

    ds_oTrainingJubsuResult.ClearData(); // 결과 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSingleActionInfo(ls_ServiceName, "", 0, "");
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"ds_iTrainingJubsu=ds_ioTrainingJubsu"    // inDs
        ,"ds_oTrainingJubsuResult=ds_oTrainingJubsu"    // outDs
        ,sArg    // args
        ,ls_CallBackServiceName
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 출력
 */
function lfn_Print(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");
        edJubsuNo.SetFocus();
        return false;
    }
    if (!gfn_Confirm("강습원서를 출력 하시겠습니까?")) {
        return false;
	}

    // 출력이력을 저장한다.
    gfn_InsertSearchPrintHistory(
            "P"
            , this.ID
            , global.mnuLeft.cbxOpenForm.Text + "(강습원서)"
            , "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
        );

    ds_oTrainingJubsuPrint.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchInternetTrainingJubsuReport", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oTrainingJubsuPrint=ds_oInternetTrainingJubsuInfoReport"    // outDs
        ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args
        ,""
        ,false
        ,false
        ,true
    );

    var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0060R03TrainingApplicationBatch.rex"
                                , "ds_oTrainingJubsuPrint"
                                , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
                                , false
                            );
}
/* 공통 필수 종료 */

/* 사용자 함수 */
/*
 * 기능 : 최근 접수가능회차를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchTrainingLatestOrder(obj) {
    ds_oTrainingOrder.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
	tit_addSearchActionInfo("training:searchTrainingOrderList", false);
	// 서버 호출
	tit_callService(
		""
		,""
		,""	// inDs
		,"ds_oTrainingOrder=ds_oTrainingOrder"	// outDs
		,"TCCOURSECD=" + quote(radCourse.Value)
            + " TOMGJIBUCD=" + quote(cbxJibu.Value)
            + " TOYEAR=" + quote(edTrainingYear.Text)
            + " sPosiYn=" + quote("Y") // 접수가능여부
            + " sRowCount=" + quote("1") // 건수
		,"lfn_AfterSearchTrainingLatestOrder"
        ,false
        ,false
        ,true
	);
}

/*
 * 기능 : 최근 접수가능회차 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchTrainingLatestOrder(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oTrainingOrder.GetCount() > 0) {
        ms_TrainingMgno = ds_oTrainingOrder.GetColumn(0, "TOMGNO"); // 관리번호
        cbxJibu.Value = ds_oTrainingOrder.GetColumn(0, "TOMGGTMGNO"); // 지부코드
        edTrainingYear.Text = ds_oTrainingOrder.GetColumn(0, "TOYEAR"); // 년도
        radCourse.Value = ds_oTrainingOrder.GetColumn(0, "COURSEMUNJECD"); // 직능코드
        edTrainingOrder.Text = ds_oTrainingOrder.GetColumn(0, "TOTRAININGORDER"); // 회차

        lfn_SearchTrainingOrderMgno(); // 강습회차관리번호를 조회한다.
    } else {
        ms_TrainingMgno = ""; // 강습관리번호

        // 시험정보
        lbTrainingInfo1.Text = "";
        lbTrainingInfo2.Text = "";

        edJubsuNo.Text = "";
        edSeatNo.Text = "";

        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
        // 그리드 초기화
        ds_oJubsuAllInfo.ClearData();
        gdJubsuInfo.NoDataText = "";
        ds_oOrderHist.ClearData();
        gdOrderHist.NoDataText = "";
        ds_oSetlmentHist.ClearData();
        gdSetlmentHist.NoDataText = "";
        btnSetlmt.Enable = false; // 결제(POS) 버튼
        btnProcRct.Enable = false;
        btnShowVirtualAccount.Enable = false;
        btnPosResultList.Enable = false;
        btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;
    }
}

/*
 * 기능 : 직능별교육자접수 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchTrainingJubsu(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    gfn_SearchMessage(gdTrainingJubsu); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
    lb_FileUpload = false;
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterDeleteTrainingJubsu(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    gfn_Alert("정상적으로 삭제되었습니다.");

    lb_FileUpload = false;
    lfn_SearchTrainingOrderMgno(); // 강습정보를 조회한다.
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterUpdateTrainingJubsu(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    gfn_SaveMessage(); // 저장 메세지를 처리한다.
    lb_FileUpload = false;

    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부
    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부
    ls_IsChangedPictureYn = "N"; // 사진 변경여부

    lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.
}

/*
 * 기능 : Transaction 서비스 호출 후 처리해야 할 내용
 * parameter : strSvcID - 서비스ID
 *             nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterInsertTrainingJubsu(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    switch (ds_oTrainingJubsuResult.GetColumn(0, "RESULTCODE")) {
        case "JUBSUNO" : // 접수번호중복
            var ls_NewJubsuNo = lpad((toNumber(edJubsuNo.Text) + 1), "0", 6); // 접수번호
            if (!gfn_Confirm("접수번호가 중복되었습니다.\n다음 접수번호[" + ls_NewJubsuNo + "]로 접수하시겠습니까?")) {
                return false;
            }
            edJubsuNo.Text = ls_NewJubsuNo;

            tit_addSingleActionInfo(ls_ServiceName, "", 0, "");
            // 서버 호출
            tit_callService(
                ""
                ,""
                ,"ds_iTrainingJubsu=ds_ioTrainingJubsu:U"    // inDs
                ,"ds_oTrainingJubsuResult=ds_oTrainingJubsu"    // outDs
                ,""    // args
                ,ls_CallBackServiceName
                ,false
                ,false
                ,true
            );
            break;
        case "SEATNO" : // 좌석번호중복
            gfn_Alert("좌석번호가 중복되었습니다.\n확인하신 후 다시 저장해 주십시오");
            break;
        case "OK" : // 정상처리
            lfn_SaveModifyHistory("I"); // 변경이력을 저장한다.
            gfn_SaveMessage(); // 저장 메세지를 처리한다.
            lb_FileUpload = false;
            lfn_Search();
            break;
    }
}

/*
 * 기능 : 강습회차관리번호를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchTrainingOrderMgno() {
    if (gfn_IsNull(cbxJibu.Value)
            || gfn_IsNull(radCourse.Value)
            || gfn_IsNull(edTrainingYear.Text)
            || gfn_IsNull(edTrainingOrder.Text)) {
        return false;
    }

    ds_oTrainingOrderMgno.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingOrderMgno", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oTrainingOrderMgno=ds_oTrainingOrderMgno"    // outDs
        ,"TOMGJIBUCD=" + quote(cbxJibu.Value)
            + " TCCOURSECD=" + quote(radCourse.Value)
            + " TOYEAR=" + quote(edTrainingYear.Text)
            + " TOORDER=" + quote(lpad(edTrainingOrder.Text, "0", 3))
        ,"lfn_AfterSearchTrainingOrderMgno"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 :  강습회차관리번호 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchTrainingOrderMgno(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oTrainingOrderMgno.GetCount() > 0) {
        ms_TrainingMgno = ds_oTrainingOrderMgno.GetColumn(0, "TOMGNO"); // 회차관리번호
        // 회차정보1
        lbTrainingInfo1 = " 좌석수:" + ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT"); // 좌석수
        //lbTrainingInfo1 = lbTrainingInfo1 + ",   최대인원수:" + ds_oTrainingOrderMgno.GetColumn(0, "TOJUBSUMAXCNT"); // 최대접수인원수
        lbTrainingInfo1 = lbTrainingInfo1 + ",   현재접수인원수:" + ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT"); // 현재접수인원수
        // 회차정보2
        lbTrainingInfo2 = " " + ds_oTrainingOrderMgno.GetColumn(0, "TOCOURSEGUBUNNM"); // 과정구분
        var ls_date = ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"); // 교육시작일
        lbTrainingInfo2 = lbTrainingInfo2 + ",  교육일:" + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + right(ls_date, 2); // 교육시작일
        ls_date = ds_oTrainingOrderMgno.GetColumn(0, "TOENDDATE"); // 교육종료일
        lbTrainingInfo2 = lbTrainingInfo2 + " ~ " + left(ls_date, 4) + "-" + substr(ls_date, 4, 2) + "-" + right(ls_date, 2); // 교육종료일

        if (!lb_BarcodeCheck) {
            edJubsuNo.Text = lpad((toNumber(ds_oTrainingOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 6); // 접수번호
            lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.

            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
            // 그리드 초기화
            ds_oJubsuAllInfo.ClearData();
            gdJubsuInfo.NoDataText = "";
            ds_oOrderHist.ClearData();
            gdOrderHist.NoDataText = "";
            ds_oSetlmentHist.ClearData();
            gdSetlmentHist.NoDataText = "";
            btnSetlmt.Enable = false; // 결제(POS) 버튼
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = false;
            btnChangeProcDate.Enable = false;
            btnPrintReRct.Enable = false;
        } else {
            if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
                edJubsuNo.Text = lpad((toNumber(ds_oTrainingOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 6); // 접수번호
                lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.
            }
        }
    } else {
        gfn_Alert("접수할 회차정보가 없습니다. 다시 선택해 주십시오.");
        lfn_Cancel();
    }

    lb_BarcodeCheck = false;
    edJubsuNo.SetFocus();
}

/*
 * 기능 : 접수자목록을 조회한다.
 * parameter : sOrderMgno - 회차관리번호
 *             sJubsuNo - 접수번호
 *             sLikeYn - LIKE 검색 여부
 * return value : 강습접수자목록 정보를 가진 배열 오브젝트
 */
function lfn_SearchTrainingJubsuList(obj) {
    var ls_HistoryArg = "";
    var ls_SearchArg = "";
    if (lb_BarcodeCheck) {
        if (gfn_IsNUll(ls_RetTjmgno)) {
            ls_HistoryArg = "바코드=" + medBarCode.Value;
            ls_SearchArg = "BARCODE=" + quote(medBarCode.Value);
        } else {
            ls_HistoryArg = "접수관리번호=" + ls_RetTjmgno;
            ls_SearchArg = "TJMGNO=" + quote(ls_RetTjmgno);
            ls_RetTjmgno = "";
        }
    } else {
        if (gfn_IsNull(ms_TrainingMgno)
                || gfn_IsNull(edJubsuNo.Text)) {
            return false;
        }

        ls_HistoryArg = "회차관리번호=" + ms_TrainingMgno
            + ", 접수번호=" + lpad(edJubsuNo.Text, "0", 6);
        ls_SearchArg = "TOMGNO=" + quote(ms_TrainingMgno)
            + " TOHJUBSUNO=" + quote(lpad(edJubsuNo.Text, "0", 6));
    }

    // 조회이력을 저장한다.
    gfn_InsertSearchPrintHistory(
            "S"
            , this.ID
            , global.mnuLeft.cbxOpenForm.Text
            , ls_HistoryArg
        );

    ds_ioTrainingJubsu.ClearData(); // 데이타셋 초기화
    lfn_SetChangedJubsuInfo(true);

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingJubsuList", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_ioTrainingJubsu=ds_oTrainingJubsu"    // outDs
        ,ls_SearchArg
        ,"lfn_AfterSearchTrainingJubsuList"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 접수자목록 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchTrainingJubsuList(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_ioTrainingJubsu.GetCount() > 0) {
        cbxJibu.Value = ds_ioTrainingJubsu.GetColumn(0, "MGJIBUCD"); // 지부
        edTrainingYear.Text = ds_ioTrainingJubsu.GetColumn(0, "YEAR"); // 년도
        radCourse.Value = ds_ioTrainingJubsu.GetColumn(0, "COURSEMUNJECD"); // 직능
        edTrainingOrder.Text = ds_ioTrainingJubsu.GetColumn(0, "TORDER"); // 회차
        edJubsuNo.Text = ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO"); // 접수번호
        edSeatNo.Text = ds_ioTrainingJubsu.GetColumn(0, "DECISIONSEATNO"); // 확정좌석번호
        ls_OldSeatNo = edSeatNo.Text; // 기존 좌석번호

        medBarCode.Value = ds_ioTrainingJubsu.GetColumn(0, "BARCODE"); // 바코드
        // 실명인증 버튼 활성/비활성
        if (ds_ioTrainingJubsu.GetColumn(0, "BARCODE") == "Y") {
            btnAuthResidentNo.Enable = false;
        } else {
            btnAuthResidentNo.Enable = true;
        }
        // 최근사진
        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "IILASTREALNM"))) {
            imgLastestPicture.Text = "최근사진";
            imgLastestPicture.ImageID = "";
        } else {
            imgLastestPicture.Text = "";
            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioTrainingJubsu.GetColumn(0, "IILASTDIRPATH") + "/" + ds_ioTrainingJubsu.GetColumn(0, "IILASTREALNM");
        }
        // 사진
        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "IIREALNM"))) {
            imgPicture.Text = "사진";
            imgPicture.ImageID = "";
        } else {
            imgPicture.Text = "";
            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems" + ds_ioTrainingJubsu.GetColumn(0, "IIDIRPATH") + "/" + ds_ioTrainingJubsu.GetColumn(0, "IIREALNM");
            ls_OldPictureNo = ds_ioTrainingJubsu.GetColumn(0, "IIIMGSEQ"); // 기존 사진번호
        }
        // 적요 처리
        cbxRemarkGubun_OnChanged(cbxRemarkGubun, ds_ioTrainingJubsu.GetColumn(0, "REMARKCD"));

        // 결제(POS) 버튼
        if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정
            btnSetlmt.Enable = true; // 결제(POS) 버튼
        }

        lfn_SearchTrainingSetlmentHistList(); // 결제내역 조회
    } else {
        if (ds_oTrainingOrderMgno.GetColumn(0, "TOSEATCNT") <= ds_oTrainingOrderMgno.GetColumn(0, "JUBSUCNT")) {
            gfn_Alert("접수인원수를 초과하였습니다.");
        }

        lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
        // 그리드 초기화
        ds_oJubsuAllInfo.ClearData();
        gdJubsuInfo.NoDataText = "";
        ds_oOrderHist.ClearData();
        gdOrderHist.NoDataText = "";
        ds_oSetlmentHist.ClearData();
        gdSetlmentHist.NoDataText = "";
        btnSetlmt.Enable = false; // 결제(POS) 버튼
        btnProcRct.Enable = false;
        btnShowVirtualAccount.Enable = false;
        btnPosResultList.Enable = false;
        btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;

        lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.
    }

    if (lb_BarcodeCheck) {
        lfn_SearchTrainingOrderMgno();
    }

    if (!gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        lfn_SearchTrainingJubsuAllInfoList(); // 개인접수정보 조회
    }

    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "N") { // 회차변경여부
        lfn_SetChangedJubsuInfo(false);
    }

    lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경
    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
    edPersonNm.SetFocus();
}

/*
 * 기능 : 강습접수자목록 팝업을 호출한다.
 * parameter : sOrderMgno - 회차관리번호
 *             sJubsuNo - 접수번호
 *             sLikeYn - LIKE 검색 여부
 * return value : 강습접수자목록 정보를 가진 배열 오브젝트
 */
function lfn_TrainingJubsuListPopup(sOrderMgno, sJubsuNo, sLikeYn) {
    var sArg = "sOrderMgno=" + quote(sOrderMgno);
    sArg += " sJubsuNo=" + quote(sJubsuNo);
    sArg += " sLikeYn=" + quote(sLikeYn);

    var arrTjmgno = Dialog("training::frmtraining0021PTrainingJubsuList.xml", sArg, 600, 400, "", -1, -1);
    if (length(arrTjmgno) > 0) {
        ls_RetTjmgno = arrTjmgno[0];  // 접수관리번호
        lb_BarcodeCheck = true;
        lfn_SearchTrainingJubsuList();
    } else {
        ls_RetTjmgno = "";
    }
}

/*
 * 기능 : 빈번호를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchUnUseJubsuNo(obj) {
    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";
        edTrainingOrder.SetFocus();
        return false;
    }

    ds_oJubsuNo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchUnUseTrainingJubsuNo", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oJubsuNo=ds_oJubsuNo"    // outDs
        ,"TOMGNO=" + quote(ms_TrainingMgno)
        ,"lfn_AfterSearchUnUseTrainingJubsuNo"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 빈번호 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchUnUseTrainingJubsuNo(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;
	btnPosResultList.Enable = false;
	btnChangeProcDate.Enable = false;
	btnPrintReRct.Enable = false;

    var ln_TotalCnt = ds_oJubsuNo.GetCount();
    if (ln_TotalCnt > 0) {
        for (var i = 1; i <= ln_TotalCnt; i++) {
            if (lpad(i, "0", 6) <> ds_oJubsuNo.GetColumn(i - 1, "TOHJUBSUNO")) {
                edJubsuNo.Text = lpad(i, "0", 6); // 접수번호
                lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.
                return true;
            }
        }
        edJubsuNo.Text = lpad((toNumber(ds_oTrainingOrderMgno.GetColumn(0, "MAXJUBSUNO")) + 1), "0", 6); // 접수번호
    } else {
        edJubsuNo.Text = "000001"; // 접수번호
    }

    lfn_SearchUnUseSeatNo(); // 빈좌석번호를 조회한다.
}

/*
 * 기능 : 빈좌석번호를 조회한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_SearchUnUseSeatNo(obj) {
    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";
        edTrainingOrder.SetFocus();
        return false;
    }

    ds_oSeatNo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchUnUseTrainingSeatNo", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oSeatNo=ds_oSeatNo"    // outDs
        ,"TOMGNO=" + quote(ms_TrainingMgno)
        ,"lfn_AfterSearchUnUseTrainingSeatNo"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 빈좌석번호 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchUnUseTrainingSeatNo(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    var ln_TotalCnt = ds_oSeatNo.GetCount();
    if (ln_TotalCnt > 0) {
        edSeatNo.Text = toNumber(ds_oSeatNo.GetColumn(0, "TOHDECISIONSEATNO")); // 접수좌석번호
    } else {
        edSeatNo.Text = 1; // 접수좌석번호
    }
}

/*
 * 기능 : 좌석목록 팝업을 호출한다.
 * parameter : sOrderMgno - 회차관리번호
 * return value : 좌석목록 정보를 가진 배열 오브젝트
 */
function lfn_SearchUnUseSeatNoListPopup(sOrderMgno) {
    var sArg = "sOrderMgno=" + quote(sOrderMgno);
    var arrSeatNo = Dialog("training::frmtraining0023PTrainingSeatNoList.xml", sArg, 600, 400, "", -1, -1);
    if (length(arrSeatNo) > 0) {
        edSeatNo.Value = arrSeatNo[0];
    }
}

/*
 * 기능 : 접수자 기본 정보를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchPersonNm() {
    var arrTrainingPerson = gfn_TrainingPersonListPopup(edPersonNm.Text, medResidentNo.Value); // 고객 조회 팝업
    if (length(arrTrainingPerson) > 0) {
        edPersonNm.text = arrTrainingPerson[0];
        medResidentNo.Value = arrTrainingPerson[1];
        ms_TrainingPersonMgno = arrTrainingPerson[2];
        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", arrTrainingPerson[2]);
        edTel.Text = arrTrainingPerson[3];
        edHpTel.Text = arrTrainingPerson[4];
        edEmail.text = arrTrainingPerson[5];
        edEmailDomain.Value = arrTrainingPerson[6];
        ds_ioTrainingJubsu.SetColumn(0, "LASTIMGSEQ", arrTrainingPerson[8]);
        medZipCode.Value = arrTrainingPerson[12];
        edAddr1.text = arrTrainingPerson[13];
        edAddr2.text = arrTrainingPerson[14];

        //실명인증 버튼
        var ls_AuthYn = arrTrainingPerson[9]; // 실명인증여부
        if (ls_AuthYn == "Y") {
            ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "Y");
            btnAuthResidentNo.Enable = false;
            edAddr1.SetFocus();
        } else {
            btnAuthResidentNo.Enable = true;
            btnAuthResidentNo_OnClick();
        }

        // 최근사진
        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ"))) {
            imgLastestPicture.Text = "최근사진";
            imgLastestPicture.ImageID = "";
        } else {
            imgLastestPicture.Text = "";
            imgLastestPicture.ImageID = GF_FILE_SERVER_URL + "kems" + arrTrainingPerson[10] + "/" + arrTrainingPerson[11];
        }
    } else {
        medResidentNo.SetFocus();
    }

    lfn_CheckTrainingJubsuAlready(); // 기접수여부 조회
    lfn_CheckTrainingJubsuEduIng(); // 교육중여부 조회
}

/*
 * 기능 : 개인접수정보를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchTrainingJubsuAllInfoList(obj) {
    ds_oJubsuAllInfo.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingJubsuAllInfoList", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oJubsuAllInfo=ds_oJubsuAllInfo" // outDs
        , "TPMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO")) // args
        , "lfn_AfterSearchTrainingJubsuAllInfoList"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 개인접수정보 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
var ln_TotalGridInfoCount = 0;
function lfn_AfterSearchTrainingJubsuAllInfoList(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }
    ln_TotalGridInfoCount = ds_oJubsuAllInfo.GetCount();

    gfn_SearchMessage(gdJubsuInfo); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

    lfn_SearchTrainingOrderHistList(); // 회차변경이력 조회
}

/*
 * 기능 : 회차변경이력를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchTrainingOrderHistList(obj) {
    ds_oOrderHist.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingOrderHistList", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oOrderHist=ds_oOrderHist" // outDs
        , "TJMGNO=" + quote(ds_oJubsuAllInfo.GetColumn(ds_oJubsuAllInfo.currow, "TJMGNO")) // args
        , "lfn_AfterSearchTrainingOrderHistList"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 회차변경이력 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
var ln_TotalGridOrderCount = 0;
function lfn_AfterSearchTrainingOrderHistList(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    ln_TotalGridOrderCount = ds_oOrderHist.GetCount();

    gfn_SearchMessage(gdOrderHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

/*
 * 기능 : 결제내역를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchTrainingSetlmentHistList(obj) {
    ds_oSetlmentHist.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingSetlmentHistList", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oSetlmentHist=ds_oSetlmentHist" // outDs
        , "TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args
        , "lfn_AfterSearchTrainingSetlmentHistList"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 결제내역 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
var ln_TotalGridSetlementCount = 0;
function lfn_AfterSearchTrainingSetlmentHistList(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    ln_TotalGridSetlementCount = ds_oSetlmentHist.GetCount();
    if (ln_TotalGridSetlementCount == 0) {
        btnPosResultList.Enable = false;
        btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;
        btnShowVirtualAccount.Enable = false;
        btnShowVirtualAccount.Enable = false;
    }
    gfn_SearchMessage(gdSetlmentHist); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.
}

/*
 * 기능 : 버튼 활성/비활성시킨다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetFormAuth(bStatus) {
    btnDelete.Enable = bStatus; // 삭제 버튼
    btnSave.Enable = bStatus; // 수정&저장 버튼
}

/*
 * 기능 : 접수자 기본 정보를 초기화한다.
 * parameter : 없음
 * return : 없음
 */
function lfn_InitJubsuBaseInfo() {
    lfn_SetChangedJubsuInfo(true);
    ds_oTrainingJubsuResult.ClearData();

    ds_ioTrainingJubsu.ClearData();
    ds_ioTrainingJubsu.InsertRow(0);

    cbxEmailDomain.Value = "";
    cbxRemarkGubun.Value = "";
    // 적요
    edRemark.Text = "";
    edRemark.Enable = false;
    // 실명인증버튼
    lb_IsNiceCheckOk = false;
    btnAuthResidentNo.Text = "실명인증";
    btnAuthResidentNo.Enable = true;
    // 사진
    imgLastestPicture.ImageID = "";
    imgLastestPicture.Text = "최근사진";
    imgPicture.ImageID = "";
    imgPicture.Text = "사진";
    ds_ioTrainingJubsu.ApplyChange();

    ls_UploadRealName = ""; // 사진이미지 실제파일명
    lb_FileUpload = false; // 사진등록여부
    lb_BarcodeCheck = false; // 바코드로 조회 여부
    ls_OldSeatNo = ""; // 기존 좌석번호
    ls_OldPictureNo = ""; // 기존 사진번호
    ls_IsChangedJubsuInfoYn = "N"; // 접수자기본정보 변경여부
    ls_IsChangedSeatNoYn = "N"; // 좌석번호 변경여부
    ls_IsChangedPictureYn = "N"; // 사진 변경여부

    medBarCode.Value = ""; // 바코드

    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부
}

/*
 * 기능 : 강습접수자정보를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_SearchTrainingPearsonMgno(obj) {
    ds_oTrainingPearson.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingPearsonMgno", false);
    // 서버 호출
    tit_callService(
        ""
        , ""
        , "" // inDs
        , "ds_oTrainingPearson=ds_oTrainingPearson" // outDs
        , "TPNM=" + quote(edPersonNm.Text) // args
            + " TPRESIDENTNO=" + quote(medResidentNo.Value) // args
        , ""
        ,false
        ,false
        ,true
    );

    if (ds_oTrainingPearson.GetCount() == 1) {
        ms_TrainingPersonMgno = ds_oTrainingPearson.getcolumn(0, "TPMGNO");
        ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", ds_oTrainingPearson.getcolumn(0, "TPMGNO"));
    }
}

/*
 * 기능 : 회차변경된 정보 상태변경한다.
 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)
 * return : 없음
 */
function lfn_SetChangedJubsuInfo(bStatus) {
    if (bStatus) {
        shpGubunBox3.BkColor = "";
    } else {
        shpGubunBox3.BkColor = "user18";
    }

    if (bStatus && ms_FormAuth == "W") { // 권한에 따른 버튼 설정
        btnSave.Enable = true;
        btnDelete.Enable = true;
    } else {
        btnSave.Enable = false;
        btnDelete.Enable = false;
    }

    btnApplyPicture.Enable = bStatus; // 사진반영
    // btnCancel.Enable = bStatus; // 초기화
    // btnEnd.Enable = bStatus; // 종료
    // btnSearchPersonInfo.Enable = bStatus; // 기본정보
    btnSearchZipCode.Enable = bStatus; // 우편번호
    btnAuthResidentNo.Enable = bStatus; // 실명인증
    // btnAbsentManageLink.Enable = bStatus; // 결강관리
    btnTrainingJubsuModify.Enable = bStatus; // 회차변경
    // btnSeqList.Enable = bStatus; // 접수목록
    // btnSearchTrainingOrder.Enable = bStatus; // 접수가능회차
    // btnTraingJubsuHist.Enable = bStatus; // 접수정보
    // btnSeatList.Enable = bStatus; // 좌석목록
    // btnSmsStat.Enable = bStatus; // SMS현황
    // btnEmailStat.Enable = bStatus; // 이메일현황
    btnSearchRegPicture.Enable = bStatus; // 등록사진조회
    // btnBarCodeSearch.Enable = bStatus; // 바코드조회
    // btnUnUseJubsuNo.Enable = bStatus; // 빈좌석
    btnLoadPicture.Enable = bStatus; // 사진찾기
    btnLoadScanPicture.Enable = bStatus; // 스캔사진불러오기
    btnScanPicture.Enable = bStatus; // 사진스캔
    // btnPictureManagement.Enable = bStatus; // 사진관리
    btnShowVirtualAccount.Enable = bStatus; // 가상계좌보기
    // btnModifyHistory.Enable = bStatus; // 변경이력
    btnChangeProcDate.Enable = bStatus; // 처리일자변경
    btnProcRct.Enable = bStatus; // 현금영수증처리
    btnPrintReRct.Enable = bStatus; // 영수증재발행
    // btnSendSms.Enable = bStatus; // SMS 전송
    // btnSendEmail.Enable = bStatus; // 이메일 전송
    btnPosResultList.Enable = bStatus; // POS처리결과조회
    btnSetlmt.Enable = bStatus; // 결제(POS) 버튼
    btnPrintJubsu.Enable = bStatus; // 수강증출력 버튼
    btnPrint.Enable = bStatus; // 강습원서출력 버튼
    btnPrintJubsuResult.Enable = bStatus; // 강습접수결과출력 버튼

    // cbxJibu.Enable = bStatus;
    // edTrainingYear.Enable = bStatus;
    // radCourse.Enable = bStatus;
    // edTrainingOrder.Enable = bStatus;
    // edJubsuNo.Enable = bStatus;
    // edSeatNo.Enable = bStatus;
    // edPersonNm.Enable = bStatus;
    // medResidentNo.Enable = bStatus;
    // medBarCode.Enable = bStatus;

    edCompNm.Enable = bStatus;
    edAddr1.Enable = bStatus;
    edAddr2.Enable = bStatus;
    edTel.Enable = bStatus;
    edHpTel.Enable = bStatus;
    edEmail.Enable = bStatus;
    edEmailDomain.Enable = bStatus;
    cbxEmailDomain.Enable = bStatus;
    edRemark.Enable = false;
    cbxRemarkGubun.Enable = bStatus;
}

/*
 * 기능 : 업무 변경이력을 저장한다.
 * parameter : sGubun - 변경구분. 예) I, U, D
 * return : 없음
 */
function lfn_SaveModifyHistory(sGubun) {
    if (sGubun = "I") { // 신규
        gds_iModifyHistory.InsertRow(0);
        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분
        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_oTrainingJubsuResult.GetColumn(0, "RESULTTJMGNO")); // KEY값
        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명
        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값
        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값
    } else if (sGubun = "D") { // 삭제
        gds_iModifyHistory.InsertRow(0);
        gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분
        gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
        gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // KEY값
        gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ""); // 변경 컬럼명
        gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ""); // 변경 전 값
        gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ""); // 변경 후 값
    } else if (sGubun = "U") { // 수정
        var ln_TotalCount = ds_oModifyColumn.GetCount();
        var ls_ColumnCd = "";
        var ls_ColumnNm = "";
        for (var i = 0; i < ln_TotalCount; i++) {
            ls_ColumnCd = ds_oModifyColumn.GetColumn(i, "COLUMNCD");
            ls_ColumnNm = ds_oModifyColumn.GetColumn(i, "COLUMNNM");
            if (ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd) <> ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd)
                        && (!gfn_IsNull(ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd)) || !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd)))
                    ) {
                gds_iModifyHistory.InsertRow(0);
                gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분
                gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
                gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // KEY값
                gds_iModifyHistory.SetColumn(0, "MHCOLUMN", ls_ColumnNm); // 변경 컬럼명
                gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ds_ioTrainingJubsu.GetOrgBuffColumn(0, ls_ColumnCd)); // 변경 전 값
                gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", ds_ioTrainingJubsu.GetColumn(0, ls_ColumnCd)); // 변경 후 값

                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            }
        }
        // 좌석번호 변경
        if (ls_OldSeatNo <> edSeatNo.Text) {
            gds_iModifyHistory.InsertRow(0);
            gds_iModifyHistory.SetColumn(0, "MHWORKGUBUN", "강습접수"); // 업무구분
            gds_iModifyHistory.SetColumn(0, "MHGUBUN", sGubun); // 변경구분
            gds_iModifyHistory.SetColumn(0, "MHKEY", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")); // KEY값
            gds_iModifyHistory.SetColumn(0, "MHCOLUMN", "좌석번호"); // 변경 컬럼명
            gds_iModifyHistory.SetColumn(0, "MHBEFOREDATA", ls_OldSeatNo); // 변경 전 값
            gds_iModifyHistory.SetColumn(0, "MHAFTERDATA", edSeatNo.Text); // 변경 후 값

            ls_IsChangedSeatNoYn = "Y"; // 좌석번호 변경여부
        }
        // 사진 변경
        if (lb_FileUpload || ls_OldPictureNo <> ds_ioTrainingJubsu.GetColumn(0, "IIIMGSEQ")) {
            if (lb_FileUpload) {
                ls_IsChangedPictureYn = "Y"; // 사진 변경여부
                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            } else {
                ls_IsChangedJubsuInfoYn = "Y"; // 접수자기본정보 변경여부
            }
        }
    }

    gfn_InsertModifyHistory(); // 업무 변경이력을 저장한다.
}

/*
 * 기능 : 기접수여부를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_CheckTrainingJubsuAlready(obj) {
    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchCheckTrainingJubsuAlready", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs
        ,"TOMGNO=" + quote(ms_TrainingMgno)
            + " TPNM=" + quote(edPersonNm.Text)
            + " TPRESIDENTNO=" + quote(medResidentNo.Value)
        ,"lfn_AfterSearchCheckTrainingJubsuAlready"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 기접수여부 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchCheckTrainingJubsuAlready(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oTrainingCheck.GetCount() > 0) {
        if (ds_oTrainingCheck.GetColumn(0, "TOHJUBSUGUBUN") == "1") { // 내방_인터넷구분(1:내방,2:인터넷)
            gfn_Alert("내방으로 이미 접수하셨습니다.");
        } else {
            gfn_Alert("인터넷으로 이미 접수/신청 하셨습니다.");
        }

        ls_RetTjmgno = ds_oTrainingCheck.GetColumn(0, "TJMGNO");  // 접수관리번호
        lb_BarcodeCheck = true;
        lfn_SearchTrainingJubsuList();
    }
}

/*
 * 기능 : 교육중여부를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_CheckTrainingJubsuEduIng(obj) {
    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchCheckTrainingJubsuEduIng", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs
        ,"TOMGNO=" + quote(ms_TrainingMgno)
            + " TPNM=" + quote(edPersonNm.Text)
            + " TPRESIDENTNO=" + quote(medResidentNo.Value)
        ,"lfn_AfterSearchCheckTrainingJubsuEduIng"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 교육중여부 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchCheckTrainingJubsuEduIng(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (ds_oTrainingCheck.GetCount() > 0) {
        gfn_Alert("교육 중인 해당 직능의 다른 회차는 교육종료 후 접수가능하십니다.");
        ls_RetTjmgno = ds_oTrainingCheck.GetColumn(0, "TJMGNO");  // 접수관리번호
        lb_BarcodeCheck = true;
        lfn_SearchTrainingJubsuList();
    }
}

/*
 * 기능 : 수료한 교육이 있는지 조회한다.
 * parameter : 없음
 * Return : 있으면 true, 없으면 false
 */
function lfn_CheckTrainingJubsuEduPassed(obj) {
    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchCheckTrainingJubsuEduPassed", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs
        ,"TOMGNO=" + quote(ms_TrainingMgno)
            + " TPNM=" + quote(edPersonNm.Text)
            + " TPRESIDENTNO=" + quote(medResidentNo.Value)
        ,""
        ,false
        ,false
        ,true
    );

    if (ds_oTrainingCheck.GetCount() > 0) {
        return true;
    } else {
        return false;
    }
}

/*
 * 기능 : 수첩이 있는지 조회한다.
 * parameter : 없음
 * Return : 있으면 true, 없으면 false
 */
function lfn_CheckTrainingJubsuHaveSameCourseLcs(obj) {
    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchCheckTrainingJubsuHaveSameCourseLcs", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs
        ,"TOMGNO=" + quote(ms_TrainingMgno)
            + " TPNM=" + quote(edPersonNm.Text)
            + " TPRESIDENTNO=" + quote(medResidentNo.Value)
            + " TPMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))
        ,""
        ,false
        ,false
        ,true
    );

    if (ds_oTrainingCheck.GetCount() > 0) {
        return true;
    } else {
        return false;
    }
}

/*
 * 기능 : 위험물안전관리자 수첩여부를 조회한다.
 * parameter : 없음
 * return value : 없음
 */
function lfn_CheckTrainingJubsuHaveLcs(obj) {
    ds_oTrainingCheck.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchCheckTrainingJubsuHaveLcs", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,"" // inDs
        ,"ds_oTrainingCheck=ds_oTrainingCheck" // outDs
        ,"TPMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))
            + " TPNM=" + quote(edPersonNm.Text)
            + " TPRESIDENTNO=" + quote(medResidentNo.Value)
        ,"lfn_AfterSearchCheckTrainingJubsuHaveLcs"
        ,false
        ,false
        ,true
    );
}

/*
 * 기능 : 위험물안전관리자 수첩여부 조회 후 처리해야 할 내용
 * parameter : nErrorCode - 에러코드
 *             strErrorMsg - 에러메시지
 * Return : 없음
 */
function lfn_AfterSearchCheckTrainingJubsuHaveLcs(nErrorCode, strErrorMsg) {
    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.
        gfn_ErrorMsg(nErrorCode, strErrorMsg);
        return;
    }

    if (!(ds_oTrainingCheck.GetColumn(0, "LCSCNT") > 0)) { // 소유 수첩이 없는 경우
        gfn_Alert("위험물안전관리자 수첩을 소유지 않아, 2급방화관리자 면제과정을 접수할 수 없습니다.");
        radCourse.Value = "22N";
        lfn_SearchTrainingLatestOrder();
    }
}

/*
 * 기능 : 소속지부 버튼 변경
 * parameter : 없음
 * return value : 없음
 */
function lfn_ChangeJibuRadioButton() {
	if (gds_oUserInfo.GetColumn(0, "PDEPTCD") == cbxJibu.Value) { // 소속지부
        cbxJibu.Enable = false;
        radJibuGubun.Value = "S";
        radJibuGubun.BkColor = "";
	} else { // 타지부
        cbxJibu.Enable = true;
        radJibuGubun.Value = "T";
        radJibuGubun.BkColor = "red";
	}
}

/* 사용자 이벤트 함수 */
function lfn_SortGrid2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
    var lobj_Dataset = object(obj.BindDataset);
    // 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.
    if (lobj_Dataset.GetRowCount() > 1) {
 	    if (nCell > 0) {
            gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.
        }
    }
}

// 년도
function edTrainingYear_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
	if (nChar == 13) { // Enter key
        gfn_EnterNextFocus();
	} else {
        if (!gfn_IsNull(ms_TrainingMgno)) {
            ms_TrainingMgno = ""; // 강습관리번호

            // 시험정보
            lbTrainingInfo1.Text = "";
            lbTrainingInfo2.Text = "";

            edJubsuNo.Text = "";
            edSeatNo.Text = "";

            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
            // 그리드 초기화
            ds_oJubsuAllInfo.ClearData();
            gdJubsuInfo.NoDataText = "";
            ds_oOrderHist.ClearData();
            gdOrderHist.NoDataText = "";
            ds_oSetlmentHist.ClearData();
            gdSetlmentHist.NoDataText = "";
            btnSetlmt.Enable = false; // 결제(POS) 버튼
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = false;
            btnChangeProcDate.Enable = false;
            btnPrintReRct.Enable = false;
        }
	}
}

// 회차
function edTrainingOrder_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
	if (nChar == 13) { // Enter key
        btnSearchTrainingOrder.SetFocus();
        lfn_SearchTrainingOrderMgno(obj);
	} else {
        if (!gfn_IsNull(ms_TrainingMgno)) {
            ms_TrainingMgno = ""; // 강습관리번호

            // 시험정보
            lbTrainingInfo1.Text = "";
            lbTrainingInfo2.Text = "";

            edJubsuNo.Text = "";
            edSeatNo.Text = "";

            lfn_InitJubsuBaseInfo(); // 접수자 기본 정보 초기화
            // 그리드 초기화
            ds_oJubsuAllInfo.ClearData();
            gdJubsuInfo.NoDataText = "";
            ds_oOrderHist.ClearData();
            gdOrderHist.NoDataText = "";
            ds_oSetlmentHist.ClearData();
            gdSetlmentHist.NoDataText = "";
            btnSetlmt.Enable = false; // 결제(POS) 버튼
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = false;
            btnChangeProcDate.Enable = false;
            btnPrintReRct.Enable = false;
        }
	}
}

function edTrainingOrder_OnKillFocus(obj) {
    gfn_ComponentOnKillFocus(obj);

    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 3));

    lfn_SearchTrainingOrderMgno(); // 강습정보를 조회한다.
}

// 접수가능회차
function btnSearchTrainingOrder_OnClick(obj) {
    var arrTrainingOrder = gfn_TrainingOrderListPopup("Y", cbxJibu.Value, edTrainingYear.Text, radCourse.Value); // 교육일정관리목록 조회 팝업
    if (length(arrTrainingOrder) > 0) {
        ms_TrainingMgno = arrTrainingOrder[0];
        cbxJibu.Value = arrTrainingOrder[1];
        edTrainingYear.Text = arrTrainingOrder[2];
        radCourse.Value = arrTrainingOrder[3];
        edTrainingOrder.Text = arrTrainingOrder[4];
        lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경

        lfn_SearchTrainingOrderMgno(); // 강습회차관리번호를 조회한다.
    } else {
        lfn_cancel();
    }
}

// 접수번호
function edJubsuNo_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
	if (nChar == 13) { // Enter key
        btnSeqList.SetFocus();
        lfn_SearchTrainingJubsuList(obj);
	}
}

function edJubsuNo_OnKillFocus(obj) {
    gfn_ComponentOnKillFocus(obj);

    obj.Text = iif(gfn_IsNull(obj.Text), "", lpad(obj.Text, "0", 6));
}

// 접수목록
function btnSeqList_OnClick(obj) {

    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";
        edTrainingOrder.SetFocus();
        return false;
    }

    lfn_TrainingJubsuListPopup(ms_TrainingMgno, edJubsuNo.Text, iif(gfn_IsNull(edJubsuNo.Text), "", "Y")); // 교육접수자목록 조회 팝업
}

// 좌석목록
function btnSeatList_OnClick(obj) {
    if (gfn_IsNull(ms_TrainingMgno)) {
        gfn_Alert(MSGI00100); // "강습을 먼저 선택해 주십시오.";
        edTrainingOrder.SetFocus();
        return false;
    }

    lfn_SearchUnUseSeatNoListPopup(ms_TrainingMgno); // 빈좌석번호를 조회한다.
}

// 결강자관리
function btnAbsentManageLink_OnClick(obj) {
    gs_SystemGubun = "training";
    gs_SystemMenuId = "0000000003";
    global.mnuLeft.tabMenu.tabpgMenu.Text = "강습관리";
    var ls_MenuId = "0000000043";
    var ls_MenuTitle = "결강자관리";
    var ls_MenuUrl = "training::frmtraining0040MTrainingAbsentManagement.xml";

    global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);
    gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId);
}

// 회차변경
function btnTrainingJubsuModify_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        edJubsuNo.SetFocus();
        return false;
    }
    if (left(GetDAte(), 8) > ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE")) {
        gfn_Alert("교육시작일이 지나서 회차변경하실 수 없습니다.");
        return false;
    }
    if (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") <> "N") { // 수납상태가 아니면
        gfn_Alert("수납 상태가 아니므로 회차변경할 수 없습니다.");
        return false;
    }
    // 2009.10.09 이길호 주임 요청
    if ((ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "13"
            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "23"
            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "15"
            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "25") // 가상계좌이면서
            && (ds_oSetlmentHist.GetColumn(0, "TSSETLMTYN") == "N")) { // 결제여부가 'N'인 경우
        gfn_Alert("가상계좌 결제처리 중 입니다.");
        return false;
    }

    var sArg = "sJibu=" + quote(cbxJibu.Text);
    sArg += " sJibuCd=" + quote(cbxJibu.Value);
    sArg += " sCourse=" + quote(ds_oCourse.GetColumn(ds_oCourse.FindRow("CD", radCourse.Value), "DATA"));
    sArg += " sCourseCd=" + quote(radCourse.Value);
    sArg += " sYear=" + quote(edTrainingYear.Text);
    sArg += " sOrder=" + quote(edTrainingOrder.Text);
    sArg += " sTjmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));
    sArg += " sTomgno=" + quote(ms_TrainingMgno);

    return Dialog("training::frmtraining0022PTrainingOrderChange.xml", sArg, 800, 400, "", -1, -1);

    lfn_ChangeJibuRadioButton(); // 소속지부 버튼 변경
}

// 성명
function edPersonNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
   if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13) || (nChar == 229)){ // (Ctrl + C)가 아니면
        if (nChar == 13) {
            btnAuthResidentNo.SetFocus();
            lfn_SearchPersonNm();
        } else {
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
                lfn_ResetPerson();
                medResidentNo.Value = "";
            }
        }
    }
}

// 기본정보
function btnSearchPersonInfo_OnClick(obj) {
    lfn_SearchPersonNm();
}

// 주민등록번호
function medResidentNo_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {
    if ((!bCtrl && !bShift && !bAlt && !(bCtrl && nChar == 67) && nChar <= 90) || (nChar == 13)){ // (Ctrl + C)가 아니면
        if (nChar == 13) {
            btnAuthResidentNo.SetFocus();
            btnAuthResidentNo_OnClick(); // 실명인증
        } else {
            if (radChangeTpmgno.Value == "S" && !gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
                lfn_ResetPerson();
            }
        }
    }
}

function lfn_ResetPerson() {
    radChangeTpmgno.Value = "S"; // 성명/주민번호변경 여부

    lfn_SetChangedJubsuInfo(true);
    ds_ioTrainingJubsu.SetColumn(0, "TJMGNO", ""); // 접수관리번호
    ms_TrainingPersonMgno = "";
    ds_ioTrainingJubsu.SetColumn(0, "TPMGNO", "");
    medZipCode.Value = "";
    edAddr1.Text = "";
    edAddr2.Text = "";
    edCompNm.Text = "";
    edTel.Text = "";
    edHpTel.Text = "";
    edEmail.text = "";
    edEmailDomain.Value = "";
    ds_ioTrainingJubsu.SetColumn(0, "LASTIMGSEQ", "");

    //실명인증 버튼
    btnAuthResidentNo.Text = "실명인증";
    btnAuthResidentNo.Enable = true;
    ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "");

    // 최근사진
    imgLastestPicture.Text = "최근사진";
    imgLastestPicture.ImageID = "";

    // 그리드 초기화
    ds_oJubsuAllInfo.ClearData();
    gdJubsuInfo.NoDataText = "";
    ds_oOrderHist.ClearData();
    gdOrderHist.NoDataText = "";
    ds_oSetlmentHist.ClearData();
    gdSetlmentHist.NoDataText = "";
    btnSetlmt.Enable = false; // 결제(POS) 버튼
    btnProcRct.Enable = false;
    btnShowVirtualAccount.Enable = false;
    btnPosResultList.Enable = false;
    btnChangeProcDate.Enable = false;
    btnPrintReRct.Enable = false;
}

// 실명인증
var lb_IsNiceCheckOk = false;
function btnAuthResidentNo_OnClick(obj) {
    if (gfn_IsNull(ds_oTrainingPearson.getcolumn(0, "TPMGNO"))) {
        lfn_SearchTrainingPearsonMgno(); // 강습자정보를 조회한다.
    }

    lb_IsNiceCheckOk = gfn_CheckNice(edPersonNm.Text, medResidentNo.Value); // 실명인증
    if (lb_IsNiceCheckOk) {
        btnAuthResidentNo.Text = "실명인증완료";
        btnAuthResidentNo.Enable = false;
        ds_ioTrainingJubsu.SetColumn(0, "AUTHYN", "Y");
        edAddr1.SetFocus();
    } else {
        btnAuthResidentNo.Text = "실명인증";
        btnAuthResidentNo.Enable = true;
        medResidentNo.SetFocus();
    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        if (radCourse.Value == "22Y") { // 2급방화관리자 면제과정이면
            lfn_CheckTrainingJubsuHaveLcs(); // 위험물안전관리자 수첩여부를 조회
        }
    
        if (radCourse.Value == "22Y") { // 2급방화관리자 면제과정이면
            lfn_CheckTrainingJubsuHaveLcs(); // 위험물안전관리자 수첩여부를 조회
        }    
        lfn_CheckTrainingJubsuAlready(); // 기접수여부 조회
        lfn_CheckTrainingJubsuEduIng(); // 교육중여부 조회
    }
}

// 접수정보
function btnTraingJubsuHist_OnClick(obj) {
    if (gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medResidentNo.Value)) {
        gfn_Alert("성명이나 주민등록번호를 입력해 주십시오.");
        edPersonNm.SetFocus();
        return false;
    }

    var sArg = "sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sResidentNo=" + quote(medResidentNo.Value);
    var arrTjmgno = Dialog("training::frmtraining0024PTrainingJubsuHistList.xml", sArg, 600, 400, "", -1, -1);
    if (length(arrTjmgno) > 0) {
        ls_RetTjmgno = arrTjmgno[0];  // 접수관리번호
        lb_BarcodeCheck = true;
        lfn_SearchTrainingJubsuList();
    } else {
        ls_RetTjmgno = "";
    }
}

// 변경이력
function btnModifyHistory_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        return false;
    }

	gfn_ModifyHistoryListPopup("강습접수", ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));
}

// 우편번호
function edZipCode_OnFocus(obj) {

    btnSearchZipCode.SetFocus();
}

// 우편번호
function btnSearchZipCode_OnClick(obj) {
    var arrZipCode = gfn_ZipCodeListPopup(); // 우편번호 조회 팝업
    if (length(arrZipCode) > 0) {
        medZipCode.Value = arrZipCode[0];
        edAddr1.Text = arrZipCode[1];
        edAddr2.SetFocus();
    }
}

// 주소1
function edAddr1_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
    if (nChar == 13) {
        btnSearchZipCode.SetFocus();
        var arrZipCode = gfn_ZipCodeListPopup(edAddr1.Text); // 우편번호 조회 팝업
        if (length(arrZipCode) > 0) {
            medZipCode.Value = arrZipCode[0];
            edAddr1.Text = arrZipCode[1];
            edAddr2.SetFocus();
        } else {
            edAddr1.SetFocus();
        }
    }
}

// E-Mail
function cbxEmailDomain_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
    if (strText == "직접입력") {
        edEmailDomain.Enable = true;
        edEmailDomain.Value = "";
        edEmailDomain.SetFocus();
    } else {
        edEmailDomain.Value = cbxEmailDomain.Value;
        edEmailDomain.SetFocus();
    }
}

// SMS발송
function btnSendSms_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    if (gfn_IsNull(edHpTel.Text)) {
        gfn_Alert("발송할 휴대폰번호가 존재하지 않습니다.");
        return false;
    }

    var arrSms = gfn_SendOneSmsPopup("21" // 강습접수
                    , edHpTel.Text, edPersonNm.Text
                    , ds_ioTrainingJubsu.GetColumn(0, "TOMGNO")
                    , ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
                    , ds_ioTrainingJubsu.GetColumn(0, "JUBSUNO")
                ); // 단일문자메시지발송 팝업
}

// 적요
function cbxRemarkGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
    if (gfn_IsNull(strCode)) {
        cbxRemarkGubun.Value = "";
        edRemark.Enable = false;
        edRemark.Text = "";
    } else {
        edRemark.Enable = true;
    }
}

// 결제(POS)
function btnSetlmt_OnClick(obj) {
    // 2009.10.01 이길호 주임 요청
    if ((ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "13"
            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "23"
            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "15"
            || ds_oSetlmentHist.GetColumn(0, "TSGUBUN") == "25") // 가상계좌이면서
            && (ds_oSetlmentHist.GetColumn(0, "TSSETLMTYN") == "N")) { // 결제여부가 'N'인 경우
        gfn_Alert("가상계좌 결제처리 중 입니다.");
        return false;
    }

    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }

    if (left(GetDate(), 8) >= left(AddDate(ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"), 365), 8)) {
        gfn_Alert("교육시작일로부터 1년이 지났습니다.");
        return false;
    }
    if (ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '5' // 5:환불신청(미입금)
            || ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '6') { // 6:환불접수(신청확인)
        gfn_Alert("인터넷 환불 처리 중입니다.");
        return false;
    }

    if ((ds_ioTrainingJubsu.GetColumn(0, "PASSYN") == "Y")  // 수료여부
            && (ds_ioTrainingJubsu.GetColumn(0, "LASTSUNAPGUBUN") == "N")) { // 최종수납구분:수납
        if (!gfn_Confirm("[수료처리]된 자료입니다.\n[카드 등 납부방법 변경]이 아닌 경우, [수료취소처리]됩니다.\n그래도, 환불처리 하시겠습니까?")) {
            return false;
        }
    }

    var ls_Key1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"); // KEY값1-접수관리번호
    var ls_Key2 = ""; // KEY값2

    // 통합영수증발급(POS)시스템 팝업을 호출한다.
    var arrPos = gfn_TrainingPOSPopup("21", ls_Key1, ls_Key2);

    if (arrPos[0] == "OK") {
        if (arrPos[1] = "0") { // 수납이면
            btnPrintJubsu_OnClick(); // 수강증 출력
        }
    }

    if (arrPos[0] <> "END") {
        lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.
    }
}

// 개인접수정보
function ds_oJubsuAllInfo_OnRowPosChanged(obj,nOldRow,nRow) {
    if (nRow <> -1) {
        lfn_SearchTrainingOrderHistList(); // 회차변경이력 조회
    }
}

// 바코드 검색
function medBarCode_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam) {
	if (nChar == 13) {
        btnBarCodeSearch.SetFocus();
        btnBarCodeSearch_OnClick();
    }
}

function btnBarCodeSearch_OnClick(obj) {
    if (gfn_IsNull(medBarCode.Value)) {
        gfn_Alert("바코드를 입력해 주십시오.");
        medBarCode.SetFocus();
        return false;
    }
    if (length(medBarCode.Value) <> 12) {
        gfn_Alert("바코드를 12자리 숫자로 정확히 입력해 주십시오.");
        medBarCode.SetFocus();
        return false;
    }

	lb_BarcodeCheck = true;
	lfn_SearchTrainingJubsuList();
}

/*
 * 사진관리 링크
 */
function btnPictureManagement_OnClick(obj) {
    gs_SystemGubun = "training";
    gs_SystemMenuId = "0000000003";
    global.mnuLeft.tabMenu.tabpgMenu.Text = "강습관리";
    var ls_MenuId = "0000000120";
    var ls_MenuTitle = "사진관리";
    var ls_MenuUrl = "training::frmtraining9100MPictureManagement.xml";
    var sArg = "sPersonNm=" + quote(edPersonNm.Text)
        + " sResidentNo=" + quote(medResidentNo.Value);

    global.mnuTop.tabTopMenu.TabIndex = gds_oTopMenu.FindRow("MSYSGUBUN", gs_SystemGubun);
    gfn_OpenChildWindow(ls_MenuUrl, ls_MenuTitle, ls_MenuId, sArg);
}

/*
 * 최근사진반영
 */
function btnApplyPicture_OnClick(obj) {
	if (gfn_IsNull(imgLastestPicture.ImageID)) {
        gfn_Alert("최근사진 등록을 먼저 해주십시오.");
        return false;
	}

	imgPicture.ImageID = imgLastestPicture.ImageID;
	imgPicture.Text = "";
	lb_FileUpload = false;
	ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ"));
}

/*
 * 사진찾기
 */
function btnLoadPicture_OnClick(obj) {
    fdImage.Type = "OPEN";
    if (fdImage.open()) {
        fiImageFile = fdImage.FilePath + "\\" + fdImage.FileName;
        fiImageFile.Open("rb");

        var ln_ImageSize = fiImageFile.GetLength();
        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
        if (ln_ImageSize > 300) {
            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");
            return false;
        }
        ds_ioTrainingJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());

        imgPicture.ImageID = fdImage.FilePath + "\\" + fdImage.FileName;
        imgPicture.Text = "";
        lb_FileUpload = true;

        ls_UploadRealName = left(medResidentNo.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);
        ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ") + 1);
        ds_ioTrainingJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);
        ds_ioTrainingJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);
        ds_ioTrainingJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);
    }
}

// 등록사진조회
function btnSearchRegPicture_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
        gfn_Alert("이미지 정보가 없습니다.");
        return;
    }
    var sArg = "sTpMgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));
    sArg += " sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sResidentNo=" + quote(medResidentNo.Value);
    var arrImage = Dialog("training::frmtraining0255PTrainingPersonPicture.xml", sArg, 536, 440, "", -1, -1); // 고객 사진 조회

    if (length(arrImage) > 0) {
        if (ds_ioTrainingJubsu.GetColumn(0, "IIIMGSEQ") <> arrImage[0]) {
            ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", arrImage[0]);
            imgPicture.Text = "";
            imgPicture.ImageID = GF_FILE_SERVER_URL + "kems"
                + arrImage[1]
                + "/" + arrImage[2];
        }
    }
}

/*
 * 스캔실행
 */
function btnScanPicture_OnClick(obj) {
	ExecProc(gs_ScanProgramName);
}

/*
 * 스캔사진불러오기
 */
function btnLoadScanPicture_OnClick(obj) {
    var ls_File = split(gs_ScanFileName,"\\");

    fdImage.FilePath = left(gs_ScanFileName, length(gs_ScanFileName) - length(ls_File[length(ls_file) - 1]));
    fdImage.FileName = ls_File[length(ls_file) - 1];

    fiImageFile.FileName = gs_ScanFileName;
    if (fiImageFile.Open()) {
        fiImageFile.Open("rb");

        var ln_ImageSize = fiImageFile.GetLength();
        ln_ImageSize = ln_ImageSize / 1024; // KB로 변경
        if (ln_ImageSize > 300) {
            gfn_Alert("사진 이미지 사이즈가 300KB를 넘겼습니다.\n이미지 사이즈 : " + NumFormat(ln_ImageSize) + "KB");
            return false;
        }

        ds_ioTrainingJubsu.SetColumn(0, "IIIMGBINARY", fiImageFile.ReadBinary());
        fiImageFile.Close();
    } else {
        gfn_Alert("스캔 이미지가 없습니다.");
        return;
    }

    imgPicture.ImageID = gs_ScanFileName;
    imgPicture.Text = "";
    lb_FileUpload = true;

    ls_UploadRealName = left(medResidentNo.Value, 7) + "_" + GetDate() + right(timem(), 3) + gfn_GetFileExtensionName(fdImage.FileName);
    ds_ioTrainingJubsu.SetColumn(0, "IIIMGSEQ", ds_ioTrainingJubsu.GetColumn(0, "LASTIMGSEQ") + 1);
    ds_ioTrainingJubsu.SetColumn(0, "IIDIRPATH", ls_FileUploadPath);
    ds_ioTrainingJubsu.SetColumn(0, "IIREALNM", ls_UploadRealName);
    ds_ioTrainingJubsu.SetColumn(0, "IISAVENM", ls_UploadRealName);
}

// 결제내역
function ds_oSetlmentHist_OnRowPosChanged(obj,nOldRow,nRow) {
    if (ds_ioTrainingJubsu.GetColumn(0, "LASTYN") == "Y") { // 회차변경여부
        var ls_PaymentGubun = obj.GetColumn(nRow, "PMPAYMENTFLAG"); // 납입방법
        var ls_SunapGubun = obj.GetColumn(nRow, "TSGUBUNCD"); // 수납구분
        var ln_RepayRefNo = obj.GetColumn(nRow, "TSREPAYREF"); // 환불번호
        if (ls_PaymentGubun == "0") { // 현금
            btnProcRct.Text = "현금영수증처리";
            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
                btnProcRct.Enable = true;
            } else {
                btnProcRct.Enable = false;
            }
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = false;
        } else if (ls_PaymentGubun == "1") { // 카드
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = true;
        } else if (ls_PaymentGubun == "2") { // 현금영수증
            btnProcRct.Text = "현금영수증취소";
            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
                btnProcRct.Enable = true;
            } else {
                btnProcRct.Enable = false;
            }
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = true;
        } else if (ls_PaymentGubun == "3") { // 가상계좌
            btnProcRct.Text = "현금영수증처리";
            if ((ls_SunapGubun == "01" || ls_SunapGubun == "11") && ln_RepayRefNo == 0) { // 수납 또는 회계수납이면서 환불이 안된 경우
                btnProcRct.Enable = true;
            } else {
                btnProcRct.Enable = false;
            }
            btnShowVirtualAccount.Enable = true;
            btnPosResultList.Enable = true;
        } else {
            btnProcRct.Enable = false;
            btnShowVirtualAccount.Enable = false;
            btnPosResultList.Enable = false;
        }
        if (obj.GetColumn(nRow, "TSGUBUN") == "15" || obj.GetColumn(nRow, "TSGUBUN") == "25" ) { // 가상계좌보기
            btnShowVirtualAccount.Enable = true;
        }
        btnChangeProcDate.Enable = true;
        btnPrintReRct.Enable = true;
    } else {
        btnPosResultList.Enable = false;
        btnChangeProcDate.Enable = false;
        btnPrintReRct.Enable = false;
        btnShowVirtualAccount.Enable = false;
        btnShowVirtualAccount.Enable = false;
    }
}

// 결제처리결과조회
function btnPosResultList_OnClick(obj) {
    // 안전원와 LGD 결과 내용 조회
	var ls_Regfn_Check = gfn_CheckPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")
                            , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"));
}

// 가상계좌보기
function btnShowVirtualAccount_OnClick(obj) {
    if ((ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG") <> "3")
                && (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUN") <> "15")
                && (ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUN") <> "25")
            ) { // 납입방법
        gfn_Alert("선택하신 결제는 가상계좌결제가 아닙니다.");
        return false;
    }

    // POS 결과 정보를 조회한다.
	var lb_Result = gfn_SearchPosResult(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")
        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO")
        , ds_oPosResult);
    if (!lb_Result) {
        gfn_Alert("가상계좌정보가 없습니다.");
        return false;
    }

    var sArg = ""; // 팝업파라메터
    sArg = "sVirtCloseDate=" + quote(ds_oPosResult.GetColumn(0, "VIRTCLOSEDATE")); // 가상계좌유효기간
    sArg += " sVirtStat=" + quote(ds_oPosResult.GetColumn(0, "VIRTRESULT")); // 입금여부(R-계좌 할당,I-입금,C-취소)
    sArg += " sVirtAccountNo=" + quote(ds_oPosResult.GetColumn(0, "VIRTACCOUNT")); // 계좌번호
    sArg += " sVirtBankCd=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKCD")); // 은행코드
    sArg += " sVirtBankNm=" + quote(ds_oPosResult.GetColumn(0, "VIRTBANKNM")); // 은행명칭
    sArg += " sVirtInputAmount=" + quote(ds_oPosResult.GetColumn(0, "VIRTINPUTAMT")); // 입금액
    sArg += " sVirtBankDate=" + quote(ds_oPosResult.GetColumn(0, "PCBANKDATE")); // 입금/취소일자

	Dialog("COM::frmCOM3401PVirtualAccountPOSResult.xml", sArg, 400, 224, "", -1, -1);
}

// 처리일자변경
function btnChangeProcDate_OnClick(obj) {
    if (ds_oSetlmentHist.currow < 0) {
        gfn_Alert("결제 내역을 선택해 주세십시오.");
        return false;
    }

    var sArg = "sTjmgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSTJMGNO"));
    sArg += " sSetlmtSeq=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSSEQ"));
    sArg += " sProcDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPROCDATE"));
    sArg += " sPonyDate=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPONYDATE"));
    sArg += " sPonyDateCheck=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPONYGUBUN"));
    sArg += " sPmYear=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR"));
    sArg += " sPmMgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"));
    sArg += " sTsgubun=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSGUBUN"));

	var ls_RetProc = Dialog("training::frmtraining0025PTrainingJubsuProcessDateChange.xml", sArg, 572, 184, "", -1, -1);

	if (ls_RetProc == "OK") {
        lfn_SearchTrainingSetlmentHistList(); // 결제내역 조회
	}
}

// 현금영수증처리/취소
function btnProcRct_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다. 저장 후 처리해 주십시오.");
        return false;
    }
    if (left(GetDate(), 8) >= left(AddDate(ds_oTrainingOrderMgno.GetColumn(0, "TOSTARTDATE"), 365), 8)) {
        gfn_Alert("교육시작일로부터 1년이 지났습니다.");
        return false;
    }
    if (ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '5' // 5:환불신청(미입금)
            || ds_ioTrainingJubsu.GetColumn(0, "LASTSTATUS") == '6') { // 6:환불접수(신청확인)
        gfn_Alert("인터넷 환불 처리 중입니다.");
        return false;
    }

    var ls_Key1 = ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"); // KEY값1-접수관리번호
    var ls_Key2 = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSSEQ"); // KEY값2-결제순차번호
    var ls_RepayPosYear = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR"); // POS년도
    var ls_RepayPosMgno = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO"); // POS관리번호
    var ls_RepayPayment = ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "PMPAYMENTFLAG"); // 결과출력용 납입방법(0,1,2,3)

    // 통합영수증발급(POS)시스템 현금영수증처리 팝업을 호출한다.
    var arrPos = gfn_TrainingCashChangePOSPopup("21", ls_Key1, ls_Key2, ls_RepayPosYear, ls_RepayPosMgno, ls_RepayPayment);

    if (arrPos[0] <> "END") {
        lfn_SearchTrainingJubsuList(); // 접수번호로 다시 조회한다.
    }
}

// 영수증재발행
function btnPrintReRct_OnClick(obj) {
    if (!gfn_Confirm("영수증을 재발행 하시겠습니까?")) {
        return false;
	}

    gfn_PrintReceipt(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMYEAR")
        , ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSPMMGNO")); // 영수증을 출력한다.
}

// SMS현황
function btnSmsStat_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        return false;
    }

    var sArg = "sTjmgno=" + quote(ds_oSetlmentHist.GetColumn(ds_oSetlmentHist.currow, "TSTJMGNO"));
	Dialog("training::frmtraining0026PTrainingSmsSendList.xml", sArg, 600, 400, "", -1, -1);

}

// 수강증
function btnPrintJubsu_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");
        edJubsuNo.SetFocus();
        return false;
    }
    if (!gfn_Confirm("수강증을 출력 하시겠습니까?")) {
        return false;
	}

    // 출력이력을 저장한다.
    gfn_InsertSearchPrintHistory(
            "P"
            , this.ID
            , global.mnuLeft.cbxOpenForm.Text + "(수강증)"
            , "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
        );

    ds_oTrainingJubsuPrint.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingJubsuPrint", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oTrainingJubsuPrint=ds_oTrainingJubsuPrint"    // outDs
        ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args
        ,""
        ,false
        ,false
        ,true
    );

    var lb_IsPrintedOk = gfn_PrintReport("frmtraining0020R01LectureLicense.rex", "ds_oTrainingJubsuPrint", "", false, "수강증");
}

// 강습접수결과 출력
function btnPrintJubsuResult_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"))) {
        gfn_Alert("출력할 접수번호를 먼저 조회해 주십시오.");
        edJubsuNo.SetFocus();
        return false;
    }
    if (!gfn_Confirm("강습접수결과를 출력 하시겠습니까?")) {
        return false;
	}

    // 출력이력을 저장한다.
    gfn_InsertSearchPrintHistory(
            "P"
            , this.ID
            , global.mnuLeft.cbxOpenForm.Text + "(강습접수결과)"
            , "접수관리번호=" + ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")
        );

    ds_oTrainingJubsuPrint.ClearData(); // 데이타셋 초기화

    tit_clearActionInfo();
    tit_addSearchActionInfo("training:searchTrainingJubsuResultPrint1", false);
    tit_addSearchActionInfo("training:searchTrainingJubsuResultPrint2", false);
    tit_addSearchActionInfo("training:searchTrainingJubsuResultPrint3", false);
    // 서버 호출
    tit_callService(
        ""
        ,""
        ,""    // inDs
        ,"ds_oTrainingJubsuPrint1=ds_oTrainingJubsuPrint1 ds_oTrainingJubsuPrint2=ds_oTrainingJubsuPrint2 ds_oTrainingJubsuPrint3=ds_oTrainingJubsuPrint3" // outDs
        ,"TJMGNO=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO")) // args
        ,""
        ,false
        ,false
        ,true
    );

    var lb_IsPrintedOk = gfn_CallReportPopup("frmtraining0020R04TrainingJubsuResult.rex"
                                , "ds_oTrainingJubsuPrint1||ds_oTrainingJubsuPrint2||ds_oTrainingJubsuPrint3"
                                , "rpDirpath=" + GF_FILE_SERVER_URL + "kems"
                                , false
                            );
}

function radJibuGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	if (strCode == "S") { // 소속지부
        cbxJibu.Enable = false;
        radJibuGubun.BkColor = "";
        if (ds_oJibu.FindRow("CD", gds_oUserInfo.GetColumn(0, "PDEPTCD")) <> -1) {
            cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD");
        }
        lfn_SearchTrainingLatestOrder();
	} else { // 타지부
        cbxJibu.Enable = true;
        radJibuGubun.BkColor = "red";
	}
}

// 수첩보유현황
function btnLicenseList_OnClick(obj) {
    if (gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medResidentNo.Value)) {
        gfn_Alert("성명을 입력해 주십시오.");
        edPersonNm.SetFocus();
        return false;
    }
    if (gfn_IsNull(edPersonNm.Text) && gfn_IsNull(medResidentNo.Value)) {
        gfn_Alert("주민등록번호를 입력해 주십시오.");
        medResidentNo.SetFocus();
        return false;
    }

    var sArg = "sPersonNm=" + quote(edPersonNm.Text);
    sArg += " sResidentNo=" + quote(medResidentNo.Value);
    sArg += " sTpmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TPMGNO"));
    Dialog("training::frmtraining0027PTrainingLicenseList.xml", sArg, 600, 400, "", -1, -1);
}

function radChangeTpmgno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	if (strCode == "C") {
        if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
            gfn_Alert("접수 정보가 없습니다.");
            radChangeTpmgno.Value = "S";
            return false;
        } else {
            gfn_Alert("이 기능은 동일 인물에 대한 오타에 의한 성명/주민번호 변경용입니다.\n따라서, 해당 강습자와 관련된 모든 정보가 일괄 변경되므로, 신중히 변경하시기 바랍니다.");
        }
	}
}

// 접수이력
function btnJubsuHistory_OnClick(obj) {
    if (gfn_IsNull(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"))) {
        gfn_Alert("접수 정보가 없습니다.");
        return false;
    }

    var sArg = "sTjmgno=" + quote(ds_ioTrainingJubsu.GetColumn(0, "TJMGNO"));
    Dialog("training::frmtraining0028PTrainingJubsuHistory.xml", sArg, 600, 400, "", -1, -1);
}
]]></Script>
</Window>
<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="605" Id="frmtraining9002PTrainingSeatListViewer" Left="8" OnKeyDown="Form_OnKeyDown" OnLoadCompleted="Form_OnLoadCompleted" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="좌석배치보기" Top="8" Ver="1.0" Width="730" WorkArea="true">
		<MSIE Bottom="600" DocumentComplete="AxMsie_DocumentComplete" Height="600" Id="AxMsie" Right="725" TitleChange="AxMsie_TitleChange" Width="725"></MSIE>
	</Form>
	<Script><![CDATA[/*
 * 프로그램명 : frmtraining9002PEducationSeatViewerPopup.xml
 * 설명 : 좌석배치생성
 * 작성일 : 2009.11.20
 * 작성자 : 김은규
 */

#include "LIB::COMMON.js"; // 공통 관련

var rtnMgno = "";		//리턴값(좌석번호)
var Url = "";			//URL

/* 공통 필수 시작 */
function Form_OnLoadCompleted(obj)
{
	gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리
	
	lfn_OpenAxMsie();
}

function AxMsie_DocumentComplete(obj,pDisp,URL)
{
	AxMsie.Document.body.Scroll = "yes";    //AxMsie scrollbar 
	AxMsie.Document.body.leftmargin = "0"; //AxMsie leftmargin
	AxMsie.Document.body.topmargin = "0";	//AxMsie topmargin
}

function lfn_OpenAxMsie(obj)
{
	//http://10.10.10.2/edu/flexConn/request_form_seat.php?gubun=m&memid=11113&emgno=3&tomgno=3
	var lsPostData  = "gubun=T";				//Miplatform
		lsPostData += "&tomgno="+ sTomgno;		//회차관리번호
		lsPostData += "&emgno="+ sEmgno;		//교육장관리번호
		lsPostData += "&jubsuno="+ sJubsuno;		//접수번호
		lsPostData += "&maxno="+ sToseatCnt;		//좌석수
		//lsPostData += "&admin=1";
		
	//Url = "http://10.10.10.2/edu/flexConn/request_form_seat.php";
	Url = "http://www.kfsi.or.kr/edu/flexConn/request_form_seat.php";
	var PostData = TextToBin(lsPostData);  //TextToBin을 해 주어야 Post로 정상적으로 전달됨
	var Headers = "Content-Type: application/x-www-form-urlencoded";
	
	AxMsie.Navigate("about:blank", ,"_self", "", "");   //IE6 버그로 인해 넣어주어야 함
	
	AxMsie.Navigate(Url, "", "", PostData, Headers);
}

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	switch (nChar) {
        case 27 : // 종료(Esc)
            lfn_End(rtnMgno);
        break;
    }
}

/*
 * 기능 : 종료
 */
function lfn_End(obj) {
    Close(rtnMgno);
}

function Form_OnUnloadCompleted(obj)
{
	Close(rtnMgno);
}

function AxMsie_TitleChange(obj,Text)
{
	if(Text != "about:blank" && Text != Url) {
		rtnMgno = Text;
		Close(rtnMgno);
	}	
}
]]></Script>
</Window>
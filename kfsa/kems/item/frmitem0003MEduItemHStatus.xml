<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user0" Height="590" Id="frmitem0003MEduItemHStatus" Left="8" OnActivate="Form_OnActivate" OnDeactivate="Form_OnDeactivate" OnFocus="Form_OnFocus" OnKeyDown="Form_OnKeyDown" OnKillFocus="Form_OnKillFocus" OnLoadCompleted="Form_OnLoadCompleted" OnSize="Form_OnSize" OnUnloadCompleted="Form_OnUnloadCompleted" PidAttrib="7" Style="sty_Form" Title="교재수불현황" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="800" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_oJibuAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="EIBTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EIMTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EISTITLE" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
						<EIBTITLE></EIBTITLE>
						<EIMTITLE></EIMTITLE>
						<EISTITLE></EISTITLE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" GroupKey="EIMNM" Id="ds_ioYearList">
				<Contents>
					<colinfo id="EIMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EISCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EISNM" size="256" summ="default" type="STRING"/>
					<colinfo id="GTDEPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPPLY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMAND_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEFICIENCY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTRECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBURECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTUSE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBUUSE_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oJibu">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMCode">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oRCode">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="EIBTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EIMTITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EISTITLE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oSCode">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oYearAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oBCode">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oBCodeAll">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>전체</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oReportGubun">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<DATA>교재별&#32;수불일자별&#32;현황</DATA>
					</record>
					<record>
						<CD>2</CD>
						<DATA>교재별&#32;지부별&#32;현황</DATA>
					</record>
					<record>
						<CD>3</CD>
						<DATA>지부별&#32;교재별&#32;현황</DATA>
					</record>
					<record>
						<CD>4</CD>
						<DATA>수불년도별&#32;현황</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" GroupKey="EISNM" Id="ds_ioYmdList">
				<Contents>
					<colinfo id="EIMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EISCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EISNM" size="256" summ="default" type="STRING"/>
					<colinfo id="GTDEPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EHSUBULDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPPLY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMAND_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEFICIENCY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTRECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBURECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTUSE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBUUSE_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oMCodeAll2">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<DATA>선택안함</DATA>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" GroupKey="EISNM" Id="ds_ioItemJibuList">
				<Contents>
					<colinfo id="EIMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EISCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EISNM" size="256" summ="default" type="STRING"/>
					<colinfo id="GTDEPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EHSUBULDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPPLY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMAND_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEFICIENCY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTRECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBURECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTUSE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBUUSE_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" GroupKey="GTDEPTNM" Id="ds_ioJibuItemList">
				<Contents>
					<colinfo id="EIMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EISCD" size="256" summ="default" type="STRING"/>
					<colinfo id="EISNM" size="256" summ="default" type="STRING"/>
					<colinfo id="GTDEPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EHSUBULDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPPLY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEMAND_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEFICIENCY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTRECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBURECEIPT_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTUSE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAJIBUUSE_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div BKColor="user0" Height="28" Id="divWorkFormTitle" OnLoadCompleted="Form_OnLoadCompleted" Style="sty_Form" TabOrder="2" TabStop="FALSE" Text="Div0" Url="COM::frmCOM0100SWorkFormTitle.xml" Width="260">
			<Contents></Contents>
		</Div>
		<Shape Bottom="28" Height="28" Id="Shape0" Left="357" LineColor="user14" Right="797" TabOrder="7" Top="0" Type="Rectangle" Width="440"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnSearch" ImageID="BTN_COM_SEARCH" Left="360" OnClick="lfn_Search" Style="sty_Button" TabOrder="7" ToolTipText="조회" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnCancel" ImageID="BTN_COM_INIT" Left="447" OnClick="lfn_Cancel" Style="sty_Button" TabOrder="3" ToolTipText="입력&#32;초기화" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnToExcel" ImageID="BTN_COM_EXCEL" Left="534" OnClick="lfn_Excel" Style="sty_Button" TabOrder="4" ToolTipText="엑셀로&#32;저장" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrintScreen" ImageID="BTN_COM_SCREEN" Left="621" OnClick="lfn_PrintScreen" Style="sty_Button" TabOrder="5" ToolTipText="화면&#32;출력" Top="3" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnEnd" ImageID="BTN_COM_END" Left="708" OnClick="lfn_End" Style="sty_Button" TabOrder="6" ToolTipText="닫기" Top="3" Width="85"></Button>
		<Static Align="Center" Height="20" Id="Static8" Left="-144" Style="sty_LabelGruopBox" TabOrder="7" Text="안전원&#32;교수&#32;관리" Top="63" VAlign="Middle" Width="120"></Static>
		<Shape Bottom="116" Height="76" Id="shpGubunBox1" Left="4" LineColor="user15" Right="796" TabOrder="9" Top="40" Type="Rectangle" Width="792"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnMutilSort" ImageID="BTN_MULTI_SORT" Left="720" OnClick="btnMutilSort_OnClick" Style="sty_Button" TabOrder="10" Top="120" Transparent="TRUE" Width="74"></Button>
		<Static Align="Center" Height="20" Id="lbEiSCdSearch" Left="480" Style="sty_Label" TabOrder="11" Text="교재명" Top="92" UserData="S" VAlign="Middle" Width="72"></Static>
		<Static Align="Center" Height="20" Id="Static4" Left="183" Style="sty_Label" TabOrder="12" Text="수불일자" Top="68" UserData="S" VAlign="Middle" Width="72"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calSubulDateSearchFr" Left="258" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="13" Top="68" UserData="S" WeeksFont="돋음,9" Width="100"></Calendar>
		<Static Align="Center" Height="20" Id="lbYear" Left="182" Style="sty_Label" TabOrder="14" Text="수불년도" Top="68" UserData="S" VAlign="Middle" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="20" Id="cbxYearSearch" INDEX="0" InnerDataset="ds_oYearAll" Left="257" ResetIndex="FIRST" Style="sty_Combo" TabOrder="15" Top="67" UserData="S" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="lbJibu" Left="8" Style="sty_Label" TabOrder="21" Text="부서/지부" Top="68" UserData="S" VAlign="Middle" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="20" Id="cbxJibuSearch" INDEX="0" InnerDataset="ds_oJibuAll" Left="82" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="16" Top="67" UserData="S" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="Static13" Left="621" Style="sty_Label" TabOrder="22" Text="교재분류" Top="68" UserData="S" VAlign="Middle" Visible="FALSE" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxEiRCdSearch" INDEX="0" InnerDataset="ds_oRCodeAll" Left="696" OnChanged="cbxEiRCdSearch_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="17" Top="67" UserData="I" Visible="FALSE" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="lbEiBCdSearch" Left="8" Style="sty_Label" TabOrder="20" Text="교육구분" Top="92" UserData="S" VAlign="Middle" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxEiBCdSearch" INDEX="0" InnerDataset="ds_oBCodeAll" Left="82" OnChanged="cbxEiBCdSearch_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="18" Top="91" UserData="S" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="lbEiMCdSearch" Left="182" Style="sty_Label" TabOrder="23" Text="제작년도" Top="92" UserData="S" VAlign="Middle" Width="72"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxEiMCdSearch" INDEX="0" InnerDataset="ds_oMCodeAll" Left="257" OnChanged="cbxEiMCdSearch_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="19" Top="91" UserData="S" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="lbTotalCnt" Left="4" Style="sty_LabelStat" TabOrder="25" Text="총건수" Top="120" VAlign="Middle" Width="68"></Static>
		<MaskEdit AutoSelect="TRUE" AutoSkip="TRUE" Border="Flat" Enable="FALSE" Height="20" Id="medTotalCnt" Left="75" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" Readonly="TRUE" Style="sty_Edit" TabOrder="24" Top="120" UserData="I" Width="68"></MaskEdit>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxEiSCdSearch" INDEX="0" InnerDataset="ds_oSCodeAll" Left="554" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="26" Top="91" UserData="S" Value="0" Width="214"></Combo>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="20" Id="cbxJibu" INDEX="0" InnerDataset="ds_oJibu" Left="786" OnChanged="cbxDept_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="27" Top="91" Value="0" Visible="FALSE" Width="8"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btnPrint" ImageID="BTN_COM_PRINT" Left="270" OnClick="lfn_Print" Style="sty_Button" TabOrder="28" ToolTipText="출력" Top="3" Visible="FALSE" Width="85"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ioYearList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="585" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="28" Height="442" Id="gdYearList" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnHeadClick="gdEduItemH_OnHeadClick" Right="796" RowHeight="20" Style="sty_Grid" TabOrder="29" TabStop="true" Top="143" UseDBuff="true" UsePopupMenu="true" UserData="수불년도별현황" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="61"/>
						<col width="188"/>
						<col width="65"/>
						<col width="63"/>
						<col width="62"/>
						<col width="70"/>
						<col width="70"/>
						<col width="63"/>
						<col width="62"/>
						<col width="62"/>
						<col width="65"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="교보재분류"/>
						<cell col="1" display="text" rowspan="2" text="제작년도"/>
						<cell align="center" col="2" display="text" rowspan="2" text="교재명"/>
						<cell col="3" display="text" rowspan="2" text="지부"/>
						<cell col="4" colspan="4" display="text" text="수령"/>
						<cell col="8" colspan="3" display="text" text="사용"/>
						<cell col="11" display="text" rowspan="2" text="재고"/>
						<cell align="center" col="0" display="text" row="1" text="교보재분류"/>
						<cell col="4" display="text" row="1" text="계"/>
						<cell col="5" display="text" row="1" text="수령"/>
						<cell col="6" display="text" row="1" text="타지부&#10;수령"/>
						<cell col="7" display="text" row="1" text="타지부&#10;지원"/>
						<cell col="8" display="text" row="1" text="계"/>
						<cell col="9" display="text" row="1" text="교육"/>
						<cell col="10" display="text" row="1" text="기타"/>
					</head>
					<body>
						<cell align="center" col="0" colid="EIKINDGUBUNNM" display="text"/>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="1" colid="EIMNM" combocol="column3" combotext="column3" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumtext="소계"/>
						<cell align="left" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="2" colid="EISNM" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)"/>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="3" colid="GTDEPTNM" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="4" colid="TOTRECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTRECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="5" colid="RECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="RECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="6" colid="TAJIBURECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBURECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="7" colid="TAJIBUUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBUUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="8" colid="TOTUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="9" colid="USEEDU_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEEDU_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="10" colid="USEETC_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEETC_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="11" colid="SUPPLY_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="SUPPLY_CNT.sum"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="20" Id="Static0" Left="8" Style="sty_LabelStat" TabOrder="30" Text="출력구분" Top="44" VAlign="Middle" Width="72"></Static>
		<Radio Border="Flat" CodeColumn="CD" ColumnCount="4" DataColumn="DATA" Height="20" Id="radReportGubun" INDEX="0" InnerDataset="ds_oReportGubun" Left="83" LeftMargin="4" OnChanged="radReportGubun_OnChanged" OnKeyDown="gfn_EnterNextFocus" RightMargin="4" Style="sty_Radio" TabOrder="31" Top="44" UserData="S" Width="701"></Radio>
		<Static Align="Center" Height="20" Id="Static22" Left="360" Style="sty_Text" TabOrder="33" Text="~" Top="68" VAlign="Middle" Width="20"></Static>
		<Calendar Border="Flat" Dateformat="yyyy-MM-dd" DayFont="돋음,9" DaySelect="Auto" EditAlign="CENTER" HeaderFont="돋음,10,Bold" Height="20" Id="calSubulDateSearchTo" Left="376" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" SaturdayTextColor="blue" SelectedDayFont="돋음,9,Bold" Style="sty_Calendar" SundayTextColor="red" TabOrder="32" Top="68" UserData="S" WeeksFont="돋음,9" Width="100"></Calendar>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Enable="FALSE" Height="20" Id="cbxEiMCdSearch2" INDEX="0" InnerDataset="ds_oMCodeAll2" Left="376" OnChanged="cbxEiMCdSearch_OnChanged" OnFocus="gfn_ComponentOnFocus" OnKeyDown="gfn_EnterNextFocus" OnKillFocus="gfn_ComponentOnKillFocus" ResetIndex="FIRST" Style="sty_Combo" TabOrder="35" Top="91" UserData="S" Visible="FALSE" Width="96"></Combo>
		<Static Align="Center" Height="20" Id="Static1" Left="353" Style="sty_Text" TabOrder="36" Text="~" Top="91" VAlign="Middle" Visible="FALSE" Width="20"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ioJibuItemList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="585" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="28" Height="442" Id="gdJibuItemList" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnHeadClick="gdEduItemH_OnHeadClick" Right="796" RowHeight="20" Style="sty_Grid" TabOrder="38" TabStop="true" Top="143" UseDBuff="true" UsePopupMenu="true" UserData="지부별&#32;교재별&#32;현황" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">
			<contents>
				<format id="Default">
					<columns>
						<col width="1"/>
						<col width="70"/>
						<col width="184"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" rowspan="2" text="교보재분류"/>
						<cell col="1" display="text" rowspan="2" text="지부"/>
						<cell align="center" col="2" display="text" rowspan="2" text="교재명"/>
						<cell col="3" colspan="4" display="text" text="수령"/>
						<cell col="7" colspan="3" display="text" text="사용"/>
						<cell col="7" display="text" row="1" text="계"/>
						<cell col="8" display="text" row="1" text="교육"/>
						<cell col="10" display="text" rowspan="2" text="재고"/>
						<cell col="3" display="text" row="1" text="계"/>
						<cell col="4" display="text" row="1" text="수령"/>
						<cell col="5" display="text" row="1" text="타지부&#10;수령"/>
						<cell col="6" display="text" row="1" text="타지부&#10;지원"/>
						<cell col="9" display="text" row="1" text="기타"/>
					</head>
					<body>
						<cell align="center" col="0" colid="EIKINDGUBUNNM" display="text"/>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="1" colid="GTDEPTNM" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumtext="&#32;"/>
						<cell align="expr:iif(rowlevel==1,&apos;center&apos;,&apos;left&apos;)" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="2" colid="EISNM" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumtext="소계"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="3" colid="TOTRECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTRECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="4" colid="RECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="RECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="5" colid="TAJIBURECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBURECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="6" colid="TAJIBUUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBUUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="7" colid="TOTUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="8" colid="USEEDU_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEEDU_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="9" colid="USEETC_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEETC_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="10" colid="SUPPLY_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ioItemJibuList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="585" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="28" Height="442" Id="gdItemJibuList" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnHeadClick="gdEduItemH_OnHeadClick" Right="796" RowHeight="20" Style="sty_Grid" TabOrder="37" TabStop="true" Top="143" UseDBuff="true" UsePopupMenu="true" UserData="교재별&#32;지부별&#32;현황" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="209"/>
						<col width="70"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="교보재분류"/>
						<cell align="center" col="1" display="text" rowspan="2" text="교재명"/>
						<cell col="2" display="text" rowspan="2" text="지부"/>
						<cell col="3" colspan="4" display="text" text="수령"/>
						<cell col="7" colspan="3" display="text" text="사용"/>
						<cell col="7" display="text" row="1" text="계"/>
						<cell col="8" display="text" row="1" text="교육"/>
						<cell col="10" display="text" rowspan="2" text="재고"/>
						<cell col="0" display="text" row="1"/>
						<cell col="3" display="text" row="1" text="계"/>
						<cell col="4" display="text" row="1" text="수령"/>
						<cell col="5" display="text" row="1" text="타지부&#10;수령"/>
						<cell col="6" display="text" row="1" text="타지부&#10;지원"/>
						<cell col="9" display="text" row="1" text="기타"/>
					</head>
					<body>
						<cell align="center" col="0" colid="EIKINDGUBUNNM" display="text"/>
						<cell align="expr:iif(rowlevel==1,&apos;center&apos;,&apos;left&apos;)" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="1" colid="EISNM" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumtext="소계"/>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="2" colid="GTDEPTNM" display="text" subsumtext="&#32;"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="3" colid="TOTRECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTRECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="4" colid="RECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="RECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="5" colid="TAJIBURECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBURECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="6" colid="TAJIBUUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBUUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="7" colid="TOTUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="8" colid="USEEDU_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEEDU_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="9" colid="USEETC_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEETC_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="10" colid="SUPPLY_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ioYmdList" BkColor2="user2" BkSelColor="user3" BoldHead="true" Border="Flat" Bottom="585" ColSizing="TRUE" Enable="true" EndLineColor="default" FillAreaType="All" HeadBorder="Flat" HeadHeight="28" Height="442" Id="gdYmdList" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnHeadClick="gdEduItemH_OnHeadClick" Right="796" RowHeight="20" Style="sty_Grid" TabOrder="34" TabStop="true" Top="143" UseDBuff="true" UsePopupMenu="true" UserData="수불일자별현황" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="792">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="183"/>
						<col width="77"/>
						<col width="55"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="53"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="교보재분류"/>
						<cell align="center" col="1" display="text" rowspan="2" text="교재명"/>
						<cell col="2" display="text" rowspan="2" text="수불일자"/>
						<cell col="3" display="text" rowspan="2" text="지부"/>
						<cell col="4" colspan="4" display="text" text="수령"/>
						<cell col="8" colspan="3" display="text" text="사용"/>
						<cell col="8" display="text" row="1" text="계"/>
						<cell col="10" display="text" row="1" text="기타"/>
						<cell col="11" display="text" rowspan="2" text="재고"/>
						<cell col="0" display="text" row="1"/>
						<cell col="4" display="text" row="1" text="계"/>
						<cell col="5" display="text" row="1" text="수령"/>
						<cell col="6" display="text" row="1" text="타지부&#10;수령"/>
						<cell col="7" display="text" row="1" text="타지부&#10;지원"/>
						<cell col="9" display="text" row="1" text="교육"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="0" colid="EIKINDGUBUNNM" display="text"/>
						<cell align="expr:iif(rowlevel==1,&apos;center&apos;,&apos;left&apos;)" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="1" colid="EISNM" display="text" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumtext="소계"/>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="2" colid="EHSUBULDATE" display="text" Mask="####-##-##" subsumtext="&#32;"/>
						<cell align="center" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="3" colid="GTDEPTNM" display="text" subsumtext="&#32;"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="4" colid="TOTRECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTRECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="5" colid="RECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="RECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="6" colid="TAJIBURECEIPT_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBURECEIPT_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="7" colid="TAJIBUUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TAJIBUUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="8" colid="TOTUSE_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTUSE_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="9" colid="USEEDU_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEEDU_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="10" colid="USEETC_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="USEETC_CNT.sum"/>
						<cell align="right" bkcolor="expr:iif(rowlevel==1,&apos;wheat&apos;,&apos;&apos;)" col="11" colid="SUPPLY_CNT" display="number" font="expr:iif(rowlevel==1,&apos;굴림,&#32;10,&#32;bold&apos;)" subsumexpr="TOTRECEIPT_CNT.sum&#32;-&#32;TOTUSE_CNT.sum"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*

 * 프로그램명 : frmitem0003MEduItemHMgmt.xml

 * 설명 : 교보재수불현황

 * 작성일 : 2009.12.17

 * 작성자 : 김종복

 */

 

#include "LIB::item.js"; // 공통업무 관련



/* 공통 필수 시작 */

function Form_OnLoadCompleted(obj) {

    gfn_Form_OnLoadCompleted(obj); // 공통 폼 로딩 이벤트 처리



    // 폼 환경설정

    ls_SystemGubun = gs_SystemGubun;

    ls_SystemMenuId = gs_SystemMenuId;

    var ls_FormId = split(sFormUrl, "::");

    ls_FormId = split(ls_FormId[1], ".");

    obj.Title = sFormTitle + "(" + ls_FormId[0] + ")";



    gfn_MakeRequiredInputMark(this); // 필수 입력란을 설정한다.



    ms_FormAuth = gfn_GetFormAuth(this); // 권한을 조회한다.

    if (ms_FormAuth == "W") { // 권한에 따른 버튼 설정

        lfn_SetFormAuth(true); // 저장 권한

    } else if (ms_FormAuth == "R") {

        lfn_SetFormAuth(false); // 읽기 권한

    } else {

        gfn_Alert(MSGI00080);

        close();

    }

    

	lfn_MakeJibuSearchCode("A"); // 부서&지부 콤보 생성

    lfn_MakeEduItemRCode("A"); // 교보재분류 콤보목록 생성

    lfn_MakeJibuSearchCode("B"); // 부서&지부 콤보 생성

    

    cbxEiRCdSearch.Value = "1";

	cbxEiRCdSearch_OnChanged("",cbxEiRCdSearch.Value);

	

	lfn_MakeSearchYear(); // 기준년도 조회조건 생성

	

	calSubulDateSearchFr.Value = substr(getDate(),0,4)+"0101";

	calSubulDateSearchTo.Value = substr(getDate(),0,8);

	radReportGubun_OnChanged();

}





/*

 * 기능 : 부서/지부 콤보 생성

 */

function lfn_MakeJibuSearchCode(sGubun) {

	if (sGubun == "A") {

		ds_oJibuAll.ClearData(); // 데이타셋 초기화

		gfn_SearchAllJibu(cbxJibuSearch, "Y", "전체"); // 지부 코드 조회

		

		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM" || gds_oUserInfo.GetColumn(0, "PDEPTCD") == "0252") { // 관리자 또는 교재개발과

			ds_oJibuAll.AddRow();

			ds_oJibuAll.SetColumn(ds_oJibuAll.row, "CD", "0252");

			ds_oJibuAll.SetColumn(ds_oJibuAll.row, "DATA", "교재개발과");

//			cbxJibuSearch.Enable = true;

		} else {

//			cbxJibuSearch.Enable = false;

		}

		

		// cbxJibuSearch.Index = 0;	// 로그인한 사용자의 부서로 세팅

	} else {

		ds_oJibu.ClearData(); // 데이타셋 초기화

		gfn_SearchAllJibu(cbxJibu, "Y", ""); // 지부 코드 조회

		

		if (gds_oUserInfo.GetColumn(0, "ADMINGUBUN") == "SM" || gds_oUserInfo.GetColumn(0, "PDEPTCD") == "0252") { // 관리자 또는 교재개발과

			ds_oJibu.AddRow();

			ds_oJibu.SetColumn(ds_oJibu.row, "CD", "0252");

			ds_oJibu.SetColumn(ds_oJibu.row, "DATA", "교재개발과");

			cbxJibu.Enable = true;

		} else {

			cbxJibu.Enable = false;

		}

		

		cbxJibu.Value = gds_oUserInfo.GetColumn(0, "PDEPTCD"); // 로그인한 사용자의 부서로 세팅

	}

}



/*

 * 기능 : 교보재분류 콤보 생성

 */

function lfn_MakeEduItemRCode(sGubun) {

	if (sGubun == "A") {

		ds_oRCodeAll.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemRCode("ds_oRCodeAll"); // 교보재분류 콤보목록 조회

		ds_oRCodeAll.InsertRow(0);

		ds_oRCodeAll.SetColumn(ds_oRCodeAll.row, "CD", "");

		ds_oRCodeAll.SetColumn(ds_oRCodeAll.row, "DATA", "전체");

		cbxEiRCdSearch.Index = 0;

	} else {

		ds_oRCode.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemRCode("ds_oRCode"); // 교보재분류 콤보목록 조회

	}

}



/*

 * 기능 : 대분류코드 콤보 생성

 */

function lfn_MakeEduItemBCode(sGubun) {

	if (sGubun == "A") {

		ds_oBCodeAll.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemBCode("ds_oBCodeAll", cbxEiRCdSearch.Value); // 대분류코드 콤보목록 조회

		ds_oBCodeAll.InsertRow(0);

		ds_oBCodeAll.SetColumn(ds_oBCodeAll.row, "CD", "");

		ds_oBCodeAll.SetColumn(ds_oBCodeAll.row, "DATA", "전체");

		cbxEiBCdSearch.Index = 0;

	} else {

		ds_oBCode.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemBCode("ds_oBCode", cbxEiRCdSearch.Value); // 대분류코드 콤보목록 조회

	}

}



/*

 * 기능 : 중분류코드 콤보 생성

 */

function lfn_MakeEduItemMCode(sGubun) {

	if (sGubun == "A") {

		// 데이타셋 초기화

		ds_oMCodeAll.ClearData();  // 중분류 START 조회

		ds_oMCodeAll2.ClearData(); // 중분류 END 조회

		// END 

		

		lfn_SearchEduItemMCode("ds_oMCodeAll", cbxEiRCdSearch.Value, cbxEiBCdSearch.Value); // 중분류코드 콤보목록 조회

		ds_oMCodeAll2.Copy("ds_oMCodeAll");

		ds_oMCodeAll.InsertRow(0);

		ds_oMCodeAll.SetColumn(ds_oMCodeAll.row, "CD", "");

		ds_oMCodeAll.SetColumn(ds_oMCodeAll.row, "DATA", "전체");		

		ds_oMCodeAll2.InsertRow(0);

		ds_oMCodeAll2.SetColumn(ds_oMCodeAll2.row, "CD", "");

		ds_oMCodeAll2.SetColumn(ds_oMCodeAll2.row, "DATA", "선택안함");

		

		cbxEiMCdSearch.Index = 0;

		cbxEiMCdSearch2.Index = 0;

	} else {

		ds_oMCode.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemMCode("ds_oMCode", cbxEiRCdSearch.Value, cbxEiBCdSearch.Value); // 중분류코드 콤보목록 조회

	}	

}



/*

 * 기능 : 소분류코드 콤보 생성

 */

function lfn_MakeEduItemSCode(sGubun) {

	if (sGubun == "A") {

		ds_oSCodeAll.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemSCode("ds_oSCodeAll", cbxEiRCdSearch.Value, cbxEiBCdSearch.Value, cbxEiMCdSearch.Value,  cbxEiMCdSearch2.Value); // 소분류코드 콤보목록 조회

		ds_oSCodeAll.InsertRow(0);

		ds_oSCodeAll.SetColumn(ds_oSCodeAll.row, "CD", "");

		ds_oSCodeAll.SetColumn(ds_oSCodeAll.row, "DATA", "전체");

		cbxEiSCdSearch.Index = 0;

	} else {

		ds_oSCode.ClearData(); // 데이타셋 초기화

		lfn_SearchEduItemSCode("ds_oSCode", cbxEiRCdSearch.Value, cbxEiBCdSearch.Value, cbxEiMCdSearch.Value); // 소분류코드 콤보목록 조회

	}

}



/*

 * 기능 : 교보재분류 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduItemRCode(sDsNm) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0003EduItemRCode", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oItemData" // outDs

		,"" // args 

		,"lfn_AfterSearchEduItemRCode"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 교보재분류 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduItemRCode(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}



/*

 * 기능 : 대분류코드 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduItemBCode(sDsNm, sRCode) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0003EduItemBCode", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oItemData" // outDs

		,"RCODE=" + quote(sRCode) //-- 교보재분류 // args 

		,"lfn_AfterSearchEduItemBCode"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 대분류코드 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduItemBCode(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}



/*

 * 기능 : 중분류코드 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduItemMCode(sDsNm, sRCode, sBCode) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0003EduItemMCode", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oItemData" // outDs

		,"RCODE=" + quote(sRCode) //-- 교보재분류

		+" BCODE=" + quote(sBCode) // -- 대분류  // args 

		,"lfn_AfterSearchEduItemMCode"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 중분류코드 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduItemMCode(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}



/*

 * 기능 : 소분류코드 콤보목록 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduItemSCode(sDsNm, sRCode, sBCode, sMCode, sMCode2) {

	object(sDsNm).ClearData(); // 데이타셋 초기화

	tit_clearActionInfo();

	

	tit_addSearchActionInfo("item:searchItem0002EduItemSCode", false);

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,sDsNm + "=ds_oItemData" // outDs

		,"RCODE=" + quote(sRCode) //-- 교보재분류

		    +" BCODE=" + quote(sBCode) // -- 대분류

		    +" MCODE=" + quote(sMCode) // -- 중분류 // args 

		    +" MCODE2=" + quote(sMCode2) // -- 중분류2 // args 

		,"lfn_AfterSearchEduItemSCode"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 소분류코드 콤보목록 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduItemSCode(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

}



/*

 * 기능 :폼사이즈 조정

 */

function Form_OnSize(obj,nCx,nCy,nState) {

    if (gs_IsResizingForm == "Y") {

		// gdEduItemH.Height = nCy - gdEduItemH.Top - 4;

		// gdEduItemH.Width = nCx - gdEduItemH.Left - 4;

    }

}



/*

 * 기능 : 조회

 */

function lfn_Search() {

	lfn_SearchEduItemHList(); // 교보재수불현황 조회

}



/*

 * 기능 : 교보재수불현황 조회

 * parameter : 없음

 * Return : 없음

 */

function lfn_SearchEduItemHList() {

	tit_clearActionInfo();


	var DataSet = "";

	// 교재별 수불일자별 현황
	if(radReportGubun.Value == "1"){
	
		ds_ioYmdList.ClearData(); // 데이타셋 초기화

		tit_addCsvSearchActionInfo("item:searchItem0003EduItemHList_SubulYmd", false);

		DataSet = "ds_ioYmdList=ds_oItemData";

	// 교재별 지부별 현황
	} else if(radReportGubun.Value == "2"){

		ds_ioItemJibuList.ClearData(); // 데이타셋 초기화

		tit_addCsvSearchActionInfo("item:searchItem0003EduItemHList_ItemJibu", false);

		DataSet = "ds_ioItemJibuList=ds_oItemData";
	// 지부별 교재별 현황
	} else if(radReportGubun.Value == "3"){
	
		ds_ioJibuItemList.ClearData(); // 데이타셋 초기화

		tit_addCsvSearchActionInfo("item:searchItem0003EduItemHList_JibuItem", false);

		DataSet = "ds_ioJibuItemList=ds_oItemData";
	// 수불년도별 현황
	} else if(radReportGubun.Value == "4"){
	
		ds_ioYearList.ClearData(); // 데이타셋 초기화

		tit_addCsvSearchActionInfo("item:searchItem0003EduItemHList_SubulYear", false);

		DataSet = "ds_ioYearList=ds_oItemData";

	}

	

	// 서버 호출 

	tit_callService(

		""

		,""

		,""	// inDs

		,DataSet // outDs

		,"GTMGNO=" + quote(cbxJibuSearch.Value) //-- 부서&지부

			+" RCODE=" + quote(cbxEiRCdSearch.Value) // -- 교보재분류

			+" BCODE=" + quote(cbxEiBCdSearch.Value) // -- 대분류

			+" MCODE=" + quote(cbxEiMCdSearch.Value) // -- 중분류 

			+" MCODE2=" + quote(cbxEiMCdSearch2.Value) // -- 중분류2

			+" SCODE=" + quote(cbxEiSCdSearch.Value) // -- 소분류  

			+" YEAR=" + quote(cbxYearSearch.Value) // -- 대상년도  

			+" SUBULYMDFR=" + quote(calSubulDateSearchFr.Value) // -- 수불일자 //arg

			+" SUBULYMDTO=" + quote(calSubulDateSearchTo.Value) // -- 수불일자 //arg

		,"lfn_AfterSearchEduItemHList"

		,false

		,false

		,true

	);

}



/*

 * 기능 : 교보재수불현황 조회 후 처리해야 할 내용

 * parameter : nErrorCode - 에러코드

 *             strErrorMsg - 에러메시지

 * Return : 없음

 */

function lfn_AfterSearchEduItemHList(nErrorCode, strErrorMsg) {

    if (nErrorCode != 0) { // 트랜잭션 에러를 처리한다.

        gfn_ErrorMsg(nErrorCode, strErrorMsg);

        return;

    }

    

    if(radReportGubun.Value == "1"){

		medTotalCnt.Value = ds_ioYmdList.GetRowCount();

		gfn_SearchMessage(gdYmdList); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

	}else{

		medTotalCnt.Value = ds_ioYearList.GetRowCount();

		gfn_SearchMessage(gdYearList); // 조회 메세지를 처리하고 그리드의 정렬 헤드 마크를 제거한다.

	}

    

}



/*

 * 기능 : 출력

 */

function lfn_Print(obj) {

	if(radReportGubun.Value == "2"){

		if(ds_ioYearList.rowcount <= 0){

			alert("출력 할 데이터가 없습니다.");

			return;

		}

		gfn_CallReportPopup("frmItem0003R01EduItemHStatus_YearSubul.rex"

					  , "ds_ioYearList"

					  , "REPORT_GUBUN=" + ""

					  , true);

	}else{

		if(ds_ioYmdList.rowcount <= 0){

			alert("출력 할 데이터가 없습니다.");

			return;

		}

		gfn_CallReportPopup("frmItem0003R01EduItemHStatus_YmdSubul.rex"

					  , "ds_ioYmdList"

					  , "SUBUL_YMD_FR=" + calSubulDateSearchFr.Value + "^SUBUL_YMD_TO=" + calSubulDateSearchTo.Value

					  , true);

	}

}



/*

 * 기능 : 초기화

 */

function lfn_Cancel(obj) {

	gfn_FormInit(this);

    cbxEiBCdSearch.Enable = false;

    cbxEiMCdSearch.Enable = false;

    cbxEiMCdSearch2.Enable = false;

	cbxEiSCdSearch.Enable = false;

	

}



/*

 * 기능 : 그리드 정렬 및 체크박스 전체선택

 */

function gdYearList_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {

	if (nCell > 0) {

		var lobj_Dataset = object(obj.BindDataset);

		// 데이터가 있는 경우 해당 컬럼을 기준으로 정렬한다.

		if (lobj_Dataset.GetRowCount() > 1) {

			gfn_GridCellSort(obj, nCell); // 해당 셀정렬을 호출한다.

		}

	}

}



/*

 * 기능 : 다중정렬

 */

function btnMutilSort_OnClick(obj) {

	gfn_GridMultiSort(gdYearList, 1); // 멀티 정렬을 실행한다.

}



/*

 * 기능 : 버튼 활성/비활성시킨다.

 * parameter : bStatus - 활성/비활성여부(true:활성, false:비활성)

 * return : 없음

 */

function lfn_SetFormAuth(bStatus) {

    gdYearList.Editable = bStatus;

}



/*

 * 기능 : 폼 키처리

 */

function Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

    // to do

    gfn_Form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam); // 공통 키 이벤트 처리

}



/*

 * 기능 : 교보재분류 조회 콤보값 변경

 */

function cbxEiRCdSearch_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (gfn_IsNull(cbxEiRCdSearch.Value)) { // 전체

		cbxEiBCdSearch.Enable = false;

		cbxEiBCdSearch.Index = 0;

		cbxEiMCdSearch.Enable = false;

		cbxEiMCdSearch.Index = 0;

		cbxEiMCdSearch2.Enable = false;

		cbxEiMCdSearch2.Index = 0;

		cbxEiSCdSearch.Enable = false;

		cbxEiSCdSearch.Index = 0;

	} else {

		cbxEiBCdSearch.Enable = true;

		lfn_MakeEduItemBCode("A"); // 대분류코드 콤보목록 생성

		cbxEiMCdSearch.Enable = false;

		cbxEiMCdSearch.Index = 0;

		cbxEiMCdSearch2.Enable = false;

		cbxEiMCdSearch2.Index = 0;

		cbxEiSCdSearch.Enable = false;

		cbxEiSCdSearch.Index = 0;

	}

}



/*

 * 기능 : 대분류코드 조회 콤보값 변경

 */

function cbxEiBCdSearch_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (gfn_IsNull(cbxEiBCdSearch.Value)) { // 전체

		cbxEiMCdSearch.Enable = false;

		cbxEiMCdSearch.Index = 0;

		cbxEiSCdSearch.Enable = false;

		cbxEiSCdSearch.Index = 0;

	} else {

		cbxEiMCdSearch.Enable = true;		

		lfn_MakeEduItemMCode("A"); // 중분류코드 콤보목록 생성

		cbxEiSCdSearch.Enable = false;

		cbxEiSCdSearch.Index = 0;

	}

}



/*

 * 기능 : 중분류코드 조회 콤보값 변경

 */

function cbxEiMCdSearch_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if (gfn_IsNull(cbxEiMCdSearch.Value)) { // 전체	

		cbxEiMCdSearch2.Enable = false;

		cbxEiMCdSearch2.Index = 0;

		cbxEiSCdSearch.Enable = false;

		cbxEiSCdSearch.Index = 0;

	} else {

		cbxEiMCdSearch2.Enable = true;

		cbxEiSCdSearch.Enable = true;

		lfn_MakeEduItemSCode("A"); // 소분류코드 콤보목록 생성

	}

}



function radReportGubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)

{
	if (radReportGubun.Value == "1" || radReportGubun.Value == "2" || radReportGubun.Value == "3") {

		Static4.Visible = true;

		calSubulDateSearchFr.Visible = true;

		calSubulDateSearchTo.Visible = true;

		Static22.Visible = true;

		calSubulDateSearchFr.Value = substr(getDate(),0,4)+"0101";

		calSubulDateSearchTo.Value = substr(getDate(),0,8);

		Static1.Visible = true;

		cbxEiMCdSearch2.Visible = true;
		
		if (radReportGubun.Value == "1") {
		
			gdYmdList.Visible = true;
			
			gdItemJibuList.Visible = false;
			
			gdJibuItemList.Visible = false;
			
			gdYearList.Visible = false;

		} else if (radReportGubun.Value == "2") {

			gdYmdList.Visible = false;
			
			gdItemJibuList.Visible = true;
			
			gdJibuItemList.Visible = false;
			
			gdYearList.Visible = false;

		} else if (radReportGubun.Value == "3") {

			gdYmdList.Visible = false;
			
			gdItemJibuList.Visible = false;
			
			gdJibuItemList.Visible = true;
			
			gdYearList.Visible = false;

		} else if (radReportGubun.Value == "4") {

			gdYmdList.Visible = false;
			
			gdItemJibuList.Visible = false;
			
			gdJibuItemList.Visible = false;
			
			gdYearList.Visible = true;

		}
		
		
		// 수불년도
		lbYear.Visible = false;
		
		cbxYearSearch.Visible = false;
		
/*
		// 위치값 변경

		lbEiSCdSearch.Left = 356;

		lbEiSCdSearch.Right = 428;

		cbxEiSCdSearch.Left = 430;

		cbxEiSCdSearch.Right = 644;		
*/
	} else if(radReportGubun.Value == "4") {

		Static4.Visible = false;

		calSubulDateSearchFr.Visible = false;

		calSubulDateSearchTo.Visible = false;

		Static22.Visible = false;

		gdYmdList.Visible = false;
		
		gdItemJibuList.Visible = false;
			
		gdJibuItemList.Visible = false;
		
		gdYearList.Visible = true;

		Static1.Visible = true;

		cbxEiMCdSearch2.Visible = true;

		// 수불년도
		lbYear.Visible = true;
		
		cbxYearSearch.Visible = true;

		// 위치값 변경

		lbEiSCdSearch.Left = 480;

		lbEiSCdSearch.Right = 552;

		cbxEiSCdSearch.Left = 554;

		cbxEiSCdSearch.Right = 768;

	}

}

]]></Script>
</Window>